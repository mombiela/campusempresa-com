<!DOCTYPE html>
<html lang="es">
<head>
    <title> FFI (Interfaz de Función Extranjera) </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/rust/09-03-ffi" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/rust/09-03-ffi" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/rust/09-03-ffi" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.1ab297bfa4.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "es";
  		var CATEGORY = "languages";
  		var MOD_NAME = "rust";
  		var TEMA_NAME = "9-3";
  		var TYPE = "mod";
  		var PATH = "mod/rust/09-03-ffi";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.ae32789132.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo_header.png" alt="Logo Campus Empresa"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/rust/09-03-ffi" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/cursos/rust/09-03-ffi" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objetivo" rel="nofollow">El Proyecto</a> | 
<a href="/acerca-de" rel="nofollow">Sobre nosotros</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donaciones</a> | 
<a href="/licencia" rel="nofollow">Licencia</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/mis-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Mis cursos</b></i>
</a>
<a href="/cursos-finalizados" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalizados             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="rust">
		<a  href="#" class="text-secondary d-none" data-read-mod="rust" data-read-unit="9-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar como leído
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="rust" data-unread-unit="9-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar como no leído
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contenido del curso
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='09-02-unsafe-rust' title="Rust Inseguro" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='09-02-unsafe-rust' title="Rust Inseguro" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">FFI (Interfaz de Función Extranjera)</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='10-01-building-project' title="Construyendo un Proyecto" class="py-2 px-3 btn btn-primary"
				data-read-mod="rust" data-read-unit="9-3">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='10-01-building-project' title="Construyendo un Proyecto" class="py-2 px-3 btn btn-primary" 
				data-read-mod="rust" data-read-unit="9-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>La Interfaz de Función Extranjera (FFI, por sus siglas en inglés) en Rust permite que el código Rust interactúe con código escrito en otros lenguajes de programación, como C. Esto es especialmente útil cuando necesitas utilizar bibliotecas existentes escritas en otros lenguajes o cuando deseas optimizar ciertas partes de tu aplicación con código de bajo nivel.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ol>
<li><strong><code>extern</code></strong>: La palabra clave <code>extern</code> se utiliza para declarar funciones y bloques de código que se implementan en otros lenguajes.</li>
<li><strong><code>unsafe</code></strong>: Interactuar con código externo puede ser inseguro, por lo que muchas operaciones FFI requieren el uso de bloques <code>unsafe</code>.</li>
<li><strong><code>libc</code></strong>: Una biblioteca comúnmente utilizada para FFI en Rust que proporciona bindings a las funciones de la biblioteca estándar de C.</li>
</ol>
</div><h2>Declarando Funciones Externas</h2>
<div class='content'><p>Para llamar a una función escrita en C desde Rust, primero debes declarar la función utilizando la palabra clave <code>extern</code>. Aquí hay un ejemplo simple:</p>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZXh0ZXJuICJDIiB7CiAgICBmbiBwcmludGYoZm9ybWF0OiAqY29uc3QgaTgsIC4uLikgLT4gaTMyOwp9CgpmbiBtYWluKCkgewogICAgbGV0IG1lc3NhZ2UgPSBiIkhlbGxvIGZyb20gUnVzdCFcMCIuYXNfcHRyKCkgYXMgKmNvbnN0IGk4OwogICAgdW5zYWZlIHsKICAgICAgICBwcmludGYobWVzc2FnZSk7CiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>extern &quot;C&quot; {
    fn printf(format: *const i8, ...) -&gt; i32;
}

fn main() {
    let message = b&quot;Hello from Rust!\0&quot;.as_ptr() as *const i8;
    unsafe {
        printf(message);
    }
}</pre></div><div class='content'></div><h3>Explicación del Código</h3>
<div class='content'><ul>
<li><strong><code>extern &quot;C&quot;</code></strong>: Indica que la función sigue el ABI (Application Binary Interface) de C.</li>
<li><strong><code>fn printf(format: *const i8, ...) -&gt; i32</code></strong>: Declara la función <code>printf</code> de C, que toma un puntero a un <code>i8</code> (cadena de caracteres) y una lista de argumentos variables, y devuelve un <code>i32</code>.</li>
<li><strong><code>b&quot;Hello from Rust!\0&quot;.as_ptr() as *const i8</code></strong>: Convierte una cadena de Rust a un puntero de C (<code>*const i8</code>).</li>
<li><strong><code>unsafe</code></strong>: Llama a la función <code>printf</code> dentro de un bloque <code>unsafe</code> porque interactuar con código externo es potencialmente inseguro.</li>
</ul>
</div><h2>Llamando a Funciones de Rust desde C</h2>
<div class='content'><p>Para que el código C pueda llamar a funciones de Rust, debes exportar las funciones de Rust utilizando <code>#[no_mangle]</code> y <code>extern &quot;C&quot;</code>.</p>
</div><h3>Ejemplo</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I1tub19tYW5nbGVdCnB1YiBleHRlcm4gIkMiIGZuIGFkZChhOiBpMzIsIGI6IGkzMikgLT4gaTMyIHsKICAgIGEgKyBiCn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#[no_mangle]
pub extern &quot;C&quot; fn add(a: i32, b: i32) -&gt; i32 {
    a + b
}</pre></div><div class='content'></div><h3>Código C para Llamar a la Función Rust</h3>
<div class='content'></div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CgpleHRlcm4gaW50IGFkZChpbnQgYSwgaW50IGIpOwoKaW50IG1haW4oKSB7CiAgICBpbnQgcmVzdWx0ID0gYWRkKDUsIDMpOwogICAgcHJpbnRmKCJSZXN1bHQ6ICVkXG4iLCByZXN1bHQpOwogICAgcmV0dXJuIDA7Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;

extern int add(int a, int b);

int main() {
    int result = add(5, 3);
    printf(&quot;Result: %d\n&quot;, result);
    return 0;
}</pre></div><div class='content'></div><h2>Ejercicio Práctico</h2>
<div class='content'></div><h3>Ejercicio</h3>
<div class='content'><ol>
<li>Escribe una función en C que multiplique dos números enteros.</li>
<li>Declara y llama a esta función desde Rust.</li>
</ol>
</div><h3>Solución</h3>
<div class='content'><h4>Código C (guardar como <code>multiply.c</code>)</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I2luY2x1ZGUgPHN0ZGlvLmg+CgppbnQgbXVsdGlwbHkoaW50IGEsIGludCBiKSB7CiAgICByZXR1cm4gYSAqIGI7Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#include &lt;stdio.h&gt;

int multiply(int a, int b) {
    return a * b;
}</pre></div><div class='content'><h4>Código Rust</h4>
</div><div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZXh0ZXJuICJDIiB7CiAgICBmbiBtdWx0aXBseShhOiBpMzIsIGI6IGkzMikgLT4gaTMyOwp9CgpmbiBtYWluKCkgewogICAgbGV0IGEgPSA2OwogICAgbGV0IGIgPSA3OwogICAgbGV0IHJlc3VsdDsKICAgIHVuc2FmZSB7CiAgICAgICAgcmVzdWx0ID0gbXVsdGlwbHkoYSwgYik7CiAgICB9CiAgICBwcmludGxuISgiUmVzdWx0OiB7fSIsIHJlc3VsdCk7Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>extern &quot;C&quot; {
    fn multiply(a: i32, b: i32) -&gt; i32;
}

fn main() {
    let a = 6;
    let b = 7;
    let result;
    unsafe {
        result = multiply(a, b);
    }
    println!(&quot;Result: {}&quot;, result);
}</pre></div><div class='content'></div><h3>Compilación y Ejecución</h3>
<div class='content'><ol>
<li>
<p>Compila el archivo C:</p>
<pre><code class="language-sh">gcc -c multiply.c -o multiply.o
gcc -shared -o libmultiply.so multiply.o
</code></pre>
</li>
<li>
<p>Compila y ejecuta el archivo Rust:</p>
<pre><code class="language-sh">rustc main.rs -L . -l multiply
./main
</code></pre>
</li>
</ol>
</div><h2>Resumen</h2>
<div class='content'><p>En esta sección, aprendiste cómo utilizar la Interfaz de Función Extranjera (FFI) en Rust para interactuar con código escrito en otros lenguajes, como C. Vimos cómo declarar y llamar a funciones externas, así como cómo exportar funciones de Rust para que puedan ser llamadas desde C. Practicar estos conceptos te permitirá aprovechar bibliotecas existentes y optimizar tu código Rust con funciones de bajo nivel.</p>
<p>En el siguiente módulo, exploraremos cómo construir un proyecto completo en Rust, incluyendo pruebas y documentación.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='09-02-unsafe-rust' title="Rust Inseguro" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='09-02-unsafe-rust' title="Rust Inseguro" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='10-01-building-project' title="Construyendo un Proyecto" class="py-2 px-3 btn btn-primary"
				data-read-mod="rust" data-read-unit="9-3">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='10-01-building-project' title="Construyendo un Proyecto" class="py-2 px-3 btn btn-primary" 
				data-read-mod="rust" data-read-unit="9-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curso de Programación en Rust</h1>
<h2>Módulo 1: Introducción a Rust</h2>
<ul>
<li><a href="01-01-what-is-rust">¿Qué es Rust?</a></li>
<li><a href="01-02-setting-up-rust">Configuración del Entorno de Rust</a></li>
<li><a href="01-03-hello-world">Programa &quot;Hola, Mundo!&quot;</a></li>
<li><a href="01-04-basic-syntax">Sintaxis y Estructura Básica</a></li>
</ul>
<h2>Módulo 2: Conceptos Básicos</h2>
<ul>
<li><a href="02-01-variables-mutability">Variables y Mutabilidad</a></li>
<li><a href="02-02-data-types">Tipos de Datos</a></li>
<li><a href="02-03-functions">Funciones</a></li>
<li><a href="02-04-control-flow">Flujo de Control</a></li>
</ul>
<h2>Módulo 3: Propiedad y Préstamo</h2>
<ul>
<li><a href="03-01-understanding-ownership">Entendiendo la Propiedad</a></li>
<li><a href="03-02-references-borrowing">Referencias y Préstamo</a></li>
<li><a href="03-03-slices">Slices</a></li>
</ul>
<h2>Módulo 4: Structs y Enums</h2>
<ul>
<li><a href="04-01-defining-structs">Definiendo Structs</a></li>
<li><a href="04-02-using-structs">Usando Structs</a></li>
<li><a href="04-03-enums-pattern-matching">Enums y Coincidencia de Patrones</a></li>
</ul>
<h2>Módulo 5: Colecciones</h2>
<ul>
<li><a href="05-01-vectors">Vectores</a></li>
<li><a href="05-02-strings">Cadenas</a></li>
<li><a href="05-03-hashmaps">HashMaps</a></li>
</ul>
<h2>Módulo 6: Manejo de Errores</h2>
<ul>
<li><a href="06-01-error-handling-result">Manejo de Errores con Result</a></li>
<li><a href="06-02-error-handling-option">Manejo de Errores con Option</a></li>
<li><a href="06-03-panic-unwinding">Pánico y Desenrollado</a></li>
</ul>
<h2>Módulo 7: Conceptos Avanzados</h2>
<ul>
<li><a href="07-01-lifetimes">Tiempos de Vida</a></li>
<li><a href="07-02-traits">Traits</a></li>
<li><a href="07-03-generics">Genéricos</a></li>
</ul>
<h2>Módulo 8: Concurrencia</h2>
<ul>
<li><a href="08-01-threads">Hilos</a></li>
<li><a href="08-02-message-passing">Paso de Mensajes</a></li>
<li><a href="08-03-shared-state">Estado Compartido</a></li>
</ul>
<h2>Módulo 9: Características Avanzadas</h2>
<ul>
<li><a href="09-01-macros">Macros</a></li>
<li><a href="09-02-unsafe-rust">Rust Inseguro</a></li>
<li><a href="09-03-ffi">FFI (Interfaz de Función Extranjera)</a></li>
</ul>
<h2>Módulo 10: Proyecto y Mejores Prácticas</h2>
<ul>
<li><a href="10-01-building-project">Construyendo un Proyecto</a></li>
<li><a href="10-02-testing">Pruebas</a></li>
<li><a href="10-03-documentation">Documentación</a></li>
<li><a href="10-04-best-practices">Mejores Prácticas</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objetivo" rel="nofollow">El Proyecto</a> | 
<a href="/acerca-de" rel="nofollow">Sobre nosotros</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donaciones</a> | 
<a href="/licencia" rel="nofollow">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuario no autenticado</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
