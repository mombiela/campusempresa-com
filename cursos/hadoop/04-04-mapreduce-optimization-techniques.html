<!DOCTYPE html>
<html lang="es">
<head>
    <title> Técnicas de Optimización de MapReduce </title>
        
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, nofollow, noarchive">
    
    <link rel="alternate" href="https://campusempresa.com/cursos/hadoop/04-04-mapreduce-optimization-techniques" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/cursos/hadoop/04-04-mapreduce-optimization-techniques" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/courses/hadoop/04-04-mapreduce-optimization-techniques" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.188a386f47.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "es";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "hadoop";
  		var TEMA_NAME = "4-4";
  		var TYPE = "mod";
  		var PATH = "mod/hadoop/04-04-mapreduce-optimization-techniques";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.902a5a267d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>
	  	
	<!-- Google tag (gtag.js) -->
	<script async src="https://www.googletagmanager.com/gtag/js?id=G-VVPMPJSR3P"></script>
	<script>
	  window.dataLayer = window.dataLayer || [];
	  function gtag(){dataLayer.push(arguments);}
	  gtag('js', new Date());	
	  gtag('config', 'G-VVPMPJSR3P');
	</script>
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<a href="/"><img src="/img/logo_header.png" alt="Logo Campus Empresa"></a>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/courses/hadoop/04-04-mapreduce-optimization-techniques" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/cursos/hadoop/04-04-mapreduce-optimization-techniques" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objetivo" rel="nofollow">El Proyecto</a> | 
<a href="/acerca-de" rel="nofollow">Sobre nosotros</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donaciones</a> | 
<a href="/licencia" rel="nofollow">Licencia</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/mis-cursos" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Mis cursos</b></i>
</a>
<a href="/cursos-finalizados" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalizados             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="hadoop">
		<a  href="#" class="text-secondary d-none" data-read-mod="hadoop" data-read-unit="4-4" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar como leído
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="hadoop" data-unread-unit="4-4" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar como no leído
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contenido del curso
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-03-writing-a-mapreduce-program' title="Escribiendo un Programa MapReduce" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-03-writing-a-mapreduce-program' title="Escribiendo un Programa MapReduce" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h1 style="text-decoration:underline">Técnicas de Optimización de MapReduce</h1>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-01-apache-pig' title="Apache Pig" class="py-2 px-3 btn btn-primary"
				data-read-mod="hadoop" data-read-unit="4-4">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-01-apache-pig' title="Apache Pig" class="py-2 px-3 btn btn-primary" 
				data-read-mod="hadoop" data-read-unit="4-4">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos diversas técnicas para optimizar los trabajos de MapReduce. La optimización es crucial para mejorar el rendimiento y la eficiencia de los trabajos de procesamiento de datos en Hadoop. A continuación, se presentan las técnicas más importantes:</p>
</div><h2><ol>
<li>Compresión de Datos</li>
</ol></h2>
<div class='content'></div><h3>¿Por qué es importante?</h3>
<div class='content'><p>La compresión de datos reduce el tamaño de los datos que se transfieren y almacenan, lo que puede mejorar significativamente el rendimiento de los trabajos de MapReduce.</p>
</div><h3>Tipos de Compresión</h3>
<div class='content'><ul>
<li><strong>Gzip</strong>: Buena compresión, pero no soporta división.</li>
<li><strong>Bzip2</strong>: Mejor compresión que Gzip y soporta división, pero es más lento.</li>
<li><strong>Snappy</strong>: Rápida, pero con menor compresión.</li>
<li><strong>LZO</strong>: Rápida y soporta división, pero requiere instalación adicional.</li>
</ul>
</div><h3>Ejemplo de Configuración</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGNvbmZpZ3VyYXRpb24+CiAgICA8cHJvcGVydHk+CiAgICAgICAgPG5hbWU+bWFwcmVkdWNlLm1hcC5vdXRwdXQuY29tcHJlc3M8L25hbWU+CiAgICAgICAgPHZhbHVlPnRydWU8L3ZhbHVlPgogICAgPC9wcm9wZXJ0eT4KICAgIDxwcm9wZXJ0eT4KICAgICAgICA8bmFtZT5tYXByZWR1Y2UubWFwLm91dHB1dC5jb21wcmVzcy5jb2RlYzwvbmFtZT4KICAgICAgICA8dmFsdWU+b3JnLmFwYWNoZS5oYWRvb3AuaW8uY29tcHJlc3MuU25hcHB5Q29kZWM8L3ZhbHVlPgogICAgPC9wcm9wZXJ0eT4KICAgIDxwcm9wZXJ0eT4KICAgICAgICA8bmFtZT5tYXByZWR1Y2Uub3V0cHV0LmZpbGVvdXRwdXRmb3JtYXQuY29tcHJlc3M8L25hbWU+CiAgICAgICAgPHZhbHVlPnRydWU8L3ZhbHVlPgogICAgPC9wcm9wZXJ0eT4KICAgIDxwcm9wZXJ0eT4KICAgICAgICA8bmFtZT5tYXByZWR1Y2Uub3V0cHV0LmZpbGVvdXRwdXRmb3JtYXQuY29tcHJlc3MuY29kZWM8L25hbWU+CiAgICAgICAgPHZhbHVlPm9yZy5hcGFjaGUuaGFkb29wLmlvLmNvbXByZXNzLlNuYXBweUNvZGVjPC92YWx1ZT4KICAgIDwvcHJvcGVydHk+CjwvY29uZmlndXJhdGlvbj4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.map.output.compress&lt;/name&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.map.output.compress.codec&lt;/name&gt;
        &lt;value&gt;org.apache.hadoop.io.compress.SnappyCodec&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.output.fileoutputformat.compress&lt;/name&gt;
        &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.output.fileoutputformat.compress.codec&lt;/name&gt;
        &lt;value&gt;org.apache.hadoop.io.compress.SnappyCodec&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;</pre></div><div class='content'></div><h2><ol start="2">
<li>Uso de Combiners</li>
</ol></h2>
<div class='content'></div><h3>¿Qué es un Combiner?</h3>
<div class='content'><p>Un Combiner es una mini-reducción que se ejecuta en el nodo de mapeo para reducir la cantidad de datos transferidos a los nodos de reducción.</p>
</div><h3>Ejemplo de Implementación</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15Q29tYmluZXIgZXh0ZW5kcyBSZWR1Y2VyPFRleHQsIEludFdyaXRhYmxlLCBUZXh0LCBJbnRXcml0YWJsZT4gewogICAgcHVibGljIHZvaWQgcmVkdWNlKFRleHQga2V5LCBJdGVyYWJsZTxJbnRXcml0YWJsZT4gdmFsdWVzLCBDb250ZXh0IGNvbnRleHQpIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIGludCBzdW0gPSAwOwogICAgICAgIGZvciAoSW50V3JpdGFibGUgdmFsIDogdmFsdWVzKSB7CiAgICAgICAgICAgIHN1bSArPSB2YWwuZ2V0KCk7CiAgICAgICAgfQogICAgICAgIGNvbnRleHQud3JpdGUoa2V5LCBuZXcgSW50V3JpdGFibGUoc3VtKSk7CiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyCombiner extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        context.write(key, new IntWritable(sum));
    }
}</pre></div><div class='content'></div><h3>Configuración del Combiner</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("am9iLnNldENvbWJpbmVyQ2xhc3MoTXlDb21iaW5lci5jbGFzcyk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>job.setCombinerClass(MyCombiner.class);</pre></div><div class='content'></div><h2><ol start="3">
<li>Particionadores Personalizados</li>
</ol></h2>
<div class='content'></div><h3>¿Qué es un Particionador?</h3>
<div class='content'><p>Un particionador determina en qué partición (reductor) se enviará una clave específica. Un particionador personalizado puede balancear la carga entre los reductores.</p>
</div><h3>Ejemplo de Implementación</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15UGFydGl0aW9uZXIgZXh0ZW5kcyBQYXJ0aXRpb25lcjxUZXh0LCBJbnRXcml0YWJsZT4gewogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IGdldFBhcnRpdGlvbihUZXh0IGtleSwgSW50V3JpdGFibGUgdmFsdWUsIGludCBudW1SZWR1Y2VUYXNrcykgewogICAgICAgIHJldHVybiAoa2V5Lmhhc2hDb2RlKCkgJiBJbnRlZ2VyLk1BWF9WQUxVRSkgJSBudW1SZWR1Y2VUYXNrczsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyPartitioner extends Partitioner&lt;Text, IntWritable&gt; {
    @Override
    public int getPartition(Text key, IntWritable value, int numReduceTasks) {
        return (key.hashCode() &amp; Integer.MAX_VALUE) % numReduceTasks;
    }
}</pre></div><div class='content'></div><h3>Configuración del Particionador</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("am9iLnNldFBhcnRpdGlvbmVyQ2xhc3MoTXlQYXJ0aXRpb25lci5jbGFzcyk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>job.setPartitionerClass(MyPartitioner.class);</pre></div><div class='content'></div><h2><ol start="4">
<li>Ajuste del Número de Reducers</li>
</ol></h2>
<div class='content'></div><h3>¿Por qué es importante?</h3>
<div class='content'><p>El número de reducers puede afectar el rendimiento del trabajo. Demasiados reducers pueden causar sobrecarga, mientras que muy pocos pueden causar cuellos de botella.</p>
</div><h3>Configuración del Número de Reducers</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("am9iLnNldE51bVJlZHVjZVRhc2tzKDEwKTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>job.setNumReduceTasks(10);</pre></div><div class='content'></div><h2><ol start="5">
<li>Uso de Contadores</li>
</ol></h2>
<div class='content'></div><h3>¿Qué son los Contadores?</h3>
<div class='content'><p>Los contadores son herramientas útiles para monitorear y depurar trabajos de MapReduce. Pueden ayudar a identificar cuellos de botella y problemas de rendimiento.</p>
</div><h3>Ejemplo de Uso</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15TWFwcGVyIGV4dGVuZHMgTWFwcGVyPExvbmdXcml0YWJsZSwgVGV4dCwgVGV4dCwgSW50V3JpdGFibGU+IHsKICAgIHByaXZhdGUgc3RhdGljIGZpbmFsIEludFdyaXRhYmxlIG9uZSA9IG5ldyBJbnRXcml0YWJsZSgxKTsKICAgIHB1YmxpYyBzdGF0aWMgZW51bSBDT1VOVEVSUyB7CiAgICAgICAgUkVDT1JEX0NPVU5UCiAgICB9CgogICAgcHVibGljIHZvaWQgbWFwKExvbmdXcml0YWJsZSBrZXksIFRleHQgdmFsdWUsIENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgY29udGV4dC5nZXRDb3VudGVyKENPVU5URVJTLlJFQ09SRF9DT1VOVCkuaW5jcmVtZW50KDEpOwogICAgICAgIC8vIEzDs2dpY2EgZGVsIG1hcGVvCiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyMapper extends Mapper&lt;LongWritable, Text, Text, IntWritable&gt; {
    private static final IntWritable one = new IntWritable(1);
    public static enum COUNTERS {
        RECORD_COUNT
    }

    public void map(LongWritable key, Text value, Context context) throws IOException, InterruptedException {
        context.getCounter(COUNTERS.RECORD_COUNT).increment(1);
        // L&oacute;gica del mapeo
    }
}</pre></div><div class='content'></div><h2><ol start="6">
<li>Configuración de Parámetros de Hadoop</li>
</ol></h2>
<div class='content'></div><h3>Parámetros Clave</h3>
<div class='content'><ul>
<li><strong>mapreduce.task.io.sort.mb</strong>: Tamaño de la memoria para la clasificación de datos.</li>
<li><strong>mapreduce.task.io.sort.factor</strong>: Número de archivos que se pueden mezclar simultáneamente.</li>
<li><strong>mapreduce.reduce.shuffle.parallelcopies</strong>: Número de copias paralelas durante la fase de shuffle.</li>
</ul>
</div><h3>Ejemplo de Configuración</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGNvbmZpZ3VyYXRpb24+CiAgICA8cHJvcGVydHk+CiAgICAgICAgPG5hbWU+bWFwcmVkdWNlLnRhc2suaW8uc29ydC5tYjwvbmFtZT4KICAgICAgICA8dmFsdWU+MTAwPC92YWx1ZT4KICAgIDwvcHJvcGVydHk+CiAgICA8cHJvcGVydHk+CiAgICAgICAgPG5hbWU+bWFwcmVkdWNlLnRhc2suaW8uc29ydC5mYWN0b3I8L25hbWU+CiAgICAgICAgPHZhbHVlPjEwPC92YWx1ZT4KICAgIDwvcHJvcGVydHk+CiAgICA8cHJvcGVydHk+CiAgICAgICAgPG5hbWU+bWFwcmVkdWNlLnJlZHVjZS5zaHVmZmxlLnBhcmFsbGVsY29waWVzPC9uYW1lPgogICAgICAgIDx2YWx1ZT41PC92YWx1ZT4KICAgIDwvcHJvcGVydHk+CjwvY29uZmlndXJhdGlvbj4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.task.io.sort.mb&lt;/name&gt;
        &lt;value&gt;100&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.task.io.sort.factor&lt;/name&gt;
        &lt;value&gt;10&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
        &lt;name&gt;mapreduce.reduce.shuffle.parallelcopies&lt;/name&gt;
        &lt;value&gt;5&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;</pre></div><div class='content'></div><h2>Ejercicio Práctico</h2>
<div class='content'></div><h3>Ejercicio</h3>
<div class='content'><ol>
<li>Escribe un programa MapReduce que cuente la frecuencia de palabras en un conjunto de datos.</li>
<li>Implementa un Combiner para reducir la cantidad de datos transferidos.</li>
<li>Configura la compresión de salida usando Snappy.</li>
<li>Ajusta el número de reducers a 5.</li>
</ol>
</div><h3>Solución</h3>
<div style='position:relative'><a class='copy_button d-none d-md-inline' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFdvcmRDb3VudCB7CiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIFRva2VuaXplck1hcHBlciBleHRlbmRzIE1hcHBlcjxPYmplY3QsIFRleHQsIFRleHQsIEludFdyaXRhYmxlPiB7CiAgICAgICAgcHJpdmF0ZSBmaW5hbCBzdGF0aWMgSW50V3JpdGFibGUgb25lID0gbmV3IEludFdyaXRhYmxlKDEpOwogICAgICAgIHByaXZhdGUgVGV4dCB3b3JkID0gbmV3IFRleHQoKTsKCiAgICAgICAgcHVibGljIHZvaWQgbWFwKE9iamVjdCBrZXksIFRleHQgdmFsdWUsIENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgICAgIFN0cmluZ1Rva2VuaXplciBpdHIgPSBuZXcgU3RyaW5nVG9rZW5pemVyKHZhbHVlLnRvU3RyaW5nKCkpOwogICAgICAgICAgICB3aGlsZSAoaXRyLmhhc01vcmVUb2tlbnMoKSkgewogICAgICAgICAgICAgICAgd29yZC5zZXQoaXRyLm5leHRUb2tlbigpKTsKICAgICAgICAgICAgICAgIGNvbnRleHQud3JpdGUod29yZCwgb25lKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgc3RhdGljIGNsYXNzIEludFN1bVJlZHVjZXIgZXh0ZW5kcyBSZWR1Y2VyPFRleHQsIEludFdyaXRhYmxlLCBUZXh0LCBJbnRXcml0YWJsZT4gewogICAgICAgIHB1YmxpYyB2b2lkIHJlZHVjZShUZXh0IGtleSwgSXRlcmFibGU8SW50V3JpdGFibGU+IHZhbHVlcywgQ29udGV4dCBjb250ZXh0KSB0aHJvd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAgICAgaW50IHN1bSA9IDA7CiAgICAgICAgICAgIGZvciAoSW50V3JpdGFibGUgdmFsIDogdmFsdWVzKSB7CiAgICAgICAgICAgICAgICBzdW0gKz0gdmFsLmdldCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnRleHQud3JpdGUoa2V5LCBuZXcgSW50V3JpdGFibGUoc3VtKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgY2xhc3MgSW50U3VtQ29tYmluZXIgZXh0ZW5kcyBSZWR1Y2VyPFRleHQsIEludFdyaXRhYmxlLCBUZXh0LCBJbnRXcml0YWJsZT4gewogICAgICAgIHB1YmxpYyB2b2lkIHJlZHVjZShUZXh0IGtleSwgSXRlcmFibGU8SW50V3JpdGFibGU+IHZhbHVlcywgQ29udGV4dCBjb250ZXh0KSB0aHJvd3MgSU9FeGNlcHRpb24sIEludGVycnVwdGVkRXhjZXB0aW9uIHsKICAgICAgICAgICAgaW50IHN1bSA9IDA7CiAgICAgICAgICAgIGZvciAoSW50V3JpdGFibGUgdmFsIDogdmFsdWVzKSB7CiAgICAgICAgICAgICAgICBzdW0gKz0gdmFsLmdldCgpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnRleHQud3JpdGUoa2V5LCBuZXcgSW50V3JpdGFibGUoc3VtKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIENvbmZpZ3VyYXRpb24gY29uZiA9IG5ldyBDb25maWd1cmF0aW9uKCk7CiAgICAgICAgSm9iIGpvYiA9IEpvYi5nZXRJbnN0YW5jZShjb25mLCAid29yZCBjb3VudCIpOwogICAgICAgIGpvYi5zZXRKYXJCeUNsYXNzKFdvcmRDb3VudC5jbGFzcyk7CiAgICAgICAgam9iLnNldE1hcHBlckNsYXNzKFRva2VuaXplck1hcHBlci5jbGFzcyk7CiAgICAgICAgam9iLnNldENvbWJpbmVyQ2xhc3MoSW50U3VtQ29tYmluZXIuY2xhc3MpOwogICAgICAgIGpvYi5zZXRSZWR1Y2VyQ2xhc3MoSW50U3VtUmVkdWNlci5jbGFzcyk7CiAgICAgICAgam9iLnNldE91dHB1dEtleUNsYXNzKFRleHQuY2xhc3MpOwogICAgICAgIGpvYi5zZXRPdXRwdXRWYWx1ZUNsYXNzKEludFdyaXRhYmxlLmNsYXNzKTsKICAgICAgICBqb2Iuc2V0TnVtUmVkdWNlVGFza3MoNSk7CgogICAgICAgIEZpbGVJbnB1dEZvcm1hdC5hZGRJbnB1dFBhdGgoam9iLCBuZXcgUGF0aChhcmdzWzBdKSk7CiAgICAgICAgRmlsZU91dHB1dEZvcm1hdC5zZXRPdXRwdXRQYXRoKGpvYiwgbmV3IFBhdGgoYXJnc1sxXSkpOwoKICAgICAgICAvLyBDb25maWd1cmFjacOzbiBkZSBjb21wcmVzacOzbgogICAgICAgIEZpbGVPdXRwdXRGb3JtYXQuc2V0Q29tcHJlc3NPdXRwdXQoam9iLCB0cnVlKTsKICAgICAgICBGaWxlT3V0cHV0Rm9ybWF0LnNldE91dHB1dENvbXByZXNzb3JDbGFzcyhqb2IsIFNuYXBweUNvZGVjLmNsYXNzKTsKCiAgICAgICAgU3lzdGVtLmV4aXQoam9iLndhaXRGb3JDb21wbGV0aW9uKHRydWUpID8gMCA6IDEpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class WordCount {
    public static class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {
        private final static IntWritable one = new IntWritable(1);
        private Text word = new Text();

        public void map(Object key, Text value, Context context) throws IOException, InterruptedException {
            StringTokenizer itr = new StringTokenizer(value.toString());
            while (itr.hasMoreTokens()) {
                word.set(itr.nextToken());
                context.write(word, one);
            }
        }
    }

    public static class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
        public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
            int sum = 0;
            for (IntWritable val : values) {
                sum += val.get();
            }
            context.write(key, new IntWritable(sum));
        }
    }

    public static class IntSumCombiner extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
        public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
            int sum = 0;
            for (IntWritable val : values) {
                sum += val.get();
            }
            context.write(key, new IntWritable(sum));
        }
    }

    public static void main(String[] args) throws Exception {
        Configuration conf = new Configuration();
        Job job = Job.getInstance(conf, &quot;word count&quot;);
        job.setJarByClass(WordCount.class);
        job.setMapperClass(TokenizerMapper.class);
        job.setCombinerClass(IntSumCombiner.class);
        job.setReducerClass(IntSumReducer.class);
        job.setOutputKeyClass(Text.class);
        job.setOutputValueClass(IntWritable.class);
        job.setNumReduceTasks(5);

        FileInputFormat.addInputPath(job, new Path(args[0]));
        FileOutputFormat.setOutputPath(job, new Path(args[1]));

        // Configuraci&oacute;n de compresi&oacute;n
        FileOutputFormat.setCompressOutput(job, true);
        FileOutputFormat.setOutputCompressorClass(job, SnappyCodec.class);

        System.exit(job.waitForCompletion(true) ? 0 : 1);
    }
}</pre></div><div class='content'></div><h2>Conclusión</h2>
<div class='content'><p>En este módulo, hemos cubierto varias técnicas de optimización para trabajos de MapReduce, incluyendo la compresión de datos, el uso de combiners, particionadores personalizados, ajuste del número de reducers, uso de contadores y configuración de parámetros de Hadoop. Estas técnicas son esenciales para mejorar el rendimiento y la eficiencia de los trabajos de MapReduce en Hadoop. Asegúrate de aplicar estas técnicas en tus proyectos para obtener el máximo rendimiento.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='04-03-writing-a-mapreduce-program' title="Escribiendo un Programa MapReduce" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='04-03-writing-a-mapreduce-program' title="Escribiendo un Programa MapReduce" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-01-apache-pig' title="Apache Pig" class="py-2 px-3 btn btn-primary"
				data-read-mod="hadoop" data-read-unit="4-4">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-01-apache-pig' title="Apache Pig" class="py-2 px-3 btn btn-primary" 
				data-read-mod="hadoop" data-read-unit="4-4">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curso de Hadoop</h1>
<h2>Módulo 1: Introducción a Hadoop</h2>
<ul>
<li><a href="01-01-what-is-hadoop">¿Qué es Hadoop?</a></li>
<li><a href="01-02-hadoop-ecosystem-overview">Visión General del Ecosistema Hadoop</a></li>
<li><a href="01-03-hadoop-vs-traditional-databases">Hadoop vs Bases de Datos Tradicionales</a></li>
<li><a href="01-04-setting-up-hadoop-environment">Configuración del Entorno Hadoop</a></li>
</ul>
<h2>Módulo 2: Arquitectura de Hadoop</h2>
<ul>
<li><a href="02-01-hadoop-core-components">Componentes Principales de Hadoop</a></li>
<li><a href="02-02-hdfs">HDFS (Sistema de Archivos Distribuido de Hadoop)</a></li>
<li><a href="02-03-mapreduce-framework">Marco de Trabajo MapReduce</a></li>
<li><a href="02-04-yarn">YARN (Yet Another Resource Negotiator)</a></li>
</ul>
<h2>Módulo 3: HDFS (Sistema de Archivos Distribuido de Hadoop)</h2>
<ul>
<li><a href="03-01-hdfs-architecture">Arquitectura de HDFS</a></li>
<li><a href="03-02-hdfs-commands">Comandos de HDFS</a></li>
<li><a href="03-03-data-replication-in-hdfs">Replicación de Datos en HDFS</a></li>
<li><a href="03-04-hdfs-fault-tolerance">Tolerancia a Fallos en HDFS</a></li>
</ul>
<h2>Módulo 4: Programación MapReduce</h2>
<ul>
<li><a href="04-01-introduction-to-mapreduce">Introducción a MapReduce</a></li>
<li><a href="04-02-mapreduce-job-workflow">Flujo de Trabajo de un Job MapReduce</a></li>
<li><a href="04-03-writing-a-mapreduce-program">Escribiendo un Programa MapReduce</a></li>
<li><a href="04-04-mapreduce-optimization-techniques">Técnicas de Optimización de MapReduce</a></li>
</ul>
<h2>Módulo 5: Herramientas del Ecosistema Hadoop</h2>
<ul>
<li><a href="05-01-apache-pig">Apache Pig</a></li>
<li><a href="05-02-apache-hive">Apache Hive</a></li>
<li><a href="05-03-apache-hbase">Apache HBase</a></li>
<li><a href="05-04-apache-sqoop">Apache Sqoop</a></li>
<li><a href="05-05-apache-flume">Apache Flume</a></li>
<li><a href="05-06-apache-oozie">Apache Oozie</a></li>
</ul>
<h2>Módulo 6: Conceptos Avanzados de Hadoop</h2>
<ul>
<li><a href="06-01-hadoop-security">Seguridad en Hadoop</a></li>
<li><a href="06-02-hadoop-cluster-management">Gestión de Clústeres Hadoop</a></li>
<li><a href="06-03-hadoop-performance-tuning">Ajuste de Rendimiento de Hadoop</a></li>
<li><a href="06-04-hadoop-data-serialization">Serialización de Datos en Hadoop</a></li>
</ul>
<h2>Módulo 7: Aplicaciones del Mundo Real y Estudios de Caso</h2>
<ul>
<li><a href="07-01-hadoop-in-data-warehousing">Hadoop en Almacenamiento de Datos</a></li>
<li><a href="07-02-hadoop-in-machine-learning">Hadoop en Aprendizaje Automático</a></li>
<li><a href="07-03-hadoop-in-real-time-data-processing">Hadoop en Procesamiento de Datos en Tiempo Real</a></li>
<li><a href="07-04-case-studies-of-hadoop-implementations">Estudios de Caso de Implementaciones de Hadoop</a></li>
</ul>
<h2>Módulo 8: Proyectos Prácticos</h2>
<ul>
<li><a href="08-01-project-1-analyzing-big-data-with-hadoop">Proyecto 1: Analizando Big Data con Hadoop</a></li>
<li><a href="08-02-project-2-building-a-data-pipeline-with-hadoop-ecosystem">Proyecto 2: Construyendo una Canalización de Datos con el Ecosistema Hadoop</a></li>
<li><a href="08-03-project-3-real-time-data-processing-with-hadoop">Proyecto 3: Procesamiento de Datos en Tiempo Real con Hadoop</a></li>
<li><a href="08-04-project-4-machine-learning-with-hadoop">Proyecto 4: Aprendizaje Automático con Hadoop</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objetivo" rel="nofollow">El Proyecto</a> | 
<a href="/acerca-de" rel="nofollow">Sobre nosotros</a> | 
<a href="/contribuir" rel="nofollow">Contribuir</a> | 
<a href="/donar" rel="nofollow">Donaciones</a> | 
<a href="/licencia" rel="nofollow">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuario no autenticado</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<div id="modal-body-main"></div>
            </div>
        </div>
    </div>
</div>	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
