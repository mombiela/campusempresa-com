<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aspirado y Mantenimiento</title>

    <link rel="alternate" href="https://campusempresa.com/es/postgresql/vacuuming-and-maintenance" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/postgresql/vacuuming-and-maintenance" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/postgresql/vacuuming-and-maintenance" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/postgresql/vacuuming-and-maintenance" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='analyzing-query-performance'>&#x25C4; Análisis del Rendimiento de Consultas</a></div><div class='col-6 text-end'><a href='transactions-and-concurrency'>Transacciones y Concurrencia &#x25BA;</a></div></div><div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Mantener una base de datos PostgreSQL es crucial para asegurar un rendimiento y fiabilidad óptimos. Una de las tareas de mantenimiento clave es el aspirado, que ayuda a gestionar el almacenamiento y mejorar el rendimiento de las consultas. Esta sección cubrirá los conceptos básicos del aspirado, su importancia y cómo realizarlo de manera efectiva.</p>
</div><h1>¿Qué es el Aspirado?</h1>
<div class='content'><p>El aspirado en PostgreSQL es un proceso que ayuda a recuperar el almacenamiento ocupado por tuplas muertas (filas que han sido actualizadas o eliminadas). También actualiza las estadísticas utilizadas por el planificador de consultas para optimizar el rendimiento de las consultas.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Tuplas Muertas</strong>: Filas que han sido eliminadas o actualizadas pero que aún ocupan espacio.</li>
<li><strong>Autovacuum</strong>: Un proceso en segundo plano que aspira automáticamente las tablas.</li>
<li><strong>Aspirado Manual</strong>: Un proceso de aspirado iniciado por el usuario.</li>
</ul>
</div><h1>Importancia del Aspirado</h1>
<div class='content'><ul>
<li><strong>Recuperación de Espacio</strong>: Libera espacio de almacenamiento al eliminar tuplas muertas.</li>
<li><strong>Mejora del Rendimiento</strong>: Mantiene los índices y tablas eficientes, reduciendo el tiempo de ejecución de las consultas.</li>
<li><strong>Prevención del Desbordamiento del ID de Transacción</strong>: Asegura que el contador de ID de transacción no se desborde, lo que podría llevar a la corrupción de datos.</li>
</ul>
</div><h1>Tipos de Aspirado</h1>
<h2>Autovacuum</h2>
<div class='content'><p>Autovacuum es una función incorporada que aspira automáticamente las tablas basándose en ciertos umbrales.</p>
<h4>Configuración</h4>
<p>Autovacuum puede configurarse en el archivo <code>postgresql.conf</code>. Los parámetros clave incluyen:</p>
<ul>
<li><code>autovacuum</code>: Habilita o deshabilita el demonio autovacuum.</li>
<li><code>autovacuum_naptime</code>: Establece el retraso entre ejecuciones de autovacuum.</li>
<li><code>autovacuum_vacuum_threshold</code>: Número mínimo de actualizaciones o eliminaciones de tuplas antes de que se desencadene un aspirado.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFamVtcGxvIGRlIGNvbmZpZ3VyYWNpw7NuIGVuIHBvc3RncmVzcWwuY29uZgphdXRvdmFjdXVtID0gb24KYXV0b3ZhY3V1bV9uYXB0aW1lID0gJzFtaW4nCmF1dG92YWN1dW1fdmFjdXVtX3RocmVzaG9sZCA9IDUw"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Ejemplo de configuraci&oacute;n en postgresql.conf
autovacuum = on
autovacuum_naptime = '1min'
autovacuum_vacuum_threshold = 50</pre></div><div class='content'></div><h2>Aspirado Manual</h2>
<div class='content'><p>El aspirado manual puede realizarse usando el comando <code>VACUUM</code>. Puede ejecutarse en tablas específicas o en toda la base de datos.</p>
<h4>Uso Básico</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQXNwaXJhciB1bmEgdGFibGEgZXNwZWPDrWZpY2EKVkFDVVVNIG15X3RhYmxlOwoKLS0gQXNwaXJhciB0b2RhIGxhIGJhc2UgZGUgZGF0b3MKVkFDVVVNOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Aspirar una tabla espec&iacute;fica
VACUUM my_table;

-- Aspirar toda la base de datos
VACUUM;</pre></div><div class='content'><h4>Aspirado Completo</h4>
<p><code>VACUUM FULL</code> es una versión más intensiva que bloquea la tabla y recupera completamente el espacio.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gUmVhbGl6YXIgdW4gYXNwaXJhZG8gY29tcGxldG8gZW4gdW5hIHRhYmxhIGVzcGVjw61maWNhClZBQ1VVTSBGVUxMIG15X3RhYmxlOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Realizar un aspirado completo en una tabla espec&iacute;fica
VACUUM FULL my_table;</pre></div><div class='content'></div><h1>Análisis de Tablas</h1>
<div class='content'><p>El comando <code>ANALYZE</code> actualiza las estadísticas utilizadas por el planificador de consultas para hacer planes de ejecución de consultas eficientes.</p>
</div><h2>Uso Básico</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQW5hbGl6YXIgdW5hIHRhYmxhIGVzcGVjw61maWNhCkFOQUxZWkUgbXlfdGFibGU7CgotLSBBbmFsaXphciB0b2RhIGxhIGJhc2UgZGUgZGF0b3MKQU5BTFlaRTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Analizar una tabla espec&iacute;fica
ANALYZE my_table;

-- Analizar toda la base de datos
ANALYZE;</pre></div><div class='content'></div><h2>Aspirado y Análisis Combinados</h2>
<div class='content'><p>Puedes combinar el aspirado y el análisis en un solo comando.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQXNwaXJhciB5IGFuYWxpemFyIHVuYSB0YWJsYSBlc3BlY8OtZmljYQpWQUNVVU0gQU5BTFlaRSBteV90YWJsZTsKCi0tIEFzcGlyYXIgeSBhbmFsaXphciB0b2RhIGxhIGJhc2UgZGUgZGF0b3MKVkFDVVVNIEFOQUxZWkU7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Aspirar y analizar una tabla espec&iacute;fica
VACUUM ANALYZE my_table;

-- Aspirar y analizar toda la base de datos
VACUUM ANALYZE;</pre></div><div class='content'></div><h1>Monitoreo y Mantenimiento</h1>
<h2>Monitoreo de la Actividad de Aspirado</h2>
<div class='content'><p>Puedes monitorear la actividad de aspirado usando vistas del sistema como <code>pg_stat_user_tables</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVmVyaWZpY2FyIGxhIGFjdGl2aWRhZCBkZSBhc3BpcmFkbyBwYXJhIHRhYmxhcyBkZSB1c3VhcmlvClNFTEVDVCByZWxuYW1lLCBsYXN0X3ZhY3V1bSwgbGFzdF9hdXRvdmFjdXVtLCBsYXN0X2FuYWx5emUsIGxhc3RfYXV0b2FuYWx5emUKRlJPTSBwZ19zdGF0X3VzZXJfdGFibGVzOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Verificar la actividad de aspirado para tablas de usuario
SELECT relname, last_vacuum, last_autovacuum, last_analyze, last_autoanalyze
FROM pg_stat_user_tables;</pre></div><div class='content'></div><h2>Programación de Mantenimiento</h2>
<div class='content'><p>Las tareas de mantenimiento regulares pueden programarse usando herramientas como <code>cron</code> o la extensión <code>pg_cron</code> de PostgreSQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRWplbXBsbyBkZSB0cmFiYWpvIGNyb24gcGFyYSBhc3BpcmFyIHVuYSBiYXNlIGRlIGRhdG9zIGRpYXJpYW1lbnRlIGEgbWVkaWFub2NoZQowIDAgKiAqICogcHNxbCAtVSBwb3N0Z3JlcyAtZCBteV9kYXRhYmFzZSAtYyAiVkFDVVVNIEFOQUxZWkU7Ig=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Ejemplo de trabajo cron para aspirar una base de datos diariamente a medianoche
0 0 * * * psql -U postgres -d my_database -c &quot;VACUUM ANALYZE;&quot;</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>El aspirado y el mantenimiento son esenciales para la salud y el rendimiento de una base de datos PostgreSQL. Al entender y configurar adecuadamente el autovacuum, realizar aspirados manuales cuando sea necesario y analizar regularmente las tablas, puedes asegurar que tu base de datos se mantenga eficiente y confiable. El monitoreo regular y la programación de tareas de mantenimiento te ayudarán a anticiparte a posibles problemas de rendimiento.</p>
</div><div class='row navigation'><div class='col-6'><a href='analyzing-query-performance'>&#x25C4; Análisis del Rendimiento de Consultas</a></div><div class='col-6 text-end'><a href='transactions-and-concurrency'>Transacciones y Concurrencia &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
