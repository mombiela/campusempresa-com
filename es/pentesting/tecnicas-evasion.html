<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es">Castellano</b>
				|
				<a href="https://campusempresa.cat/pentesting/tecnicas-evasion" id="lnk_lang_ca" data-lang="ca">Català</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Proyecto</a>
				<a href="about">Sobre nosotros</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donaciones</a>
				<a href="licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En el contexto del pentesting, las técnicas de evasión son métodos utilizados por los pentesters para evitar la detección por parte de sistemas de seguridad como firewalls, sistemas de detección de intrusos (IDS), y sistemas de prevención de intrusos (IPS). Estas técnicas son cruciales para evaluar la efectividad de las defensas de una organización.</p>
</div><h1>Tipos de Técnicas de Evasión</h1>
<div class='content'></div><h2>Evasión de Firewalls</h2>
<div class='content'><ul>
<li><strong>Fragmentación de Paquetes</strong>: Dividir un paquete de datos en fragmentos más pequeños para evitar la detección.</li>
<li><strong>Tunneling</strong>: Encapsular el tráfico malicioso en protocolos permitidos, como HTTP o HTTPS.</li>
<li><strong>IP Spoofing</strong>: Alterar la dirección IP de origen para parecer que el tráfico proviene de una fuente confiable.</li>
</ul>
</div><h2>Evasión de IDS/IPS</h2>
<div class='content'><ul>
<li><strong>Obfuscación de Payloads</strong>: Modificar el payload para que no coincida con las firmas conocidas.</li>
<li><strong>Polimorfismo</strong>: Cambiar el código malicioso en cada ejecución para evitar la detección basada en firmas.</li>
<li><strong>Timing Attacks</strong>: Enviar paquetes a intervalos irregulares para evitar patrones detectables.</li>
</ul>
</div><h2>Evasión de Antivirus</h2>
<div class='content'><ul>
<li><strong>Empaquetado</strong>: Utilizar herramientas de empaquetado para modificar la estructura del archivo ejecutable.</li>
<li><strong>Cifrado</strong>: Cifrar el código malicioso y descifrarlo en tiempo de ejecución.</li>
<li><strong>Uso de Técnicas de Ingeniería Social</strong>: Engañar al usuario para que desactive el antivirus o permita la ejecución del código malicioso.</li>
</ul>
</div><h1>Ejemplos de Código</h1>
<div class='content'></div><h2>Fragmentación de Paquetes</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBzY2FweS5hbGwgaW1wb3J0ICoKCiMgQ3JlYXIgdW4gcGFxdWV0ZSBJUCBjb24gZnJhZ21lbnRhY2nDs24KaXAgPSBJUChkc3Q9IjE5Mi4xNjguMS4xIiwgZmxhZ3M9Ik1GIikKdGNwID0gVENQKGRwb3J0PTgwLCBmbGFncz0iUyIpCnBrdCA9IGlwL3RjcAoKIyBFbnZpYXIgZWwgcGFxdWV0ZSBmcmFnbWVudGFkbwpzZW5kKHBrdCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from scapy.all import *

# Crear un paquete IP con fragmentaci&oacute;n
ip = IP(dst=&quot;192.168.1.1&quot;, flags=&quot;MF&quot;)
tcp = TCP(dport=80, flags=&quot;S&quot;)
pkt = ip/tcp

# Enviar el paquete fragmentado
send(pkt)</pre></div><div class='content'><p><em>Explicación</em>: Este script utiliza la biblioteca Scapy para crear y enviar un paquete IP fragmentado. La bandera &quot;MF&quot; (More Fragments) indica que el paquete es parte de una serie de fragmentos.</p>
</div><h2>Obfuscación de Payloads</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGJhc2U2NAoKIyBQYXlsb2FkIG9yaWdpbmFsCnBheWxvYWQgPSAibWFsaWNpb3VzX2NvZGVfaGVyZSIKCiMgT2JmdXNjYWNpw7NuIG1lZGlhbnRlIGNvZGlmaWNhY2nDs24gQmFzZTY0Cm9iZnVzY2F0ZWRfcGF5bG9hZCA9IGJhc2U2NC5iNjRlbmNvZGUocGF5bG9hZC5lbmNvZGUoKSkuZGVjb2RlKCkKCnByaW50KG9iZnVzY2F0ZWRfcGF5bG9hZCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import base64

# Payload original
payload = &quot;malicious_code_here&quot;

# Obfuscaci&oacute;n mediante codificaci&oacute;n Base64
obfuscated_payload = base64.b64encode(payload.encode()).decode()

print(obfuscated_payload)</pre></div><div class='content'><p><em>Explicación</em>: Este script obfusca un payload simple mediante codificación Base64. Aunque básico, este método puede eludir algunas detecciones basadas en firmas.</p>
</div><h1>Comparación de Técnicas</h1>
<div class='content'><p>| Técnica                | Ventajas                                      | Desventajas                                  |
|------------------------|-----------------------------------------------|----------------------------------------------|
| Fragmentación de Paquetes | Evita detección por firewalls simples         | Puede ser detectado por IDS avanzados        |
| Tunneling              | Encapsula tráfico malicioso en protocolos permitidos | Requiere control sobre el servidor de destino |
| Polimorfismo           | Cambia el código en cada ejecución             | Complejidad en la implementación             |
| Empaquetado            | Modifica la estructura del archivo ejecutable  | Puede ser detectado por análisis heurístico  |</p>
</div><h1>Conclusión</h1>
<div class='content'><p>Las técnicas de evasión son herramientas esenciales en el arsenal de un pentester. Comprender y aplicar estas técnicas permite evaluar la robustez de las defensas de una organización y mejorar su capacidad para detectar y mitigar amenazas. Es importante recordar que el uso de estas técnicas debe ser ético y autorizado, siempre con el objetivo de mejorar la seguridad de los sistemas evaluados.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
