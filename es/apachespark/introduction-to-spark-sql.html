<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introducción a Spark SQL</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/introduction-to-spark-sql" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/introduction-to-spark-sql" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/introduction-to-spark-sql" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/apachespark/introduction-to-spark-sql" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Proyecto</a>
				<a href="about">Sobre nosotros</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donaciones</a>
				<a href="licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Visión General</h1>
<div class='content'><p>Apache Spark SQL es un módulo para el procesamiento de datos estructurados. Permite consultar datos a través de SQL así como la API de Dataset de Apache Spark. Esta sección te introducirá a los conceptos básicos de Spark SQL, su arquitectura y cómo usarlo para el procesamiento de datos.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>SparkSession</strong>: El punto de entrada para programar Spark con la API de Dataset y DataFrame.</li>
<li><strong>DataFrame</strong>: Una colección distribuida de datos organizada en columnas nombradas.</li>
<li><strong>SQLContext</strong>: Un punto de entrada para trabajar con datos estructurados en Spark.</li>
<li><strong>Catalyst Optimizer</strong>: Un optimizador de consultas extensible utilizado por Spark SQL.</li>
<li><strong>Data Source API</strong>: Permite a Spark leer datos de varias fuentes como JSON, Parquet, JDBC, etc.</li>
</ul>
</div><h1>Configuración de Spark SQL</h1>
<div class='content'><p>Para usar Spark SQL, necesitas configurar una SparkSession. Este es el punto de partida para cualquier aplicación de Spark SQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaWNpYWxpemFyIFNwYXJrU2Vzc2lvbgpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyIFwKICAgIC5hcHBOYW1lKCJFamVtcGxvIGRlIFNwYXJrIFNRTCIpIFwKICAgIC5nZXRPckNyZWF0ZSgp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Inicializar SparkSession
spark = SparkSession.builder \
    .appName(&quot;Ejemplo de Spark SQL&quot;) \
    .getOrCreate()</pre></div><div class='content'></div><h1>Creación de DataFrames</h1>
<div class='content'><p>Los DataFrames pueden ser creados a partir de varias fuentes de datos, incluyendo archivos JSON, Parquet y CSV.</p>
</div><h2>Ejemplo: Creación de DataFrame desde JSON</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgZGF0b3MgSlNPTiBlbiBEYXRhRnJhbWUKZGYgPSBzcGFyay5yZWFkLmpzb24oInJ1dGEvYWwvYXJjaGl2by9qc29uLmpzb24iKQoKIyBNb3N0cmFyIGVsIGNvbnRlbmlkbyBkZWwgRGF0YUZyYW1lCmRmLnNob3coKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar datos JSON en DataFrame
df = spark.read.json(&quot;ruta/al/archivo/json.json&quot;)

# Mostrar el contenido del DataFrame
df.show()</pre></div><div class='content'></div><h2>Ejemplo: Creación de DataFrame desde CSV</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgZGF0b3MgQ1NWIGVuIERhdGFGcmFtZQpkZiA9IHNwYXJrLnJlYWQuY3N2KCJydXRhL2FsL2FyY2hpdm8vY3N2LmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQoKIyBNb3N0cmFyIGVsIGNvbnRlbmlkbyBkZWwgRGF0YUZyYW1lCmRmLnNob3coKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar datos CSV en DataFrame
df = spark.read.csv(&quot;ruta/al/archivo/csv.csv&quot;, header=True, inferSchema=True)

# Mostrar el contenido del DataFrame
df.show()</pre></div><div class='content'></div><h1>Ejecución de Consultas SQL</h1>
<div class='content'><p>Puedes ejecutar consultas SQL directamente en DataFrames usando el método <code>sql</code> de SparkSession.</p>
</div><h2>Ejemplo: Ejecución de Consulta SQL</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZWdpc3RyYXIgRGF0YUZyYW1lIGNvbW8gdW5hIHZpc3RhIHRlbXBvcmFsIFNRTApkZi5jcmVhdGVPclJlcGxhY2VUZW1wVmlldygicGVyc29uYXMiKQoKIyBFamVjdXRhciBjb25zdWx0YSBTUUwKc3FsREYgPSBzcGFyay5zcWwoIlNFTEVDVCBub21icmUsIGVkYWQgRlJPTSBwZXJzb25hcyBXSEVSRSBlZGFkID4gMjEiKQoKIyBNb3N0cmFyIGVsIHJlc3VsdGFkbwpzcWxERi5zaG93KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Registrar DataFrame como una vista temporal SQL
df.createOrReplaceTempView(&quot;personas&quot;)

# Ejecutar consulta SQL
sqlDF = spark.sql(&quot;SELECT nombre, edad FROM personas WHERE edad &gt; 21&quot;)

# Mostrar el resultado
sqlDF.show()</pre></div><div class='content'></div><h1>Operaciones con DataFrames</h1>
<div class='content'><p>Los DataFrames proporcionan un lenguaje específico de dominio para la manipulación de datos estructurados. Aquí hay algunas operaciones comunes:</p>
</div><h2>Selección de Columnas</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWxlY2Npb25hciBjb2x1bW5hcyBlc3BlY8OtZmljYXMKZGYuc2VsZWN0KCJub21icmUiLCAiZWRhZCIpLnNob3coKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Seleccionar columnas espec&iacute;ficas
df.select(&quot;nombre&quot;, &quot;edad&quot;).show()</pre></div><div class='content'></div><h2>Filtrado de Filas</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBGaWx0cmFyIGZpbGFzIGJhc2FkbyBlbiB1bmEgY29uZGljacOzbgpkZi5maWx0ZXIoZGYuZWRhZCA+IDIxKS5zaG93KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Filtrar filas basado en una condici&oacute;n
df.filter(df.edad &gt; 21).show()</pre></div><div class='content'></div><h2>Agrupación y Agregación</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBZ3J1cGFyIHkgYWdyZWdhcgpkZi5ncm91cEJ5KCJlZGFkIikuY291bnQoKS5zaG93KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Agrupar y agregar
df.groupBy(&quot;edad&quot;).count().show()</pre></div><div class='content'></div><h1>Trabajando con Diferentes Fuentes de Datos</h1>
<div class='content'><p>Spark SQL puede leer y escribir datos desde/hacia varias fuentes de datos.</p>
</div><h2>Ejemplo: Lectura desde Parquet</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgZGF0b3MgUGFycXVldCBlbiBEYXRhRnJhbWUKcGFycXVldERGID0gc3BhcmsucmVhZC5wYXJxdWV0KCJydXRhL2FsL2FyY2hpdm8vcGFycXVldC5wYXJxdWV0IikKCiMgTW9zdHJhciBlbCBjb250ZW5pZG8gZGVsIERhdGFGcmFtZQpwYXJxdWV0REYuc2hvdygp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar datos Parquet en DataFrame
parquetDF = spark.read.parquet(&quot;ruta/al/archivo/parquet.parquet&quot;)

# Mostrar el contenido del DataFrame
parquetDF.show()</pre></div><div class='content'></div><h2>Ejemplo: Escritura a Parquet</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFc2NyaWJpciBEYXRhRnJhbWUgYSBQYXJxdWV0CmRmLndyaXRlLnBhcnF1ZXQoInJ1dGEvYWwvYXJjaGl2by9zYWxpZGEucGFycXVldCIp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Escribir DataFrame a Parquet
df.write.parquet(&quot;ruta/al/archivo/salida.parquet&quot;)</pre></div><div class='content'></div><h1>Optimización del Rendimiento</h1>
<div class='content'><p>Spark SQL incluye un optimizador basado en costos, generación de código y almacenamiento columnar para hacer las consultas rápidas. Aquí hay algunos consejos para la optimización del rendimiento:</p>
<ul>
<li><strong>Caché</strong>: Cachear DataFrames que se reutilizan múltiples veces.</li>
<li><strong>Particionamiento</strong>: Usar particionamiento para distribuir los datos uniformemente a través del clúster.</li>
<li><strong>Joins de Broadcast</strong>: Usar joins de broadcast para DataFrames pequeños para evitar el intercambio de grandes conjuntos de datos.</li>
</ul>
</div><h2>Ejemplo: Cachear DataFrame</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYWNoZWFyIERhdGFGcmFtZQpkZi5jYWNoZSgpCgojIFJlYWxpemFyIG9wZXJhY2lvbmVzIGVuIGVsIERhdGFGcmFtZSBjYWNoZWFkbwpkZi5jb3VudCgp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cachear DataFrame
df.cache()

# Realizar operaciones en el DataFrame cacheado
df.count()</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Spark SQL es una herramienta poderosa para trabajar con datos estructurados en Apache Spark. Proporciona una manera simple y eficiente de realizar consultas SQL, manipulación de datos e integración con varias fuentes de datos. Al entender los conceptos básicos de Spark SQL, puedes aprovechar sus capacidades para procesar grandes conjuntos de datos de manera eficiente.</p>
<p>En las próximas secciones, profundizaremos en temas avanzados como la optimización de consultas Spark SQL, trabajar con tipos de datos complejos e integrar Spark SQL con otras herramientas de big data.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
