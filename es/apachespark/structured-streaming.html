<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es">Castellano</b>
				|
				<a href="https://campusempresa.cat/apachespark/structured-streaming" id="lnk_lang_ca" data-lang="ca">Català</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Proyecto</a>
				<a href="about">Sobre nosotros</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donaciones</a>
				<a href="licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción al Streaming Estructurado</h1>
<div class='content'><p>El Streaming Estructurado es un motor de procesamiento de flujos escalable y tolerante a fallos construido sobre el motor de Spark SQL. Te permite expresar cálculos de streaming de la misma manera que expresarías cálculos por lotes en datos estáticos.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Datos Ilimitados</strong>: Datos que llegan continuamente con el tiempo.</li>
<li><strong>Consulta de Streaming</strong>: Una consulta continua que procesa datos de streaming.</li>
<li><strong>Disparador</strong>: Define el momento del procesamiento de datos de streaming.</li>
<li><strong>Operaciones con Estado</strong>: Operaciones que mantienen el estado a través de lotes de datos.</li>
</ul>
</div><h1>Configuración del Streaming Estructurado</h1>
<div class='content'><p>Antes de sumergirte en la codificación, asegúrate de tener el entorno necesario configurado:</p>
<ul>
<li>Apache Spark instalado.</li>
<li>Un entorno de desarrollo como Jupyter Notebook o un IDE (por ejemplo, IntelliJ IDEA).</li>
</ul>
</div><h2>Código de Configuración de Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIENyZWFyIHVuYSBzZXNpw7NuIGRlIFNwYXJrCnNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIgXAogICAgLmFwcE5hbWUoIlN0cnVjdHVyZWRTdHJlYW1pbmdFeGFtcGxlIikgXAogICAgLmdldE9yQ3JlYXRlKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Crear una sesi&oacute;n de Spark
spark = SparkSession.builder \
    .appName(&quot;StructuredStreamingExample&quot;) \
    .getOrCreate()</pre></div><div class='content'></div><h1>Operaciones Básicas</h1>
<h2>Lectura desde un Stream</h2>
<div class='content'><p>El Streaming Estructurado soporta varias fuentes de datos como Kafka, archivos y sockets.</p>
<h4>Ejemplo: Lectura desde un Socket</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBMZWVyIGRhdG9zIGRlIHN0cmVhbWluZyBkZXNkZSB1biBzb2NrZXQKbGluZXMgPSBzcGFyay5yZWFkU3RyZWFtIFwKICAgIC5mb3JtYXQoInNvY2tldCIpIFwKICAgIC5vcHRpb24oImhvc3QiLCAibG9jYWxob3N0IikgXAogICAgLm9wdGlvbigicG9ydCIsIDk5OTkpIFwKICAgIC5sb2FkKCkKCiMgTW9zdHJhciBlbCBlc3F1ZW1hIGRlbCBEYXRhRnJhbWUKbGluZXMucHJpbnRTY2hlbWEoKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Leer datos de streaming desde un socket
lines = spark.readStream \
    .format(&quot;socket&quot;) \
    .option(&quot;host&quot;, &quot;localhost&quot;) \
    .option(&quot;port&quot;, 9999) \
    .load()

# Mostrar el esquema del DataFrame
lines.printSchema()</pre></div><div class='content'></div><h2>Escritura a un Stream</h2>
<div class='content'><p>Puedes escribir la salida de una consulta de streaming a varios destinos como consola, archivos o Kafka.</p>
<h4>Ejemplo: Escritura a la Consola</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFc2NyaWJpciBsb3MgZGF0b3MgZGUgc3RyZWFtaW5nIGEgbGEgY29uc29sYQpxdWVyeSA9IGxpbmVzLndyaXRlU3RyZWFtIFwKICAgIC5vdXRwdXRNb2RlKCJhcHBlbmQiKSBcCiAgICAuZm9ybWF0KCJjb25zb2xlIikgXAogICAgLnN0YXJ0KCkKCiMgRXNwZXJhciBsYSB0ZXJtaW5hY2nDs24gZGUgbGEgY29uc3VsdGEKcXVlcnkuYXdhaXRUZXJtaW5hdGlvbigp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Escribir los datos de streaming a la consola
query = lines.writeStream \
    .outputMode(&quot;append&quot;) \
    .format(&quot;console&quot;) \
    .start()

# Esperar la terminaci&oacute;n de la consulta
query.awaitTermination()</pre></div><div class='content'></div><h1>Transformaciones en Datos de Streaming</h1>
<div class='content'><p>El Streaming Estructurado te permite aplicar varias transformaciones en datos de streaming.</p>
</div><h2>Ejemplo: Conteo de Palabras</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IGV4cGxvZGUsIHNwbGl0CgojIERpdmlkaXIgbGFzIGzDrW5lYXMgZW4gcGFsYWJyYXMKd29yZHMgPSBsaW5lcy5zZWxlY3QoCiAgICBleHBsb2RlKAogICAgICAgIHNwbGl0KGxpbmVzLnZhbHVlLCAiICIpCiAgICApLmFsaWFzKCJ3b3JkIikKKQoKIyBDb250YXIgbGFzIG9jdXJyZW5jaWFzIGRlIGNhZGEgcGFsYWJyYQp3b3JkQ291bnRzID0gd29yZHMuZ3JvdXBCeSgid29yZCIpLmNvdW50KCkKCiMgRXNjcmliaXIgZWwgY29udGVvIGRlIHBhbGFicmFzIGEgbGEgY29uc29sYQpxdWVyeSA9IHdvcmRDb3VudHMud3JpdGVTdHJlYW0gXAogICAgLm91dHB1dE1vZGUoImNvbXBsZXRlIikgXAogICAgLmZvcm1hdCgiY29uc29sZSIpIFwKICAgIC5zdGFydCgpCgpxdWVyeS5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql.functions import explode, split

# Dividir las l&iacute;neas en palabras
words = lines.select(
    explode(
        split(lines.value, &quot; &quot;)
    ).alias(&quot;word&quot;)
)

# Contar las ocurrencias de cada palabra
wordCounts = words.groupBy(&quot;word&quot;).count()

# Escribir el conteo de palabras a la consola
query = wordCounts.writeStream \
    .outputMode(&quot;complete&quot;) \
    .format(&quot;console&quot;) \
    .start()

query.awaitTermination()</pre></div><div class='content'></div><h1>Temas Avanzados</h1>
<h2>Operaciones con Ventanas</h2>
<div class='content'><p>Las operaciones con ventanas te permiten realizar agregaciones sobre una ventana deslizante de tiempo.</p>
<h4>Ejemplo: Conteo de Palabras con Ventanas</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IHdpbmRvdwoKIyBEZWZpbmlyIHVuYSB2ZW50YW5hIGRlIDEwIG1pbnV0b3MsIGRlc2xpesOhbmRvc2UgY2FkYSA1IG1pbnV0b3MKd2luZG93ZWRDb3VudHMgPSB3b3Jkcy5ncm91cEJ5KAogICAgd2luZG93KHdvcmRzLnRpbWVzdGFtcCwgIjEwIG1pbnV0b3MiLCAiNSBtaW51dG9zIiksCiAgICB3b3Jkcy53b3JkCikuY291bnQoKQoKIyBFc2NyaWJpciBlbCBjb250ZW8gZGUgcGFsYWJyYXMgY29uIHZlbnRhbmFzIGEgbGEgY29uc29sYQpxdWVyeSA9IHdpbmRvd2VkQ291bnRzLndyaXRlU3RyZWFtIFwKICAgIC5vdXRwdXRNb2RlKCJjb21wbGV0ZSIpIFwKICAgIC5mb3JtYXQoImNvbnNvbGUiKSBcCiAgICAuc3RhcnQoKQoKcXVlcnkuYXdhaXRUZXJtaW5hdGlvbigp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql.functions import window

# Definir una ventana de 10 minutos, desliz&aacute;ndose cada 5 minutos
windowedCounts = words.groupBy(
    window(words.timestamp, &quot;10 minutos&quot;, &quot;5 minutos&quot;),
    words.word
).count()

# Escribir el conteo de palabras con ventanas a la consola
query = windowedCounts.writeStream \
    .outputMode(&quot;complete&quot;) \
    .format(&quot;console&quot;) \
    .start()

query.awaitTermination()</pre></div><div class='content'></div><h2>Operaciones con Estado</h2>
<div class='content'><p>Las operaciones con estado mantienen el estado a través de lotes de datos, lo cual es útil para operaciones como totales acumulados.</p>
<h4>Ejemplo: Total Acumulado</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbC5mdW5jdGlvbnMgaW1wb3J0IGV4cHIKCiMgRGVmaW5pciB1biB0b3RhbCBhY3VtdWxhZG8KcnVubmluZ1RvdGFsID0gd29yZHMud2l0aFdhdGVybWFyaygidGltZXN0YW1wIiwgIjEwIG1pbnV0b3MiKSBcCiAgICAuZ3JvdXBCeSgid29yZCIpIFwKICAgIC5hZ2coZXhwcigiY291bnQoKikgYXMgdG90YWwiKSkKCiMgRXNjcmliaXIgZWwgdG90YWwgYWN1bXVsYWRvIGEgbGEgY29uc29sYQpxdWVyeSA9IHJ1bm5pbmdUb3RhbC53cml0ZVN0cmVhbSBcCiAgICAub3V0cHV0TW9kZSgidXBkYXRlIikgXAogICAgLmZvcm1hdCgiY29uc29sZSIpIFwKICAgIC5zdGFydCgpCgpxdWVyeS5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql.functions import expr

# Definir un total acumulado
runningTotal = words.withWatermark(&quot;timestamp&quot;, &quot;10 minutos&quot;) \
    .groupBy(&quot;word&quot;) \
    .agg(expr(&quot;count(*) as total&quot;))

# Escribir el total acumulado a la consola
query = runningTotal.writeStream \
    .outputMode(&quot;update&quot;) \
    .format(&quot;console&quot;) \
    .start()

query.awaitTermination()</pre></div><div class='content'></div><h1>Tolerancia a Fallos y Checkpointing</h1>
<div class='content'><p>El Streaming Estructurado proporciona tolerancia a fallos incorporada a través de checkpointing y registros de escritura anticipada.</p>
</div><h2>Ejemplo: Checkpointing</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmlyIHVuYSB1YmljYWNpw7NuIGRlIGNoZWNrcG9pbnQKcXVlcnkgPSB3b3JkQ291bnRzLndyaXRlU3RyZWFtIFwKICAgIC5vdXRwdXRNb2RlKCJjb21wbGV0ZSIpIFwKICAgIC5mb3JtYXQoImNvbnNvbGUiKSBcCiAgICAub3B0aW9uKCJjaGVja3BvaW50TG9jYXRpb24iLCAiL3BhdGgvdG8vY2hlY2twb2ludC9kaXIiKSBcCiAgICAuc3RhcnQoKQoKcXVlcnkuYXdhaXRUZXJtaW5hdGlvbigp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Definir una ubicaci&oacute;n de checkpoint
query = wordCounts.writeStream \
    .outputMode(&quot;complete&quot;) \
    .format(&quot;console&quot;) \
    .option(&quot;checkpointLocation&quot;, &quot;/path/to/checkpoint/dir&quot;) \
    .start()

query.awaitTermination()</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>El Streaming Estructurado en Apache Spark proporciona un marco poderoso y flexible para procesar datos de streaming. Al aprovechar las mismas APIs utilizadas para el procesamiento por lotes, simplifica el desarrollo de aplicaciones de streaming. Características clave como operaciones con ventanas, procesamiento con estado y tolerancia a fallos lo hacen adecuado para una amplia gama de tareas de procesamiento de datos en tiempo real.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
