<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operadores de Grafos en Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/graph-operators" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/graph-operators" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/graph-operators" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/apachespark/graph-operators" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción a los Operadores de Grafos</h1>
<div class='content'><p>Los operadores de grafos son herramientas esenciales en el procesamiento y análisis de grafos. Apache Spark proporciona una poderosa biblioteca llamada GraphX para cálculos en paralelo de grafos. Esta sección te introducirá a los conceptos básicos de los operadores de grafos y cómo se implementan en Spark.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Grafo</strong>: Una colección de vértices (nodos) y aristas (enlaces) que conectan pares de vértices.</li>
<li><strong>GraphX</strong>: La API de Spark para grafos y cálculos en paralelo de grafos.</li>
<li><strong>RDD</strong>: Resilient Distributed Dataset, la estructura de datos fundamental de Spark.</li>
</ul>
</div><h1>Operadores Básicos de Grafos</h1>
<div class='content'><p>GraphX proporciona una variedad de operadores para manipular y analizar grafos. Aquí hay algunos de los operadores básicos de grafos:</p>
</div><h2>Creación de Grafos</h2>
<div class='content'><p>Puedes crear grafos en GraphX usando dos RDDs: uno para los vértices y otro para las aristas.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuZ3JhcGh4Ll8KaW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsucmRkLlJERAoKLy8gQ3JlYXIgdW4gUkREIHBhcmEgbG9zIHbDqXJ0aWNlcwp2YWwgdmVydGljZXM6IFJERFsoVmVydGV4SWQsIFN0cmluZyldID0gc2MucGFyYWxsZWxpemUoQXJyYXkoKDFMLCAiQWxpY2UiKSwgKDJMLCAiQm9iIiksICgzTCwgIkNoYXJsaWUiKSkpCgovLyBDcmVhciB1biBSREQgcGFyYSBsYXMgYXJpc3Rhcwp2YWwgZWRnZXM6IFJERFtFZGdlW1N0cmluZ11dID0gc2MucGFyYWxsZWxpemUoQXJyYXkoRWRnZSgxTCwgMkwsICJmcmllbmQiKSwgRWRnZSgyTCwgM0wsICJmb2xsb3ciKSkpCgovLyBDb25zdHJ1aXIgZWwgR3JhZm8gaW5pY2lhbAp2YWwgZ3JhcGg6IEdyYXBoW1N0cmluZywgU3RyaW5nXSA9IEdyYXBoKHZlcnRpY2VzLCBlZGdlcyk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.graphx._
import org.apache.spark.rdd.RDD

// Crear un RDD para los v&eacute;rtices
val vertices: RDD[(VertexId, String)] = sc.parallelize(Array((1L, &quot;Alice&quot;), (2L, &quot;Bob&quot;), (3L, &quot;Charlie&quot;)))

// Crear un RDD para las aristas
val edges: RDD[Edge[String]] = sc.parallelize(Array(Edge(1L, 2L, &quot;friend&quot;), Edge(2L, 3L, &quot;follow&quot;)))

// Construir el Grafo inicial
val graph: Graph[String, String] = Graph(vertices, edges)</pre></div><div class='content'></div><h2>Transformación de Grafos</h2>
<div class='content'><p>GraphX te permite transformar grafos usando los operadores <code>mapVertices</code> y <code>mapEdges</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVHJhbnNmb3JtYXIgdsOpcnRpY2VzCnZhbCBuZXdHcmFwaCA9IGdyYXBoLm1hcFZlcnRpY2VzKChpZCwgbmFtZSkgPT4gbmFtZS50b1VwcGVyQ2FzZSkKCi8vIFRyYW5zZm9ybWFyIGFyaXN0YXMKdmFsIG5ld0dyYXBoRWRnZXMgPSBncmFwaC5tYXBFZGdlcyhlZGdlID0+IGVkZ2UuYXR0ci50b1VwcGVyQ2FzZSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Transformar v&eacute;rtices
val newGraph = graph.mapVertices((id, name) =&gt; name.toUpperCase)

// Transformar aristas
val newGraphEdges = graph.mapEdges(edge =&gt; edge.attr.toUpperCase)</pre></div><div class='content'></div><h2>Subgrafo</h2>
<div class='content'><p>Puedes crear un subgrafo filtrando vértices y aristas.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ3JlYXIgdW4gc3ViZ3JhZm8gZG9uZGUgZWwgbm9tYnJlIGRlbCB2w6lydGljZSBjb21pZW56YSBjb24gJ0EnCnZhbCBzdWJncmFwaCA9IGdyYXBoLnN1YmdyYXBoKHZwcmVkID0gKGlkLCBuYW1lKSA9PiBuYW1lLnN0YXJ0c1dpdGgoIkEiKSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Crear un subgrafo donde el nombre del v&eacute;rtice comienza con 'A'
val subgraph = graph.subgraph(vpred = (id, name) =&gt; name.startsWith(&quot;A&quot;))</pre></div><div class='content'></div><h2>Operadores de Unión</h2>
<div class='content'><p>GraphX proporciona operadores de unión para combinar grafos con datos externos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGF0b3MgZXh0ZXJub3MKdmFsIGV4dGVybmFsRGF0YTogUkREWyhWZXJ0ZXhJZCwgSW50KV0gPSBzYy5wYXJhbGxlbGl6ZShBcnJheSgoMUwsIDEwMCksICgyTCwgMjAwKSkpCgovLyBVbmlyIGVsIGdyYWZvIGNvbiBsb3MgZGF0b3MgZXh0ZXJub3MKdmFsIGpvaW5lZEdyYXBoID0gZ3JhcGgub3V0ZXJKb2luVmVydGljZXMoZXh0ZXJuYWxEYXRhKSB7CiAgY2FzZSAoaWQsIG5hbWUsIFNvbWUoZGF0YSkpID0+IChuYW1lLCBkYXRhKQogIGNhc2UgKGlkLCBuYW1lLCBOb25lKSA9PiAobmFtZSwgMCkKfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Datos externos
val externalData: RDD[(VertexId, Int)] = sc.parallelize(Array((1L, 100), (2L, 200)))

// Unir el grafo con los datos externos
val joinedGraph = graph.outerJoinVertices(externalData) {
  case (id, name, Some(data)) =&gt; (name, data)
  case (id, name, None) =&gt; (name, 0)
}</pre></div><div class='content'></div><h1>Operadores Avanzados de Grafos</h1>
<div class='content'><p>Para operaciones de grafos más complejas, GraphX proporciona operadores avanzados como <code>aggregateMessages</code> y <code>pregel</code>.</p>
</div><h2>Agregar Mensajes</h2>
<div class='content'><p>El operador <code>aggregateMessages</code> te permite enviar mensajes a lo largo de las aristas y agregarlos en los vértices de destino.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIG1lc3NhZ2VzID0gZ3JhcGguYWdncmVnYXRlTWVzc2FnZXNbSW50XSgKICB0cmlwbGV0ID0+IHsKICAgIC8vIEVudmlhciBtZW5zYWplIGFsIHbDqXJ0aWNlIGRlIGRlc3Rpbm8KICAgIHRyaXBsZXQuc2VuZFRvRHN0KDEpCiAgfSwKICAvLyBTdW1hciBsb3MgbWVuc2FqZXMKICBfICsgXwop"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val messages = graph.aggregateMessages[Int](
  triplet =&gt; {
    // Enviar mensaje al v&eacute;rtice de destino
    triplet.sendToDst(1)
  },
  // Sumar los mensajes
  _ + _
)</pre></div><div class='content'></div><h2>API Pregel</h2>
<div class='content'><p>La API Pregel se usa para algoritmos iterativos de grafos. Te permite realizar cálculos de manera centrada en los vértices.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGluaXRpYWxNc2cgPSAwCnZhbCBtYXhJdGVyYXRpb25zID0gNQoKdmFsIHByZWdlbEdyYXBoID0gZ3JhcGgucHJlZ2VsKGluaXRpYWxNc2csIG1heEl0ZXJhdGlvbnMpKAogIChpZCwgYXR0ciwgbXNnKSA9PiBhdHRyICsgbXNnLCAvLyBQcm9ncmFtYSBkZSBWw6lydGljZXMKICB0cmlwbGV0ID0+IHsgLy8gRW52aWFyIE1lbnNhamUKICAgIEl0ZXJhdG9yKCh0cmlwbGV0LmRzdElkLCB0cmlwbGV0LnNyY0F0dHIgKyAxKSkKICB9LAogIChhLCBiKSA9PiBhICsgYiAvLyBGdXNpb25hciBNZW5zYWplCik="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val initialMsg = 0
val maxIterations = 5

val pregelGraph = graph.pregel(initialMsg, maxIterations)(
  (id, attr, msg) =&gt; attr + msg, // Programa de V&eacute;rtices
  triplet =&gt; { // Enviar Mensaje
    Iterator((triplet.dstId, triplet.srcAttr + 1))
  },
  (a, b) =&gt; a + b // Fusionar Mensaje
)</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Los operadores de grafos en GraphX de Apache Spark proporcionan un marco robusto para el procesamiento y análisis de grafos. Al comprender y utilizar estos operadores, puedes realizar una amplia gama de cálculos de grafos de manera eficiente. Desde transformaciones básicas hasta algoritmos iterativos avanzados, GraphX te equipa con las herramientas necesarias para manejar datos de grafos complejos.</p>
</div><h2>Resumen</h2>
<div class='content'><ul>
<li><strong>GraphX</strong>: La API de Spark para cálculos en paralelo de grafos.</li>
<li><strong>Operadores Básicos</strong>: Creación, transformación y subgrafiado de grafos.</li>
<li><strong>Operadores Avanzados</strong>: Agregar mensajes y API Pregel para algoritmos iterativos.</li>
</ul>
<p>Al dominar estos operadores, puedes aprovechar todo el poder de GraphX para resolver problemas de grafos del mundo real.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
