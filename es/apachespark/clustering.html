<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clustering en Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/clustering" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/clustering" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/clustering" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/apachespark/clustering" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='classification-and-regression'>&#x25C4; Clasificación y Regresión</a></div><div class='col-6 text-end'><a href='collaborative-filtering'>Filtrado Colaborativo &#x25BA;</a></div></div><div class='content'></div><h1>Introducción al Clustering</h1>
<div class='content'><p>El clustering es un tipo de aprendizaje no supervisado que implica agrupar un conjunto de objetos de tal manera que los objetos en el mismo grupo (o clúster) sean más similares entre sí que aquellos en otros grupos. En Apache Spark, el clustering se puede realizar de manera eficiente utilizando la biblioteca MLlib.</p>
<ul>
<li><strong>Aprendizaje No Supervisado</strong>: No se proporcionan datos etiquetados; el algoritmo intenta aprender los patrones y la estructura a partir de los datos mismos.</li>
<li><strong>Aplicaciones</strong>: Segmentación de mercado, análisis de redes sociales, compresión de imágenes, etc.</li>
</ul>
</div><h1>Clustering K-Means</h1>
<div class='content'><p>K-Means es uno de los algoritmos de clustering más simples y populares. Divide los datos en K clústeres, donde cada punto de datos pertenece al clúster con la media más cercana.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Centroide</strong>: El centro de un clúster.</li>
<li><strong>Inercia</strong>: La suma de las distancias al cuadrado de las muestras a su centro de clúster más cercano.</li>
</ul>
</div><h2>Pasos en el Algoritmo K-Means</h2>
<div class='content'><ol>
<li>Inicializar K centroides aleatoriamente.</li>
<li>Asignar cada punto de datos al centroide más cercano.</li>
<li>Recalcular los centroides como la media de todos los puntos en el clúster.</li>
<li>Repetir los pasos 2 y 3 hasta la convergencia (los centroides no cambian).</li>
</ol>
</div><h2>Ejemplo de Código</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsdXN0ZXJpbmcgaW1wb3J0IEtNZWFucwpmcm9tIHB5c3BhcmsubWwuZXZhbHVhdGlvbiBpbXBvcnQgQ2x1c3RlcmluZ0V2YWx1YXRvcgpmcm9tIHB5c3Bhcmsuc3FsIGltcG9ydCBTcGFya1Nlc3Npb24KCiMgSW5pY2lhbGl6YXIgc2VzacOzbiBkZSBTcGFyawpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIktNZWFuc0V4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIENhcmdhciBkYXRvcwpkYXRhc2V0ID0gc3BhcmsucmVhZC5mb3JtYXQoImxpYnN2bSIpLmxvYWQoImRhdGEvbWxsaWIvc2FtcGxlX2ttZWFuc19kYXRhLnR4dCIpCgojIEVudHJlbmFyIHVuIG1vZGVsbyBLTWVhbnMKa21lYW5zID0gS01lYW5zKCkuc2V0SygyKS5zZXRTZWVkKDEpCm1vZGVsID0ga21lYW5zLmZpdChkYXRhc2V0KQoKIyBIYWNlciBwcmVkaWNjaW9uZXMKcHJlZGljdGlvbnMgPSBtb2RlbC50cmFuc2Zvcm0oZGF0YXNldCkKCiMgRXZhbHVhciBlbCBjbHVzdGVyaW5nIGNhbGN1bGFuZG8gbGEgcHVudHVhY2nDs24gU2lsaG91ZXR0ZQpldmFsdWF0b3IgPSBDbHVzdGVyaW5nRXZhbHVhdG9yKCkKCnNpbGhvdWV0dGUgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiU2lsaG91ZXR0ZSBjb24gZGlzdGFuY2lhIGV1Y2xpZGlhbmEgYWwgY3VhZHJhZG8gPSB7c2lsaG91ZXR0ZX0iKQoKIyBNb3N0cmFyIGVsIHJlc3VsdGFkbwpjZW50ZXJzID0gbW9kZWwuY2x1c3RlckNlbnRlcnMoKQpwcmludCgiQ2VudHJvcyBkZSBDbMO6c3RlcjogIikKZm9yIGNlbnRlciBpbiBjZW50ZXJzOgogICAgcHJpbnQoY2VudGVyKQoKIyBEZXRlbmVyIHNlc2nDs24gZGUgU3BhcmsKc3Bhcmsuc3RvcCgp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.clustering import KMeans
from pyspark.ml.evaluation import ClusteringEvaluator
from pyspark.sql import SparkSession

# Inicializar sesi&oacute;n de Spark
spark = SparkSession.builder.appName(&quot;KMeansExample&quot;).getOrCreate()

# Cargar datos
dataset = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_kmeans_data.txt&quot;)

# Entrenar un modelo KMeans
kmeans = KMeans().setK(2).setSeed(1)
model = kmeans.fit(dataset)

# Hacer predicciones
predictions = model.transform(dataset)

# Evaluar el clustering calculando la puntuaci&oacute;n Silhouette
evaluator = ClusteringEvaluator()

silhouette = evaluator.evaluate(predictions)
print(f&quot;Silhouette con distancia euclidiana al cuadrado = {silhouette}&quot;)

# Mostrar el resultado
centers = model.clusterCenters()
print(&quot;Centros de Cl&uacute;ster: &quot;)
for center in centers:
    print(center)

# Detener sesi&oacute;n de Spark
spark.stop()</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>SparkSession</strong>: Punto de entrada para programar con Spark.</li>
<li><strong>KMeans</strong>: La clase KMeans se utiliza para crear un modelo KMeans.</li>
<li><strong>fit()</strong>: Entrena el modelo.</li>
<li><strong>transform()</strong>: Hace predicciones.</li>
<li><strong>ClusteringEvaluator</strong>: Evalúa el modelo de clustering utilizando métricas como la puntuación Silhouette.</li>
</ul>
</div><h1>Modelo de Mezcla Gaussiana (GMM)</h1>
<div class='content'><p>El Modelo de Mezcla Gaussiana es un modelo probabilístico que asume que todos los puntos de datos se generan a partir de una mezcla de varias distribuciones gaussianas con parámetros desconocidos.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Maximización de Expectativas (EM)</strong>: Algoritmo utilizado para encontrar las estimaciones de máxima verosimilitud de los parámetros en GMM.</li>
<li><strong>Matriz de Covarianza</strong>: Describe la forma de las distribuciones gaussianas.</li>
</ul>
</div><h2>Ejemplo de Código</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsdXN0ZXJpbmcgaW1wb3J0IEdhdXNzaWFuTWl4dHVyZQoKIyBJbmljaWFsaXphciBzZXNpw7NuIGRlIFNwYXJrCnNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIuYXBwTmFtZSgiR01NRXhhbXBsZSIpLmdldE9yQ3JlYXRlKCkKCiMgQ2FyZ2FyIGRhdG9zCmRhdGFzZXQgPSBzcGFyay5yZWFkLmZvcm1hdCgibGlic3ZtIikubG9hZCgiZGF0YS9tbGxpYi9zYW1wbGVfa21lYW5zX2RhdGEudHh0IikKCiMgRW50cmVuYXIgdW4gbW9kZWxvIEdhdXNzaWFuTWl4dHVyZQpnbW0gPSBHYXVzc2lhbk1peHR1cmUoKS5zZXRLKDIpLnNldFNlZWQoMSkKbW9kZWwgPSBnbW0uZml0KGRhdGFzZXQpCgojIEhhY2VyIHByZWRpY2Npb25lcwpwcmVkaWN0aW9ucyA9IG1vZGVsLnRyYW5zZm9ybShkYXRhc2V0KQoKIyBNb3N0cmFyIGVsIHJlc3VsdGFkbwpwcmludCgiR2F1c3NpYW5hcyBtb3N0cmFkYXMgY29tbyB1biBEYXRhRnJhbWU6ICIpCm1vZGVsLmdhdXNzaWFuc0RGLnNob3codHJ1bmNhdGU9RmFsc2UpCgojIERldGVuZXIgc2VzacOzbiBkZSBTcGFyawpzcGFyay5zdG9wKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.clustering import GaussianMixture

# Inicializar sesi&oacute;n de Spark
spark = SparkSession.builder.appName(&quot;GMMExample&quot;).getOrCreate()

# Cargar datos
dataset = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_kmeans_data.txt&quot;)

# Entrenar un modelo GaussianMixture
gmm = GaussianMixture().setK(2).setSeed(1)
model = gmm.fit(dataset)

# Hacer predicciones
predictions = model.transform(dataset)

# Mostrar el resultado
print(&quot;Gaussianas mostradas como un DataFrame: &quot;)
model.gaussiansDF.show(truncate=False)

# Detener sesi&oacute;n de Spark
spark.stop()</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>GaussianMixture</strong>: La clase GaussianMixture se utiliza para crear un modelo GMM.</li>
<li><strong>gaussiansDF</strong>: DataFrame que contiene los parámetros para cada distribución gaussiana.</li>
</ul>
</div><h1>Clustering Jerárquico</h1>
<div class='content'><p>El clustering jerárquico construye una jerarquía de clústeres ya sea fusionando pequeños clústeres en más grandes (aglomerativo) o dividiendo grandes clústeres en más pequeños (divisivo).</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Dendrograma</strong>: Un diagrama en forma de árbol que registra las secuencias de fusiones o divisiones.</li>
<li><strong>Criterio de Enlace</strong>: Determina la distancia entre conjuntos de observaciones (simple, completo, promedio).</li>
</ul>
</div><h2>Ejemplo de Código</h2>
<div class='content'><p>El clustering jerárquico no es compatible directamente en Spark MLlib, pero se puede implementar utilizando bibliotecas de terceros o código personalizado.</p>
</div><h1>Conclusión</h1>
<div class='content'><p>El clustering es una técnica poderosa para descubrir patrones y estructuras en los datos. Apache Spark proporciona herramientas robustas para implementar algoritmos de clustering como K-Means y Modelos de Mezcla Gaussiana. Comprender estos algoritmos y su implementación en Spark puede mejorar significativamente su capacidad para analizar e interpretar grandes conjuntos de datos.</p>
<ul>
<li><strong>K-Means</strong>: Simple y eficiente, pero requiere especificar el número de clústeres.</li>
<li><strong>GMM</strong>: Más flexible, puede modelar clústeres con diferentes formas y tamaños.</li>
<li><strong>Clustering Jerárquico</strong>: Útil para crear una jerarquía de clústeres, aunque no es compatible nativamente en Spark MLlib.</li>
</ul>
<p>Al dominar estas técnicas de clustering, puede aplicarlas a una amplia gama de problemas del mundo real, desde la segmentación de mercado hasta el análisis de imágenes.</p>
</div><div class='row navigation'><div class='col-6'><a href='classification-and-regression'>&#x25C4; Clasificación y Regresión</a></div><div class='col-6 text-end'><a href='collaborative-filtering'>Filtrado Colaborativo &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
