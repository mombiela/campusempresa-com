<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Seguridad de Formularios en PHP</title>

    <link rel="alternate" href="https://campusempresa.com/es/php/form-security" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/php/form-security" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/php/form-security" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/php/form-security" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='form-validation'>&#x25C4;Validación de Formularios</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Seguridad de Formularios en PHP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='working-with-arrays'>Trabajando con Arrays &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>La seguridad de los formularios es un aspecto crucial del desarrollo web, especialmente cuando se trata de la entrada de datos por parte del usuario. En PHP, asegurar que los formularios sean seguros puede prevenir una amplia gama de ataques, como la inyección SQL, Cross-Site Scripting (XSS) y Cross-Site Request Forgery (CSRF). Esta sección te guiará a través de las prácticas y técnicas esenciales para asegurar formularios en PHP, desde niveles principiantes hasta avanzados.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Validación y Saneamiento de Entradas</strong></li>
<li><strong>Prevención de Inyección SQL</strong></li>
<li><strong>Prevención de Cross-Site Scripting (XSS)</strong></li>
<li><strong>Protección contra Cross-Site Request Forgery (CSRF)</strong></li>
<li><strong>Hashing y Almacenamiento de Contraseñas</strong></li>
</ul>
</div><h1>Validación y Saneamiento de Entradas</h1>
<div class='content'><p>La validación de entradas asegura que los datos recibidos de los usuarios estén en el formato esperado, mientras que el saneamiento limpia los datos para prevenir entradas maliciosas.</p>
</div><h2>Ejemplo: Validación y Saneamiento Básico de Entradas</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKaWYgKCRfU0VSVkVSWyJSRVFVRVNUX01FVEhPRCJdID09ICJQT1NUIikgewogICAgJG5hbWUgPSBzYW5pdGl6ZV9pbnB1dCgkX1BPU1RbIm5hbWUiXSk7CiAgICAkZW1haWwgPSBzYW5pdGl6ZV9pbnB1dCgkX1BPU1RbImVtYWlsIl0pOwogICAgLy8gUHJvY2VzYW1pZW50byBhZGljaW9uYWwKfQoKZnVuY3Rpb24gc2FuaXRpemVfaW5wdXQoJGRhdGEpIHsKICAgICRkYXRhID0gdHJpbSgkZGF0YSk7IC8vIEVsaW1pbmEgZXNwYWNpb3MgZW4gYmxhbmNvIGRlIGFtYm9zIGxhZG9zCiAgICAkZGF0YSA9IHN0cmlwc2xhc2hlcygkZGF0YSk7IC8vIEVsaW1pbmEgbGFzIGJhcnJhcyBpbnZlcnRpZGFzCiAgICAkZGF0YSA9IGh0bWxzcGVjaWFsY2hhcnMoJGRhdGEpOyAvLyBDb252aWVydGUgY2FyYWN0ZXJlcyBlc3BlY2lhbGVzIGVuIGVudGlkYWRlcyBIVE1MCiAgICByZXR1cm4gJGRhdGE7Cn0KPz4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $name = sanitize_input($_POST[&quot;name&quot;]);
    $email = sanitize_input($_POST[&quot;email&quot;]);
    // Procesamiento adicional
}

function sanitize_input($data) {
    $data = trim($data); // Elimina espacios en blanco de ambos lados
    $data = stripslashes($data); // Elimina las barras invertidas
    $data = htmlspecialchars($data); // Convierte caracteres especiales en entidades HTML
    return $data;
}
?&gt;</pre></div><div class='content'><ul>
<li><code>trim()</code>: Elimina espacios en blanco del principio y el final de una cadena.</li>
<li><code>stripslashes()</code>: Elimina las barras invertidas de una cadena.</li>
<li><code>htmlspecialchars()</code>: Convierte caracteres especiales en entidades HTML para prevenir XSS.</li>
</ul>
</div><h1>Prevención de Inyección SQL</h1>
<div class='content'><p>La inyección SQL es una técnica donde los atacantes pueden ejecutar código SQL arbitrario en tu base de datos. Usar declaraciones preparadas con consultas parametrizadas es la mejor manera de prevenir la inyección SQL.</p>
</div><h2>Ejemplo: Uso de Declaraciones Preparadas</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHNlcnZlcm5hbWUgPSAibG9jYWxob3N0IjsKJHVzZXJuYW1lID0gInVzZXJuYW1lIjsKJHBhc3N3b3JkID0gInBhc3N3b3JkIjsKJGRibmFtZSA9ICJkYXRhYmFzZSI7CgokY29ubiA9IG5ldyBteXNxbGkoJHNlcnZlcm5hbWUsICR1c2VybmFtZSwgJHBhc3N3b3JkLCAkZGJuYW1lKTsKCmlmICgkY29ubi0+Y29ubmVjdF9lcnJvcikgewogICAgZGllKCJDb25leGnDs24gZmFsbGlkYTogIiAuICRjb25uLT5jb25uZWN0X2Vycm9yKTsKfQoKaWYgKCRfU0VSVkVSWyJSRVFVRVNUX01FVEhPRCJdID09ICJQT1NUIikgewogICAgJG5hbWUgPSAkX1BPU1RbIm5hbWUiXTsKICAgICRlbWFpbCA9ICRfUE9TVFsiZW1haWwiXTsKCiAgICAkc3RtdCA9ICRjb25uLT5wcmVwYXJlKCJJTlNFUlQgSU5UTyB1c2VycyAobmFtZSwgZW1haWwpIFZBTFVFUyAoPywgPykiKTsKICAgICRzdG10LT5iaW5kX3BhcmFtKCJzcyIsICRuYW1lLCAkZW1haWwpOwogICAgJHN0bXQtPmV4ZWN1dGUoKTsKICAgICRzdG10LT5jbG9zZSgpOwp9CgokY29ubi0+Y2xvc2UoKTsKPz4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$servername = &quot;localhost&quot;;
$username = &quot;username&quot;;
$password = &quot;password&quot;;
$dbname = &quot;database&quot;;

$conn = new mysqli($servername, $username, $password, $dbname);

if ($conn-&gt;connect_error) {
    die(&quot;Conexi&oacute;n fallida: &quot; . $conn-&gt;connect_error);
}

if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $name = $_POST[&quot;name&quot;];
    $email = $_POST[&quot;email&quot;];

    $stmt = $conn-&gt;prepare(&quot;INSERT INTO users (name, email) VALUES (?, ?)&quot;);
    $stmt-&gt;bind_param(&quot;ss&quot;, $name, $email);
    $stmt-&gt;execute();
    $stmt-&gt;close();
}

$conn-&gt;close();
?&gt;</pre></div><div class='content'><ul>
<li><code>prepare()</code>: Prepara una declaración SQL para su ejecución.</li>
<li><code>bind_param()</code>: Vincula variables a la declaración preparada como parámetros.</li>
<li><code>execute()</code>: Ejecuta la declaración preparada.</li>
</ul>
</div><h1>Prevención de Cross-Site Scripting (XSS)</h1>
<div class='content'><p>Los ataques XSS ocurren cuando los atacantes inyectan scripts maliciosos en páginas web vistas por otros usuarios. Usar <code>htmlspecialchars()</code> es una forma común de prevenir XSS.</p>
</div><h2>Ejemplo: Prevención de XSS</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKaWYgKCRfU0VSVkVSWyJSRVFVRVNUX01FVEhPRCJdID09ICJQT1NUIikgewogICAgJGNvbW1lbnQgPSBodG1sc3BlY2lhbGNoYXJzKCRfUE9TVFsiY29tbWVudCJdKTsKICAgIGVjaG8gIlR1IGNvbWVudGFyaW86ICIgLiAkY29tbWVudDsKfQo/Pg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $comment = htmlspecialchars($_POST[&quot;comment&quot;]);
    echo &quot;Tu comentario: &quot; . $comment;
}
?&gt;</pre></div><div class='content'><ul>
<li><code>htmlspecialchars()</code>: Convierte caracteres especiales en entidades HTML, previniendo la ejecución de scripts maliciosos.</li>
</ul>
</div><h1>Protección contra Cross-Site Request Forgery (CSRF)</h1>
<div class='content'><p>Los ataques CSRF engañan a los usuarios para que realicen acciones que no tenían la intención de realizar. Usar tokens es un método común para protegerse contra CSRF.</p>
</div><h2>Ejemplo: Implementación de Token CSRF</h2>
<div class='content'><h4>Generación de un Token</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoZW1wdHkoJF9TRVNTSU9OWyd0b2tlbiddKSkgewogICAgJF9TRVNTSU9OWyd0b2tlbiddID0gYmluMmhleChyYW5kb21fYnl0ZXMoMzIpKTsKfQo/Pgo8Zm9ybSBtZXRob2Q9InBvc3QiIGFjdGlvbj0icHJvY2Vzcy5waHAiPgogICAgPGlucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0idG9rZW4iIHZhbHVlPSI8P3BocCBlY2hvICRfU0VTU0lPTlsndG9rZW4nXTsgPz4iPgogICAgPCEtLSBPdHJvcyBjYW1wb3MgZGVsIGZvcm11bGFyaW8gLS0+CiAgICA8aW5wdXQgdHlwZT0ic3VibWl0IiB2YWx1ZT0iRW52aWFyIj4KPC9mb3JtPg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();
if (empty($_SESSION['token'])) {
    $_SESSION['token'] = bin2hex(random_bytes(32));
}
?&gt;
&lt;form method=&quot;post&quot; action=&quot;process.php&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;token&quot; value=&quot;&lt;?php echo $_SESSION['token']; ?&gt;&quot;&gt;
    &lt;!-- Otros campos del formulario --&gt;
    &lt;input type=&quot;submit&quot; value=&quot;Enviar&quot;&gt;
&lt;/form&gt;</pre></div><div class='content'><h4>Validación del Token</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKc2Vzc2lvbl9zdGFydCgpOwppZiAoJF9TRVJWRVJbIlJFUVVFU1RfTUVUSE9EIl0gPT0gIlBPU1QiKSB7CiAgICBpZiAoIWhhc2hfZXF1YWxzKCRfU0VTU0lPTlsndG9rZW4nXSwgJF9QT1NUWyd0b2tlbiddKSkgewogICAgICAgIGRpZSgiTGEgdmFsaWRhY2nDs24gZGVsIHRva2VuIENTUkYgZmFsbMOzIik7CiAgICB9CiAgICAvLyBQcm9jZXNhciBkYXRvcyBkZWwgZm9ybXVsYXJpbwp9Cj8+"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
session_start();
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    if (!hash_equals($_SESSION['token'], $_POST['token'])) {
        die(&quot;La validaci&oacute;n del token CSRF fall&oacute;&quot;);
    }
    // Procesar datos del formulario
}
?&gt;</pre></div><div class='content'><ul>
<li><code>bin2hex()</code>: Convierte datos binarios en representación hexadecimal.</li>
<li><code>random_bytes()</code>: Genera bytes pseudoaleatorios criptográficamente seguros.</li>
<li><code>hash_equals()</code>: Compara dos cadenas de manera segura contra ataques de temporización.</li>
</ul>
</div><h1>Hashing y Almacenamiento de Contraseñas</h1>
<div class='content'><p>Almacenar contraseñas de manera segura es esencial para proteger las cuentas de los usuarios. PHP proporciona las funciones <code>password_hash()</code> y <code>password_verify()</code> para este propósito.</p>
</div><h2>Ejemplo: Hashing y Verificación de Contraseñas</h2>
<div class='content'><h4>Hashing de una Contraseña</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHBhc3N3b3JkID0gInVzZXJfcGFzc3dvcmQiOwokaGFzaGVkX3Bhc3N3b3JkID0gcGFzc3dvcmRfaGFzaCgkcGFzc3dvcmQsIFBBU1NXT1JEX0RFRkFVTFQpOwplY2hvICRoYXNoZWRfcGFzc3dvcmQ7Cj8+"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$password = &quot;user_password&quot;;
$hashed_password = password_hash($password, PASSWORD_DEFAULT);
echo $hashed_password;
?&gt;</pre></div><div class='content'><h4>Verificación de una Contraseña</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJGVudGVyZWRfcGFzc3dvcmQgPSAidXNlcl9wYXNzd29yZCI7CiRzdG9yZWRfaGFzaGVkX3Bhc3N3b3JkID0gJyQyeSQxMCRFOU4xLi4uJzsgLy8gRWplbXBsbyBkZSBjb250cmFzZcOxYSBoYXNoZWFkYSBkZSBsYSBiYXNlIGRlIGRhdG9zCgppZiAocGFzc3dvcmRfdmVyaWZ5KCRlbnRlcmVkX3Bhc3N3b3JkLCAkc3RvcmVkX2hhc2hlZF9wYXNzd29yZCkpIHsKICAgIGVjaG8gIsKhTGEgY29udHJhc2XDsWEgZXMgdsOhbGlkYSEiOwp9IGVsc2UgewogICAgZWNobyAiQ29udHJhc2XDsWEgaW52w6FsaWRhLiI7Cn0KPz4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$entered_password = &quot;user_password&quot;;
$stored_hashed_password = '$2y$10$E9N1...'; // Ejemplo de contrase&ntilde;a hasheada de la base de datos

if (password_verify($entered_password, $stored_hashed_password)) {
    echo &quot;&iexcl;La contrase&ntilde;a es v&aacute;lida!&quot;;
} else {
    echo &quot;Contrase&ntilde;a inv&aacute;lida.&quot;;
}
?&gt;</pre></div><div class='content'><ul>
<li><code>password_hash()</code>: Crea un hash de contraseña.</li>
<li><code>password_verify()</code>: Verifica que una contraseña coincida con un hash.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>La seguridad de formularios en PHP implica múltiples capas de protección, incluyendo validación y saneamiento de entradas, prevención de inyección SQL, prevención de XSS, protección contra CSRF y manejo seguro de contraseñas. Al implementar estas prácticas, puedes mejorar significativamente la seguridad de tus aplicaciones web y proteger tanto tus datos como a tus usuarios.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='form-validation'>&#x25C4;Validación de Formularios</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Seguridad de Formularios en PHP</a>
	</div>
	<div class='col-4 text-end'>
					<a href='working-with-arrays'>Trabajando con Arrays &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
