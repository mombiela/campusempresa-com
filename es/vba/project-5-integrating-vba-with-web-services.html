<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto 5: Integración de VBA con Servicios Web</title>

    <link rel="alternate" href="https://campusempresa.com/es/vba/project-5-integrating-vba-with-web-services" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/vba/project-5-integrating-vba-with-web-services" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/vba/project-5-integrating-vba-with-web-services" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/vba/project-5-integrating-vba-with-web-services" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='project-4-building-a-dashboard'>&#x25C4;Proyecto 4: Construcción de un Tablero</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Proyecto 5: Integración de VBA con Servicios Web</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vba-best-practices'>Mejores Prácticas de VBA &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En este proyecto, exploraremos cómo integrar VBA (Visual Basic para Aplicaciones) con servicios web. Este es un tema avanzado que te permitirá extender las capacidades de tus aplicaciones VBA interactuando con APIs en línea para obtener o enviar datos. Al final de este proyecto, serás capaz de:</p>
<ul>
<li>Entender los conceptos básicos de los servicios web y las APIs.</li>
<li>Realizar solicitudes HTTP desde VBA.</li>
<li>Analizar respuestas JSON.</li>
<li>Manejar errores y excepciones en llamadas a servicios web.</li>
</ul>
</div><h1>Entendiendo los Servicios Web y las APIs</h1>
<div class='content'><p>Antes de sumergirnos en el código, es importante entender qué son los servicios web y las APIs.</p>
<ul>
<li><strong>Servicios Web</strong>: Son servicios ofrecidos por un dispositivo electrónico a otro dispositivo electrónico, comunicándose entre sí a través de la World Wide Web.</li>
<li><strong>API (Interfaz de Programación de Aplicaciones)</strong>: Es un conjunto de reglas que permite que una aplicación de software interactúe con otra.</li>
</ul>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Métodos HTTP</strong>: GET, POST, PUT, DELETE.</li>
<li><strong>Endpoints</strong>: URLs que proporcionan acceso al servicio web.</li>
<li><strong>Headers</strong>: Metadatos enviados con la solicitud.</li>
<li><strong>JSON (JavaScript Object Notation)</strong>: Un formato ligero de intercambio de datos.</li>
</ul>
</div><h1>Realizando Solicitudes HTTP desde VBA</h1>
<div class='content'><p>Para interactuar con servicios web, necesitamos realizar solicitudes HTTP. VBA no tiene soporte incorporado para solicitudes HTTP, por lo que utilizaremos el objeto <code>MSXML2.XMLHTTP</code>.</p>
</div><h2>Ejemplo: Realizando una Solicitud GET</h2>
<div class='content'><p>Aquí hay un ejemplo simple de cómo realizar una solicitud GET a un servicio web que devuelve datos JSON.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdldFJlcXVlc3RFeGFtcGxlKCkKICAgIERpbSBodHRwIEFzIE9iamVjdAogICAgRGltIHVybCBBcyBTdHJpbmcKICAgIERpbSByZXNwb25zZSBBcyBTdHJpbmcKICAgIAogICAgJyBDcmVhciBlbCBvYmpldG8gWE1MSFRUUAogICAgU2V0IGh0dHAgPSBDcmVhdGVPYmplY3QoIk1TWE1MMi5YTUxIVFRQIikKICAgIAogICAgJyBEZWZpbmlyIGxhIFVSTCBkZWwgc2VydmljaW8gd2ViCiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20vZGF0YSIKICAgIAogICAgJyBBYnJpciBsYSBzb2xpY2l0dWQKICAgIGh0dHAuT3BlbiAiR0VUIiwgdXJsLCBGYWxzZQogICAgCiAgICAnIEVudmlhciBsYSBzb2xpY2l0dWQKICAgIGh0dHAuU2VuZAogICAgCiAgICAnIE9idGVuZXIgZWwgdGV4dG8gZGUgbGEgcmVzcHVlc3RhCiAgICByZXNwb25zZSA9IGh0dHAucmVzcG9uc2VUZXh0CiAgICAKICAgICcgTW9zdHJhciBsYSByZXNwdWVzdGEKICAgIE1zZ0JveCByZXNwb25zZQpFbmQgU3Vi"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GetRequestExample()
    Dim http As Object
    Dim url As String
    Dim response As String
    
    ' Crear el objeto XMLHTTP
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Definir la URL del servicio web
    url = &quot;https://api.example.com/data&quot;
    
    ' Abrir la solicitud
    http.Open &quot;GET&quot;, url, False
    
    ' Enviar la solicitud
    http.Send
    
    ' Obtener el texto de la respuesta
    response = http.responseText
    
    ' Mostrar la respuesta
    MsgBox response
End Sub</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>CreateObject(&quot;MSXML2.XMLHTTP&quot;)</strong>: Crea una instancia del objeto XMLHTTP.</li>
<li><strong>http.Open &quot;GET&quot;, url, False</strong>: Inicializa una solicitud GET a la URL especificada.</li>
<li><strong>http.Send</strong>: Envía la solicitud al servidor.</li>
<li><strong>http.responseText</strong>: Recupera la respuesta del servidor.</li>
</ul>
</div><h1>Analizando Respuestas JSON</h1>
<div class='content'><p>Una vez que recibimos la respuesta del servicio web, a menudo está en formato JSON. Necesitamos analizar este JSON para extraer información útil.</p>
</div><h2>Ejemplo: Analizando JSON</h2>
<div class='content'><p>Usaremos la biblioteca <code>JsonConverter</code> para analizar JSON en VBA. Puedes descargar esta biblioteca desde GitHub e importarla en tu proyecto VBA.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFBhcnNlSnNvbkV4YW1wbGUoKQogICAgRGltIGh0dHAgQXMgT2JqZWN0CiAgICBEaW0gdXJsIEFzIFN0cmluZwogICAgRGltIHJlc3BvbnNlIEFzIFN0cmluZwogICAgRGltIGpzb24gQXMgT2JqZWN0CiAgICBEaW0gZGF0YSBBcyBPYmplY3QKICAgIAogICAgJyBDcmVhciBlbCBvYmpldG8gWE1MSFRUUAogICAgU2V0IGh0dHAgPSBDcmVhdGVPYmplY3QoIk1TWE1MMi5YTUxIVFRQIikKICAgIAogICAgJyBEZWZpbmlyIGxhIFVSTCBkZWwgc2VydmljaW8gd2ViCiAgICB1cmwgPSAiaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20vZGF0YSIKICAgIAogICAgJyBBYnJpciBsYSBzb2xpY2l0dWQKICAgIGh0dHAuT3BlbiAiR0VUIiwgdXJsLCBGYWxzZQogICAgCiAgICAnIEVudmlhciBsYSBzb2xpY2l0dWQKICAgIGh0dHAuU2VuZAogICAgCiAgICAnIE9idGVuZXIgZWwgdGV4dG8gZGUgbGEgcmVzcHVlc3RhCiAgICByZXNwb25zZSA9IGh0dHAucmVzcG9uc2VUZXh0CiAgICAKICAgICcgQW5hbGl6YXIgbGEgcmVzcHVlc3RhIEpTT04KICAgIFNldCBqc29uID0gSnNvbkNvbnZlcnRlci5QYXJzZUpzb24ocmVzcG9uc2UpCiAgICAKICAgICcgQWNjZWRlciBhIGxvcyBkYXRvcyBkZWwgb2JqZXRvIEpTT04KICAgIFNldCBkYXRhID0ganNvbigia2V5IikKICAgIAogICAgJyBNb3N0cmFyIGxvcyBkYXRvcwogICAgTXNnQm94IGRhdGEKRW5kIFN1Yg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ParseJsonExample()
    Dim http As Object
    Dim url As String
    Dim response As String
    Dim json As Object
    Dim data As Object
    
    ' Crear el objeto XMLHTTP
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Definir la URL del servicio web
    url = &quot;https://api.example.com/data&quot;
    
    ' Abrir la solicitud
    http.Open &quot;GET&quot;, url, False
    
    ' Enviar la solicitud
    http.Send
    
    ' Obtener el texto de la respuesta
    response = http.responseText
    
    ' Analizar la respuesta JSON
    Set json = JsonConverter.ParseJson(response)
    
    ' Acceder a los datos del objeto JSON
    Set data = json(&quot;key&quot;)
    
    ' Mostrar los datos
    MsgBox data
End Sub</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>JsonConverter.ParseJson(response)</strong>: Analiza la respuesta JSON en un objeto VBA.</li>
<li><strong>json(&quot;key&quot;)</strong>: Accede a un valor específico del objeto JSON.</li>
</ul>
</div><h1>Manejo de Errores y Excepciones</h1>
<div class='content'><p>Cuando trabajamos con servicios web, es importante manejar los errores y excepciones de manera adecuada.</p>
</div><h2>Ejemplo: Manejo de Errores</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdldFJlcXVlc3RXaXRoRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgogICAgCiAgICBEaW0gaHR0cCBBcyBPYmplY3QKICAgIERpbSB1cmwgQXMgU3RyaW5nCiAgICBEaW0gcmVzcG9uc2UgQXMgU3RyaW5nCiAgICAKICAgICcgQ3JlYXIgZWwgb2JqZXRvIFhNTEhUVFAKICAgIFNldCBodHRwID0gQ3JlYXRlT2JqZWN0KCJNU1hNTDIuWE1MSFRUUCIpCiAgICAKICAgICcgRGVmaW5pciBsYSBVUkwgZGVsIHNlcnZpY2lvIHdlYgogICAgdXJsID0gImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEiCiAgICAKICAgICcgQWJyaXIgbGEgc29saWNpdHVkCiAgICBodHRwLk9wZW4gIkdFVCIsIHVybCwgRmFsc2UKICAgIAogICAgJyBFbnZpYXIgbGEgc29saWNpdHVkCiAgICBodHRwLlNlbmQKICAgIAogICAgJyBWZXJpZmljYXIgZXJyb3JlcyBIVFRQCiAgICBJZiBodHRwLlN0YXR1cyA8PiAyMDAgVGhlbgogICAgICAgIEVyci5SYWlzZSB2Yk9iamVjdEVycm9yICsgMSwgIkdldFJlcXVlc3RXaXRoRXJyb3JIYW5kbGluZyIsICJMYSBzb2xpY2l0dWQgSFRUUCBmYWxsw7MgY29uIGVsIGVzdGFkbyAiICYgaHR0cC5TdGF0dXMKICAgIEVuZCBJZgogICAgCiAgICAnIE9idGVuZXIgZWwgdGV4dG8gZGUgbGEgcmVzcHVlc3RhCiAgICByZXNwb25zZSA9IGh0dHAucmVzcG9uc2VUZXh0CiAgICAKICAgICcgTW9zdHJhciBsYSByZXNwdWVzdGEKICAgIE1zZ0JveCByZXNwb25zZQogICAgCiAgICBFeGl0IFN1YgogICAgCkVycm9ySGFuZGxlcjoKICAgIE1zZ0JveCAiT2N1cnJpw7MgdW4gZXJyb3I6ICIgJiBFcnIuRGVzY3JpcHRpb24KRW5kIFN1Yg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GetRequestWithErrorHandling()
    On Error GoTo ErrorHandler
    
    Dim http As Object
    Dim url As String
    Dim response As String
    
    ' Crear el objeto XMLHTTP
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Definir la URL del servicio web
    url = &quot;https://api.example.com/data&quot;
    
    ' Abrir la solicitud
    http.Open &quot;GET&quot;, url, False
    
    ' Enviar la solicitud
    http.Send
    
    ' Verificar errores HTTP
    If http.Status &lt;&gt; 200 Then
        Err.Raise vbObjectError + 1, &quot;GetRequestWithErrorHandling&quot;, &quot;La solicitud HTTP fall&oacute; con el estado &quot; &amp; http.Status
    End If
    
    ' Obtener el texto de la respuesta
    response = http.responseText
    
    ' Mostrar la respuesta
    MsgBox response
    
    Exit Sub
    
ErrorHandler:
    MsgBox &quot;Ocurri&oacute; un error: &quot; &amp; Err.Description
End Sub</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>On Error GoTo ErrorHandler</strong>: Dirige VBA a la etiqueta ErrorHandler si ocurre un error.</li>
<li><strong>http.Status</strong>: Verifica el código de estado HTTP de la respuesta.</li>
<li><strong>Err.Raise</strong>: Genera un error personalizado si la solicitud HTTP falla.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Integrar VBA con servicios web puede mejorar significativamente la funcionalidad de tus aplicaciones al permitirles interactuar con APIs en línea. En este proyecto, cubrimos:</p>
<ul>
<li>Los conceptos básicos de los servicios web y las APIs.</li>
<li>Realizar solicitudes HTTP desde VBA.</li>
<li>Analizar respuestas JSON.</li>
<li>Manejar errores y excepciones.</li>
</ul>
<p>Al dominar estas técnicas, podrás crear aplicaciones VBA poderosas que aprovechen la gran cantidad de datos y servicios disponibles en la web.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='project-4-building-a-dashboard'>&#x25C4;Proyecto 4: Construcción de un Tablero</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Proyecto 5: Integración de VBA con Servicios Web</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vba-best-practices'>Mejores Prácticas de VBA &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
