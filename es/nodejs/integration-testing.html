<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pruebas de Integración en Node.js</title>

    <link rel="alternate" href="https://campusempresa.com/es/nodejs/integration-testing" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nodejs/integration-testing" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nodejs/integration-testing" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/nodejs/integration-testing" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>Las pruebas de integración son una parte crucial del ciclo de vida del desarrollo de software. Aseguran que los diferentes módulos o servicios en tu aplicación funcionen juntos como se espera. Este tema te guiará a través de los conceptos básicos hasta los avanzados de las pruebas de integración en Node.js.</p>
</div><h1>¿Qué son las Pruebas de Integración?</h1>
<div class='content'><ul>
<li><strong>Definición</strong>: Las pruebas de integración son un nivel de pruebas de software donde las unidades individuales se combinan y se prueban como un grupo.</li>
<li><strong>Propósito</strong>: Identificar problemas en la interacción entre unidades integradas.</li>
<li><strong>Alcance</strong>: Va más allá de las pruebas unitarias al enfocarse en la comunicación entre módulos.</li>
</ul>
</div><h1>Por Qué las Pruebas de Integración son Importantes</h1>
<div class='content'><ul>
<li><strong>Detecta Problemas de Interfaz</strong>: Ayuda a identificar problemas en la interacción entre diferentes módulos.</li>
<li><strong>Asegura la Integridad de los Datos</strong>: Verifica que los datos se pasen correctamente entre los módulos.</li>
<li><strong>Mejora la Calidad del Código</strong>: Mejora la calidad general del código al detectar errores temprano en el proceso de desarrollo.</li>
</ul>
</div><h1>Herramientas para Pruebas de Integración en Node.js</h1>
<div class='content'><ul>
<li><strong>Mocha</strong>: Un marco de pruebas de JavaScript con muchas características que se ejecuta en Node.js.</li>
<li><strong>Chai</strong>: Una biblioteca de aserciones BDD / TDD para Node.js.</li>
<li><strong>Supertest</strong>: Una biblioteca para probar servidores HTTP de Node.js.</li>
</ul>
</div><h1>Configurando Tu Entorno</h1>
<div class='content'><p>Para comenzar con las pruebas de integración en Node.js, necesitas configurar tu entorno con las herramientas necesarias.</p>
</div><h2>Instalando Mocha, Chai y Supertest</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgLS1zYXZlLWRldiBtb2NoYSBjaGFpIHN1cGVydGVzdA=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install --save-dev mocha chai supertest</pre></div><div class='content'></div><h2>Estructura Básica del Proyecto</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWktYXBwLW5vZGUvCuKUnOKUgOKUgCBhcHAuanMK4pSc4pSA4pSAIHBhY2thZ2UuanNvbgrilJzilIDilIAgdGVzdC8K4pSCICAg4pSU4pSA4pSAIGludGVncmF0aW9uLwrilIIgICAgICAg4pSU4pSA4pSAIGFwcC50ZXN0Lmpz"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mi-app-node/
├── app.js
├── package.json
├── test/
│   └── integration/
│       └── app.test.js</pre></div><div class='content'></div><h1>Escribiendo Tu Primera Prueba de Integración</h1>
<div class='content'><p>Vamos a escribir una simple prueba de integración para una aplicación Node.js.</p>
</div><h2>Aplicación de Ejemplo (app.js)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKYXBwLmdldCgnL2FwaS9oZWxsbycsIChyZXEsIHJlcykgPT4gewogIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ8KhSG9sYSwgbXVuZG8hJyB9KTsKfSk7Cgptb2R1bGUuZXhwb3J0cyA9IGFwcDs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

app.get('/api/hello', (req, res) =&gt; {
  res.status(200).json({ message: '&iexcl;Hola, mundo!' });
});

module.exports = app;</pre></div><div class='content'></div><h2>Prueba de Integración (test/integration/app.test.js)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpOwpjb25zdCBhcHAgPSByZXF1aXJlKCcuLi8uLi9hcHAnKTsKY29uc3QgY2hhaSA9IHJlcXVpcmUoJ2NoYWknKTsKY29uc3QgZXhwZWN0ID0gY2hhaS5leHBlY3Q7CgpkZXNjcmliZSgnR0VUIC9hcGkvaGVsbG8nLCAoKSA9PiB7CiAgaXQoJ2RlYmVyw61hIGRldm9sdmVyIHVuIG1lbnNhamUgIsKhSG9sYSwgbXVuZG8hIicsIChkb25lKSA9PiB7CiAgICByZXF1ZXN0KGFwcCkKICAgICAgLmdldCgnL2FwaS9oZWxsbycpCiAgICAgIC5lbmQoKGVyciwgcmVzKSA9PiB7CiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDIwMCk7CiAgICAgICAgZXhwZWN0KHJlcy5ib2R5Lm1lc3NhZ2UpLnRvLmVxdWFsKCfCoUhvbGEsIG11bmRvIScpOwogICAgICAgIGRvbmUoKTsKICAgICAgfSk7CiAgfSk7Cn0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const request = require('supertest');
const app = require('../../app');
const chai = require('chai');
const expect = chai.expect;

describe('GET /api/hello', () =&gt; {
  it('deber&iacute;a devolver un mensaje &quot;&iexcl;Hola, mundo!&quot;', (done) =&gt; {
    request(app)
      .get('/api/hello')
      .end((err, res) =&gt; {
        expect(res.status).to.equal(200);
        expect(res.body.message).to.equal('&iexcl;Hola, mundo!');
        done();
      });
  });
});</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>Configuración</strong>: Importar los módulos necesarios (<code>supertest</code>, <code>chai</code> y la aplicación).</li>
<li><strong>Caso de Prueba</strong>: Describir el caso de prueba usando bloques <code>describe</code> e <code>it</code>.</li>
<li><strong>Solicitud</strong>: Usar <code>supertest</code> para hacer una solicitud GET a <code>/api/hello</code>.</li>
<li><strong>Aserciones</strong>: Usar <code>chai</code> para afirmar el estado y el cuerpo de la respuesta.</li>
</ul>
</div><h1>Conceptos Avanzados de Pruebas de Integración</h1>
<div class='content'></div><h2>Pruebas con Bases de Datos</h2>
<div class='content'><p>Cuando tu aplicación interactúa con una base de datos, necesitas asegurarte de que tus pruebas de integración cubran estas interacciones.</p>
<h4>Ejemplo con MongoDB</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwpjb25zdCBVc2VyID0gcmVxdWlyZSgnLi4vLi4vbW9kZWxzL3VzZXInKTsKCmJlZm9yZSgoZG9uZSkgPT4gewogIG1vbmdvb3NlLmNvbm5lY3QoJ21vbmdvZGI6Ly9sb2NhbGhvc3QvdGVzdGRiJywgeyB1c2VOZXdVcmxQYXJzZXI6IHRydWUsIHVzZVVuaWZpZWRUb3BvbG9neTogdHJ1ZSB9KTsKICBtb25nb29zZS5jb25uZWN0aW9uLm9uY2UoJ29wZW4nLCAoKSA9PiBkb25lKCkpLm9uKCdlcnJvcicsIChlcnJvcikgPT4gY29uc29sZS53YXJuKCdFcnJvcicsIGVycm9yKSk7Cn0pOwoKYWZ0ZXIoKGRvbmUpID0+IHsKICBtb25nb29zZS5jb25uZWN0aW9uLmNsb3NlKCgpID0+IGRvbmUoKSk7Cn0pOwoKZGVzY3JpYmUoJ1BPU1QgL2FwaS91c2VycycsICgpID0+IHsKICBpdCgnZGViZXLDrWEgY3JlYXIgdW4gbnVldm8gdXN1YXJpbycsIChkb25lKSA9PiB7CiAgICBjb25zdCB1c2VyID0geyBuYW1lOiAnSm9obiBEb2UnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH07CiAgICByZXF1ZXN0KGFwcCkKICAgICAgLnBvc3QoJy9hcGkvdXNlcnMnKQogICAgICAuc2VuZCh1c2VyKQogICAgICAuZW5kKChlcnIsIHJlcykgPT4gewogICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCgyMDEpOwogICAgICAgIGV4cGVjdChyZXMuYm9keS5uYW1lKS50by5lcXVhbCgnSm9obiBEb2UnKTsKICAgICAgICBkb25lKCk7CiAgICAgIH0pOwogIH0pOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const mongoose = require('mongoose');
const User = require('../../models/user');

before((done) =&gt; {
  mongoose.connect('mongodb://localhost/testdb', { useNewUrlParser: true, useUnifiedTopology: true });
  mongoose.connection.once('open', () =&gt; done()).on('error', (error) =&gt; console.warn('Error', error));
});

after((done) =&gt; {
  mongoose.connection.close(() =&gt; done());
});

describe('POST /api/users', () =&gt; {
  it('deber&iacute;a crear un nuevo usuario', (done) =&gt; {
    const user = { name: 'John Doe', email: 'john@example.com' };
    request(app)
      .post('/api/users')
      .send(user)
      .end((err, res) =&gt; {
        expect(res.status).to.equal(201);
        expect(res.body.name).to.equal('John Doe');
        done();
      });
  });
});</pre></div><div class='content'></div><h2>Simulación de Servicios Externos</h2>
<div class='content'><p>A veces, tu aplicación podría depender de servicios externos. Puedes usar bibliotecas como <code>nock</code> para simular estos servicios.</p>
<h4>Ejemplo con Nock</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgbm9jayA9IHJlcXVpcmUoJ25vY2snKTsKCmRlc2NyaWJlKCdHRVQgL2FwaS9leHRlcm5hbCcsICgpID0+IHsKICBiZWZvcmUoKCkgPT4gewogICAgbm9jaygnaHR0cHM6Ly9leHRlcm5hbC1zZXJ2aWNlLmNvbScpCiAgICAgIC5nZXQoJy9kYXRhJykKICAgICAgLnJlcGx5KDIwMCwgeyBkYXRhOiAnZGF0b3Mgc2ltdWxhZG9zJyB9KTsKICB9KTsKCiAgaXQoJ2RlYmVyw61hIGRldm9sdmVyIGRhdG9zIHNpbXVsYWRvcyBkZWwgc2VydmljaW8gZXh0ZXJubycsIChkb25lKSA9PiB7CiAgICByZXF1ZXN0KGFwcCkKICAgICAgLmdldCgnL2FwaS9leHRlcm5hbCcpCiAgICAgIC5lbmQoKGVyciwgcmVzKSA9PiB7CiAgICAgICAgZXhwZWN0KHJlcy5zdGF0dXMpLnRvLmVxdWFsKDIwMCk7CiAgICAgICAgZXhwZWN0KHJlcy5ib2R5LmRhdGEpLnRvLmVxdWFsKCdkYXRvcyBzaW11bGFkb3MnKTsKICAgICAgICBkb25lKCk7CiAgICAgIH0pOwogIH0pOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const nock = require('nock');

describe('GET /api/external', () =&gt; {
  before(() =&gt; {
    nock('https://external-service.com')
      .get('/data')
      .reply(200, { data: 'datos simulados' });
  });

  it('deber&iacute;a devolver datos simulados del servicio externo', (done) =&gt; {
    request(app)
      .get('/api/external')
      .end((err, res) =&gt; {
        expect(res.status).to.equal(200);
        expect(res.body.data).to.equal('datos simulados');
        done();
      });
  });
});</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Las pruebas de integración son esenciales para asegurar que las diferentes partes de tu aplicación funcionen juntas sin problemas. Usando herramientas como Mocha, Chai y Supertest, puedes escribir pruebas de integración efectivas para tus aplicaciones Node.js. A medida que avances, considera probar interacciones con bases de datos y simular servicios externos para cubrir todos los aspectos de tu aplicación.</p>
<p>Siguiendo estas prácticas, puedes mejorar la fiabilidad y calidad de tus aplicaciones Node.js, haciéndolas más robustas y mantenibles.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
