<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introducción a la Autenticación</title>

    <link rel="alternate" href="https://campusempresa.com/es/nodejs/intro-to-authentication" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nodejs/intro-to-authentication" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nodejs/intro-to-authentication" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/nodejs/intro-to-authentication" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>La autenticación es un aspecto crucial del desarrollo web, asegurando que los usuarios sean quienes dicen ser. En este módulo, exploraremos cómo implementar la autenticación en una aplicación Node.js, cubriendo tanto conceptos básicos como avanzados.</p>
</div><h1>¿Qué es la Autenticación?</h1>
<div class='content'><p>La autenticación es el proceso de verificar la identidad de un usuario o sistema. Es una parte fundamental para asegurar aplicaciones y servicios web.</p>
</div><h2>Conceptos Clave:</h2>
<div class='content'><ul>
<li><strong>Credenciales de Usuario</strong>: Típicamente una combinación de un nombre de usuario y una contraseña.</li>
<li><strong>Tokens</strong>: Utilizados para mantener sesiones de usuario sin almacenar información sensible en el lado del cliente.</li>
<li><strong>Sesiones</strong>: Almacenamiento en el servidor de datos del usuario para mantener el estado a través de múltiples solicitudes.</li>
<li><strong>OAuth</strong>: Un estándar abierto para la delegación de acceso, comúnmente utilizado para la autenticación basada en tokens.</li>
</ul>
</div><h1>Configuración de un Proyecto Node.js</h1>
<div class='content'><p>Antes de sumergirnos en la autenticación, configuremos un proyecto básico de Node.js.</p>
<ol>
<li>
<p><strong>Inicializar un Proyecto Node.js</strong>:</p>
<pre><code class="language-bash">mkdir auth-demo
cd auth-demo
npm init -y
</code></pre>
</li>
<li>
<p><strong>Instalar Paquetes Requeridos</strong>:</p>
<pre><code class="language-bash">npm install express body-parser bcryptjs jsonwebtoken
</code></pre>
</li>
<li>
<p><strong>Crear un Servidor Básico</strong>:</p>
<pre><code class="language-javascript">const express = require('express');
const bodyParser = require('body-parser');

const app = express();
app.use(bodyParser.json());

app.get('/', (req, res) =&gt; {
    res.send('¡Bienvenido a la Demostración de Autenticación!');
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, () =&gt; {
    console.log(`El servidor está corriendo en el puerto ${PORT}`);
});
</code></pre>
</li>
</ol>
</div><h1>Autenticación Básica</h1>
<div class='content'></div><h2>Registro de Usuario</h2>
<div class='content'><ol>
<li>
<p><strong>Hashing de Contraseñas</strong>: Usa <code>bcryptjs</code> para hashear contraseñas antes de almacenarlas en la base de datos.</p>
<pre><code class="language-javascript">const bcrypt = require('bcryptjs');

const hashPassword = async (password) =&gt; {
    const salt = await bcrypt.genSalt(10);
    const hashedPassword = await bcrypt.hash(password, salt);
    return hashedPassword;
};
</code></pre>
</li>
<li>
<p><strong>Endpoint de Registro</strong>:</p>
<pre><code class="language-javascript">app.post('/register', async (req, res) =&gt; {
    const { username, password } = req.body;
    const hashedPassword = await hashPassword(password);
    // Guarda el usuario en la base de datos (simulado aquí)
    const user = { id: Date.now(), username, password: hashedPassword };
    res.status(201).send(user);
});
</code></pre>
</li>
</ol>
</div><h2>Inicio de Sesión de Usuario</h2>
<div class='content'><ol>
<li>
<p><strong>Verificar Contraseñas</strong>: Compara la contraseña hasheada con el hash almacenado.</p>
<pre><code class="language-javascript">const verifyPassword = async (password, hashedPassword) =&gt; {
    return await bcrypt.compare(password, hashedPassword);
};
</code></pre>
</li>
<li>
<p><strong>Endpoint de Inicio de Sesión</strong>:</p>
<pre><code class="language-javascript">app.post('/login', async (req, res) =&gt; {
    const { username, password } = req.body;
    // Recupera el usuario de la base de datos (simulado aquí)
    const user = { id: 1, username, password: '$2a$10$...' }; // contraseña hasheada
    const isMatch = await verifyPassword(password, user.password);
    if (isMatch) {
        res.status(200).send('Inicio de sesión exitoso');
    } else {
        res.status(400).send('Credenciales inválidas');
    }
});
</code></pre>
</li>
</ol>
</div><h1>Autenticación Basada en Tokens</h1>
<div class='content'></div><h2>Generación de Tokens</h2>
<div class='content'><ol>
<li>
<p><strong>Instalar <code>jsonwebtoken</code></strong>:</p>
<pre><code class="language-bash">npm install jsonwebtoken
</code></pre>
</li>
<li>
<p><strong>Generar JWT</strong>:</p>
<pre><code class="language-javascript">const jwt = require('jsonwebtoken');

const generateToken = (user) =&gt; {
    const token = jwt.sign({ id: user.id, username: user.username }, 'secretKey', { expiresIn: '1h' });
    return token;
};
</code></pre>
</li>
<li>
<p><strong>Endpoint de Inicio de Sesión con Token</strong>:</p>
<pre><code class="language-javascript">app.post('/login', async (req, res) =&gt; {
    const { username, password } = req.body;
    const user = { id: 1, username, password: '$2a$10$...' };
    const isMatch = await verifyPassword(password, user.password);
    if (isMatch) {
        const token = generateToken(user);
        res.status(200).send({ token });
    } else {
        res.status(400).send('Credenciales inválidas');
    }
});
</code></pre>
</li>
</ol>
</div><h2>Protección de Rutas</h2>
<div class='content'><ol>
<li>
<p><strong>Middleware para Verificar el Token</strong>:</p>
<pre><code class="language-javascript">const authenticateToken = (req, res, next) =&gt; {
    const token = req.header('Authorization').replace('Bearer ', '');
    if (!token) {
        return res.status(401).send('Acceso Denegado');
    }
    try {
        const verified = jwt.verify(token, 'secretKey');
        req.user = verified;
        next();
    } catch (err) {
        res.status(400).send('Token Inválido');
    }
};
</code></pre>
</li>
<li>
<p><strong>Ruta Protegida</strong>:</p>
<pre><code class="language-javascript">app.get('/protected', authenticateToken, (req, res) =&gt; {
    res.send('Esta es una ruta protegida');
});
</code></pre>
</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>En este módulo, cubrimos los conceptos básicos de la autenticación en una aplicación Node.js. Comenzamos configurando un proyecto Node.js, luego pasamos a implementar la autenticación básica con contraseñas hasheadas. También exploramos la autenticación basada en tokens usando JSON Web Tokens (JWT) y cómo proteger rutas usando middleware.</p>
<p>Al entender estos conceptos, puedes construir aplicaciones Node.js más seguras y asegurarte de que solo los usuarios autenticados puedan acceder a ciertos recursos.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
