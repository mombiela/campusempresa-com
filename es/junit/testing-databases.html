<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pruebas de Bases de Datos con JUnit</title>

    <link rel="alternate" href="https://campusempresa.com/es/junit/testing-databases" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/junit/testing-databases" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/junit/testing-databases" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/junit/testing-databases" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Probar bases de datos es una parte crucial para asegurar la fiabilidad y corrección de tus aplicaciones. En esta sección, exploraremos cómo usar JUnit para probar interacciones con bases de datos de manera efectiva. Cubriremos los conceptos básicos de la configuración de tu entorno, la escritura de pruebas y técnicas avanzadas para escenarios más complejos.</p>
</div><h1>Configuración de Tu Entorno</h1>
<div class='content'><p>Antes de que puedas comenzar a probar tus interacciones con la base de datos, necesitas configurar tu entorno.</p>
</div><h2>Dependencias</h2>
<div class='content'><p>Primero, asegúrate de tener las dependencias necesarias en tu <code>pom.xml</code> si estás usando Maven:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY2llcz4KICAgIDwhLS0gRGVwZW5kZW5jaWEgZGUgSlVuaXQgNSAtLT4KICAgIDxkZXBlbmRlbmN5PgogICAgICAgIDxncm91cElkPm9yZy5qdW5pdC5qdXBpdGVyPC9ncm91cElkPgogICAgICAgIDxhcnRpZmFjdElkPmp1bml0LWp1cGl0ZXItZW5naW5lPC9hcnRpZmFjdElkPgogICAgICAgIDx2ZXJzaW9uPjUuNy4wPC92ZXJzaW9uPgogICAgICAgIDxzY29wZT50ZXN0PC9zY29wZT4KICAgIDwvZGVwZW5kZW5jeT4KICAgIDwhLS0gRGVwZW5kZW5jaWEgZGUgbGEgYmFzZSBkZSBkYXRvcyBIMiBwYXJhIHBydWViYXMgZW4gbWVtb3JpYSAtLT4KICAgIDxkZXBlbmRlbmN5PgogICAgICAgIDxncm91cElkPmNvbS5oMmRhdGFiYXNlPC9ncm91cElkPgogICAgICAgIDxhcnRpZmFjdElkPmgyPC9hcnRpZmFjdElkPgogICAgICAgIDxzY29wZT50ZXN0PC9zY29wZT4KICAgIDwvZGVwZW5kZW5jeT4KICAgIDwhLS0gRGVwZW5kZW5jaWEgZGUgU3ByaW5nIEJvb3QgVGVzdCBzaSB1c2FzIFNwcmluZyBCb290IC0tPgogICAgPGRlcGVuZGVuY3k+CiAgICAgICAgPGdyb3VwSWQ+b3JnLnNwcmluZ2ZyYW1ld29yay5ib290PC9ncm91cElkPgogICAgICAgIDxhcnRpZmFjdElkPnNwcmluZy1ib290LXN0YXJ0ZXItdGVzdDwvYXJ0aWZhY3RJZD4KICAgICAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CiAgICA8L2RlcGVuZGVuY3k+CjwvZGVwZW5kZW5jaWVzPg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependencies&gt;
    &lt;!-- Dependencia de JUnit 5 --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
        &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;
        &lt;version&gt;5.7.0&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- Dependencia de la base de datos H2 para pruebas en memoria --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.h2database&lt;/groupId&gt;
        &lt;artifactId&gt;h2&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- Dependencia de Spring Boot Test si usas Spring Boot --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</pre></div><div class='content'></div><h2>Configuración</h2>
<div class='content'><p>Configura tu aplicación para usar una base de datos en memoria con fines de prueba. Esto se puede hacer en tu archivo <code>application-test.properties</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3ByaW5nLmRhdGFzb3VyY2UudXJsPWpkYmM6aDI6bWVtOnRlc3RkYgpzcHJpbmcuZGF0YXNvdXJjZS5kcml2ZXJDbGFzc05hbWU9b3JnLmgyLkRyaXZlcgpzcHJpbmcuZGF0YXNvdXJjZS51c2VybmFtZT1zYQpzcHJpbmcuZGF0YXNvdXJjZS5wYXNzd29yZD1wYXNzd29yZApzcHJpbmcuanBhLmRhdGFiYXNlLXBsYXRmb3JtPW9yZy5oaWJlcm5hdGUuZGlhbGVjdC5IMkRpYWxlY3Q="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect</pre></div><div class='content'></div><h1>Escribiendo Pruebas Básicas de Base de Datos</h1>
<div class='content'><p>Comencemos con algunas pruebas básicas para asegurarnos de que nuestras interacciones con la base de datos están funcionando como se espera.</p>
</div><h2>Ejemplo: Probando un Repositorio</h2>
<div class='content'><p>Supongamos que tienes una entidad <code>User</code> simple y un <code>UserRepository</code> correspondiente. Así es como puedes escribir una prueba básica:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5qdW5pdC5qdXBpdGVyLmFwaS5UZXN0OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5iZWFucy5mYWN0b3J5LmFubm90YXRpb24uQXV0b3dpcmVkOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5ib290LnRlc3QuYXV0b2NvbmZpZ3VyZS5vcm0uanBhLkRhdGFKcGFUZXN0OwppbXBvcnQgc3RhdGljIG9yZy5hc3NlcnRqLmNvcmUuYXBpLkFzc2VydGlvbnMuYXNzZXJ0VGhhdDsKCkBEYXRhSnBhVGVzdApwdWJsaWMgY2xhc3MgVXNlclJlcG9zaXRvcnlUZXN0IHsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJSZXBvc2l0b3J5IHVzZXJSZXBvc2l0b3J5OwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0U2F2ZVVzZXIoKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoKTsKICAgICAgICB1c2VyLnNldE5hbWUoIkpvaG4gRG9lIik7CiAgICAgICAgdXNlci5zZXRFbWFpbCgiam9obi5kb2VAZXhhbXBsZS5jb20iKTsKCiAgICAgICAgdXNlclJlcG9zaXRvcnkuc2F2ZSh1c2VyKTsKCiAgICAgICAgVXNlciBmb3VuZFVzZXIgPSB1c2VyUmVwb3NpdG9yeS5maW5kQnlJZCh1c2VyLmdldElkKCkpLm9yRWxzZShudWxsKTsKICAgICAgICBhc3NlcnRUaGF0KGZvdW5kVXNlcikuaXNOb3ROdWxsKCk7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0TmFtZSgpKS5pc0VxdWFsVG8oIkpvaG4gRG9lIik7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0RW1haWwoKSkuaXNFcXVhbFRvKCJqb2huLmRvZUBleGFtcGxlLmNvbSIpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
import static org.assertj.core.api.Assertions.assertThat;

@DataJpaTest
public class UserRepositoryTest {

    @Autowired
    private UserRepository userRepository;

    @Test
    public void testSaveUser() {
        User user = new User();
        user.setName(&quot;John Doe&quot;);
        user.setEmail(&quot;john.doe@example.com&quot;);

        userRepository.save(user);

        User foundUser = userRepository.findById(user.getId()).orElse(null);
        assertThat(foundUser).isNotNull();
        assertThat(foundUser.getName()).isEqualTo(&quot;John Doe&quot;);
        assertThat(foundUser.getEmail()).isEqualTo(&quot;john.doe@example.com&quot;);
    }
}</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>@DataJpaTest</strong>: Esta anotación se usa para configurar un slice de prueba para repositorios JPA.</li>
<li><strong>@Autowired</strong>: Inyecta el bean <code>UserRepository</code>.</li>
<li><strong>assertThat</strong>: De AssertJ, usado para aserciones fluidas.</li>
</ul>
</div><h1>Técnicas Avanzadas de Pruebas de Base de Datos</h1>
<div class='content'><p>A medida que te sientas más cómodo con las pruebas básicas, puedes explorar técnicas más avanzadas.</p>
</div><h2>Usando Testcontainers</h2>
<div class='content'><p>Testcontainers es una biblioteca de Java que soporta pruebas JUnit, proporcionando instancias ligeras y desechables de bases de datos comunes.</p>
<h4>Ejemplo: Configurando Testcontainers</h4>
<p>Agrega la dependencia de Testcontainers a tu <code>pom.xml</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcudGVzdGNvbnRhaW5lcnM8L2dyb3VwSWQ+CiAgICA8YXJ0aWZhY3RJZD5qdW5pdC1qdXBpdGVyPC9hcnRpZmFjdElkPgogICAgPHZlcnNpb24+MS4xNS4zPC92ZXJzaW9uPgogICAgPHNjb3BlPnRlc3Q8L3Njb3BlPgo8L2RlcGVuZGVuY3k+CjxkZXBlbmRlbmN5PgogICAgPGdyb3VwSWQ+b3JnLnRlc3Rjb250YWluZXJzPC9ncm91cElkPgogICAgPGFydGlmYWN0SWQ+bXlzcWw8L2FydGlmYWN0SWQ+CiAgICA8dmVyc2lvbj4xLjE1LjM8L3ZlcnNpb24+CiAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CjwvZGVwZW5kZW5jeT4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.testcontainers&lt;/groupId&gt;
    &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
    &lt;version&gt;1.15.3&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.testcontainers&lt;/groupId&gt;
    &lt;artifactId&gt;mysql&lt;/artifactId&gt;
    &lt;version&gt;1.15.3&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div><div class='content'><h4>Ejemplo: Escribiendo una Prueba con Testcontainers</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5qdW5pdC5qdXBpdGVyLmFwaS5UZXN0OwppbXBvcnQgb3JnLmp1bml0Lmp1cGl0ZXIuYXBpLmV4dGVuc2lvbi5FeHRlbmRXaXRoOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5iZWFucy5mYWN0b3J5LmFubm90YXRpb24uQXV0b3dpcmVkOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5ib290LnRlc3QuYXV0b2NvbmZpZ3VyZS5vcm0uanBhLkRhdGFKcGFUZXN0OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay50ZXN0LmNvbnRleHQuanVuaXQuanVwaXRlci5TcHJpbmdFeHRlbnNpb247CmltcG9ydCBvcmcudGVzdGNvbnRhaW5lcnMuY29udGFpbmVycy5NeVNRTENvbnRhaW5lcjsKCmltcG9ydCBzdGF0aWMgb3JnLmFzc2VydGouY29yZS5hcGkuQXNzZXJ0aW9ucy5hc3NlcnRUaGF0OwoKQEV4dGVuZFdpdGgoU3ByaW5nRXh0ZW5zaW9uLmNsYXNzKQpARGF0YUpwYVRlc3QKcHVibGljIGNsYXNzIFVzZXJSZXBvc2l0b3J5VGVzdCB7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBVc2VyUmVwb3NpdG9yeSB1c2VyUmVwb3NpdG9yeTsKCiAgICBzdGF0aWMgTXlTUUxDb250YWluZXI8Pz4gbXlzcWwgPSBuZXcgTXlTUUxDb250YWluZXI8PigibXlzcWw6OC4wLjIyIikKICAgICAgICAgICAgLndpdGhEYXRhYmFzZU5hbWUoInRlc3RkYiIpCiAgICAgICAgICAgIC53aXRoVXNlcm5hbWUoInRlc3QiKQogICAgICAgICAgICAud2l0aFBhc3N3b3JkKCJ0ZXN0Iik7CgogICAgc3RhdGljIHsKICAgICAgICBteXNxbC5zdGFydCgpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0U2F2ZVVzZXIoKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoKTsKICAgICAgICB1c2VyLnNldE5hbWUoIkpvaG4gRG9lIik7CiAgICAgICAgdXNlci5zZXRFbWFpbCgiam9obi5kb2VAZXhhbXBsZS5jb20iKTsKCiAgICAgICAgdXNlclJlcG9zaXRvcnkuc2F2ZSh1c2VyKTsKCiAgICAgICAgVXNlciBmb3VuZFVzZXIgPSB1c2VyUmVwb3NpdG9yeS5maW5kQnlJZCh1c2VyLmdldElkKCkpLm9yRWxzZShudWxsKTsKICAgICAgICBhc3NlcnRUaGF0KGZvdW5kVXNlcikuaXNOb3ROdWxsKCk7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0TmFtZSgpKS5pc0VxdWFsVG8oIkpvaG4gRG9lIik7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0RW1haWwoKSkuaXNFcXVhbFRvKCJqb2huLmRvZUBleGFtcGxlLmNvbSIpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
import org.springframework.test.context.junit.jupiter.SpringExtension;
import org.testcontainers.containers.MySQLContainer;

import static org.assertj.core.api.Assertions.assertThat;

@ExtendWith(SpringExtension.class)
@DataJpaTest
public class UserRepositoryTest {

    @Autowired
    private UserRepository userRepository;

    static MySQLContainer&lt;?&gt; mysql = new MySQLContainer&lt;&gt;(&quot;mysql:8.0.22&quot;)
            .withDatabaseName(&quot;testdb&quot;)
            .withUsername(&quot;test&quot;)
            .withPassword(&quot;test&quot;);

    static {
        mysql.start();
    }

    @Test
    public void testSaveUser() {
        User user = new User();
        user.setName(&quot;John Doe&quot;);
        user.setEmail(&quot;john.doe@example.com&quot;);

        userRepository.save(user);

        User foundUser = userRepository.findById(user.getId()).orElse(null);
        assertThat(foundUser).isNotNull();
        assertThat(foundUser.getName()).isEqualTo(&quot;John Doe&quot;);
        assertThat(foundUser.getEmail()).isEqualTo(&quot;john.doe@example.com&quot;);
    }
}</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>MySQLContainer</strong>: Esta clase se usa para crear y gestionar un contenedor MySQL.</li>
<li><strong>@ExtendWith(SpringExtension.class)</strong>: Integra el Spring TestContext Framework con JUnit 5.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Probar bases de datos con JUnit es esencial para asegurar la fiabilidad de tu aplicación. Desde pruebas básicas usando bases de datos en memoria hasta técnicas más avanzadas como Testcontainers, puedes asegurarte de que tus interacciones con la base de datos están completamente probadas. Recuerda:</p>
<ul>
<li>Configurar tu entorno correctamente.</li>
<li>Escribir pruebas claras y concisas.</li>
<li>Usar herramientas y técnicas avanzadas según sea necesario.</li>
</ul>
<p>Siguiendo estas pautas, puedes crear pruebas robustas que ayudarán a mantener la integridad de tu aplicación a lo largo del tiempo.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
