<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Roles y Desarrollo Basado en Roles</title>

    <link rel="alternate" href="https://campusempresa.com/es/ansible/roles-and-role-based-development" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/ansible/roles-and-role-based-development" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/ansible/roles-and-role-based-development" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/ansible/roles-and-role-based-development" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción a los Roles en Ansible</h1>
<div class='content'><p>Los roles en Ansible son una forma de agrupar tareas, variables, archivos, plantillas y manejadores relacionados en unidades reutilizables. Ayudan a organizar los playbooks y hacerlos más mantenibles y escalables.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Estructura del Directorio de Roles</strong>: Un diseño estándar para organizar archivos dentro de un rol.</li>
<li><strong>Reusabilidad</strong>: Los roles pueden ser reutilizados en diferentes playbooks y proyectos.</li>
<li><strong>Modularidad</strong>: Descomponer playbooks complejos en roles más pequeños y manejables.</li>
</ul>
</div><h1>Creación y Uso de Roles</h1>
<h2>Estructura del Directorio de Roles</h2>
<div class='content'><p>Un rol de Ansible tiene una estructura de directorio específica. Aquí hay un ejemplo:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bWlfcm9sLwrilJzilIDilIAgZGVmYXVsdHMvCuKUgiAgIOKUlOKUgOKUgCBtYWluLnltbArilJzilIDilIAgZmlsZXMvCuKUnOKUgOKUgCBoYW5kbGVycy8K4pSCICAg4pSU4pSA4pSAIG1haW4ueW1sCuKUnOKUgOKUgCBtZXRhLwrilIIgICDilJTilIDilIAgbWFpbi55bWwK4pSc4pSA4pSAIHRhc2tzLwrilIIgICDilJTilIDilIAgbWFpbi55bWwK4pSc4pSA4pSAIHRlbXBsYXRlcy8K4pSc4pSA4pSAIHRlc3RzLwrilIIgICDilJzilIDilIAgaW52ZW50b3J5CuKUgiAgIOKUlOKUgOKUgCB0ZXN0LnltbArilJTilIDilIAgdmFycy8KICAgIOKUlOKUgOKUgCBtYWluLnltbA=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mi_rol/
├── defaults/
│   └── main.yml
├── files/
├── handlers/
│   └── main.yml
├── meta/
│   └── main.yml
├── tasks/
│   └── main.yml
├── templates/
├── tests/
│   ├── inventory
│   └── test.yml
└── vars/
    └── main.yml</pre></div><div class='content'><ul>
<li><strong>defaults/main.yml</strong>: Variables predeterminadas para el rol.</li>
<li><strong>files/</strong>: Archivos estáticos para ser usados en tareas.</li>
<li><strong>handlers/main.yml</strong>: Manejadores activados por tareas.</li>
<li><strong>meta/main.yml</strong>: Metadatos del rol, incluyendo dependencias.</li>
<li><strong>tasks/main.yml</strong>: Lista principal de tareas a ser ejecutadas por el rol.</li>
<li><strong>templates/</strong>: Plantillas Jinja2 para ser usadas en tareas.</li>
<li><strong>tests/</strong>: Playbooks de prueba e inventario para el rol.</li>
<li><strong>vars/main.yml</strong>: Variables específicas del rol.</li>
</ul>
</div><h2>Creación de un Rol Simple</h2>
<div class='content'><p>Vamos a crear un rol simple para instalar y configurar Nginx.</p>
<ol>
<li>
<p><strong>Crear la Estructura del Directorio del Rol</strong>:</p>
<pre><code class="language-bash">ansible-galaxy init nginx_role
</code></pre>
</li>
<li>
<p><strong>Definir Tareas en <code>tasks/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- name: Instalar Nginx
  apt:
    name: nginx
    state: present

- name: Iniciar el servicio de Nginx
  service:
    name: nginx
    state: started
    enabled: true
</code></pre>
</li>
<li>
<p><strong>Definir Manejadores en <code>handlers/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- name: Reiniciar Nginx
  service:
    name: nginx
    state: restarted
</code></pre>
</li>
<li>
<p><strong>Usar el Rol en un Playbook</strong>:</p>
<pre><code class="language-yaml">---
- hosts: servidores_web
  roles:
    - nginx_role
</code></pre>
</li>
</ol>
</div><h2>Uso de Variables en Roles</h2>
<div class='content'><p>Las variables pueden ser definidas en <code>defaults/main.yml</code> o <code>vars/main.yml</code>. Aquí hay un ejemplo de uso de variables en un rol:</p>
<ol>
<li>
<p><strong>Definir Variables en <code>defaults/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
nginx_port: 80
</code></pre>
</li>
<li>
<p><strong>Usar Variables en <code>tasks/main.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- name: Instalar Nginx
  apt:
    name: nginx
    state: present

- name: Configurar Nginx
  template:
    src: nginx.conf.j2
    dest: /etc/nginx/nginx.conf
  notify: Reiniciar Nginx

- name: Iniciar el servicio de Nginx
  service:
    name: nginx
    state: started
    enabled: true
</code></pre>
</li>
<li>
<p><strong>Crear una Plantilla en <code>templates/nginx.conf.j2</code></strong>:</p>
<pre><code class="language-nginx">server {
    listen {{ nginx_port }};
    server_name localhost;

    location / {
        root /var/www/html;
        index index.html index.htm;
    }
}
</code></pre>
</li>
</ol>
</div><h1>Características Avanzadas de Roles</h1>
<h2>Dependencias de Roles</h2>
<div class='content'><p>Los roles pueden depender de otros roles. Las dependencias se definen en <code>meta/main.yml</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCmRlcGVuZGVuY2llczoKICAtIHsgcm9sZTogY29tbW9uLCBzb21lX3ZhcjogNDIgfQogIC0geyByb2xlOiBhcGFjaGUsIGFwYWNoZV9wb3J0OiA4MDgwIH0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
dependencies:
  - { role: common, some_var: 42 }
  - { role: apache, apache_port: 8080 }</pre></div><div class='content'></div><h2>Pruebas de Roles</h2>
<div class='content'><p>Probar roles asegura que funcionen como se espera. Usa el directorio <code>tests/</code> para crear playbooks de prueba y archivos de inventario.</p>
<ol>
<li>
<p><strong>Crear un Playbook de Prueba en <code>tests/test.yml</code></strong>:</p>
<pre><code class="language-yaml">---
- hosts: localhost
  roles:
    - nginx_role
</code></pre>
</li>
<li>
<p><strong>Ejecutar el Playbook de Prueba</strong>:</p>
<pre><code class="language-bash">ansible-playbook tests/test.yml
</code></pre>
</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>Los roles en Ansible proporcionan una forma poderosa de organizar y reutilizar código, haciendo los playbooks más modulares y mantenibles. Al entender la estructura y el uso de roles, puedes crear scripts de automatización escalables y eficientes. Recuerda aprovechar las variables, manejadores y dependencias para maximizar la flexibilidad y funcionalidad de tus roles.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
