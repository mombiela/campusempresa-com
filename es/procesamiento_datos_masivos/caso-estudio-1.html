<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caso de Estudio 1: Análisis de Logs</title>

    <link rel="alternate" href="https://campusempresa.com/es/procesamiento_datos_masivos/caso-estudio-1" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/procesamiento_datos_masivos/caso-estudio-1" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/procesamiento_datos_masivos/caso-estudio-1" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/procesamiento_datos_masivos/caso-estudio-1" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='visualizacion-datos'>&#x25C4; Visualización de Datos</a></div><div class='col-6 text-end'><a href='caso-estudio-2'>Caso de Estudio 2: Recomendaciones en Tiempo Real &#x25BA;</a></div></div><div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En este caso de estudio, exploraremos cómo analizar grandes volúmenes de logs generados por sistemas informáticos. Los logs son registros detallados de eventos que ocurren en un sistema y son esenciales para el monitoreo, la depuración y la seguridad. Aprenderemos a procesar y extraer información valiosa de estos datos utilizando herramientas y técnicas de procesamiento de datos masivos.</p>
</div><h1>Objetivos</h1>
<div class='content'><ul>
<li>Comprender la importancia de los logs en el monitoreo y la depuración de sistemas.</li>
<li>Aprender a preprocesar y limpiar datos de logs.</li>
<li>Utilizar herramientas de procesamiento de datos masivos para analizar logs.</li>
<li>Extraer información valiosa y generar reportes a partir de los logs.</li>
</ul>
</div><h1>Herramientas y Tecnologías</h1>
<div class='content'><ul>
<li><strong>Apache Hadoop</strong>: Para el almacenamiento y procesamiento distribuido de grandes volúmenes de datos.</li>
<li><strong>Apache Spark</strong>: Para el procesamiento rápido y en memoria de datos masivos.</li>
<li><strong>Python</strong>: Para la manipulación y análisis de datos.</li>
<li><strong>Logstash</strong>: Para la ingesta y transformación de logs.</li>
<li><strong>Kibana</strong>: Para la visualización de datos de logs.</li>
</ul>
</div><h1>Dataset</h1>
<div class='content'><p>El dataset utilizado en este caso de estudio consiste en logs de acceso web generados por un servidor web Apache. Cada línea del log contiene información sobre una solicitud HTTP, incluyendo la dirección IP del cliente, la fecha y hora de la solicitud, el método HTTP, el recurso solicitado, el código de estado HTTP, y el tamaño de la respuesta.</p>
<p>Ejemplo de una línea de log:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("MTI3LjAuMC4xIC0gLSBbMTAvT2N0LzIwMjM6MTM6NTU6MzYgLTA3MDBdICJHRVQgL2luZGV4Lmh0bWwgSFRUUC8xLjEiIDIwMCAyMzI2"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>127.0.0.1 - - [10/Oct/2023:13:55:36 -0700] &quot;GET /index.html HTTP/1.1&quot; 200 2326</pre></div><div class='content'></div><h1>Preprocesamiento de Datos</h1>
<div class='content'><p>Antes de analizar los logs, es necesario preprocesar los datos para limpiarlos y estructurarlos adecuadamente.</p>
</div><h2>Pasos de Preprocesamiento</h2>
<div class='content'><ol>
<li><strong>Eliminar líneas corruptas</strong>: Filtrar líneas que no sigan el formato esperado.</li>
<li><strong>Parsear líneas de log</strong>: Extraer campos relevantes de cada línea.</li>
<li><strong>Convertir tipos de datos</strong>: Asegurarse de que cada campo tenga el tipo de dato correcto (por ejemplo, convertir fechas a objetos datetime).</li>
</ol>
<p>Ejemplo de código en Python para preprocesar logs:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHJlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpsb2dfcGF0dGVybiA9IHJlLmNvbXBpbGUoCiAgICByJyg/UDxpcD5cZCtcLlxkK1wuXGQrXC5cZCspIC0gLSBcWyg/UDxkYXRldGltZT5bXlxdXSspXF0gIig/UDxtZXRob2Q+XHcrKSAoP1A8cmVzb3VyY2U+W15cc10rKSBIVFRQL1xkXC5cZCIgKD9QPHN0YXR1cz5cZCspICg/UDxzaXplPlxkKyknCikKCmRlZiBwYXJzZV9sb2dfbGluZShsaW5lKToKICAgIG1hdGNoID0gbG9nX3BhdHRlcm4ubWF0Y2gobGluZSkKICAgIGlmIG1hdGNoOgogICAgICAgIGRhdGEgPSBtYXRjaC5ncm91cGRpY3QoKQogICAgICAgIGRhdGFbJ2RhdGV0aW1lJ10gPSBkYXRldGltZS5zdHJwdGltZShkYXRhWydkYXRldGltZSddLCAnJWQvJWIvJVk6JUg6JU06JVMgJXonKQogICAgICAgIGRhdGFbJ3N0YXR1cyddID0gaW50KGRhdGFbJ3N0YXR1cyddKQogICAgICAgIGRhdGFbJ3NpemUnXSA9IGludChkYXRhWydzaXplJ10pCiAgICAgICAgcmV0dXJuIGRhdGEKICAgIHJldHVybiBOb25lCgojIEVqZW1wbG8gZGUgdXNvCmxvZ19saW5lID0gJzEyNy4wLjAuMSAtIC0gWzEwL09jdC8yMDIzOjEzOjU1OjM2IC0wNzAwXSAiR0VUIC9pbmRleC5odG1sIEhUVFAvMS4xIiAyMDAgMjMyNicKcGFyc2VkX2xvZyA9IHBhcnNlX2xvZ19saW5lKGxvZ19saW5lKQpwcmludChwYXJzZWRfbG9nKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import re
from datetime import datetime

log_pattern = re.compile(
    r'(?P&lt;ip&gt;\d+\.\d+\.\d+\.\d+) - - \[(?P&lt;datetime&gt;[^\]]+)\] &quot;(?P&lt;method&gt;\w+) (?P&lt;resource&gt;[^\s]+) HTTP/\d\.\d&quot; (?P&lt;status&gt;\d+) (?P&lt;size&gt;\d+)'
)

def parse_log_line(line):
    match = log_pattern.match(line)
    if match:
        data = match.groupdict()
        data['datetime'] = datetime.strptime(data['datetime'], '%d/%b/%Y:%H:%M:%S %z')
        data['status'] = int(data['status'])
        data['size'] = int(data['size'])
        return data
    return None

# Ejemplo de uso
log_line = '127.0.0.1 - - [10/Oct/2023:13:55:36 -0700] &quot;GET /index.html HTTP/1.1&quot; 200 2326'
parsed_log = parse_log_line(log_line)
print(parsed_log)</pre></div><div class='content'></div><h1>Análisis de Logs</h1>
<div class='content'><p>Una vez preprocesados los datos, podemos proceder con el análisis. Utilizaremos Apache Spark para realizar análisis distribuidos y obtener insights de los logs.</p>
</div><h2>Ejemplos de Análisis</h2>
<div class='content'><ul>
<li><strong>Contar el número de solicitudes por IP</strong>: Identificar las IPs que realizan más solicitudes.</li>
<li><strong>Distribución de códigos de estado HTTP</strong>: Analizar la frecuencia de diferentes códigos de estado (200, 404, 500, etc.).</li>
<li><strong>Recursos más solicitados</strong>: Determinar cuáles son los recursos más accedidos en el servidor.</li>
</ul>
<p>Ejemplo de código en PySpark para contar solicitudes por IP:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCmZyb20gcHlzcGFyay5zcWwuZnVuY3Rpb25zIGltcG9ydCBjb2wKCiMgQ3JlYXIgdW5hIHNlc2nDs24gZGUgU3BhcmsKc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJMb2dBbmFseXNpcyIpLmdldE9yQ3JlYXRlKCkKCiMgQ2FyZ2FyIGxvcyBsb2dzIHByZXByb2Nlc2Fkb3MgZW4gdW4gRGF0YUZyYW1lCmxvZ3NfZGYgPSBzcGFyay5yZWFkLmpzb24oInBhdGgvdG8vcHJlcHJvY2Vzc2VkX2xvZ3MuanNvbiIpCgojIENvbnRhciBlbCBuw7ptZXJvIGRlIHNvbGljaXR1ZGVzIHBvciBJUAppcF9jb3VudHMgPSBsb2dzX2RmLmdyb3VwQnkoImlwIikuY291bnQoKS5vcmRlckJ5KGNvbCgiY291bnQiKS5kZXNjKCkpCgojIE1vc3RyYXIgbG9zIHJlc3VsdGFkb3MKaXBfY291bnRzLnNob3coKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession
from pyspark.sql.functions import col

# Crear una sesi&oacute;n de Spark
spark = SparkSession.builder.appName(&quot;LogAnalysis&quot;).getOrCreate()

# Cargar los logs preprocesados en un DataFrame
logs_df = spark.read.json(&quot;path/to/preprocessed_logs.json&quot;)

# Contar el n&uacute;mero de solicitudes por IP
ip_counts = logs_df.groupBy(&quot;ip&quot;).count().orderBy(col(&quot;count&quot;).desc())

# Mostrar los resultados
ip_counts.show()</pre></div><div class='content'></div><h1>Visualización de Datos</h1>
<div class='content'><p>Para visualizar los resultados del análisis, utilizaremos Kibana. Kibana permite crear dashboards interactivos que facilitan la interpretación de los datos.</p>
</div><h2>Ejemplos de Visualizaciones</h2>
<div class='content'><ul>
<li><strong>Gráfico de barras</strong>: Número de solicitudes por IP.</li>
<li><strong>Gráfico de pastel</strong>: Distribución de códigos de estado HTTP.</li>
<li><strong>Gráfico de líneas</strong>: Tendencia de solicitudes a lo largo del tiempo.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>En este caso de estudio, hemos aprendido a analizar logs de acceso web utilizando herramientas de procesamiento de datos masivos. Desde el preprocesamiento de datos hasta el análisis y la visualización, cada paso es crucial para extraer información valiosa de los logs. Estas habilidades son esenciales para cualquier profesional que trabaje con grandes volúmenes de datos y necesite monitorear y depurar sistemas de manera efectiva.</p>
</div><div class='row navigation'><div class='col-6'><a href='visualizacion-datos'>&#x25C4; Visualización de Datos</a></div><div class='col-6 text-end'><a href='caso-estudio-2'>Caso de Estudio 2: Recomendaciones en Tiempo Real &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
