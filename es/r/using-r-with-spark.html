<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usando R con Spark</title>

    <link rel="alternate" href="https://campusempresa.com/es/r/using-r-with-spark" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/r/using-r-with-spark" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/r/using-r-with-spark" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/r/using-r-with-spark" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción a la Integración de Spark y R</h1>
<div class='content'><p>Apache Spark es un sistema de computación distribuida de código abierto que proporciona una interfaz para programar clústeres completos con paralelismo de datos implícito y tolerancia a fallos. Integrar Spark con R permite a los científicos de datos aprovechar el poder de Spark para el procesamiento de grandes volúmenes de datos mientras usan el familiar lenguaje de programación R.</p>
<ul>
<li><strong>Apache Spark</strong>: Un potente motor de procesamiento de código abierto construido en torno a la velocidad, la facilidad de uso y análisis sofisticados.</li>
<li><strong>R</strong>: Un lenguaje y entorno para la computación estadística y gráficos.</li>
</ul>
</div><h1>Configuración de Spark con R</h1>
<div class='content'><p>Para usar Spark con R, necesitas instalar el paquete <code>sparklyr</code>, que proporciona una interfaz a Spark.</p>
</div><h2>Instalación de `sparklyr`</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW5zdGFsbC5wYWNrYWdlcygic3BhcmtseXIiKQpsaWJyYXJ5KHNwYXJrbHlyKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>install.packages(&quot;sparklyr&quot;)
library(sparklyr)</pre></div><div class='content'></div><h2>Conexión a Spark</h2>
<div class='content'><p>Puedes conectarte a una instancia local de Spark o a un clúster remoto de Spark.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb25lY3RhciBhIHVuYSBpbnN0YW5jaWEgbG9jYWwgZGUgU3BhcmsKc2MgPC0gc3BhcmtfY29ubmVjdChtYXN0ZXIgPSAibG9jYWwiKQoKIyBDb25lY3RhciBhIHVuIGNsw7pzdGVyIHJlbW90byBkZSBTcGFyawpzYyA8LSBzcGFya19jb25uZWN0KG1hc3RlciA9ICJzcGFyazovL0hPU1Q6UE9SVCIp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Conectar a una instancia local de Spark
sc &lt;- spark_connect(master = &quot;local&quot;)

# Conectar a un cl&uacute;ster remoto de Spark
sc &lt;- spark_connect(master = &quot;spark://HOST:PORT&quot;)</pre></div><div class='content'></div><h1>Manipulación de Datos con Spark y R</h1>
<div class='content'><p>Una vez conectado a Spark, puedes usar la sintaxis de <code>dplyr</code> para manipular datos.</p>
</div><h2>Cargar Datos en Spark</h2>
<div class='content'><p>Puedes cargar datos desde varias fuentes en Spark.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgdW4gYXJjaGl2byBDU1YgZW4gU3BhcmsKc3BhcmtfcmVhZF9jc3Yoc2MsIG5hbWUgPSAiaXJpc19zcGFyayIsIHBhdGggPSAicGF0aC90by9pcmlzLmNzdiIpCgojIENhcmdhciB1biBEYXRhRnJhbWUgZGUgUiBlbiBTcGFyawppcmlzX3RibCA8LSBjb3B5X3RvKHNjLCBpcmlzLCAiaXJpc19zcGFyayIsIG92ZXJ3cml0ZSA9IFRSVUUp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar un archivo CSV en Spark
spark_read_csv(sc, name = &quot;iris_spark&quot;, path = &quot;path/to/iris.csv&quot;)

# Cargar un DataFrame de R en Spark
iris_tbl &lt;- copy_to(sc, iris, &quot;iris_spark&quot;, overwrite = TRUE)</pre></div><div class='content'></div><h2>Manipulación de Datos con `dplyr`</h2>
<div class='content'><p>Puedes usar funciones familiares de <code>dplyr</code> para manipular DataFrames de Spark.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTZWxlY2Npb25hciBjb2x1bW5hcwppcmlzX3RibCAlPiUKICBzZWxlY3QoU2VwYWxfTGVuZ3RoLCBTcGVjaWVzKQoKIyBGaWx0cmFyIGZpbGFzCmlyaXNfdGJsICU+JQogIGZpbHRlcihTZXBhbF9MZW5ndGggPiA1LjApCgojIEFncnVwYXIgeSByZXN1bWlyCmlyaXNfdGJsICU+JQogIGdyb3VwX2J5KFNwZWNpZXMpICU+JQogIHN1bW1hcml6ZShtZWFuX3NlcGFsX2xlbmd0aCA9IG1lYW4oU2VwYWxfTGVuZ3RoKSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Seleccionar columnas
iris_tbl %&gt;%
  select(Sepal_Length, Species)

# Filtrar filas
iris_tbl %&gt;%
  filter(Sepal_Length &gt; 5.0)

# Agrupar y resumir
iris_tbl %&gt;%
  group_by(Species) %&gt;%
  summarize(mean_sepal_length = mean(Sepal_Length))</pre></div><div class='content'></div><h1>Aprendizaje Automático con Spark y R</h1>
<div class='content'><p>El paquete <code>sparklyr</code> proporciona una interfaz de alto nivel para el aprendizaje automático con Spark.</p>
</div><h2>Construcción de un Modelo de Aprendizaje Automático</h2>
<div class='content'><p>Puedes usar Spark MLlib para construir modelos de aprendizaje automático.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQYXJ0aWNpb25hciBsb3MgZGF0b3MgZW4gY29uanVudG9zIGRlIGVudHJlbmFtaWVudG8geSBwcnVlYmEKcGFydGl0aW9ucyA8LSBpcmlzX3RibCAlPiUKICBzZGZfcGFydGl0aW9uKHRyYWluaW5nID0gMC43LCB0ZXN0ID0gMC4zLCBzZWVkID0gMTIzKQoKIyBBanVzdGFyIHVuIG1vZGVsbyBkZSByZWdyZXNpw7NuIGxvZ8Otc3RpY2EKbWxfbW9kZWwgPC0gcGFydGl0aW9ucyR0cmFpbmluZyAlPiUKICBtbF9sb2dpc3RpY19yZWdyZXNzaW9uKFNwZWNpZXMgfiBTZXBhbF9MZW5ndGggKyBTZXBhbF9XaWR0aCArIFBldGFsX0xlbmd0aCArIFBldGFsX1dpZHRoKQoKIyBJbXByaW1pciBlbCByZXN1bWVuIGRlbCBtb2RlbG8Kc3VtbWFyeShtbF9tb2RlbCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Particionar los datos en conjuntos de entrenamiento y prueba
partitions &lt;- iris_tbl %&gt;%
  sdf_partition(training = 0.7, test = 0.3, seed = 123)

# Ajustar un modelo de regresi&oacute;n log&iacute;stica
ml_model &lt;- partitions$training %&gt;%
  ml_logistic_regression(Species ~ Sepal_Length + Sepal_Width + Petal_Length + Petal_Width)

# Imprimir el resumen del modelo
summary(ml_model)</pre></div><div class='content'></div><h2>Realización de Predicciones</h2>
<div class='content'><p>Puedes usar el modelo entrenado para hacer predicciones sobre nuevos datos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBIYWNlciBwcmVkaWNjaW9uZXMgZW4gZWwgY29uanVudG8gZGUgcHJ1ZWJhCnByZWRpY3Rpb25zIDwtIG1sX21vZGVsICU+JQogIG1sX3ByZWRpY3QocGFydGl0aW9ucyR0ZXN0KQoKIyBNb3N0cmFyIGxhcyBwcmVkaWNjaW9uZXMKcHJlZGljdGlvbnMgJT4lCiAgc2VsZWN0KFNwZWNpZXMsIHByZWRpY3Rpb24p"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Hacer predicciones en el conjunto de prueba
predictions &lt;- ml_model %&gt;%
  ml_predict(partitions$test)

# Mostrar las predicciones
predictions %&gt;%
  select(Species, prediction)</pre></div><div class='content'></div><h1>Temas Avanzados</h1>
<div class='content'><p>Para usuarios avanzados, <code>sparklyr</code> proporciona funcionalidades adicionales como transformaciones personalizadas e integración con otras bibliotecas de Spark.</p>
</div><h2>Transformaciones Personalizadas</h2>
<div class='content'><p>Puedes definir funciones personalizadas en R y aplicarlas a DataFrames de Spark.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmlyIHVuYSBmdW5jacOzbiBwZXJzb25hbGl6YWRhIGVuIFIKY3VzdG9tX2Z1bmN0aW9uIDwtIGZ1bmN0aW9uKGRmKSB7CiAgZGYgJT4lCiAgICBtdXRhdGUoU2VwYWxfUmF0aW8gPSBTZXBhbF9MZW5ndGggLyBTZXBhbF9XaWR0aCkKfQoKIyBBcGxpY2FyIGxhIGZ1bmNpw7NuIHBlcnNvbmFsaXphZGEgYSB1biBEYXRhRnJhbWUgZGUgU3BhcmsKaXJpc19jdXN0b20gPC0gaXJpc190YmwgJT4lCiAgc2RmX3dpdGhfc2VwYXJhdGUoY3VzdG9tX2Z1bmN0aW9uKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Definir una funci&oacute;n personalizada en R
custom_function &lt;- function(df) {
  df %&gt;%
    mutate(Sepal_Ratio = Sepal_Length / Sepal_Width)
}

# Aplicar la funci&oacute;n personalizada a un DataFrame de Spark
iris_custom &lt;- iris_tbl %&gt;%
  sdf_with_separate(custom_function)</pre></div><div class='content'></div><h2>Integración con Otras Bibliotecas de Spark</h2>
<div class='content'><p>Puedes integrar <code>sparklyr</code> con otras bibliotecas de Spark como GraphFrames y SparkR.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFamVtcGxvIGRlIHVzbyBkZSBHcmFwaEZyYW1lcwpsaWJyYXJ5KGdyYXBoZnJhbWVzKQpnIDwtIGdmX2dyYXBoZnJhbWUodmVydGljZXMsIGVkZ2VzKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Ejemplo de uso de GraphFrames
library(graphframes)
g &lt;- gf_graphframe(vertices, edges)</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Integrar R con Spark usando el paquete <code>sparklyr</code> permite a los científicos de datos aprovechar el poder de Spark para el procesamiento de grandes volúmenes de datos mientras usan el familiar lenguaje de programación R. Esta integración proporciona una experiencia fluida para la manipulación de datos, el aprendizaje automático y las tareas avanzadas de procesamiento de datos. Siguiendo los pasos descritos en este tema, puedes configurar Spark con R, realizar manipulación de datos, construir modelos de aprendizaje automático y explorar funcionalidades avanzadas.</p>
<p>Recuerda practicar los ejemplos proporcionados y explorar la documentación de <code>sparklyr</code> para casos de uso y funcionalidades más avanzadas.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
