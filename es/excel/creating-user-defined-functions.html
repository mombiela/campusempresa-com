<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creación de Funciones Definidas por el Usuario</title>

    <link rel="alternate" href="https://campusempresa.com/es/excel/creating-user-defined-functions" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/excel/creating-user-defined-functions" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/excel/creating-user-defined-functions" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/excel/creating-user-defined-functions" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='editing-macros-with-vba'>&#x25C4;Editar Macros con VBA</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creación de Funciones Definidas por el Usuario</a>
	</div>
	<div class='col-4 text-end'>
					<a href='sharing-workbooks'>Compartir Libros de Trabajo &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En Excel, las funciones definidas por el usuario (UDFs) te permiten crear funciones personalizadas usando VBA (Visual Basic para Aplicaciones). Estas funciones pueden ser usadas en fórmulas al igual que las funciones integradas de Excel. Este tema te guiará a través del proceso de creación y uso de UDFs, desde niveles principiantes hasta avanzados.</p>
</div><h1>Empezando con VBA</h1>
<div class='content'><p>Antes de crear UDFs, necesitas entender los conceptos básicos de VBA. VBA es el lenguaje de programación usado en Excel para automatizar tareas y crear funciones personalizadas.</p>
</div><h2>Habilitando la Pestaña de Desarrollador</h2>
<div class='content'><p>Para escribir código VBA, necesitas habilitar la pestaña de Desarrollador en Excel:</p>
<ol>
<li>Ve a <code>Archivo</code> &gt; <code>Opciones</code>.</li>
<li>Selecciona <code>Personalizar cinta de opciones</code>.</li>
<li>Marca la opción <code>Desarrollador</code> en el panel derecho.</li>
<li>Haz clic en <code>Aceptar</code>.</li>
</ol>
</div><h2>Abriendo el Editor de VBA</h2>
<div class='content'><ol>
<li>Haz clic en la pestaña <code>Desarrollador</code>.</li>
<li>Selecciona <code>Visual Basic</code> para abrir el editor de VBA.</li>
</ol>
</div><h1>Creando Tu Primera Función Definida por el Usuario</h1>
<div class='content'><p>Vamos a empezar con un ejemplo simple de una UDF que suma dos números.</p>
</div><h2>Ejemplo: Sumar Dos Números</h2>
<div class='content'><ol>
<li>Abre el editor de VBA.</li>
<li>Inserta un nuevo módulo: <code>Insertar</code> &gt; <code>Módulo</code>.</li>
<li>Escribe el siguiente código en el módulo:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQWRkVHdvTnVtYmVycyhhIEFzIERvdWJsZSwgYiBBcyBEb3VibGUpIEFzIERvdWJsZQogICAgQWRkVHdvTnVtYmVycyA9IGEgKyBiCkVuZCBGdW5jdGlvbg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function AddTwoNumbers(a As Double, b As Double) As Double
    AddTwoNumbers = a + b
End Function</pre></div><div class='content'><ol start="4">
<li>Guarda tu trabajo y cierra el editor de VBA.</li>
</ol>
</div><h2>Usando la UDF en Excel</h2>
<div class='content'><ol>
<li>Regresa a tu hoja de cálculo de Excel.</li>
<li>En cualquier celda, escribe <code>=AddTwoNumbers(3, 5)</code> y presiona <code>Enter</code>.</li>
<li>La celda debería mostrar <code>8</code>.</li>
</ol>
</div><h1>UDFs Intermedias</h1>
<div class='content'><p>Ahora que sabes cómo crear una UDF básica, exploremos funciones más complejas.</p>
</div><h2>Ejemplo: Calcular el Área de un Círculo</h2>
<div class='content'><ol>
<li>Abre el editor de VBA e inserta un nuevo módulo si es necesario.</li>
<li>Escribe el siguiente código:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQ2lyY2xlQXJlYShyYWRpdXMgQXMgRG91YmxlKSBBcyBEb3VibGUKICAgIENpcmNsZUFyZWEgPSBXb3Jrc2hlZXRGdW5jdGlvbi5QaSgpICogcmFkaXVzICogcmFkaXVzCkVuZCBGdW5jdGlvbg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function CircleArea(radius As Double) As Double
    CircleArea = WorksheetFunction.Pi() * radius * radius
End Function</pre></div><div class='content'><ol start="3">
<li>Guarda y cierra el editor de VBA.</li>
</ol>
</div><h2>Usando la UDF en Excel</h2>
<div class='content'><ol>
<li>En cualquier celda, escribe <code>=CircleArea(5)</code> y presiona <code>Enter</code>.</li>
<li>La celda debería mostrar <code>78.53981634</code>.</li>
</ol>
</div><h1>UDFs Avanzadas</h1>
<div class='content'><p>Las UDFs avanzadas pueden incluir manejo de errores y lógica más compleja.</p>
</div><h2>Ejemplo: Calcular la Secuencia de Fibonacci</h2>
<div class='content'><ol>
<li>Abre el editor de VBA e inserta un nuevo módulo si es necesario.</li>
<li>Escribe el siguiente código:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gRmlib25hY2NpKG4gQXMgSW50ZWdlcikgQXMgVmFyaWFudAogICAgSWYgbiA8IDEgVGhlbgogICAgICAgIEZpYm9uYWNjaSA9ICJJbnZhbGlkIElucHV0IgogICAgRWxzZUlmIG4gPSAxIE9yIG4gPSAyIFRoZW4KICAgICAgICBGaWJvbmFjY2kgPSAxCiAgICBFbHNlCiAgICAgICAgRmlib25hY2NpID0gRmlib25hY2NpKG4gLSAxKSArIEZpYm9uYWNjaShuIC0gMikKICAgIEVuZCBJZgpFbmQgRnVuY3Rpb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function Fibonacci(n As Integer) As Variant
    If n &lt; 1 Then
        Fibonacci = &quot;Invalid Input&quot;
    ElseIf n = 1 Or n = 2 Then
        Fibonacci = 1
    Else
        Fibonacci = Fibonacci(n - 1) + Fibonacci(n - 2)
    End If
End Function</pre></div><div class='content'><ol start="3">
<li>Guarda y cierra el editor de VBA.</li>
</ol>
</div><h2>Usando la UDF en Excel</h2>
<div class='content'><ol>
<li>En cualquier celda, escribe <code>=Fibonacci(10)</code> y presiona <code>Enter</code>.</li>
<li>La celda debería mostrar <code>55</code>.</li>
</ol>
</div><h1>Mejores Prácticas para UDFs</h1>
<div class='content'><ul>
<li><strong>Manejo de Errores</strong>: Siempre incluye manejo de errores para gestionar entradas inesperadas.</li>
<li><strong>Comentarios</strong>: Añade comentarios a tu código para explicar la lógica.</li>
<li><strong>Optimización</strong>: Optimiza tu código para el rendimiento, especialmente para cálculos complejos.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Crear funciones definidas por el usuario en Excel usando VBA puede aumentar enormemente tu productividad y permitirte realizar cálculos personalizados que no son posibles con las funciones integradas. Siguiendo los pasos descritos en este tema, puedes crear UDFs desde simples hasta avanzadas adaptadas a tus necesidades específicas. Practica escribiendo diferentes tipos de UDFs para volverte competente en VBA y automatización en Excel.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='editing-macros-with-vba'>&#x25C4;Editar Macros con VBA</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Creación de Funciones Definidas por el Usuario</a>
	</div>
	<div class='col-4 text-end'>
					<a href='sharing-workbooks'>Compartir Libros de Trabajo &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
