<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestión de Desplazamientos en Apache Kafka</title>

    <link rel="alternate" href="https://campusempresa.com/es/kafka/offset-management" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/kafka/offset-management" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/kafka/offset-management" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/kafka/offset-management" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Proyecto</a>
				<a href="about">Sobre nosotros</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donaciones</a>
				<a href="licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>La gestión de desplazamientos es un concepto crucial en Apache Kafka, ya que determina cómo los consumidores llevan un registro de los mensajes que han leído de un tema. Este tema te guiará desde los aspectos básicos hasta los avanzados de la gestión de desplazamientos en Kafka.</p>
</div><h1>Introducción a los Desplazamientos</h1>
<div class='content'><p>Los desplazamientos son identificadores únicos asignados a cada mensaje dentro de una partición de Kafka. Ayudan a los consumidores a saber qué mensajes han sido leídos y cuáles aún están por procesar.</p>
<ul>
<li><strong>Desplazamiento</strong>: Un número de identificación secuencial asignado a cada mensaje dentro de una partición.</li>
<li><strong>Partición</strong>: Una división de un tema que permite a Kafka escalar horizontalmente y gestionar la carga.</li>
</ul>
</div><h2>Ejemplo</h2>
<div class='content'><p>Considera un tema <code>orders</code> con dos particiones:</p>
<p>| Partición | Mensaje | Desplazamiento |
|-----------|---------|----------------|
| 0         | Order1  | 0              |
| 0         | Order2  | 1              |
| 1         | Order3  | 0              |
| 1         | Order4  | 1              |</p>
</div><h1>Cómo Funcionan los Desplazamientos</h1>
<div class='content'><p>Cuando un consumidor lee mensajes de una partición, lleva un registro del desplazamiento del último mensaje que ha procesado. Esto permite al consumidor reanudar la lectura desde la posición correcta en caso de una falla o reinicio.</p>
<ul>
<li><strong>Grupo de Consumidores</strong>: Un grupo de consumidores que trabajan juntos para consumir mensajes de un tema.</li>
<li><strong>Desplazamiento Comprometido</strong>: El último desplazamiento que ha sido reconocido por el consumidor como procesado.</li>
</ul>
</div><h2>Ejemplo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gUHNldWRvLWPDs2RpZ28gcGFyYSB1biBjb25zdW1pZG9yIGRlIEthZmthIHF1ZSBsZWUgbWVuc2FqZXMgeSBjb21wcm9tZXRlIGRlc3BsYXphbWllbnRvcwp3aGlsZSAodHJ1ZSkgewogICAgQ29uc3VtZXJSZWNvcmRzPFN0cmluZywgU3RyaW5nPiByZWNvcmRzID0gY29uc3VtZXIucG9sbChEdXJhdGlvbi5vZk1pbGxpcygxMDApKTsKICAgIGZvciAoQ29uc3VtZXJSZWNvcmQ8U3RyaW5nLCBTdHJpbmc+IHJlY29yZCA6IHJlY29yZHMpIHsKICAgICAgICBwcm9jZXNzKHJlY29yZCk7CiAgICAgICAgY29uc3VtZXIuY29tbWl0U3luYyhDb2xsZWN0aW9ucy5zaW5nbGV0b25NYXAobmV3IFRvcGljUGFydGl0aW9uKHJlY29yZC50b3BpYygpLCByZWNvcmQucGFydGl0aW9uKCkpLCBuZXcgT2Zmc2V0QW5kTWV0YWRhdGEocmVjb3JkLm9mZnNldCgpICsgMSkpKTsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Pseudo-c&oacute;digo para un consumidor de Kafka que lee mensajes y compromete desplazamientos
while (true) {
    ConsumerRecords&lt;String, String&gt; records = consumer.poll(Duration.ofMillis(100));
    for (ConsumerRecord&lt;String, String&gt; record : records) {
        process(record);
        consumer.commitSync(Collections.singletonMap(new TopicPartition(record.topic(), record.partition()), new OffsetAndMetadata(record.offset() + 1)));
    }
}</pre></div><div class='content'><p>En este ejemplo, el consumidor lee mensajes, los procesa y luego compromete el desplazamiento del siguiente mensaje a leer.</p>
</div><h1>Estrategias de Gestión de Desplazamientos</h1>
<div class='content'><p>Existen diferentes estrategias para gestionar los desplazamientos en Kafka:</p>
<ul>
<li><strong>Compromiso Automático de Desplazamientos</strong>: Kafka compromete automáticamente los desplazamientos a intervalos regulares.</li>
<li><strong>Compromiso Manual de Desplazamientos</strong>: El consumidor compromete manualmente los desplazamientos después de procesar los mensajes.</li>
</ul>
</div><h2>Compromiso Automático de Desplazamientos</h2>
<div class='content'><p>Este es el enfoque más simple donde Kafka maneja el compromiso de desplazamientos. Sin embargo, puede llevar a la pérdida o duplicación de mensajes en caso de fallas del consumidor.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CnByb3BzLnB1dCgiZW5hYmxlLmF1dG8uY29tbWl0IiwgInRydWUiKTsKcHJvcHMucHV0KCJhdXRvLmNvbW1pdC5pbnRlcnZhbC5tcyIsICIxMDAwIik7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Properties props = new Properties();
props.put(&quot;enable.auto.commit&quot;, &quot;true&quot;);
props.put(&quot;auto.commit.interval.ms&quot;, &quot;1000&quot;);</pre></div><div class='content'></div><h2>Compromiso Manual de Desplazamientos</h2>
<div class='content'><p>Este enfoque da más control al consumidor, permitiéndole comprometer los desplazamientos solo después de procesar exitosamente los mensajes.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CnByb3BzLnB1dCgiZW5hYmxlLmF1dG8uY29tbWl0IiwgImZhbHNlIik7CgovLyBDb21wcm9tZXRlciBkZXNwbGF6YW1pZW50b3MgbWFudWFsbWVudGUKY29uc3VtZXIuY29tbWl0U3luYygpOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Properties props = new Properties();
props.put(&quot;enable.auto.commit&quot;, &quot;false&quot;);

// Comprometer desplazamientos manualmente
consumer.commitSync();</pre></div><div class='content'></div><h1>Gestión Avanzada de Desplazamientos</h1>
<div class='content'><p>La gestión avanzada de desplazamientos implica manejar escenarios como el reequilibrio, la retención de desplazamientos y las políticas de reinicio de desplazamientos.</p>
<ul>
<li><strong>Reequilibrio</strong>: Cuando un consumidor se une o deja un grupo, Kafka reasigna las particiones entre los consumidores.</li>
<li><strong>Retención de Desplazamientos</strong>: Kafka retiene los desplazamientos comprometidos durante un período configurable.</li>
<li><strong>Políticas de Reinicio de Desplazamientos</strong>: Políticas para manejar casos donde el desplazamiento del consumidor es inválido (por ejemplo, <code>earliest</code>, <code>latest</code>).</li>
</ul>
</div><h2>Ejemplo de Reequilibrio</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3VtZXIuc3Vic2NyaWJlKEFycmF5cy5hc0xpc3QoIm9yZGVycyIpLCBuZXcgQ29uc3VtZXJSZWJhbGFuY2VMaXN0ZW5lcigpIHsKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgb25QYXJ0aXRpb25zUmV2b2tlZChDb2xsZWN0aW9uPFRvcGljUGFydGl0aW9uPiBwYXJ0aXRpb25zKSB7CiAgICAgICAgLy8gQ29tcHJvbWV0ZXIgZGVzcGxhemFtaWVudG9zIGFudGVzIGRlbCByZWVxdWlsaWJyaW8KICAgICAgICBjb25zdW1lci5jb21taXRTeW5jKCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBvblBhcnRpdGlvbnNBc3NpZ25lZChDb2xsZWN0aW9uPFRvcGljUGFydGl0aW9uPiBwYXJ0aXRpb25zKSB7CiAgICAgICAgLy8gTWFuZWphciBsYSBhc2lnbmFjacOzbiBkZSBwYXJ0aWNpb25lcwogICAgfQp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>consumer.subscribe(Arrays.asList(&quot;orders&quot;), new ConsumerRebalanceListener() {
    @Override
    public void onPartitionsRevoked(Collection&lt;TopicPartition&gt; partitions) {
        // Comprometer desplazamientos antes del reequilibrio
        consumer.commitSync();
    }

    @Override
    public void onPartitionsAssigned(Collection&lt;TopicPartition&gt; partitions) {
        // Manejar la asignaci&oacute;n de particiones
    }
});</pre></div><div class='content'></div><h2>Política de Reinicio de Desplazamientos</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJvcGVydGllcyBwcm9wcyA9IG5ldyBQcm9wZXJ0aWVzKCk7CnByb3BzLnB1dCgiYXV0by5vZmZzZXQucmVzZXQiLCAiZWFybGllc3QiKTsgLy8gT3BjaW9uZXM6IGVhcmxpZXN0LCBsYXRlc3QsIG5vbmU="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Properties props = new Properties();
props.put(&quot;auto.offset.reset&quot;, &quot;earliest&quot;); // Opciones: earliest, latest, none</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>La gestión de desplazamientos es un aspecto fundamental al trabajar con Apache Kafka. Entender cómo gestionar los desplazamientos de manera efectiva asegura un procesamiento confiable de mensajes y tolerancia a fallos. Ya sea que uses el compromiso automático o manual de desplazamientos, o manejes escenarios avanzados como el reequilibrio, dominar la gestión de desplazamientos es clave para construir aplicaciones robustas en Kafka.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
