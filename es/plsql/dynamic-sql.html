<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Dinámico en PL/SQL</title>

    <link rel="alternate" href="https://campusempresa.com/es/plsql/dynamic-sql" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/plsql/dynamic-sql" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/plsql/dynamic-sql" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/plsql/dynamic-sql" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='triggers'>&#x25C4; Triggers</a></div><div class='col-6 text-end'><a href='plsql-optimization-techniques'>Técnicas de Optimización de PL/SQL &#x25BA;</a></div></div><div class='content'><p>El SQL dinámico es una característica poderosa en PL/SQL que te permite construir y ejecutar sentencias SQL dinámicamente en tiempo de ejecución. Esto es particularmente útil cuando la sentencia SQL exacta no se conoce hasta el tiempo de ejecución, como cuando se construyen consultas complejas basadas en la entrada del usuario u otras condiciones de tiempo de ejecución.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>SQL Estático vs. SQL Dinámico</strong>: Las sentencias SQL estáticas están codificadas en el bloque PL/SQL y se conocen en tiempo de compilación, mientras que las sentencias SQL dinámicas se construyen y ejecutan en tiempo de ejecución.</li>
<li><strong>EXECUTE IMMEDIATE</strong>: Un comando PL/SQL utilizado para ejecutar una sola sentencia SQL o un bloque PL/SQL dinámicamente.</li>
<li><strong>Paquete DBMS_SQL</strong>: Un paquete PL/SQL que proporciona una forma más flexible de ejecutar SQL dinámico, especialmente útil para ejecutar múltiples sentencias SQL o manejar consultas complejas.</li>
</ul>
</div><h1>SQL Estático vs. SQL Dinámico</h1>
<div class='content'><p>| Característica    | SQL Estático                          | SQL Dinámico                          |
|-------------------|---------------------------------------|---------------------------------------|
| Compilación       | Conocido en tiempo de compilación     | Construido y ejecutado en tiempo de ejecución |
| Rendimiento       | Generalmente más rápido debido a la precompilación | Puede ser más lento debido al análisis en tiempo de ejecución |
| Flexibilidad      | Menos flexible, estructura fija       | Altamente flexible, puede cambiar en tiempo de ejecución |</p>
</div><h1>Uso de EXECUTE IMMEDIATE</h1>
<div class='content'><p><code>EXECUTE IMMEDIATE</code> es la forma más simple de ejecutar SQL dinámico en PL/SQL. Te permite ejecutar una sola sentencia SQL o un bloque PL/SQL.</p>
</div><h2>Ejemplo: Ejecutando una Sentencia SQL Simple</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgc3FsX3N0bXQgVkFSQ0hBUjIoMTAwKTsKQkVHSU4KICAgIHNxbF9zdG10IDo9ICdVUERBVEUgZW1wbG95ZWVzIFNFVCBzYWxhcnkgPSBzYWxhcnkgKiAxLjEgV0hFUkUgZGVwYXJ0bWVudF9pZCA9IDEwJzsKICAgIEVYRUNVVEUgSU1NRURJQVRFIHNxbF9zdG10OwogICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ1NhbGFyaW9zIGFjdHVhbGl6YWRvcyBleGl0b3NhbWVudGUuJyk7CkVORDsKLw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    sql_stmt VARCHAR2(100);
BEGIN
    sql_stmt := 'UPDATE employees SET salary = salary * 1.1 WHERE department_id = 10';
    EXECUTE IMMEDIATE sql_stmt;
    DBMS_OUTPUT.PUT_LINE('Salarios actualizados exitosamente.');
END;
/</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>sql_stmt</strong>: Una variable para almacenar la sentencia SQL dinámica.</li>
<li><strong>EXECUTE IMMEDIATE</strong>: Ejecuta la sentencia SQL almacenada en <code>sql_stmt</code>.</li>
<li><strong>DBMS_OUTPUT.PUT_LINE</strong>: Muestra un mensaje indicando que la operación fue exitosa.</li>
</ul>
</div><h2>Ejemplo: Usando Variables de Vinculación</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgc3FsX3N0bXQgVkFSQ0hBUjIoMTAwKTsKICAgIGRlcHRfaWQgTlVNQkVSIDo9IDEwOwogICAgaW5jcmVtZW50IE5VTUJFUiA6PSAxLjE7CkJFR0lOCiAgICBzcWxfc3RtdCA6PSAnVVBEQVRFIGVtcGxveWVlcyBTRVQgc2FsYXJ5ID0gc2FsYXJ5ICogOmluY3JlbWVudCBXSEVSRSBkZXBhcnRtZW50X2lkID0gOmRlcHRfaWQnOwogICAgRVhFQ1VURSBJTU1FRElBVEUgc3FsX3N0bXQgVVNJTkcgaW5jcmVtZW50LCBkZXB0X2lkOwogICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ1NhbGFyaW9zIGFjdHVhbGl6YWRvcyBleGl0b3NhbWVudGUuJyk7CkVORDsKLw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    sql_stmt VARCHAR2(100);
    dept_id NUMBER := 10;
    increment NUMBER := 1.1;
BEGIN
    sql_stmt := 'UPDATE employees SET salary = salary * :increment WHERE department_id = :dept_id';
    EXECUTE IMMEDIATE sql_stmt USING increment, dept_id;
    DBMS_OUTPUT.PUT_LINE('Salarios actualizados exitosamente.');
END;
/</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>Variables de Vinculación</strong>: <code>:increment</code> y <code>:dept_id</code> son marcadores de posición en la sentencia SQL.</li>
<li><strong>Cláusula USING</strong>: Proporciona valores para las variables de vinculación en tiempo de ejecución.</li>
</ul>
</div><h1>Uso del Paquete DBMS_SQL</h1>
<div class='content'><p>El paquete <code>DBMS_SQL</code> ofrece más control y flexibilidad para ejecutar SQL dinámico, especialmente para escenarios complejos.</p>
</div><h2>Ejemplo: Ejecutando una Consulta con DBMS_SQL</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgY3Vyc29yX2lkIElOVEVHRVI7CiAgICBzcWxfc3RtdCBWQVJDSEFSMigyMDApOwogICAgZW1wX25hbWUgVkFSQ0hBUjIoNTApOwpCRUdJTgogICAgc3FsX3N0bXQgOj0gJ1NFTEVDVCBmaXJzdF9uYW1lIEZST00gZW1wbG95ZWVzIFdIRVJFIGVtcGxveWVlX2lkID0gOmVtcF9pZCc7CiAgICBjdXJzb3JfaWQgOj0gREJNU19TUUwuT1BFTl9DVVJTT1I7CiAgICBEQk1TX1NRTC5QQVJTRShjdXJzb3JfaWQsIHNxbF9zdG10LCBEQk1TX1NRTC5OQVRJVkUpOwogICAgREJNU19TUUwuQklORF9WQVJJQUJMRShjdXJzb3JfaWQsICc6ZW1wX2lkJywgMTAwKTsKICAgIERCTVNfU1FMLkRFRklORV9DT0xVTU4oY3Vyc29yX2lkLCAxLCBlbXBfbmFtZSk7CiAgICAKICAgIElGIERCTVNfU1FMLkVYRUNVVEVfQU5EX0ZFVENIKGN1cnNvcl9pZCkgPiAwIFRIRU4KICAgICAgICBEQk1TX1NRTC5DT0xVTU5fVkFMVUUoY3Vyc29yX2lkLCAxLCBlbXBfbmFtZSk7CiAgICAgICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ05vbWJyZSBkZWwgRW1wbGVhZG86ICcgfHwgZW1wX25hbWUpOwogICAgRU5EIElGOwogICAgCiAgICBEQk1TX1NRTC5DTE9TRV9DVVJTT1IoY3Vyc29yX2lkKTsKRU5EOwov"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    cursor_id INTEGER;
    sql_stmt VARCHAR2(200);
    emp_name VARCHAR2(50);
BEGIN
    sql_stmt := 'SELECT first_name FROM employees WHERE employee_id = :emp_id';
    cursor_id := DBMS_SQL.OPEN_CURSOR;
    DBMS_SQL.PARSE(cursor_id, sql_stmt, DBMS_SQL.NATIVE);
    DBMS_SQL.BIND_VARIABLE(cursor_id, ':emp_id', 100);
    DBMS_SQL.DEFINE_COLUMN(cursor_id, 1, emp_name);
    
    IF DBMS_SQL.EXECUTE_AND_FETCH(cursor_id) &gt; 0 THEN
        DBMS_SQL.COLUMN_VALUE(cursor_id, 1, emp_name);
        DBMS_OUTPUT.PUT_LINE('Nombre del Empleado: ' || emp_name);
    END IF;
    
    DBMS_SQL.CLOSE_CURSOR(cursor_id);
END;
/</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>OPEN_CURSOR</strong>: Abre un nuevo cursor para la sentencia SQL dinámica.</li>
<li><strong>PARSE</strong>: Analiza la sentencia SQL.</li>
<li><strong>BIND_VARIABLE</strong>: Vincula un valor a la variable de vinculación <code>:emp_id</code>.</li>
<li><strong>DEFINE_COLUMN</strong>: Define la variable de salida para el conjunto de resultados.</li>
<li><strong>EXECUTE_AND_FETCH</strong>: Ejecuta la sentencia SQL y obtiene el resultado.</li>
<li><strong>COLUMN_VALUE</strong>: Recupera el valor de la columna especificada.</li>
<li><strong>CLOSE_CURSOR</strong>: Cierra el cursor.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El SQL dinámico en PL/SQL proporciona la flexibilidad para construir y ejecutar sentencias SQL en tiempo de ejecución, convirtiéndolo en una herramienta poderosa para manejar consultas complejas y variables. El comando <code>EXECUTE IMMEDIATE</code> es adecuado para ejecuciones más simples de una sola sentencia, mientras que el paquete <code>DBMS_SQL</code> ofrece capacidades más avanzadas para manejar múltiples sentencias y escenarios complejos. Entender cuándo y cómo usar estas herramientas de manera efectiva puede mejorar en gran medida la versatilidad y funcionalidad de tus programas PL/SQL.</p>
</div><div class='row navigation'><div class='col-6'><a href='triggers'>&#x25C4; Triggers</a></div><div class='col-6 text-end'><a href='plsql-optimization-techniques'>Técnicas de Optimización de PL/SQL &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
