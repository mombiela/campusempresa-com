<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disparadores en PL/SQL</title>

    <link rel="alternate" href="https://campusempresa.com/es/plsql/triggers" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/plsql/triggers" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/plsql/triggers" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/plsql/triggers" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='packages'>&#x25C4; Paquetes</a></div><div class='col-6 text-end'><a href='dynamic-sql'>SQL Dinámico &#x25BA;</a></div></div><div class='content'></div><h1>Introducción a los Disparadores</h1>
<div class='content'><p>Los disparadores son un tipo especial de procedimiento almacenado que se ejecuta o dispara automáticamente cuando ocurren ciertos eventos. Se utilizan para hacer cumplir reglas de negocio, mantener registros de auditoría y sincronizar tablas.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Evento del Disparador</strong>: El evento específico que causa que el disparador se dispare (por ejemplo, INSERT, UPDATE, DELETE).</li>
<li><strong>Tiempo del Disparador</strong>: Especifica cuándo debe dispararse el disparador (por ejemplo, BEFORE, AFTER).</li>
<li><strong>Tipo de Disparador</strong>: Define el alcance del disparador (por ejemplo, a nivel de fila, a nivel de declaración).</li>
<li><strong>Cuerpo del Disparador</strong>: El código PL/SQL que se ejecuta cuando se dispara el disparador.</li>
</ul>
</div><h1>Creación de Disparadores</h1>
<div class='content'><p>Para crear un disparador, se utiliza la declaración <code>CREATE TRIGGER</code>. La sintaxis básica es la siguiente:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIFtPUiBSRVBMQUNFXSBUUklHR0VSIG5vbWJyZV9kZWxfZGlzcGFyYWRvcgp7QkVGT1JFIHwgQUZURVJ9IHtJTlNFUlQgfCBVUERBVEUgfCBERUxFVEV9Ck9OIG5vbWJyZV9kZV9sYV90YWJsYQpbRk9SIEVBQ0ggUk9XXQpERUNMQVJFCiAgLS0gZGVjbGFyYWNpb25lcyBkZSB2YXJpYWJsZXMKQkVHSU4KICAtLSBjdWVycG8gZGVsIGRpc3BhcmFkb3IKRU5EOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE [OR REPLACE] TRIGGER nombre_del_disparador
{BEFORE | AFTER} {INSERT | UPDATE | DELETE}
ON nombre_de_la_tabla
[FOR EACH ROW]
DECLARE
  -- declaraciones de variables
BEGIN
  -- cuerpo del disparador
END;</pre></div><div class='content'></div><h2>Ejemplo: Disparador Básico</h2>
<div class='content'><p>Vamos a crear un disparador simple que registre cambios en una tabla <code>employees</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlcwpBRlRFUiBJTlNFUlQgT1IgVVBEQVRFIE9SIERFTEVURQpPTiBlbXBsb3llZXMKRk9SIEVBQ0ggUk9XCkJFR0lOCiAgSUYgSU5TRVJUSU5HIFRIRU4KICAgIElOU0VSVCBJTlRPIGVtcGxveWVlX2xvZyAobG9nX2RhdGUsIHVzZXJfaWQsIG9wZXJhdGlvbikKICAgIFZBTFVFUyAoU1lTREFURSwgVVNFUiwgJ0lOU0VSVCcpOwogIEVMU0lGIFVQREFUSU5HIFRIRU4KICAgIElOU0VSVCBJTlRPIGVtcGxveWVlX2xvZyAobG9nX2RhdGUsIHVzZXJfaWQsIG9wZXJhdGlvbikKICAgIFZBTFVFUyAoU1lTREFURSwgVVNFUiwgJ1VQREFURScpOwogIEVMU0lGIERFTEVUSU5HIFRIRU4KICAgIElOU0VSVCBJTlRPIGVtcGxveWVlX2xvZyAobG9nX2RhdGUsIHVzZXJfaWQsIG9wZXJhdGlvbikKICAgIFZBTFVFUyAoU1lTREFURSwgVVNFUiwgJ0RFTEVURScpOwogIEVORCBJRjsKRU5EOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE TRIGGER log_employee_changes
AFTER INSERT OR UPDATE OR DELETE
ON employees
FOR EACH ROW
BEGIN
  IF INSERTING THEN
    INSERT INTO employee_log (log_date, user_id, operation)
    VALUES (SYSDATE, USER, 'INSERT');
  ELSIF UPDATING THEN
    INSERT INTO employee_log (log_date, user_id, operation)
    VALUES (SYSDATE, USER, 'UPDATE');
  ELSIF DELETING THEN
    INSERT INTO employee_log (log_date, user_id, operation)
    VALUES (SYSDATE, USER, 'DELETE');
  END IF;
END;</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>Nombre del Disparador</strong>: <code>log_employee_changes</code></li>
<li><strong>Tiempo del Disparador</strong>: <code>AFTER</code></li>
<li><strong>Evento del Disparador</strong>: <code>INSERT</code>, <code>UPDATE</code>, <code>DELETE</code></li>
<li><strong>Alcance del Disparador</strong>: <code>FOR EACH ROW</code> (disparador a nivel de fila)</li>
<li><strong>Cuerpo del Disparador</strong>: Inserta una entrada de registro en la tabla <code>employee_log</code> cada vez que ocurre una operación de inserción, actualización o eliminación en la tabla <code>employees</code>.</li>
</ul>
</div><h1>Conceptos Avanzados de Disparadores</h1>
<div class='content'></div><h2>Disparadores Compuestos</h2>
<div class='content'><p>Los disparadores compuestos permiten definir múltiples puntos de tiempo dentro de un solo disparador. Esto puede ayudar a evitar errores de tablas mutantes y mejorar el rendimiento.</p>
<h4>Ejemplo: Disparador Compuesto</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JFQVRFIE9SIFJFUExBQ0UgVFJJR0dFUiBjb21wb3VuZF9lbXBsb3llZV90cmlnZ2VyCkZPUiBJTlNFUlQgT1IgVVBEQVRFIE9SIERFTEVURSBPTiBlbXBsb3llZXMKQ09NUE9VTkQgVFJJR0dFUgogIFRZUEUgdF9lbXBsb3llZV9pZHMgSVMgVEFCTEUgT0YgZW1wbG95ZWVzLmVtcGxveWVlX2lkJVRZUEU7CiAgZW1wbG95ZWVfaWRzIHRfZW1wbG95ZWVfaWRzIDo9IHRfZW1wbG95ZWVfaWRzKCk7CgogIEJFRk9SRSBTVEFURU1FTlQgSVMKICBCRUdJTgogICAgLS0gQ8OzZGlnbyBhIGVqZWN1dGFyIGFudGVzIGRlIGxhIGRlY2xhcmFjacOzbiBkZXNlbmNhZGVuYW50ZQogIEVORCBCRUZPUkUgU1RBVEVNRU5UOwoKICBCRUZPUkUgRUFDSCBST1cgSVMKICBCRUdJTgogICAgLS0gQ8OzZGlnbyBhIGVqZWN1dGFyIGFudGVzIGRlIGNhZGEgZmlsYQogICAgSUYgSU5TRVJUSU5HIE9SIFVQREFUSU5HIFRIRU4KICAgICAgZW1wbG95ZWVfaWRzLkVYVEVORDsKICAgICAgZW1wbG95ZWVfaWRzKGVtcGxveWVlX2lkcy5DT1VOVCkgOj0gOk5FVy5lbXBsb3llZV9pZDsKICAgIEVORCBJRjsKICBFTkQgQkVGT1JFIEVBQ0ggUk9XOwoKICBBRlRFUiBFQUNIIFJPVyBJUwogIEJFR0lOCiAgICAtLSBDw7NkaWdvIGEgZWplY3V0YXIgZGVzcHXDqXMgZGUgY2FkYSBmaWxhCiAgRU5EIEFGVEVSIEVBQ0ggUk9XOwoKICBBRlRFUiBTVEFURU1FTlQgSVMKICBCRUdJTgogICAgLS0gQ8OzZGlnbyBhIGVqZWN1dGFyIGRlc3B1w6lzIGRlIGxhIGRlY2xhcmFjacOzbiBkZXNlbmNhZGVuYW50ZQogICAgRk9SIGkgSU4gMSAuLiBlbXBsb3llZV9pZHMuQ09VTlQgTE9PUAogICAgICAtLSBQcm9jZXNhciBjYWRhIGVtcGxveWVlX2lkCiAgICBFTkQgTE9PUDsKICBFTkQgQUZURVIgU1RBVEVNRU5UOwpFTkQgY29tcG91bmRfZW1wbG95ZWVfdHJpZ2dlcjs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CREATE OR REPLACE TRIGGER compound_employee_trigger
FOR INSERT OR UPDATE OR DELETE ON employees
COMPOUND TRIGGER
  TYPE t_employee_ids IS TABLE OF employees.employee_id%TYPE;
  employee_ids t_employee_ids := t_employee_ids();

  BEFORE STATEMENT IS
  BEGIN
    -- C&oacute;digo a ejecutar antes de la declaraci&oacute;n desencadenante
  END BEFORE STATEMENT;

  BEFORE EACH ROW IS
  BEGIN
    -- C&oacute;digo a ejecutar antes de cada fila
    IF INSERTING OR UPDATING THEN
      employee_ids.EXTEND;
      employee_ids(employee_ids.COUNT) := :NEW.employee_id;
    END IF;
  END BEFORE EACH ROW;

  AFTER EACH ROW IS
  BEGIN
    -- C&oacute;digo a ejecutar despu&eacute;s de cada fila
  END AFTER EACH ROW;

  AFTER STATEMENT IS
  BEGIN
    -- C&oacute;digo a ejecutar despu&eacute;s de la declaraci&oacute;n desencadenante
    FOR i IN 1 .. employee_ids.COUNT LOOP
      -- Procesar cada employee_id
    END LOOP;
  END AFTER STATEMENT;
END compound_employee_trigger;</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>Disparador Compuesto</strong>: Combina múltiples puntos de tiempo (<code>BEFORE STATEMENT</code>, <code>BEFORE EACH ROW</code>, <code>AFTER EACH ROW</code>, <code>AFTER STATEMENT</code>) dentro de un solo disparador.</li>
<li><strong>Almacenamiento Temporal</strong>: Utiliza una colección PL/SQL (<code>employee_ids</code>) para almacenar datos a través de diferentes puntos de tiempo.</li>
</ul>
</div><h1>Gestión de Disparadores</h1>
<div class='content'><ul>
<li><strong>Habilitar/Deshabilitar Disparadores</strong>: Puedes habilitar o deshabilitar disparadores utilizando la declaración <code>ALTER TRIGGER</code>.</li>
<li><strong>Eliminar Disparadores</strong>: Puedes eliminar un disparador utilizando la declaración <code>DROP TRIGGER</code>.</li>
</ul>
</div><h2>Ejemplo: Gestión de Disparadores</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRGVzaGFiaWxpdGFyIHVuIGRpc3BhcmFkb3IKQUxURVIgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlcyBESVNBQkxFOwoKLS0gSGFiaWxpdGFyIHVuIGRpc3BhcmFkb3IKQUxURVIgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlcyBFTkFCTEU7CgotLSBFbGltaW5hciB1biBkaXNwYXJhZG9yCkRST1AgVFJJR0dFUiBsb2dfZW1wbG95ZWVfY2hhbmdlczs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Deshabilitar un disparador
ALTER TRIGGER log_employee_changes DISABLE;

-- Habilitar un disparador
ALTER TRIGGER log_employee_changes ENABLE;

-- Eliminar un disparador
DROP TRIGGER log_employee_changes;</pre></div><div class='content'></div><h1>Mejores Prácticas</h1>
<div class='content'><ul>
<li><strong>Mantén los Disparadores Simples</strong>: Evita lógica compleja dentro de los disparadores para mantener el rendimiento y la legibilidad.</li>
<li><strong>Usa Disparadores Compuestos</strong>: Para manejar múltiples puntos de tiempo y evitar errores de tablas mutantes.</li>
<li><strong>Documenta los Disparadores</strong>: Documenta claramente el propósito y la lógica de cada disparador.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Los disparadores en PL/SQL son herramientas poderosas para automatizar tareas de base de datos y hacer cumplir reglas de negocio. Al comprender los conceptos básicos y avanzados, puedes utilizar eficazmente los disparadores para mejorar tus aplicaciones de base de datos. Siempre sigue las mejores prácticas para asegurar que tus disparadores sean eficientes y mantenibles.</p>
</div><div class='row navigation'><div class='col-6'><a href='packages'>&#x25C4; Paquetes</a></div><div class='col-6 text-end'><a href='dynamic-sql'>SQL Dinámico &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
