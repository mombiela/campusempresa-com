<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto 2: Generación de Texto con RNN</title>

    <link rel="alternate" href="https://campusempresa.com/es/deep_learning/proyecto-generacion-texto-rnn" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/deep_learning/proyecto-generacion-texto-rnn" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/deep_learning/proyecto-generacion-texto-rnn" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/deep_learning/proyecto-generacion-texto-rnn" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Proyecto</a>
				<a href="about">Sobre nosotros</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donaciones</a>
				<a href="licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En este proyecto, exploraremos cómo las Redes Neuronales Recurrentes (RNN) pueden ser utilizadas para la generación de texto. Las RNN son especialmente adecuadas para tareas secuenciales, como el procesamiento de texto, debido a su capacidad para mantener información sobre estados anteriores en la secuencia.</p>
</div><h1>Objetivos del Proyecto</h1>
<div class='content'><ul>
<li>Comprender el funcionamiento básico de las RNN.</li>
<li>Implementar una RNN para la generación de texto.</li>
<li>Evaluar el rendimiento de la RNN en la tarea de generación de texto.</li>
</ul>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Redes Neuronales Recurrentes (RNN)</strong>: Un tipo de red neuronal que es capaz de manejar datos secuenciales.</li>
<li><strong>Estados Ocultos</strong>: Los estados internos de la RNN que permiten mantener información sobre entradas anteriores.</li>
<li><strong>Generación de Texto</strong>: El proceso de producir texto nuevo basado en patrones aprendidos de un corpus de texto existente.</li>
</ul>
</div><h1>Implementación de una RNN para Generación de Texto</h1>
<div class='content'></div><h2>Preparación del Entorno</h2>
<div class='content'><p>Primero, asegúrate de tener instaladas las bibliotecas necesarias. Utilizaremos TensorFlow y Keras para implementar nuestra RNN.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IXBpcCBpbnN0YWxsIHRlbnNvcmZsb3c="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>!pip install tensorflow</pre></div><div class='content'></div><h2>Importación de Bibliotecas</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCmZyb20gdGVuc29yZmxvdy5rZXJhcy5tb2RlbHMgaW1wb3J0IFNlcXVlbnRpYWwKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgRGVuc2UsIExTVE0sIEVtYmVkZGluZwpmcm9tIHRlbnNvcmZsb3cua2VyYXMub3B0aW1pemVycyBpbXBvcnQgQWRhbQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, LSTM, Embedding
from tensorflow.keras.optimizers import Adam</pre></div><div class='content'></div><h2>Carga y Preprocesamiento de Datos</h2>
<div class='content'><p>Para este proyecto, utilizaremos un corpus de texto. Puedes elegir cualquier texto largo, como un libro o una colección de artículos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgZWwgdGV4dG8KcGF0aF90b19maWxlID0gJ3BhdGgvdG8veW91ci90ZXh0ZmlsZS50eHQnCnRleHQgPSBvcGVuKHBhdGhfdG9fZmlsZSwgJ3InKS5yZWFkKCkKCiMgUHJlcHJvY2VzYW1pZW50bwp2b2NhYiA9IHNvcnRlZChzZXQodGV4dCkpCmNoYXIyaWR4ID0ge3U6aSBmb3IgaSwgdSBpbiBlbnVtZXJhdGUodm9jYWIpfQppZHgyY2hhciA9IG5wLmFycmF5KHZvY2FiKQp0ZXh0X2FzX2ludCA9IG5wLmFycmF5KFtjaGFyMmlkeFtjXSBmb3IgYyBpbiB0ZXh0XSkKCiMgQ3JlYXIgc2VjdWVuY2lhcyBkZSBlbnRyYWRhIHkgc2FsaWRhCnNlcV9sZW5ndGggPSAxMDAKZXhhbXBsZXNfcGVyX2Vwb2NoID0gbGVuKHRleHQpLy8oc2VxX2xlbmd0aCsxKQoKY2hhcl9kYXRhc2V0ID0gdGYuZGF0YS5EYXRhc2V0LmZyb21fdGVuc29yX3NsaWNlcyh0ZXh0X2FzX2ludCkKc2VxdWVuY2VzID0gY2hhcl9kYXRhc2V0LmJhdGNoKHNlcV9sZW5ndGgrMSwgZHJvcF9yZW1haW5kZXI9VHJ1ZSkKCmRlZiBzcGxpdF9pbnB1dF90YXJnZXQoY2h1bmspOgogICAgaW5wdXRfdGV4dCA9IGNodW5rWzotMV0KICAgIHRhcmdldF90ZXh0ID0gY2h1bmtbMTpdCiAgICByZXR1cm4gaW5wdXRfdGV4dCwgdGFyZ2V0X3RleHQKCmRhdGFzZXQgPSBzZXF1ZW5jZXMubWFwKHNwbGl0X2lucHV0X3RhcmdldCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar el texto
path_to_file = 'path/to/your/textfile.txt'
text = open(path_to_file, 'r').read()

# Preprocesamiento
vocab = sorted(set(text))
char2idx = {u:i for i, u in enumerate(vocab)}
idx2char = np.array(vocab)
text_as_int = np.array([char2idx[c] for c in text])

# Crear secuencias de entrada y salida
seq_length = 100
examples_per_epoch = len(text)//(seq_length+1)

char_dataset = tf.data.Dataset.from_tensor_slices(text_as_int)
sequences = char_dataset.batch(seq_length+1, drop_remainder=True)

def split_input_target(chunk):
    input_text = chunk[:-1]
    target_text = chunk[1:]
    return input_text, target_text

dataset = sequences.map(split_input_target)</pre></div><div class='content'></div><h2>Construcción del Modelo</h2>
<div class='content'><p>Utilizaremos una arquitectura simple de LSTM para nuestra RNN.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQYXLDoW1ldHJvcyBkZWwgbW9kZWxvCnZvY2FiX3NpemUgPSBsZW4odm9jYWIpCmVtYmVkZGluZ19kaW0gPSAyNTYKcm5uX3VuaXRzID0gMTAyNAoKIyBDb25zdHJ1Y2Npw7NuIGRlbCBtb2RlbG8KbW9kZWwgPSBTZXF1ZW50aWFsKFsKICAgIEVtYmVkZGluZyh2b2NhYl9zaXplLCBlbWJlZGRpbmdfZGltLCBiYXRjaF9pbnB1dF9zaGFwZT1bTm9uZSwgTm9uZV0pLAogICAgTFNUTShybm5fdW5pdHMsIHJldHVybl9zZXF1ZW5jZXM9VHJ1ZSwgc3RhdGVmdWw9RmFsc2UsIHJlY3VycmVudF9pbml0aWFsaXplcj0nZ2xvcm90X3VuaWZvcm0nKSwKICAgIERlbnNlKHZvY2FiX3NpemUpCl0pCgojIENvbXBpbGFjacOzbiBkZWwgbW9kZWxvCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywgbG9zcz10Zi5sb3NzZXMuU3BhcnNlQ2F0ZWdvcmljYWxDcm9zc2VudHJvcHkoZnJvbV9sb2dpdHM9VHJ1ZSkp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Par&aacute;metros del modelo
vocab_size = len(vocab)
embedding_dim = 256
rnn_units = 1024

# Construcci&oacute;n del modelo
model = Sequential([
    Embedding(vocab_size, embedding_dim, batch_input_shape=[None, None]),
    LSTM(rnn_units, return_sequences=True, stateful=False, recurrent_initializer='glorot_uniform'),
    Dense(vocab_size)
])

# Compilaci&oacute;n del modelo
model.compile(optimizer='adam', loss=tf.losses.SparseCategoricalCrossentropy(from_logits=True))</pre></div><div class='content'></div><h2>Entrenamiento del Modelo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb25maWd1cmFjacOzbiBkZWwgZW50cmVuYW1pZW50bwpCQVRDSF9TSVpFID0gNjQKQlVGRkVSX1NJWkUgPSAxMDAwMAoKZGF0YXNldCA9IGRhdGFzZXQuc2h1ZmZsZShCVUZGRVJfU0laRSkuYmF0Y2goQkFUQ0hfU0laRSwgZHJvcF9yZW1haW5kZXI9VHJ1ZSkKCiMgRW50cmVuYW1pZW50bwpFUE9DSFMgPSAxMApoaXN0b3J5ID0gbW9kZWwuZml0KGRhdGFzZXQsIGVwb2Nocz1FUE9DSFMp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Configuraci&oacute;n del entrenamiento
BATCH_SIZE = 64
BUFFER_SIZE = 10000

dataset = dataset.shuffle(BUFFER_SIZE).batch(BATCH_SIZE, drop_remainder=True)

# Entrenamiento
EPOCHS = 10
history = model.fit(dataset, epochs=EPOCHS)</pre></div><div class='content'></div><h2>Generación de Texto</h2>
<div class='content'><p>Una vez entrenado el modelo, podemos generar texto nuevo.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGdlbmVyYXRlX3RleHQobW9kZWwsIHN0YXJ0X3N0cmluZyk6CiAgICBudW1fZ2VuZXJhdGUgPSAxMDAwCiAgICBpbnB1dF9ldmFsID0gW2NoYXIyaWR4W3NdIGZvciBzIGluIHN0YXJ0X3N0cmluZ10KICAgIGlucHV0X2V2YWwgPSB0Zi5leHBhbmRfZGltcyhpbnB1dF9ldmFsLCAwKQogICAgdGV4dF9nZW5lcmF0ZWQgPSBbXQogICAgdGVtcGVyYXR1cmUgPSAxLjAKCiAgICBtb2RlbC5yZXNldF9zdGF0ZXMoKQogICAgZm9yIGkgaW4gcmFuZ2UobnVtX2dlbmVyYXRlKToKICAgICAgICBwcmVkaWN0aW9ucyA9IG1vZGVsKGlucHV0X2V2YWwpCiAgICAgICAgcHJlZGljdGlvbnMgPSB0Zi5zcXVlZXplKHByZWRpY3Rpb25zLCAwKQogICAgICAgIHByZWRpY3Rpb25zID0gcHJlZGljdGlvbnMgLyB0ZW1wZXJhdHVyZQogICAgICAgIHByZWRpY3RlZF9pZCA9IHRmLnJhbmRvbS5jYXRlZ29yaWNhbChwcmVkaWN0aW9ucywgbnVtX3NhbXBsZXM9MSlbLTEsMF0ubnVtcHkoKQogICAgICAgIGlucHV0X2V2YWwgPSB0Zi5leHBhbmRfZGltcyhbcHJlZGljdGVkX2lkXSwgMCkKICAgICAgICB0ZXh0X2dlbmVyYXRlZC5hcHBlbmQoaWR4MmNoYXJbcHJlZGljdGVkX2lkXSkKCiAgICByZXR1cm4gKHN0YXJ0X3N0cmluZyArICcnLmpvaW4odGV4dF9nZW5lcmF0ZWQpKQoKcHJpbnQoZ2VuZXJhdGVfdGV4dChtb2RlbCwgc3RhcnRfc3RyaW5nPSJPbmNlIHVwb24gYSB0aW1lIikp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def generate_text(model, start_string):
    num_generate = 1000
    input_eval = [char2idx[s] for s in start_string]
    input_eval = tf.expand_dims(input_eval, 0)
    text_generated = []
    temperature = 1.0

    model.reset_states()
    for i in range(num_generate):
        predictions = model(input_eval)
        predictions = tf.squeeze(predictions, 0)
        predictions = predictions / temperature
        predicted_id = tf.random.categorical(predictions, num_samples=1)[-1,0].numpy()
        input_eval = tf.expand_dims([predicted_id], 0)
        text_generated.append(idx2char[predicted_id])

    return (start_string + ''.join(text_generated))

print(generate_text(model, start_string=&quot;Once upon a time&quot;))</pre></div><div class='content'></div><h1>Evaluación y Ajustes</h1>
<div class='content'><ul>
<li><strong>Evaluación</strong>: Revisa el texto generado para evaluar la coherencia y fluidez.</li>
<li><strong>Ajustes</strong>: Si el texto generado no es satisfactorio, considera ajustar los hiperparámetros, como el tamaño de la red, la longitud de las secuencias de entrada, o el número de épocas de entrenamiento.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>En este proyecto, hemos aprendido a implementar una RNN para la generación de texto. Hemos cubierto desde la preparación de datos hasta la construcción, entrenamiento y evaluación del modelo. La generación de texto con RNN es una poderosa técnica que puede ser aplicada en diversas áreas, como la creación de contenido, chatbots y más.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
