<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Control de Acceso Basado en Roles en Flask</title>

    <link rel="alternate" href="https://campusempresa.com/es/flask/role-based-access-control" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/flask/role-based-access-control" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/flask/role-based-access-control" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/es/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es" class="px-2">ES</b>
				|
				<a href="/ca/flask/role-based-access-control" id="lnk_lang_ca" data-lang="ca" class="px-2">CA</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/es/objective">El Proyecto</a>
				<a href="/es/about">Sobre nosotros</a>
				<a href="/es/contribute">Contribuir</a>
				<a href="/es/donate">Donaciones</a>
				<a href="/es/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducción al Control de Acceso Basado en Roles (RBAC)</h1>
<div class='content'><p>El Control de Acceso Basado en Roles (RBAC) es un método para regular el acceso a recursos basado en los roles de los usuarios individuales dentro de una organización. En una aplicación Flask, RBAC puede ser implementado para asegurar que los usuarios tengan permisos apropiados para acceder a ciertas partes de la aplicación.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Roles</strong>: Un rol es una colección de permisos. Ejemplos incluyen 'admin', 'editor', 'viewer'.</li>
<li><strong>Permisos</strong>: Los permisos son los derechos para realizar ciertas acciones. Ejemplos incluyen 'leer', 'escribir', 'eliminar'.</li>
<li><strong>Usuarios</strong>: Los usuarios son asignados a roles que determinan sus permisos.</li>
</ul>
</div><h1>Configuración de Flask para RBAC</h1>
<div class='content'><p>Para implementar RBAC en Flask, utilizaremos la extensión <code>Flask-Security</code>, que proporciona una manera sencilla de manejar la autenticación y la gestión de roles.</p>
</div><h2>Instalación</h2>
<div class='content'><p>Primero, instala los paquetes necesarios:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgRmxhc2sgRmxhc2stU1FMQWxjaGVteSBGbGFzay1TZWN1cml0eQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install Flask Flask-SQLAlchemy Flask-Security</pre></div><div class='content'></div><h2>Configuración Básica</h2>
<div class='content'><p>Crea una aplicación Flask básica y configúrala para usar Flask-Security.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2sKZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CmZyb20gZmxhc2tfc2VjdXJpdHkgaW1wb3J0IFNlY3VyaXR5LCBTUUxBbGNoZW15VXNlckRhdGFzdG9yZSwgVXNlck1peGluLCBSb2xlTWl4aW4KCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQphcHAuY29uZmlnWydTRUNSRVRfS0VZJ10gPSAnc3VwZXItc2VjcmV0JwphcHAuY29uZmlnWydTUUxBTENIRU1ZX0RBVEFCQVNFX1VSSSddID0gJ3NxbGl0ZTovLy9yYmFjLmRiJwphcHAuY29uZmlnWydTRUNVUklUWV9SRUdJU1RFUkFCTEUnXSA9IFRydWUKYXBwLmNvbmZpZ1snU0VDVVJJVFlfUEFTU1dPUkRfU0FMVCddID0gJ3N1cGVyLXNlY3JldC1zYWx0JwoKZGIgPSBTUUxBbGNoZW15KGFwcCkKCiMgRGVmaW5pciBtb2RlbG9zCnJvbGVzX3VzZXJzID0gZGIuVGFibGUoJ3JvbGVzX3VzZXJzJywKICAgIGRiLkNvbHVtbigndXNlcl9pZCcsIGRiLkludGVnZXIoKSwgZGIuRm9yZWlnbktleSgndXNlci5pZCcpKSwKICAgIGRiLkNvbHVtbigncm9sZV9pZCcsIGRiLkludGVnZXIoKSwgZGIuRm9yZWlnbktleSgncm9sZS5pZCcpKQopCgpjbGFzcyBSb2xlKGRiLk1vZGVsLCBSb2xlTWl4aW4pOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlcigpLCBwcmltYXJ5X2tleT1UcnVlKQogICAgbmFtZSA9IGRiLkNvbHVtbihkYi5TdHJpbmcoODApLCB1bmlxdWU9VHJ1ZSkKICAgIGRlc2NyaXB0aW9uID0gZGIuQ29sdW1uKGRiLlN0cmluZygyNTUpKQoKY2xhc3MgVXNlcihkYi5Nb2RlbCwgVXNlck1peGluKToKICAgIGlkID0gZGIuQ29sdW1uKGRiLkludGVnZXIoKSwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIGVtYWlsID0gZGIuQ29sdW1uKGRiLlN0cmluZygyNTUpLCB1bmlxdWU9VHJ1ZSkKICAgIHBhc3N3b3JkID0gZGIuQ29sdW1uKGRiLlN0cmluZygyNTUpKQogICAgYWN0aXZlID0gZGIuQ29sdW1uKGRiLkJvb2xlYW4oKSkKICAgIHJvbGVzID0gZGIucmVsYXRpb25zaGlwKCdSb2xlJywgc2Vjb25kYXJ5PXJvbGVzX3VzZXJzLCBiYWNrcmVmPWRiLmJhY2tyZWYoJ3VzZXJzJywgbGF6eT0nZHluYW1pYycpKQoKIyBDb25maWd1cmFyIEZsYXNrLVNlY3VyaXR5CnVzZXJfZGF0YXN0b3JlID0gU1FMQWxjaGVteVVzZXJEYXRhc3RvcmUoZGIsIFVzZXIsIFJvbGUpCnNlY3VyaXR5ID0gU2VjdXJpdHkoYXBwLCB1c2VyX2RhdGFzdG9yZSkKCkBhcHAuYmVmb3JlX2ZpcnN0X3JlcXVlc3QKZGVmIGNyZWF0ZV91c2VyKCk6CiAgICBkYi5jcmVhdGVfYWxsKCkKICAgIGlmIG5vdCB1c2VyX2RhdGFzdG9yZS5maW5kX3VzZXIoZW1haWw9ImFkbWluQGV4YW1wbGUuY29tIik6CiAgICAgICAgdXNlcl9kYXRhc3RvcmUuY3JlYXRlX3VzZXIoZW1haWw9ImFkbWluQGV4YW1wbGUuY29tIiwgcGFzc3dvcmQ9InBhc3N3b3JkIikKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBhcHAucnVuKGRlYnVnPVRydWUp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask
from flask_sqlalchemy import SQLAlchemy
from flask_security import Security, SQLAlchemyUserDatastore, UserMixin, RoleMixin

app = Flask(__name__)
app.config['SECRET_KEY'] = 'super-secret'
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///rbac.db'
app.config['SECURITY_REGISTERABLE'] = True
app.config['SECURITY_PASSWORD_SALT'] = 'super-secret-salt'

db = SQLAlchemy(app)

# Definir modelos
roles_users = db.Table('roles_users',
    db.Column('user_id', db.Integer(), db.ForeignKey('user.id')),
    db.Column('role_id', db.Integer(), db.ForeignKey('role.id'))
)

class Role(db.Model, RoleMixin):
    id = db.Column(db.Integer(), primary_key=True)
    name = db.Column(db.String(80), unique=True)
    description = db.Column(db.String(255))

class User(db.Model, UserMixin):
    id = db.Column(db.Integer(), primary_key=True)
    email = db.Column(db.String(255), unique=True)
    password = db.Column(db.String(255))
    active = db.Column(db.Boolean())
    roles = db.relationship('Role', secondary=roles_users, backref=db.backref('users', lazy='dynamic'))

# Configurar Flask-Security
user_datastore = SQLAlchemyUserDatastore(db, User, Role)
security = Security(app, user_datastore)

@app.before_first_request
def create_user():
    db.create_all()
    if not user_datastore.find_user(email=&quot;admin@example.com&quot;):
        user_datastore.create_user(email=&quot;admin@example.com&quot;, password=&quot;password&quot;)
    db.session.commit()

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'></div><h1>Asignación de Roles a Usuarios</h1>
<div class='content'><p>Para asignar roles a los usuarios, puedes usar la API de Flask-Security. Aquí hay un ejemplo de cómo crear roles y asignarlos a un usuario.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QGFwcC5iZWZvcmVfZmlyc3RfcmVxdWVzdApkZWYgY3JlYXRlX3VzZXIoKToKICAgIGRiLmNyZWF0ZV9hbGwoKQogICAgaWYgbm90IHVzZXJfZGF0YXN0b3JlLmZpbmRfdXNlcihlbWFpbD0iYWRtaW5AZXhhbXBsZS5jb20iKToKICAgICAgICBhZG1pbl9yb2xlID0gdXNlcl9kYXRhc3RvcmUuY3JlYXRlX3JvbGUobmFtZT0nYWRtaW4nLCBkZXNjcmlwdGlvbj0nQWRtaW5pc3RyYWRvcicpCiAgICAgICAgdXNlciA9IHVzZXJfZGF0YXN0b3JlLmNyZWF0ZV91c2VyKGVtYWlsPSJhZG1pbkBleGFtcGxlLmNvbSIsIHBhc3N3b3JkPSJwYXNzd29yZCIpCiAgICAgICAgdXNlcl9kYXRhc3RvcmUuYWRkX3JvbGVfdG9fdXNlcih1c2VyLCBhZG1pbl9yb2xlKQogICAgZGIuc2Vzc2lvbi5jb21taXQoKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@app.before_first_request
def create_user():
    db.create_all()
    if not user_datastore.find_user(email=&quot;admin@example.com&quot;):
        admin_role = user_datastore.create_role(name='admin', description='Administrador')
        user = user_datastore.create_user(email=&quot;admin@example.com&quot;, password=&quot;password&quot;)
        user_datastore.add_role_to_user(user, admin_role)
    db.session.commit()</pre></div><div class='content'></div><h1>Protección de Rutas con Roles</h1>
<div class='content'><p>Puedes proteger rutas especificando los roles requeridos usando el decorador <code>@roles_required</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFza19zZWN1cml0eSBpbXBvcnQgcm9sZXNfcmVxdWlyZWQKCkBhcHAucm91dGUoJy9hZG1pbicpCkByb2xlc19yZXF1aXJlZCgnYWRtaW4nKQpkZWYgYWRtaW5fcGFnZSgpOgogICAgcmV0dXJuICLCoUJpZW52ZW5pZG8gYSBsYSBww6FnaW5hIGRlIGFkbWluaXN0cmFjacOzbiEiCgpAYXBwLnJvdXRlKCcvZWRpdG9yJykKQHJvbGVzX3JlcXVpcmVkKCdlZGl0b3InKQpkZWYgZWRpdG9yX3BhZ2UoKToKICAgIHJldHVybiAiwqFCaWVudmVuaWRvIGEgbGEgcMOhZ2luYSBkZWwgZWRpdG9yISI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask_security import roles_required

@app.route('/admin')
@roles_required('admin')
def admin_page():
    return &quot;&iexcl;Bienvenido a la p&aacute;gina de administraci&oacute;n!&quot;

@app.route('/editor')
@roles_required('editor')
def editor_page():
    return &quot;&iexcl;Bienvenido a la p&aacute;gina del editor!&quot;</pre></div><div class='content'></div><h1>Gestión Avanzada de Roles</h1>
<div class='content'><p>Para una gestión más avanzada de roles, podrías necesitar crear decoradores personalizados o usar el decorador <code>@roles_accepted</code> para permitir múltiples roles.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFza19zZWN1cml0eSBpbXBvcnQgcm9sZXNfYWNjZXB0ZWQKCkBhcHAucm91dGUoJy9kYXNoYm9hcmQnKQpAcm9sZXNfYWNjZXB0ZWQoJ2FkbWluJywgJ2VkaXRvcicpCmRlZiBkYXNoYm9hcmQoKToKICAgIHJldHVybiAiwqFCaWVudmVuaWRvIGFsIHBhbmVsIGRlIGNvbnRyb2whIg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask_security import roles_accepted

@app.route('/dashboard')
@roles_accepted('admin', 'editor')
def dashboard():
    return &quot;&iexcl;Bienvenido al panel de control!&quot;</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>El Control de Acceso Basado en Roles (RBAC) es una manera poderosa de gestionar los permisos de los usuarios en una aplicación Flask. Usando Flask-Security, puedes configurar fácilmente roles y permisos, asignar roles a usuarios y proteger rutas basadas en roles. Esto asegura que solo los usuarios autorizados puedan acceder a ciertas partes de tu aplicación, mejorando la seguridad y la organización.</p>
<p>Siguiendo los pasos descritos en este tema, ahora deberías tener una comprensión básica de cómo implementar RBAC en tus aplicaciones Flask. Continúa explorando la documentación de Flask-Security para más características avanzadas y opciones de personalización.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/es/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
