<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy<br> y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<b id="lit_lang_es">Castellano</b>
				|
				<a href="https://campusempresa.cat/flask/handling-user-input-securely" id="lnk_lang_ca" data-lang="ca">Català</a>
					</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Proyecto</a>
				<a href="about">Sobre nosotros</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donaciones</a>
				<a href="licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>El manejo seguro de la entrada del usuario es un aspecto crítico del desarrollo web. En esta sección, exploraremos cómo gestionar la entrada del usuario en aplicaciones Flask para prevenir vulnerabilidades de seguridad comunes.</p>
</div><h1>Introducción a la Seguridad de la Entrada del Usuario</h1>
<div class='content'><ul>
<li><strong>Importancia de la Seguridad</strong>: Entender por qué es crucial asegurar la entrada del usuario.</li>
<li><strong>Vulnerabilidades Comunes</strong>: Descripción general de problemas de seguridad comunes como la Inyección SQL, Cross-Site Scripting (XSS) y Cross-Site Request Forgery (CSRF).</li>
</ul>
</div><h1>Validación de la Entrada del Usuario</h1>
<div class='content'><ul>
<li><strong>Validación del Lado del Cliente vs. del Lado del Servidor</strong>:
<ul>
<li>La validación del lado del cliente mejora la experiencia del usuario, pero no debe ser la única en la que se confíe.</li>
<li>La validación del lado del servidor es esencial para la seguridad.</li>
</ul>
</li>
</ul>
</div><h2>Ejemplo: Validación Simple de Formularios</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIHJlbmRlcl90ZW1wbGF0ZV9zdHJpbmcKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKQGFwcC5yb3V0ZSgnL3N1Ym1pdCcsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBzdWJtaXQoKToKICAgIHVzZXJuYW1lID0gcmVxdWVzdC5mb3JtLmdldCgndXNlcm5hbWUnKQogICAgaWYgbm90IHVzZXJuYW1lIG9yIGxlbih1c2VybmFtZSkgPCAzOgogICAgICAgIHJldHVybiAiSW52YWxpZCB1c2VybmFtZSIsIDQwMAogICAgcmV0dXJuIGYiV2VsY29tZSwge3VzZXJuYW1lfSEiCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/submit', methods=['POST'])
def submit():
    username = request.form.get('username')
    if not username or len(username) &lt; 3:
        return &quot;Invalid username&quot;, 400
    return f&quot;Welcome, {username}!&quot;

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>: Este ejemplo muestra una validación básica del lado del servidor donde el nombre de usuario debe tener al menos 3 caracteres.</li>
</ul>
</div><h1>Saneamiento de la Entrada del Usuario</h1>
<div class='content'><ul>
<li><strong>¿Por qué Saneamiento?</strong>: Para eliminar caracteres o código potencialmente dañinos de la entrada del usuario.</li>
<li><strong>Técnicas Comunes</strong>:
<ul>
<li>Escapar caracteres HTML.</li>
<li>Usar bibliotecas como <code>bleach</code> para limpiar la entrada.</li>
</ul>
</li>
</ul>
</div><h2>Ejemplo: Saneamiento de Entrada con Bleach</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGJsZWFjaApmcm9tIGZsYXNrIGltcG9ydCBGbGFzaywgcmVxdWVzdCwgcmVuZGVyX3RlbXBsYXRlX3N0cmluZwoKYXBwID0gRmxhc2soX19uYW1lX18pCgpAYXBwLnJvdXRlKCcvc3VibWl0JywgbWV0aG9kcz1bJ1BPU1QnXSkKZGVmIHN1Ym1pdCgpOgogICAgdXNlcm5hbWUgPSByZXF1ZXN0LmZvcm0uZ2V0KCd1c2VybmFtZScpCiAgICBzYW5pdGl6ZWRfdXNlcm5hbWUgPSBibGVhY2guY2xlYW4odXNlcm5hbWUpCiAgICByZXR1cm4gZiJXZWxjb21lLCB7c2FuaXRpemVkX3VzZXJuYW1lfSEiCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import bleach
from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/submit', methods=['POST'])
def submit():
    username = request.form.get('username')
    sanitized_username = bleach.clean(username)
    return f&quot;Welcome, {sanitized_username}!&quot;

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>: Este ejemplo usa la biblioteca <code>bleach</code> para sanear la entrada del nombre de usuario, eliminando cualquier etiqueta HTML o de script potencialmente dañina.</li>
</ul>
</div><h1>Protección Contra Inyección SQL</h1>
<div class='content'><ul>
<li><strong>¿Qué es la Inyección SQL?</strong>: Una técnica donde los atacantes pueden ejecutar código SQL arbitrario en tu base de datos.</li>
<li><strong>Uso de ORM</strong>: Las herramientas de Mapeo Objeto-Relacional (ORM) como SQLAlchemy pueden ayudar a prevenir la inyección SQL.</li>
</ul>
</div><h2>Ejemplo: Uso de SQLAlchemy</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QKZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CgphcHAgPSBGbGFzayhfX25hbWVfXykKYXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9EQVRBQkFTRV9VUkknXSA9ICdzcWxpdGU6Ly8vdGVzdC5kYicKZGIgPSBTUUxBbGNoZW15KGFwcCkKCmNsYXNzIFVzZXIoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIHVzZXJuYW1lID0gZGIuQ29sdW1uKGRiLlN0cmluZyg4MCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKCkBhcHAucm91dGUoJy9hZGRfdXNlcicsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBhZGRfdXNlcigpOgogICAgdXNlcm5hbWUgPSByZXF1ZXN0LmZvcm0uZ2V0KCd1c2VybmFtZScpCiAgICBpZiBub3QgdXNlcm5hbWU6CiAgICAgICAgcmV0dXJuICJJbnZhbGlkIHVzZXJuYW1lIiwgNDAwCiAgICBuZXdfdXNlciA9IFVzZXIodXNlcm5hbWU9dXNlcm5hbWUpCiAgICBkYi5zZXNzaW9uLmFkZChuZXdfdXNlcikKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKICAgIHJldHVybiBmIlVzZXIge3VzZXJuYW1lfSBhZGRlZCEiCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///test.db'
db = SQLAlchemy(app)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)

@app.route('/add_user', methods=['POST'])
def add_user():
    username = request.form.get('username')
    if not username:
        return &quot;Invalid username&quot;, 400
    new_user = User(username=username)
    db.session.add(new_user)
    db.session.commit()
    return f&quot;User {username} added!&quot;

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>: Este ejemplo demuestra cómo usar SQLAlchemy para insertar de manera segura datos del usuario en la base de datos, mitigando el riesgo de inyección SQL.</li>
</ul>
</div><h1>Prevención de Cross-Site Scripting (XSS)</h1>
<div class='content'><ul>
<li><strong>¿Qué es XSS?</strong>: Una vulnerabilidad que permite a los atacantes inyectar scripts maliciosos en páginas web vistas por otros usuarios.</li>
<li><strong>Escapar Salida</strong>: Siempre escapa el contenido generado por el usuario antes de renderizarlo en HTML.</li>
</ul>
</div><h2>Ejemplo: Escapar Salida</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIHJlbmRlcl90ZW1wbGF0ZV9zdHJpbmcKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKQGFwcC5yb3V0ZSgnL3N1Ym1pdCcsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBzdWJtaXQoKToKICAgIHVzZXJuYW1lID0gcmVxdWVzdC5mb3JtLmdldCgndXNlcm5hbWUnKQogICAgZXNjYXBlZF91c2VybmFtZSA9IGVzY2FwZSh1c2VybmFtZSkKICAgIHJldHVybiByZW5kZXJfdGVtcGxhdGVfc3RyaW5nKCc8aDE+V2VsY29tZSwge3sgdXNlcm5hbWUgfX08L2gxPicsIHVzZXJuYW1lPWVzY2FwZWRfdXNlcm5hbWUpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/submit', methods=['POST'])
def submit():
    username = request.form.get('username')
    escaped_username = escape(username)
    return render_template_string('&lt;h1&gt;Welcome, {{ username }}&lt;/h1&gt;', username=escaped_username)

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>: Este ejemplo usa la función <code>escape</code> de Flask para sanear el nombre de usuario antes de renderizarlo en la plantilla HTML.</li>
</ul>
</div><h1>Implementación de Protección CSRF</h1>
<div class='content'><ul>
<li><strong>¿Qué es CSRF?</strong>: Un ataque que engaña al usuario para que envíe una solicitud que no tenía la intención de hacer.</li>
<li><strong>Uso de Flask-WTF</strong>: La extensión Flask-WTF proporciona protección CSRF de manera predeterminada.</li>
</ul>
</div><h2>Ejemplo: Protección CSRF con Flask-WTF</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlbmRlcl90ZW1wbGF0ZSwgcmVxdWVzdApmcm9tIGZsYXNrX3d0ZiBpbXBvcnQgRmxhc2tGb3JtCmZyb20gd3Rmb3JtcyBpbXBvcnQgU3RyaW5nRmllbGQsIFN1Ym1pdEZpZWxkCmZyb20gd3Rmb3Jtcy52YWxpZGF0b3JzIGltcG9ydCBEYXRhUmVxdWlyZWQKZnJvbSBmbGFza193dGYuY3NyZiBpbXBvcnQgQ1NSRlByb3RlY3QKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQphcHAuY29uZmlnWydTRUNSRVRfS0VZJ10gPSAnbXlzZWNyZXQnCmNzcmYgPSBDU1JGUHJvdGVjdChhcHApCgpjbGFzcyBNeUZvcm0oRmxhc2tGb3JtKToKICAgIHVzZXJuYW1lID0gU3RyaW5nRmllbGQoJ1VzZXJuYW1lJywgdmFsaWRhdG9ycz1bRGF0YVJlcXVpcmVkKCldKQogICAgc3VibWl0ID0gU3VibWl0RmllbGQoJ1N1Ym1pdCcpCgpAYXBwLnJvdXRlKCcvc3VibWl0JywgbWV0aG9kcz1bJ0dFVCcsICdQT1NUJ10pCmRlZiBzdWJtaXQoKToKICAgIGZvcm0gPSBNeUZvcm0oKQogICAgaWYgZm9ybS52YWxpZGF0ZV9vbl9zdWJtaXQoKToKICAgICAgICB1c2VybmFtZSA9IGZvcm0udXNlcm5hbWUuZGF0YQogICAgICAgIHJldHVybiBmIldlbGNvbWUsIHt1c2VybmFtZX0hIgogICAgcmV0dXJuIHJlbmRlcl90ZW1wbGF0ZSgnZm9ybS5odG1sJywgZm9ybT1mb3JtKQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGFwcC5ydW4oZGVidWc9VHJ1ZSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, render_template, request
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField
from wtforms.validators import DataRequired
from flask_wtf.csrf import CSRFProtect

app = Flask(__name__)
app.config['SECRET_KEY'] = 'mysecret'
csrf = CSRFProtect(app)

class MyForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired()])
    submit = SubmitField('Submit')

@app.route('/submit', methods=['GET', 'POST'])
def submit():
    form = MyForm()
    if form.validate_on_submit():
        username = form.username.data
        return f&quot;Welcome, {username}!&quot;
    return render_template('form.html', form=form)

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>: Este ejemplo muestra cómo usar Flask-WTF para crear un formulario con protección CSRF. La clase <code>CSRFProtect</code> asegura que todos los formularios incluyan un token CSRF.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Asegurar la entrada del usuario es un aspecto fundamental para construir aplicaciones Flask robustas. Al validar, sanear y proteger contra vulnerabilidades comunes como la Inyección SQL, XSS y CSRF, puedes mejorar significativamente la seguridad de tus aplicaciones web. Mantente siempre actualizado con las últimas prácticas de seguridad y revisa regularmente tu código en busca de posibles vulnerabilidades.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
