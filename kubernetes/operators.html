<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Operadores en Kubernetes</title>

    <link rel="alternate" href="https://campusempresa.com/kubernetes/operators" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/kubernetes/operators" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/kubernetes/operators" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/kubernetes/operators" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/kubernetes/operators" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='custom-resource-definitions'>&#x25C4;Definiciones de Recursos Personalizados (CRDs)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Operadores en Kubernetes</a>
	</div>
	<div class='col-4 text-end'>
					<a href='helm-and-package-management'>Helm y Gestión de Paquetes &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a los Operadores</h1>
<div class='content'><p>Los operadores son un concepto poderoso en Kubernetes que extiende las capacidades de la API de Kubernetes para gestionar aplicaciones complejas y sus componentes. Son esencialmente controladores personalizados que utilizan recursos personalizados para gestionar aplicaciones y sus componentes.</p>
<ul>
<li><strong>Definición</strong>: Los operadores son extensiones de software para Kubernetes que utilizan recursos personalizados para gestionar aplicaciones y sus componentes.</li>
<li><strong>Propósito</strong>: Automatizar la gestión de aplicaciones complejas y con estado.</li>
<li><strong>Componentes</strong>:
<ul>
<li><strong>Definiciones de Recursos Personalizados (CRDs)</strong>: Definen el esquema para el recurso personalizado.</li>
<li><strong>Controlador</strong>: Observa los recursos personalizados y toma acciones para reconciliar el estado actual con el estado deseado.</li>
</ul>
</li>
</ul>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Definiciones de Recursos Personalizados (CRDs)</strong>: Extienden la API de Kubernetes para incluir objetos personalizados.</li>
<li><strong>Controlador</strong>: Un bucle que observa el estado de tu clúster y realiza cambios para mover el estado actual hacia el estado deseado.</li>
<li><strong>Bucle de Reconciliación</strong>: El proceso mediante el cual el controlador asegura que el estado actual coincida con el estado deseado.</li>
</ul>
</div><h1>Creando un Operador Simple</h1>
<h2>Paso 1: Definir un Recurso Personalizado</h2>
<div class='content'><p>Un Recurso Personalizado (CR) es una extensión de la API de Kubernetes que te permite almacenar y recuperar datos estructurados.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC1jcmQueWFtbAphcGlWZXJzaW9uOiBhcGlleHRlbnNpb25zLms4cy5pby92MQpraW5kOiBDdXN0b21SZXNvdXJjZURlZmluaXRpb24KbWV0YWRhdGE6CiAgbmFtZTogbXlhcHBzLmV4YW1wbGUuY29tCnNwZWM6CiAgZ3JvdXA6IGV4YW1wbGUuY29tCiAgdmVyc2lvbnM6CiAgICAtIG5hbWU6IHYxCiAgICAgIHNlcnZlZDogdHJ1ZQogICAgICBzdG9yYWdlOiB0cnVlCiAgc2NvcGU6IE5hbWVzcGFjZWQKICBuYW1lczoKICAgIHBsdXJhbDogbXlhcHBzCiAgICBzaW5ndWxhcjogbXlhcHAKICAgIGtpbmQ6IE15QXBwCiAgICBzaG9ydE5hbWVzOgogICAgLSBtYQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp-crd.yaml
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: myapps.example.com
spec:
  group: example.com
  versions:
    - name: v1
      served: true
      storage: true
  scope: Namespaced
  names:
    plural: myapps
    singular: myapp
    kind: MyApp
    shortNames:
    - ma</pre></div><div class='content'></div><h2>Paso 2: Crear el Recurso Personalizado</h2>
<div class='content'><p>Una vez que se define el CRD, puedes crear instancias del recurso personalizado.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC1pbnN0YW5jZS55YW1sCmFwaVZlcnNpb246IGV4YW1wbGUuY29tL3YxCmtpbmQ6IE15QXBwCm1ldGFkYXRhOgogIG5hbWU6IG15YXBwLXNhbXBsZQpzcGVjOgogIHNpemU6IDM="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp-instance.yaml
apiVersion: example.com/v1
kind: MyApp
metadata:
  name: myapp-sample
spec:
  size: 3</pre></div><div class='content'></div><h2>Paso 3: Implementar el Controlador</h2>
<div class='content'><p>El controlador observa los recursos personalizados y asegura que se mantenga el estado deseado.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBteWFwcC1jb250cm9sbGVyLnB5CmZyb20ga3ViZXJuZXRlcyBpbXBvcnQgY2xpZW50LCBjb25maWcsIHdhdGNoCgpkZWYgbWFpbigpOgogICAgY29uZmlnLmxvYWRfa3ViZV9jb25maWcoKQogICAgdjEgPSBjbGllbnQuQ3VzdG9tT2JqZWN0c0FwaSgpCiAgICB3ID0gd2F0Y2guV2F0Y2goKQoKICAgIGZvciBldmVudCBpbiB3LnN0cmVhbSh2MS5saXN0X25hbWVzcGFjZWRfY3VzdG9tX29iamVjdCwgZ3JvdXA9ImV4YW1wbGUuY29tIiwgdmVyc2lvbj0idjEiLCBuYW1lc3BhY2U9ImRlZmF1bHQiLCBwbHVyYWw9Im15YXBwcyIpOgogICAgICAgIHByaW50KCJFdmVudG86ICVzICVzIiAlIChldmVudFsndHlwZSddLCBldmVudFsnb2JqZWN0J11bJ21ldGFkYXRhJ11bJ25hbWUnXSkpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgbWFpbigp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># myapp-controller.py
from kubernetes import client, config, watch

def main():
    config.load_kube_config()
    v1 = client.CustomObjectsApi()
    w = watch.Watch()

    for event in w.stream(v1.list_namespaced_custom_object, group=&quot;example.com&quot;, version=&quot;v1&quot;, namespace=&quot;default&quot;, plural=&quot;myapps&quot;):
        print(&quot;Evento: %s %s&quot; % (event['type'], event['object']['metadata']['name']))

if __name__ == '__main__':
    main()</pre></div><div class='content'></div><h1>Patrones Avanzados de Operadores</h1>
<div class='content'><ul>
<li><strong>Aplicaciones con Estado</strong>: Los operadores pueden gestionar aplicaciones con estado como bases de datos, asegurando la consistencia y disponibilidad de los datos.</li>
<li><strong>Respaldo y Restauración</strong>: Los operadores pueden automatizar los procesos de respaldo y restauración para aplicaciones.</li>
<li><strong>Escalado</strong>: Los operadores pueden gestionar el escalado de aplicaciones basado en métricas personalizadas.</li>
</ul>
</div><h1>Marcos de Trabajo para Operadores</h1>
<div class='content'><p>Varios marcos pueden ayudarte a construir operadores de manera más eficiente:</p>
<ul>
<li><strong>Operator SDK</strong>: Un marco que proporciona herramientas para construir, probar y empaquetar operadores.</li>
<li><strong>Kubebuilder</strong>: Un marco para construir APIs de Kubernetes usando CRDs.</li>
</ul>
</div><h1>Ejemplo: Usando Operator SDK</h1>
<h2>Paso 1: Instalar Operator SDK</h2>
<div class='content'><p>Sigue las instrucciones de instalación de la <a href="https://sdk.operatorframework.io/docs/installation/">documentación de Operator SDK</a>.</p>
</div><h2>Paso 2: Crear un Nuevo Proyecto de Operador</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlcmF0b3Itc2RrIGluaXQgLS1kb21haW4gZXhhbXBsZS5jb20gLS1yZXBvIGdpdGh1Yi5jb20vZXhhbXBsZS9teWFwcC1vcGVyYXRvcg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>operator-sdk init --domain example.com --repo github.com/example/myapp-operator</pre></div><div class='content'></div><h2>Paso 3: Definir la API</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlcmF0b3Itc2RrIGNyZWF0ZSBhcGkgLS1ncm91cCBleGFtcGxlIC0tdmVyc2lvbiB2MSAtLWtpbmQgTXlBcHAgLS1yZXNvdXJjZSAtLWNvbnRyb2xsZXI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>operator-sdk create api --group example --version v1 --kind MyApp --resource --controller</pre></div><div class='content'></div><h2>Paso 4: Implementar la Lógica de Reconciliación</h2>
<div class='content'><p>Edita el archivo del controlador generado para implementar tu lógica de reconciliación.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gY29udHJvbGxlcnMvbXlhcHBfY29udHJvbGxlci5nbwpmdW5jIChyICpNeUFwcFJlY29uY2lsZXIpIFJlY29uY2lsZShjdHggY29udGV4dC5Db250ZXh0LCByZXEgY3RybC5SZXF1ZXN0KSAoY3RybC5SZXN1bHQsIGVycm9yKSB7CiAgICAvLyBPYnRlbmVyIGxhIGluc3RhbmNpYSBkZSBNeUFwcAogICAgbXlhcHAgOj0gJmV4YW1wbGV2MS5NeUFwcHt9CiAgICBlcnIgOj0gci5HZXQoY3R4LCByZXEuTmFtZXNwYWNlZE5hbWUsIG15YXBwKQogICAgaWYgZXJyICE9IG5pbCB7CiAgICAgICAgcmV0dXJuIGN0cmwuUmVzdWx0e30sIGNsaWVudC5JZ25vcmVOb3RGb3VuZChlcnIpCiAgICB9CgogICAgLy8gSW1wbGVtZW50YSB0dSBsw7NnaWNhIGRlIHJlY29uY2lsaWFjacOzbiBhcXXDrQoKICAgIHJldHVybiBjdHJsLlJlc3VsdHt9LCBuaWwKfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// controllers/myapp_controller.go
func (r *MyAppReconciler) Reconcile(ctx context.Context, req ctrl.Request) (ctrl.Result, error) {
    // Obtener la instancia de MyApp
    myapp := &amp;examplev1.MyApp{}
    err := r.Get(ctx, req.NamespacedName, myapp)
    if err != nil {
        return ctrl.Result{}, client.IgnoreNotFound(err)
    }

    // Implementa tu l&oacute;gica de reconciliaci&oacute;n aqu&iacute;

    return ctrl.Result{}, nil
}</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Los operadores son una forma poderosa de extender las capacidades de Kubernetes para gestionar aplicaciones complejas. Al definir recursos personalizados e implementar controladores, puedes automatizar la gestión de aplicaciones con estado, respaldos, escalado y más. Usar marcos como Operator SDK y Kubebuilder puede simplificar el proceso de desarrollo, permitiéndote enfocarte en la lógica de negocio de tu operador.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='custom-resource-definitions'>&#x25C4;Definiciones de Recursos Personalizados (CRDs)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Operadores en Kubernetes</a>
	</div>
	<div class='col-4 text-end'>
					<a href='helm-and-package-management'>Helm y Gestión de Paquetes &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
