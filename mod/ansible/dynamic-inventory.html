<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventario Dinámico en Ansible</title>

    <link rel="alternate" href="https://campusempresa.com/mod/ansible/dynamic-inventory" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/ansible/dynamic-inventory" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/ansible/dynamic-inventory" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/ansible/dynamic-inventory" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/ansible/dynamic-inventory" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='ansible-vault'>&#x25C4;Ansible Vault</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Inventario Dinámico en Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='ansible-plugins'>Plugins de Ansible &#x25BA;</a>
			</div>
</div>
<div class='content'><p>El Inventario Dinámico es una característica poderosa en Ansible que te permite gestionar y configurar hosts de manera dinámica, en lugar de depender de archivos de inventario estáticos. Este tema te guiará desde los conceptos básicos hasta el uso avanzado del inventario dinámico en Ansible.</p>
</div><h1>Introducción al Inventario Dinámico</h1>
<div class='content'><ul>
<li><strong>Definición</strong>: El Inventario Dinámico se refiere a la capacidad de obtener datos de inventario de fuentes externas, como proveedores de nube, bases de datos u otras APIs, en lugar de usar archivos estáticos.</li>
<li><strong>Casos de Uso</strong>: Ideal para entornos donde la infraestructura está cambiando constantemente, como entornos en la nube (AWS, Azure, GCP), o para despliegues a gran escala donde mantener un inventario estático es impráctico.</li>
</ul>
</div><h1>Configuración del Inventario Dinámico</h1>
<div class='content'></div><h2>Prerrequisitos</h2>
<div class='content'><ul>
<li>Comprensión básica de Ansible y del inventario estático.</li>
<li>Ansible instalado en tu máquina local.</li>
<li>Acceso a una fuente externa (por ejemplo, AWS, Azure) si planeas usarla para inventario dinámico.</li>
</ul>
</div><h2>Ejemplo Básico: Usando AWS EC2 como Inventario Dinámico</h2>
<div class='content'><ol>
<li>
<p><strong>Instalar Boto3 y el Plugin EC2 de Ansible</strong>:</p>
<pre><code class="language-bash">pip install boto3
ansible-galaxy collection install amazon.aws
</code></pre>
</li>
<li>
<p><strong>Configurar Credenciales de AWS</strong>:
Asegúrate de tener tus credenciales de AWS configuradas. Esto se puede hacer usando la CLI de AWS:</p>
<pre><code class="language-bash">aws configure
</code></pre>
</li>
<li>
<p><strong>Crear un Archivo de Configuración de Inventario</strong>:
Crea un archivo llamado <code>aws_ec2.yaml</code> con el siguiente contenido:</p>
<pre><code class="language-yaml">plugin: amazon.aws.aws_ec2
regions:
  - us-east-1
filters:
  instance-state-name: running
keyed_groups:
  - key: tags.Name
    prefix: tag
</code></pre>
</li>
<li>
<p><strong>Ejecutar Ansible con Inventario Dinámico</strong>:</p>
<pre><code class="language-bash">ansible-inventory -i aws_ec2.yaml --graph
</code></pre>
</li>
</ol>
</div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>plugin</strong>: Especifica el plugin a usar, en este caso, <code>amazon.aws.aws_ec2</code>.</li>
<li><strong>regions</strong>: Lista de regiones de AWS a consultar.</li>
<li><strong>filters</strong>: Filtros a aplicar al consultar instancias, como <code>instance-state-name: running</code>.</li>
<li><strong>keyed_groups</strong>: Agrupa instancias basadas en sus etiquetas.</li>
</ul>
</div><h1>Inventario Dinámico Avanzado</h1>
<div class='content'></div><h2>Usando Scripts Personalizados</h2>
<div class='content'><ul>
<li><strong>Scripts de Inventario Personalizados</strong>: Puedes escribir tus propios scripts para generar inventario dinámico. Estos scripts deben generar JSON que Ansible pueda entender.</li>
</ul>
<h4>Ejemplo: Script de Inventario Personalizado</h4>
<ol>
<li>
<p><strong>Crear un Script</strong>:</p>
<pre><code class="language-python">#!/usr/bin/env python3
import json

def get_inventory():
    inventory = {
        &quot;all&quot;: {
            &quot;hosts&quot;: [&quot;host1.example.com&quot;, &quot;host2.example.com&quot;],
            &quot;vars&quot;: {
                &quot;ansible_user&quot;: &quot;admin&quot;
            }
        },
        &quot;_meta&quot;: {
            &quot;hostvars&quot;: {
                &quot;host1.example.com&quot;: {
                    &quot;ansible_host&quot;: &quot;192.168.1.1&quot;
                },
                &quot;host2.example.com&quot;: {
                    &quot;ansible_host&quot;: &quot;192.168.1.2&quot;
                }
            }
        }
    }
    return inventory

if __name__ == &quot;__main__&quot;:
    print(json.dumps(get_inventory()))
</code></pre>
</li>
<li>
<p><strong>Hacer el Script Ejecutable</strong>:</p>
<pre><code class="language-bash">chmod +x custom_inventory.py
</code></pre>
</li>
<li>
<p><strong>Ejecutar Ansible con el Script Personalizado</strong>:</p>
<pre><code class="language-bash">ansible-inventory -i custom_inventory.py --graph
</code></pre>
</li>
</ol>
</div><h2>Usando Plugins de Inventario</h2>
<div class='content'><ul>
<li><strong>Plugins de Inventario</strong>: Ansible proporciona varios plugins integrados para inventario dinámico, como <code>azure_rm</code>, <code>gcp_compute</code>, y <code>openstack</code>.</li>
</ul>
<h4>Ejemplo: Usando el Plugin de Inventario de Azure</h4>
<ol>
<li>
<p><strong>Instalar la Colección de Azure</strong>:</p>
<pre><code class="language-bash">ansible-galaxy collection install azure.azcollection
</code></pre>
</li>
<li>
<p><strong>Crear un Archivo de Configuración de Inventario</strong>:</p>
<pre><code class="language-yaml">plugin: azure.azcollection.azure_rm
auth_source: auto
include_vm_resource_groups:
  - myResourceGroup
</code></pre>
</li>
<li>
<p><strong>Ejecutar Ansible con Inventario de Azure</strong>:</p>
<pre><code class="language-bash">ansible-inventory -i azure_rm.yaml --graph
</code></pre>
</li>
</ol>
</div><h1>Mejores Prácticas</h1>
<div class='content'><ul>
<li><strong>Seguridad</strong>: Asegúrate de que tus scripts de inventario dinámico y archivos de configuración no expongan información sensible.</li>
<li><strong>Rendimiento</strong>: Optimiza tus scripts de inventario para minimizar llamadas a la API y reducir la latencia.</li>
<li><strong>Pruebas</strong>: Prueba regularmente tu configuración de inventario dinámico para asegurarte de que funciona como se espera, especialmente después de cambios en tu infraestructura.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El Inventario Dinámico en Ansible proporciona una forma flexible y poderosa de gestionar hosts y entornos que están cambiando constantemente. Al aprovechar fuentes externas y scripts personalizados, puedes mantener un inventario actualizado sin intervención manual. Ya sea que uses proveedores de nube como AWS, Azure, o escribas tus propios scripts, el inventario dinámico puede simplificar significativamente tus flujos de trabajo en Ansible.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='ansible-vault'>&#x25C4;Ansible Vault</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Inventario Dinámico en Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='ansible-plugins'>Plugins de Ansible &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
