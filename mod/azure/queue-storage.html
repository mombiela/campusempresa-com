<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Almacenamiento de Colas en Azure</title>

    <link rel="alternate" href="https://campusempresa.com/mod/azure/queue-storage" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/azure/queue-storage" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/azure/queue-storage" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/azure/queue-storage" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/azure/queue-storage" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='table-storage'>&#x25C4;Almacenamiento de Tablas</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Almacenamiento de Colas en Azure</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-and-securing-storage'>Gestión y Seguridad del Almacenamiento &#x25BA;</a>
			</div>
</div>
<div class='content'><p>El Almacenamiento de Colas de Azure es un servicio para almacenar grandes cantidades de mensajes que pueden ser accedidos desde cualquier parte del mundo mediante llamadas autenticadas usando HTTP o HTTPS. Este tema te guiará desde los conceptos básicos hasta los avanzados del Almacenamiento de Colas de Azure.</p>
</div><h1>Introducción al Almacenamiento de Colas de Azure</h1>
<div class='content'><p>El Almacenamiento de Colas de Azure está diseñado para habilitar la comunicación entre diferentes componentes de una aplicación en la nube. Te permite almacenar y recuperar mensajes, asegurando que tu aplicación pueda escalar y permanecer receptiva.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Cola</strong>: Una cola contiene un conjunto de mensajes. Cada mensaje puede tener hasta 64 KB de tamaño.</li>
<li><strong>Mensaje</strong>: Un mensaje es el dato que se almacena en una cola. Los mensajes son típicamente texto pero pueden ser cualquier tipo de dato.</li>
<li><strong>Tiempo de Visibilidad</strong>: El período durante el cual un mensaje es invisible para otros consumidores después de ser recuperado.</li>
<li><strong>Mensajes Tóxicos</strong>: Mensajes que no pueden ser procesados exitosamente después de múltiples intentos.</li>
</ul>
</div><h1>Configuración del Almacenamiento de Colas de Azure</h1>
<div class='content'></div><h2>Requisitos Previos</h2>
<div class='content'><ul>
<li>Una cuenta de Azure. Si no tienes una, puedes crear una cuenta gratuita en <a href="https://azure.microsoft.com/free/">Azure Free Account</a>.</li>
</ul>
</div><h2>Creación de una Cuenta de Almacenamiento de Colas</h2>
<div class='content'><ol>
<li>
<p><strong>Inicia sesión en el Portal de Azure</strong>.</p>
</li>
<li>
<p><strong>Crea una Cuenta de Almacenamiento</strong>:</p>
<ul>
<li>Navega a &quot;Cuentas de almacenamiento&quot; y haz clic en &quot;Crear&quot;.</li>
<li>Rellena los detalles necesarios como Suscripción, Grupo de Recursos, Nombre de la Cuenta de Almacenamiento y Ubicación.</li>
<li>Elige el nivel de rendimiento &quot;Estándar&quot; y &quot;StorageV2 (uso general v2)&quot; para el tipo de cuenta.</li>
<li>Haz clic en &quot;Revisar + crear&quot; y luego en &quot;Crear&quot;.</li>
</ul>
</li>
<li>
<p><strong>Crea una Cola</strong>:</p>
<ul>
<li>Ve a tu cuenta de almacenamiento recién creada.</li>
<li>Bajo &quot;Almacenamiento de datos&quot;, selecciona &quot;Colas&quot;.</li>
<li>Haz clic en &quot;+ Cola&quot; y proporciona un nombre para tu cola.</li>
<li>Haz clic en &quot;OK&quot; para crear la cola.</li>
</ul>
</li>
</ol>
</div><h1>Trabajando con el Almacenamiento de Colas de Azure</h1>
<div class='content'></div><h2>Añadiendo Mensajes a una Cola</h2>
<div class='content'><p>Para añadir mensajes a una cola, puedes usar los SDKs de Almacenamiento de Azure o la API REST. A continuación se muestra un ejemplo usando el SDK de Azure para Python.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBhenVyZS5zdG9yYWdlLnF1ZXVlIGltcG9ydCBRdWV1ZVNlcnZpY2VDbGllbnQKCiMgQ3JlYXIgdW4gUXVldWVTZXJ2aWNlQ2xpZW50CnF1ZXVlX3NlcnZpY2VfY2xpZW50ID0gUXVldWVTZXJ2aWNlQ2xpZW50LmZyb21fY29ubmVjdGlvbl9zdHJpbmcoInR1X2NhZGVuYV9kZV9jb25leGnDs24iKQoKIyBPYnRlbmVyIHVuIFF1ZXVlQ2xpZW50CnF1ZXVlX2NsaWVudCA9IHF1ZXVlX3NlcnZpY2VfY2xpZW50LmdldF9xdWV1ZV9jbGllbnQoInR1X25vbWJyZV9kZV9jb2xhIikKCiMgQcOxYWRpciB1biBtZW5zYWplIGEgbGEgY29sYQpxdWV1ZV9jbGllbnQuc2VuZF9tZXNzYWdlKCLCoUhvbGEsIEFsbWFjZW5hbWllbnRvIGRlIENvbGFzIGRlIEF6dXJlISIp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from azure.storage.queue import QueueServiceClient

# Crear un QueueServiceClient
queue_service_client = QueueServiceClient.from_connection_string(&quot;tu_cadena_de_conexi&oacute;n&quot;)

# Obtener un QueueClient
queue_client = queue_service_client.get_queue_client(&quot;tu_nombre_de_cola&quot;)

# A&ntilde;adir un mensaje a la cola
queue_client.send_message(&quot;&iexcl;Hola, Almacenamiento de Colas de Azure!&quot;)</pre></div><div class='content'></div><h2>Recuperando Mensajes de una Cola</h2>
<div class='content'><p>Para recuperar mensajes, puedes usar el método <code>receive_messages</code>. Aquí hay un ejemplo en Python:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZWN1cGVyYXIgbWVuc2FqZXMgZGUgbGEgY29sYQptZXNzYWdlcyA9IHF1ZXVlX2NsaWVudC5yZWNlaXZlX21lc3NhZ2VzKCkKCmZvciBtZXNzYWdlIGluIG1lc3NhZ2VzOgogICAgcHJpbnQoZiJNZW5zYWplOiB7bWVzc2FnZS5jb250ZW50fSIpCiAgICAjIEVsaW1pbmFyIGVsIG1lbnNhamUgZGVzcHXDqXMgZGUgcHJvY2VzYXJsbwogICAgcXVldWVfY2xpZW50LmRlbGV0ZV9tZXNzYWdlKG1lc3NhZ2Up"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Recuperar mensajes de la cola
messages = queue_client.receive_messages()

for message in messages:
    print(f&quot;Mensaje: {message.content}&quot;)
    # Eliminar el mensaje despu&eacute;s de procesarlo
    queue_client.delete_message(message)</pre></div><div class='content'></div><h2>Manejo del Tiempo de Visibilidad</h2>
<div class='content'><p>Cuando un mensaje es recuperado, se vuelve invisible para otros consumidores por un período especificado (tiempo de visibilidad). Si el mensaje no es eliminado dentro de este período, se vuelve visible nuevamente.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBSZWN1cGVyYXIgdW4gbWVuc2FqZSBjb24gdW4gdGllbXBvIGRlIHZpc2liaWxpZGFkIGRlIDMwIHNlZ3VuZG9zCm1lc3NhZ2VzID0gcXVldWVfY2xpZW50LnJlY2VpdmVfbWVzc2FnZXModmlzaWJpbGl0eV90aW1lb3V0PTMwKQoKZm9yIG1lc3NhZ2UgaW4gbWVzc2FnZXM6CiAgICBwcmludChmIk1lbnNhamU6IHttZXNzYWdlLmNvbnRlbnR9IikKICAgICMgUHJvY2VzYXIgZWwgbWVuc2FqZQogICAgIyAuLi4KICAgICMgRWxpbWluYXIgZWwgbWVuc2FqZSBkZXNwdcOpcyBkZSBwcm9jZXNhcmxvCiAgICBxdWV1ZV9jbGllbnQuZGVsZXRlX21lc3NhZ2UobWVzc2FnZSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Recuperar un mensaje con un tiempo de visibilidad de 30 segundos
messages = queue_client.receive_messages(visibility_timeout=30)

for message in messages:
    print(f&quot;Mensaje: {message.content}&quot;)
    # Procesar el mensaje
    # ...
    # Eliminar el mensaje despu&eacute;s de procesarlo
    queue_client.delete_message(message)</pre></div><div class='content'></div><h1>Conceptos Avanzados</h1>
<div class='content'></div><h2>TTL (Tiempo de Vida) del Mensaje</h2>
<div class='content'><p>Los mensajes en una cola pueden tener un TTL, que especifica cuánto tiempo debe permanecer el mensaje en la cola antes de ser eliminado automáticamente.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbnZpYXIgdW4gbWVuc2FqZSBjb24gdW4gVFRMIGRlIDYwIHNlZ3VuZG9zCnF1ZXVlX2NsaWVudC5zZW5kX21lc3NhZ2UoIkVzdGUgbWVuc2FqZSBleHBpcmFyw6EgZW4gNjAgc2VndW5kb3MiLCB0aW1lX3RvX2xpdmU9NjAp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Enviar un mensaje con un TTL de 60 segundos
queue_client.send_message(&quot;Este mensaje expirar&aacute; en 60 segundos&quot;, time_to_live=60)</pre></div><div class='content'></div><h2>Manejo de Mensajes Tóxicos</h2>
<div class='content'><p>Los mensajes que no pueden ser procesados exitosamente después de múltiples intentos se conocen como mensajes tóxicos. Puedes implementar lógica para mover estos mensajes a una cola separada para un análisis posterior.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFamVtcGxvIGRlIGzDs2dpY2EgcGFyYSBtYW5lamFyIG1lbnNhamVzIHTDs3hpY29zCm1heF9hdHRlbXB0cyA9IDUKCmZvciBtZXNzYWdlIGluIG1lc3NhZ2VzOgogICAgaWYgbWVzc2FnZS5kZXF1ZXVlX2NvdW50ID4gbWF4X2F0dGVtcHRzOgogICAgICAgICMgTW92ZXIgYSBsYSBjb2xhIGRlIG1lbnNhamVzIHTDs3hpY29zCiAgICAgICAgcG9pc29uX3F1ZXVlX2NsaWVudC5zZW5kX21lc3NhZ2UobWVzc2FnZS5jb250ZW50KQogICAgICAgIHF1ZXVlX2NsaWVudC5kZWxldGVfbWVzc2FnZShtZXNzYWdlKQogICAgZWxzZToKICAgICAgICAjIFByb2Nlc2FyIGVsIG1lbnNhamUKICAgICAgICAjIC4uLgogICAgICAgIHF1ZXVlX2NsaWVudC5kZWxldGVfbWVzc2FnZShtZXNzYWdlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Ejemplo de l&oacute;gica para manejar mensajes t&oacute;xicos
max_attempts = 5

for message in messages:
    if message.dequeue_count &gt; max_attempts:
        # Mover a la cola de mensajes t&oacute;xicos
        poison_queue_client.send_message(message.content)
        queue_client.delete_message(message)
    else:
        # Procesar el mensaje
        # ...
        queue_client.delete_message(message)</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>El Almacenamiento de Colas de Azure es un servicio poderoso para desacoplar componentes de una aplicación en la nube y asegurar la entrega confiable de mensajes. Al entender los conceptos básicos y las características avanzadas, puedes usar efectivamente el Almacenamiento de Colas de Azure para construir aplicaciones escalables y resilientes.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='table-storage'>&#x25C4;Almacenamiento de Tablas</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Almacenamiento de Colas en Azure</a>
	</div>
	<div class='col-4 text-end'>
					<a href='managing-and-securing-storage'>Gestión y Seguridad del Almacenamiento &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
