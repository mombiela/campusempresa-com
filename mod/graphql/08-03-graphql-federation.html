<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Federación de GraphQL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/graphql/08-03-graphql-federation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/graphql/08-03-graphql-federation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/graphql/08-03-graphql-federation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/graphql/08-03-graphql-federation" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/graphql/08-03-graphql-federation" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-graphql-in-microservices' title="GraphQL en Microservicios">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Federación de GraphQL</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-case-studies' title="Estudios de Caso">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La federación de GraphQL es una técnica avanzada que permite dividir un esquema de GraphQL en múltiples servicios independientes, cada uno responsable de una parte del esquema. Esto facilita la escalabilidad y la modularidad en aplicaciones grandes y complejas.</p>
</div><h1>¿Qué es la Federación de GraphQL?</h1>
<div class='content'><p>La federación de GraphQL permite que múltiples servicios colaboren para resolver una única consulta GraphQL. En lugar de tener un único servidor monolítico que maneje todas las resoluciones, la federación permite que diferentes servicios manejen diferentes partes del esquema.</p>
</div><h2>Beneficios de la Federación de GraphQL</h2>
<div class='content'><ul>
<li><strong>Escalabilidad</strong>: Permite escalar diferentes partes del esquema de manera independiente.</li>
<li><strong>Modularidad</strong>: Facilita la división del código en módulos más manejables.</li>
<li><strong>Desarrollo Independiente</strong>: Equipos diferentes pueden trabajar en diferentes servicios sin interferir entre sí.</li>
<li><strong>Despliegue Independiente</strong>: Permite desplegar servicios de manera independiente, reduciendo el riesgo de errores en el despliegue.</li>
</ul>
</div><h1>Conceptos Clave</h1>
<div class='content'></div><h2>Gateway</h2>
<div class='content'><p>El Gateway es el punto de entrada único para todas las consultas GraphQL. Se encarga de delegar las resoluciones a los servicios correspondientes.</p>
</div><h2>Servicios Federados</h2>
<div class='content'><p>Son los servicios individuales que manejan partes específicas del esquema. Cada servicio define su propio esquema y resolvers.</p>
</div><h2>Extensiones de Esquema</h2>
<div class='content'><p>Permiten que un servicio extienda tipos definidos en otro servicio. Esto es crucial para la colaboración entre servicios.</p>
</div><h1>Configuración de un Gateway Federado</h1>
<div class='content'></div><h2>Paso 1: Configuración del Gateway</h2>
<div class='content'><p>Primero, configuramos el Gateway utilizando Apollo Server.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBBcG9sbG9TZXJ2ZXIgfSA9IHJlcXVpcmUoJ2Fwb2xsby1zZXJ2ZXInKTsKY29uc3QgeyBBcG9sbG9HYXRld2F5IH0gPSByZXF1aXJlKCdAYXBvbGxvL2dhdGV3YXknKTsKCmNvbnN0IGdhdGV3YXkgPSBuZXcgQXBvbGxvR2F0ZXdheSh7CiAgc2VydmljZUxpc3Q6IFsKICAgIHsgbmFtZTogJ3VzZXJzJywgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0MDAxL2dyYXBocWwnIH0sCiAgICB7IG5hbWU6ICdwcm9kdWN0cycsIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6NDAwMi9ncmFwaHFsJyB9LAogIF0sCn0pOwoKY29uc3Qgc2VydmVyID0gbmV3IEFwb2xsb1NlcnZlcih7IGdhdGV3YXkgfSk7CgpzZXJ2ZXIubGlzdGVuKCkudGhlbigoeyB1cmwgfSkgPT4gewogIGNvbnNvbGUubG9nKGDwn5qAIEdhdGV3YXkgcmVhZHkgYXQgJHt1cmx9YCk7Cn0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { ApolloServer } = require('apollo-server');
const { ApolloGateway } = require('@apollo/gateway');

const gateway = new ApolloGateway({
  serviceList: [
    { name: 'users', url: 'http://localhost:4001/graphql' },
    { name: 'products', url: 'http://localhost:4002/graphql' },
  ],
});

const server = new ApolloServer({ gateway });

server.listen().then(({ url }) =&gt; {
  console.log(`🚀 Gateway ready at ${url}`);
});</pre></div><div class='content'></div><h2>Paso 2: Configuración de Servicios Federados</h2>
<div class='content'><p>Cada servicio federado debe definir su propio esquema y resolvers. Aquí hay un ejemplo de un servicio de usuarios.</p>
<h4>Esquema del Servicio de Usuarios</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyB1c2Vycy9zY2hlbWEuZ3JhcGhxbAp0eXBlIFVzZXIgQGtleShmaWVsZHM6ICJpZCIpIHsKICBpZDogSUQhCiAgbmFtZTogU3RyaW5nIQogIGVtYWlsOiBTdHJpbmchCn0KCmV4dGVuZCB0eXBlIFF1ZXJ5IHsKICB1c2VyKGlkOiBJRCEpOiBVc2VyCn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># users/schema.graphql
type User @key(fields: &quot;id&quot;) {
  id: ID!
  name: String!
  email: String!
}

extend type Query {
  user(id: ID!): User
}</pre></div><div class='content'><h4>Resolvers del Servicio de Usuarios</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlcnMvaW5kZXguanMKY29uc3QgeyBBcG9sbG9TZXJ2ZXIsIGdxbCB9ID0gcmVxdWlyZSgnYXBvbGxvLXNlcnZlcicpOwpjb25zdCB7IGJ1aWxkRmVkZXJhdGVkU2NoZW1hIH0gPSByZXF1aXJlKCdAYXBvbGxvL2ZlZGVyYXRpb24nKTsKCmNvbnN0IHR5cGVEZWZzID0gZ3FsYAogIHR5cGUgVXNlciBAa2V5KGZpZWxkczogImlkIikgewogICAgaWQ6IElEIQogICAgbmFtZTogU3RyaW5nIQogICAgZW1haWw6IFN0cmluZyEKICB9CgogIGV4dGVuZCB0eXBlIFF1ZXJ5IHsKICAgIHVzZXIoaWQ6IElEISk6IFVzZXIKICB9CmA7Cgpjb25zdCByZXNvbHZlcnMgPSB7CiAgUXVlcnk6IHsKICAgIHVzZXIoXywgeyBpZCB9KSB7CiAgICAgIHJldHVybiB1c2Vycy5maW5kKHVzZXIgPT4gdXNlci5pZCA9PT0gaWQpOwogICAgfSwKICB9LAogIFVzZXI6IHsKICAgIF9fcmVzb2x2ZVJlZmVyZW5jZSh1c2VyKSB7CiAgICAgIHJldHVybiB1c2Vycy5maW5kKHUgPT4gdS5pZCA9PT0gdXNlci5pZCk7CiAgICB9LAogIH0sCn07Cgpjb25zdCBzZXJ2ZXIgPSBuZXcgQXBvbGxvU2VydmVyKHsKICBzY2hlbWE6IGJ1aWxkRmVkZXJhdGVkU2NoZW1hKFt7IHR5cGVEZWZzLCByZXNvbHZlcnMgfV0pLAp9KTsKCnNlcnZlci5saXN0ZW4oeyBwb3J0OiA0MDAxIH0pLnRoZW4oKHsgdXJsIH0pID0+IHsKICBjb25zb2xlLmxvZyhg8J+agCBVc2VycyBzZXJ2aWNlIHJlYWR5IGF0ICR7dXJsfWApOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// users/index.js
const { ApolloServer, gql } = require('apollo-server');
const { buildFederatedSchema } = require('@apollo/federation');

const typeDefs = gql`
  type User @key(fields: &quot;id&quot;) {
    id: ID!
    name: String!
    email: String!
  }

  extend type Query {
    user(id: ID!): User
  }
`;

const resolvers = {
  Query: {
    user(_, { id }) {
      return users.find(user =&gt; user.id === id);
    },
  },
  User: {
    __resolveReference(user) {
      return users.find(u =&gt; u.id === user.id);
    },
  },
};

const server = new ApolloServer({
  schema: buildFederatedSchema([{ typeDefs, resolvers }]),
});

server.listen({ port: 4001 }).then(({ url }) =&gt; {
  console.log(`🚀 Users service ready at ${url}`);
});</pre></div><div class='content'></div><h2>Paso 3: Extender Tipos en Otros Servicios</h2>
<div class='content'><p>Un servicio puede extender tipos definidos en otro servicio. Aquí hay un ejemplo de un servicio de productos que extiende el tipo <code>User</code>.</p>
<h4>Esquema del Servicio de Productos</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBwcm9kdWN0cy9zY2hlbWEuZ3JhcGhxbApleHRlbmQgdHlwZSBVc2VyIEBrZXkoZmllbGRzOiAiaWQiKSB7CiAgaWQ6IElEISBAZXh0ZXJuYWwKICBwcm9kdWN0czogW1Byb2R1Y3RdCn0KCnR5cGUgUHJvZHVjdCB7CiAgaWQ6IElEIQogIG5hbWU6IFN0cmluZyEKICBwcmljZTogRmxvYXQhCn0KCmV4dGVuZCB0eXBlIFF1ZXJ5IHsKICBwcm9kdWN0KGlkOiBJRCEpOiBQcm9kdWN0Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># products/schema.graphql
extend type User @key(fields: &quot;id&quot;) {
  id: ID! @external
  products: [Product]
}

type Product {
  id: ID!
  name: String!
  price: Float!
}

extend type Query {
  product(id: ID!): Product
}</pre></div><div class='content'><h4>Resolvers del Servicio de Productos</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gcHJvZHVjdHMvaW5kZXguanMKY29uc3QgeyBBcG9sbG9TZXJ2ZXIsIGdxbCB9ID0gcmVxdWlyZSgnYXBvbGxvLXNlcnZlcicpOwpjb25zdCB7IGJ1aWxkRmVkZXJhdGVkU2NoZW1hIH0gPSByZXF1aXJlKCdAYXBvbGxvL2ZlZGVyYXRpb24nKTsKCmNvbnN0IHR5cGVEZWZzID0gZ3FsYAogIGV4dGVuZCB0eXBlIFVzZXIgQGtleShmaWVsZHM6ICJpZCIpIHsKICAgIGlkOiBJRCEgQGV4dGVybmFsCiAgICBwcm9kdWN0czogW1Byb2R1Y3RdCiAgfQoKICB0eXBlIFByb2R1Y3QgewogICAgaWQ6IElEIQogICAgbmFtZTogU3RyaW5nIQogICAgcHJpY2U6IEZsb2F0IQogIH0KCiAgZXh0ZW5kIHR5cGUgUXVlcnkgewogICAgcHJvZHVjdChpZDogSUQhKTogUHJvZHVjdAogIH0KYDsKCmNvbnN0IHJlc29sdmVycyA9IHsKICBVc2VyOiB7CiAgICBwcm9kdWN0cyh1c2VyKSB7CiAgICAgIHJldHVybiBwcm9kdWN0cy5maWx0ZXIocHJvZHVjdCA9PiBwcm9kdWN0LnVzZXJJZCA9PT0gdXNlci5pZCk7CiAgICB9LAogIH0sCiAgUXVlcnk6IHsKICAgIHByb2R1Y3QoXywgeyBpZCB9KSB7CiAgICAgIHJldHVybiBwcm9kdWN0cy5maW5kKHByb2R1Y3QgPT4gcHJvZHVjdC5pZCA9PT0gaWQpOwogICAgfSwKICB9LAp9OwoKY29uc3Qgc2VydmVyID0gbmV3IEFwb2xsb1NlcnZlcih7CiAgc2NoZW1hOiBidWlsZEZlZGVyYXRlZFNjaGVtYShbeyB0eXBlRGVmcywgcmVzb2x2ZXJzIH1dKSwKfSk7CgpzZXJ2ZXIubGlzdGVuKHsgcG9ydDogNDAwMiB9KS50aGVuKCh7IHVybCB9KSA9PiB7CiAgY29uc29sZS5sb2coYPCfmoAgUHJvZHVjdHMgc2VydmljZSByZWFkeSBhdCAke3VybH1gKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// products/index.js
const { ApolloServer, gql } = require('apollo-server');
const { buildFederatedSchema } = require('@apollo/federation');

const typeDefs = gql`
  extend type User @key(fields: &quot;id&quot;) {
    id: ID! @external
    products: [Product]
  }

  type Product {
    id: ID!
    name: String!
    price: Float!
  }

  extend type Query {
    product(id: ID!): Product
  }
`;

const resolvers = {
  User: {
    products(user) {
      return products.filter(product =&gt; product.userId === user.id);
    },
  },
  Query: {
    product(_, { id }) {
      return products.find(product =&gt; product.id === id);
    },
  },
};

const server = new ApolloServer({
  schema: buildFederatedSchema([{ typeDefs, resolvers }]),
});

server.listen({ port: 4002 }).then(({ url }) =&gt; {
  console.log(`🚀 Products service ready at ${url}`);
});</pre></div><div class='content'></div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><ol>
<li>Configura un Gateway federado que incluya dos servicios: <code>orders</code> y <code>customers</code>.</li>
<li>Define un esquema y resolvers para cada servicio.</li>
<li>Asegúrate de que el servicio <code>orders</code> pueda extender el tipo <code>Customer</code> definido en el servicio <code>customers</code>.</li>
</ol>
</div><h2>Solución</h2>
<div class='content'><h4>Esquema del Servicio de Clientes</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBjdXN0b21lcnMvc2NoZW1hLmdyYXBocWwKdHlwZSBDdXN0b21lciBAa2V5KGZpZWxkczogImlkIikgewogIGlkOiBJRCEKICBuYW1lOiBTdHJpbmchCiAgZW1haWw6IFN0cmluZyEKfQoKZXh0ZW5kIHR5cGUgUXVlcnkgewogIGN1c3RvbWVyKGlkOiBJRCEpOiBDdXN0b21lcgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># customers/schema.graphql
type Customer @key(fields: &quot;id&quot;) {
  id: ID!
  name: String!
  email: String!
}

extend type Query {
  customer(id: ID!): Customer
}</pre></div><div class='content'><h4>Resolvers del Servicio de Clientes</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gY3VzdG9tZXJzL2luZGV4LmpzCmNvbnN0IHsgQXBvbGxvU2VydmVyLCBncWwgfSA9IHJlcXVpcmUoJ2Fwb2xsby1zZXJ2ZXInKTsKY29uc3QgeyBidWlsZEZlZGVyYXRlZFNjaGVtYSB9ID0gcmVxdWlyZSgnQGFwb2xsby9mZWRlcmF0aW9uJyk7Cgpjb25zdCB0eXBlRGVmcyA9IGdxbGAKICB0eXBlIEN1c3RvbWVyIEBrZXkoZmllbGRzOiAiaWQiKSB7CiAgICBpZDogSUQhCiAgICBuYW1lOiBTdHJpbmchCiAgICBlbWFpbDogU3RyaW5nIQogIH0KCiAgZXh0ZW5kIHR5cGUgUXVlcnkgewogICAgY3VzdG9tZXIoaWQ6IElEISk6IEN1c3RvbWVyCiAgfQpgOwoKY29uc3QgcmVzb2x2ZXJzID0gewogIFF1ZXJ5OiB7CiAgICBjdXN0b21lcihfLCB7IGlkIH0pIHsKICAgICAgcmV0dXJuIGN1c3RvbWVycy5maW5kKGN1c3RvbWVyID0+IGN1c3RvbWVyLmlkID09PSBpZCk7CiAgICB9LAogIH0sCiAgQ3VzdG9tZXI6IHsKICAgIF9fcmVzb2x2ZVJlZmVyZW5jZShjdXN0b21lcikgewogICAgICByZXR1cm4gY3VzdG9tZXJzLmZpbmQoYyA9PiBjLmlkID09PSBjdXN0b21lci5pZCk7CiAgICB9LAogIH0sCn07Cgpjb25zdCBzZXJ2ZXIgPSBuZXcgQXBvbGxvU2VydmVyKHsKICBzY2hlbWE6IGJ1aWxkRmVkZXJhdGVkU2NoZW1hKFt7IHR5cGVEZWZzLCByZXNvbHZlcnMgfV0pLAp9KTsKCnNlcnZlci5saXN0ZW4oeyBwb3J0OiA0MDAzIH0pLnRoZW4oKHsgdXJsIH0pID0+IHsKICBjb25zb2xlLmxvZyhg8J+agCBDdXN0b21lcnMgc2VydmljZSByZWFkeSBhdCAke3VybH1gKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// customers/index.js
const { ApolloServer, gql } = require('apollo-server');
const { buildFederatedSchema } = require('@apollo/federation');

const typeDefs = gql`
  type Customer @key(fields: &quot;id&quot;) {
    id: ID!
    name: String!
    email: String!
  }

  extend type Query {
    customer(id: ID!): Customer
  }
`;

const resolvers = {
  Query: {
    customer(_, { id }) {
      return customers.find(customer =&gt; customer.id === id);
    },
  },
  Customer: {
    __resolveReference(customer) {
      return customers.find(c =&gt; c.id === customer.id);
    },
  },
};

const server = new ApolloServer({
  schema: buildFederatedSchema([{ typeDefs, resolvers }]),
});

server.listen({ port: 4003 }).then(({ url }) =&gt; {
  console.log(`🚀 Customers service ready at ${url}`);
});</pre></div><div class='content'><h4>Esquema del Servicio de Pedidos</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBvcmRlcnMvc2NoZW1hLmdyYXBocWwKZXh0ZW5kIHR5cGUgQ3VzdG9tZXIgQGtleShmaWVsZHM6ICJpZCIpIHsKICBpZDogSUQhIEBleHRlcm5hbAogIG9yZGVyczogW09yZGVyXQp9Cgp0eXBlIE9yZGVyIHsKICBpZDogSUQhCiAgcHJvZHVjdDogU3RyaW5nIQogIHF1YW50aXR5OiBJbnQhCn0KCmV4dGVuZCB0eXBlIFF1ZXJ5IHsKICBvcmRlcihpZDogSUQhKTogT3JkZXIKfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># orders/schema.graphql
extend type Customer @key(fields: &quot;id&quot;) {
  id: ID! @external
  orders: [Order]
}

type Order {
  id: ID!
  product: String!
  quantity: Int!
}

extend type Query {
  order(id: ID!): Order
}</pre></div><div class='content'><h4>Resolvers del Servicio de Pedidos</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gb3JkZXJzL2luZGV4LmpzCmNvbnN0IHsgQXBvbGxvU2VydmVyLCBncWwgfSA9IHJlcXVpcmUoJ2Fwb2xsby1zZXJ2ZXInKTsKY29uc3QgeyBidWlsZEZlZGVyYXRlZFNjaGVtYSB9ID0gcmVxdWlyZSgnQGFwb2xsby9mZWRlcmF0aW9uJyk7Cgpjb25zdCB0eXBlRGVmcyA9IGdxbGAKICBleHRlbmQgdHlwZSBDdXN0b21lciBAa2V5KGZpZWxkczogImlkIikgewogICAgaWQ6IElEISBAZXh0ZXJuYWwKICAgIG9yZGVyczogW09yZGVyXQogIH0KCiAgdHlwZSBPcmRlciB7CiAgICBpZDogSUQhCiAgICBwcm9kdWN0OiBTdHJpbmchCiAgICBxdWFudGl0eTogSW50IQogIH0KCiAgZXh0ZW5kIHR5cGUgUXVlcnkgewogICAgb3JkZXIoaWQ6IElEISk6IE9yZGVyCiAgfQpgOwoKY29uc3QgcmVzb2x2ZXJzID0gewogIEN1c3RvbWVyOiB7CiAgICBvcmRlcnMoY3VzdG9tZXIpIHsKICAgICAgcmV0dXJuIG9yZGVycy5maWx0ZXIob3JkZXIgPT4gb3JkZXIuY3VzdG9tZXJJZCA9PT0gY3VzdG9tZXIuaWQpOwogICAgfSwKICB9LAogIFF1ZXJ5OiB7CiAgICBvcmRlcihfLCB7IGlkIH0pIHsKICAgICAgcmV0dXJuIG9yZGVycy5maW5kKG9yZGVyID0+IG9yZGVyLmlkID09PSBpZCk7CiAgICB9LAogIH0sCn07Cgpjb25zdCBzZXJ2ZXIgPSBuZXcgQXBvbGxvU2VydmVyKHsKICBzY2hlbWE6IGJ1aWxkRmVkZXJhdGVkU2NoZW1hKFt7IHR5cGVEZWZzLCByZXNvbHZlcnMgfV0pLAp9KTsKCnNlcnZlci5saXN0ZW4oeyBwb3J0OiA0MDA0IH0pLnRoZW4oKHsgdXJsIH0pID0+IHsKICBjb25zb2xlLmxvZyhg8J+agCBPcmRlcnMgc2VydmljZSByZWFkeSBhdCAke3VybH1gKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// orders/index.js
const { ApolloServer, gql } = require('apollo-server');
const { buildFederatedSchema } = require('@apollo/federation');

const typeDefs = gql`
  extend type Customer @key(fields: &quot;id&quot;) {
    id: ID! @external
    orders: [Order]
  }

  type Order {
    id: ID!
    product: String!
    quantity: Int!
  }

  extend type Query {
    order(id: ID!): Order
  }
`;

const resolvers = {
  Customer: {
    orders(customer) {
      return orders.filter(order =&gt; order.customerId === customer.id);
    },
  },
  Query: {
    order(_, { id }) {
      return orders.find(order =&gt; order.id === id);
    },
  },
};

const server = new ApolloServer({
  schema: buildFederatedSchema([{ typeDefs, resolvers }]),
});

server.listen({ port: 4004 }).then(({ url }) =&gt; {
  console.log(`🚀 Orders service ready at ${url}`);
});</pre></div><div class='content'><h4>Configuración del Gateway</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBBcG9sbG9TZXJ2ZXIgfSA9IHJlcXVpcmUoJ2Fwb2xsby1zZXJ2ZXInKTsKY29uc3QgeyBBcG9sbG9HYXRld2F5IH0gPSByZXF1aXJlKCdAYXBvbGxvL2dhdGV3YXknKTsKCmNvbnN0IGdhdGV3YXkgPSBuZXcgQXBvbGxvR2F0ZXdheSh7CiAgc2VydmljZUxpc3Q6IFsKICAgIHsgbmFtZTogJ2N1c3RvbWVycycsIHVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6NDAwMy9ncmFwaHFsJyB9LAogICAgeyBuYW1lOiAnb3JkZXJzJywgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0MDA0L2dyYXBocWwnIH0sCiAgXSwKfSk7Cgpjb25zdCBzZXJ2ZXIgPSBuZXcgQXBvbGxvU2VydmVyKHsgZ2F0ZXdheSB9KTsKCnNlcnZlci5saXN0ZW4oKS50aGVuKCh7IHVybCB9KSA9PiB7CiAgY29uc29sZS5sb2coYPCfmoAgR2F0ZXdheSByZWFkeSBhdCAke3VybH1gKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { ApolloServer } = require('apollo-server');
const { ApolloGateway } = require('@apollo/gateway');

const gateway = new ApolloGateway({
  serviceList: [
    { name: 'customers', url: 'http://localhost:4003/graphql' },
    { name: 'orders', url: 'http://localhost:4004/graphql' },
  ],
});

const server = new ApolloServer({ gateway });

server.listen().then(({ url }) =&gt; {
  console.log(`🚀 Gateway ready at ${url}`);
});</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>La federación de GraphQL es una poderosa técnica para manejar esquemas grandes y complejos de manera modular y escalable. Al dividir el esquema en múltiples servicios independientes, se facilita el desarrollo, despliegue y mantenimiento de aplicaciones grandes. Con la práctica y la correcta implementación, la federación puede mejorar significativamente la eficiencia y la colaboración en equipos de desarrollo.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-graphql-in-microservices' title="GraphQL en Microservicios">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-case-studies' title="Estudios de Caso">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
