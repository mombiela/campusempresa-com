<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Acceso a Bases de Datos con REXX</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rexx/05-03-database-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rexx/05-03-database-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rexx/05-03-database-access" hreflang="en" />
    
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.ea63f62b9e.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "es";
  		var CATEGORY = "languages";
  		var MOD_NAME = "rexx";
  		var TEMA_NAME = "5-3";
  		var TYPE = "mod";
  		var PATH = "mod/rexx/05-03-database-access";
  		var IS_INDEX = false;
  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="module" src="/js/app.49d891d32f.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/rexx/05-03-database-access" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/rexx/05-03-database-access" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Mis cursos</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalizados             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="rexx">
		<a  href="#" class="text-secondary d-none" data-read-mod="rexx" data-read-unit="5-3" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar como leído
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="rexx" data-unread-unit="5-3" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar como no leído
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contenido del curso
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-02-creating-utilities' title="Creación de Utilidades REXX" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-02-creating-utilities' title="Creación de Utilidades REXX" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Acceso a Bases de Datos con REXX</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-04-web-programming' title="Programación Web con REXX" class="py-2 px-3 btn btn-primary"
				data-read-mod="rexx" data-read-unit="5-3">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-04-web-programming' title="Programación Web con REXX" class="py-2 px-3 btn btn-primary" 
				data-read-mod="rexx" data-read-unit="5-3">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos cómo interactuar con bases de datos utilizando REXX. Este conocimiento es crucial para desarrollar aplicaciones que requieran almacenamiento y recuperación de datos de manera eficiente.</p>
</div><h1>Objetivos del Módulo</h1>
<div class='content'><ul>
<li>Comprender los conceptos básicos de acceso a bases de datos.</li>
<li>Aprender a conectar REXX con una base de datos.</li>
<li>Ejecutar consultas SQL desde REXX.</li>
<li>Manipular datos (insertar, actualizar, eliminar) en una base de datos.</li>
<li>Manejar errores comunes en operaciones de bases de datos.</li>
</ul>
</div><h1>Contenido</h1>
<div class='content'><ol>
<li><a href="#conceptos-basicos-de-bases-de-datos">Conceptos Básicos de Bases de Datos</a></li>
<li><a href="#configuracion-del-entorno-para-acceso-a-bases-de-datos">Configuración del Entorno para Acceso a Bases de Datos</a></li>
<li><a href="#conexion-a-una-base-de-datos">Conexión a una Base de Datos</a></li>
<li><a href="#ejecutar-consultas-sql">Ejecutar Consultas SQL</a></li>
<li><a href="#manipulacion-de-datos">Manipulación de Datos</a></li>
<li><a href="#manejo-de-errores">Manejo de Errores</a></li>
<li><a href="#ejercicio-practico">Ejercicio Práctico</a></li>
<li><a href="#conclusion">Conclusión</a></li>
</ol>
</div><h1>Conceptos Básicos de Bases de Datos</h1>
<div class='content'><p>Antes de comenzar con la programación, es importante entender algunos conceptos básicos sobre bases de datos:</p>
<ul>
<li><strong>Base de Datos (BD):</strong> Colección organizada de datos que se pueden acceder, gestionar y actualizar.</li>
<li><strong>SQL (Structured Query Language):</strong> Lenguaje estándar para gestionar y manipular bases de datos.</li>
<li><strong>Tabla:</strong> Estructura dentro de una base de datos que organiza los datos en filas y columnas.</li>
<li><strong>Registro:</strong> Fila en una tabla que contiene datos específicos.</li>
<li><strong>Campo:</strong> Columna en una tabla que contiene un tipo específico de datos.</li>
</ul>
</div><h1>Configuración del Entorno para Acceso a Bases de Datos</h1>
<div class='content'><p>Para interactuar con una base de datos desde REXX, necesitamos configurar el entorno adecuadamente. Esto incluye instalar y configurar un controlador de base de datos compatible con REXX.</p>
</div><h2>Pasos de Configuración</h2>
<div class='content'><ol>
<li>
<p><strong>Instalar el Controlador de Base de Datos:</strong></p>
<ul>
<li>Dependiendo de la base de datos que estés utilizando (por ejemplo, DB2, MySQL, Oracle), necesitarás instalar el controlador correspondiente.</li>
<li>Asegúrate de que el controlador esté correctamente instalado y configurado en tu sistema.</li>
</ul>
</li>
<li>
<p><strong>Configurar el Archivo de Conexión:</strong></p>
<ul>
<li>Crea un archivo de configuración que contenga los detalles de la conexión a la base de datos, como el nombre del servidor, el nombre de la base de datos, el usuario y la contraseña.</li>
</ul>
</li>
</ol>
</div><h1>Conexión a una Base de Datos</h1>
<div class='content'><p>Para conectar REXX a una base de datos, utilizaremos una biblioteca específica que permita la conexión y ejecución de comandos SQL. A continuación, se muestra un ejemplo de cómo establecer una conexión:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogQ29uZXhpw7NuIGEgdW5hIGJhc2UgZGUgZGF0b3MgTXlTUUwgKi8KZGJfaG9zdCA9ICdsb2NhbGhvc3QnCmRiX3VzZXIgPSAndXN1YXJpbycKZGJfcGFzcyA9ICdjb250cmFzZcOxYScKZGJfbmFtZSA9ICdub21icmVfYmFzZV9kYXRvcycKCi8qIENhcmdhciBsYSBiaWJsaW90ZWNhIGRlIGNvbmV4acOzbiAqLwpjYWxsIHJ4ZnVuY2FkZCAnU1FMQ29ubmVjdCcsICdyeHNxbCcsICdTUUxDb25uZWN0JwoKLyogRXN0YWJsZWNlciBsYSBjb25leGnDs24gKi8KY2FsbCBTUUxDb25uZWN0IGRiX2hvc3QsIGRiX3VzZXIsIGRiX3Bhc3MsIGRiX25hbWUKCmlmIHJjID0gMCB0aGVuCiAgICBzYXkgJ0NvbmV4acOzbiBleGl0b3NhIGEgbGEgYmFzZSBkZSBkYXRvcycKZWxzZQogICAgc2F5ICdFcnJvciBhbCBjb25lY3RhciBhIGxhIGJhc2UgZGUgZGF0b3Mn"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Conexi&oacute;n a una base de datos MySQL */
db_host = 'localhost'
db_user = 'usuario'
db_pass = 'contrase&ntilde;a'
db_name = 'nombre_base_datos'

/* Cargar la biblioteca de conexi&oacute;n */
call rxfuncadd 'SQLConnect', 'rxsql', 'SQLConnect'

/* Establecer la conexi&oacute;n */
call SQLConnect db_host, db_user, db_pass, db_name

if rc = 0 then
    say 'Conexi&oacute;n exitosa a la base de datos'
else
    say 'Error al conectar a la base de datos'</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ul>
<li><strong>db_host, db_user, db_pass, db_name:</strong> Variables que almacenan los detalles de la conexión.</li>
<li><strong>rxfuncadd:</strong> Función que agrega una función externa (en este caso, <code>SQLConnect</code>) al entorno REXX.</li>
<li><strong>SQLConnect:</strong> Función que establece la conexión a la base de datos utilizando los detalles proporcionados.</li>
</ul>
</div><h1>Ejecutar Consultas SQL</h1>
<div class='content'><p>Una vez establecida la conexión, podemos ejecutar consultas SQL para recuperar datos de la base de datos. A continuación, se muestra un ejemplo de cómo ejecutar una consulta SELECT:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogRWplY3V0YXIgdW5hIGNvbnN1bHRhIFNFTEVDVCAqLwpxdWVyeSA9ICdTRUxFQ1QgKiBGUk9NIGVtcGxlYWRvcycKCi8qIENhcmdhciBsYSBiaWJsaW90ZWNhIGRlIGVqZWN1Y2nDs24gZGUgY29uc3VsdGFzICovCmNhbGwgcnhmdW5jYWRkICdTUUxFeGVjRGlyZWN0JywgJ3J4c3FsJywgJ1NRTEV4ZWNEaXJlY3QnCgovKiBFamVjdXRhciBsYSBjb25zdWx0YSAqLwpjYWxsIFNRTEV4ZWNEaXJlY3QgcXVlcnkKCmlmIHJjID0gMCB0aGVuIGRvCiAgICAvKiBQcm9jZXNhciBsb3MgcmVzdWx0YWRvcyAqLwogICAgZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgICAgICBzYXkgJ0lEOicgU1FMR2V0RGF0YSgxKSAnTm9tYnJlOicgU1FMR2V0RGF0YSgyKSAnQXBlbGxpZG86JyBTUUxHZXREYXRhKDMpCiAgICBlbmQKZW5kCmVsc2UKICAgIHNheSAnRXJyb3IgYWwgZWplY3V0YXIgbGEgY29uc3VsdGEn"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Ejecutar una consulta SELECT */
query = 'SELECT * FROM empleados'

/* Cargar la biblioteca de ejecuci&oacute;n de consultas */
call rxfuncadd 'SQLExecDirect', 'rxsql', 'SQLExecDirect'

/* Ejecutar la consulta */
call SQLExecDirect query

if rc = 0 then do
    /* Procesar los resultados */
    do while SQLFetch() = 0
        say 'ID:' SQLGetData(1) 'Nombre:' SQLGetData(2) 'Apellido:' SQLGetData(3)
    end
end
else
    say 'Error al ejecutar la consulta'</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ul>
<li><strong>query:</strong> Variable que almacena la consulta SQL.</li>
<li><strong>SQLExecDirect:</strong> Función que ejecuta la consulta SQL.</li>
<li><strong>SQLFetch:</strong> Función que recupera la siguiente fila de resultados.</li>
<li><strong>SQLGetData:</strong> Función que obtiene los datos de una columna específica en la fila actual.</li>
</ul>
</div><h1>Manipulación de Datos</h1>
<div class='content'><p>Además de recuperar datos, también podemos insertar, actualizar y eliminar datos en la base de datos. A continuación, se muestra un ejemplo de cómo insertar un nuevo registro:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogSW5zZXJ0YXIgdW4gbnVldm8gcmVnaXN0cm8gKi8KaW5zZXJ0X3F1ZXJ5ID0gIklOU0VSVCBJTlRPIGVtcGxlYWRvcyAoaWQsIG5vbWJyZSwgYXBlbGxpZG8pIFZBTFVFUyAoNCwgJ0p1YW4nLCAnUMOpcmV6JykiCgovKiBFamVjdXRhciBsYSBjb25zdWx0YSBkZSBpbnNlcmNpw7NuICovCmNhbGwgU1FMRXhlY0RpcmVjdCBpbnNlcnRfcXVlcnkKCmlmIHJjID0gMCB0aGVuCiAgICBzYXkgJ1JlZ2lzdHJvIGluc2VydGFkbyBleGl0b3NhbWVudGUnCmVsc2UKICAgIHNheSAnRXJyb3IgYWwgaW5zZXJ0YXIgZWwgcmVnaXN0cm8n"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Insertar un nuevo registro */
insert_query = &quot;INSERT INTO empleados (id, nombre, apellido) VALUES (4, 'Juan', 'P&eacute;rez')&quot;

/* Ejecutar la consulta de inserci&oacute;n */
call SQLExecDirect insert_query

if rc = 0 then
    say 'Registro insertado exitosamente'
else
    say 'Error al insertar el registro'</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ul>
<li><strong>insert_query:</strong> Variable que almacena la consulta SQL de inserción.</li>
<li><strong>SQLExecDirect:</strong> Función que ejecuta la consulta SQL.</li>
</ul>
</div><h1>Manejo de Errores</h1>
<div class='content'><p>Es importante manejar los errores que puedan ocurrir durante las operaciones de base de datos. A continuación, se muestra un ejemplo de cómo manejar errores:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogRWplY3V0YXIgdW5hIGNvbnN1bHRhIGNvbiBtYW5lam8gZGUgZXJyb3JlcyAqLwpxdWVyeSA9ICdTRUxFQ1QgKiBGUk9NIGVtcGxlYWRvcycKCmNhbGwgU1FMRXhlY0RpcmVjdCBxdWVyeQoKaWYgcmMgXD0gMCB0aGVuIGRvCiAgICBzYXkgJ0Vycm9yIGFsIGVqZWN1dGFyIGxhIGNvbnN1bHRhJwogICAgY2FsbCBTUUxHZXRFcnJvcgogICAgc2F5ICdDw7NkaWdvIGRlIGVycm9yOicgU1FMR2V0RXJyb3JDb2RlKCkKICAgIHNheSAnTWVuc2FqZSBkZSBlcnJvcjonIFNRTEdldEVycm9yTWVzc2FnZSgpCmVuZAplbHNlIGRvCiAgICAvKiBQcm9jZXNhciBsb3MgcmVzdWx0YWRvcyAqLwogICAgZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgICAgICBzYXkgJ0lEOicgU1FMR2V0RGF0YSgxKSAnTm9tYnJlOicgU1FMR2V0RGF0YSgyKSAnQXBlbGxpZG86JyBTUUxHZXREYXRhKDMpCiAgICBlbmQKZW5k"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Ejecutar una consulta con manejo de errores */
query = 'SELECT * FROM empleados'

call SQLExecDirect query

if rc \= 0 then do
    say 'Error al ejecutar la consulta'
    call SQLGetError
    say 'C&oacute;digo de error:' SQLGetErrorCode()
    say 'Mensaje de error:' SQLGetErrorMessage()
end
else do
    /* Procesar los resultados */
    do while SQLFetch() = 0
        say 'ID:' SQLGetData(1) 'Nombre:' SQLGetData(2) 'Apellido:' SQLGetData(3)
    end
end</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ul>
<li><strong>SQLGetError:</strong> Función que obtiene los detalles del error.</li>
<li><strong>SQLGetErrorCode:</strong> Función que obtiene el código del error.</li>
<li><strong>SQLGetErrorMessage:</strong> Función que obtiene el mensaje del error.</li>
</ul>
</div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><ol>
<li>Conéctate a una base de datos de prueba.</li>
<li>Crea una tabla llamada <code>productos</code> con las columnas <code>id</code>, <code>nombre</code> y <code>precio</code>.</li>
<li>Inserta tres registros en la tabla <code>productos</code>.</li>
<li>Recupera y muestra todos los registros de la tabla <code>productos</code>.</li>
<li>Actualiza el precio de uno de los productos.</li>
<li>Elimina uno de los productos.</li>
</ol>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogQ29uZXhpw7NuIGEgbGEgYmFzZSBkZSBkYXRvcyAqLwpkYl9ob3N0ID0gJ2xvY2FsaG9zdCcKZGJfdXNlciA9ICd1c3VhcmlvJwpkYl9wYXNzID0gJ2NvbnRyYXNlw7FhJwpkYl9uYW1lID0gJ25vbWJyZV9iYXNlX2RhdG9zJwoKY2FsbCByeGZ1bmNhZGQgJ1NRTENvbm5lY3QnLCAncnhzcWwnLCAnU1FMQ29ubmVjdCcKY2FsbCBTUUxDb25uZWN0IGRiX2hvc3QsIGRiX3VzZXIsIGRiX3Bhc3MsIGRiX25hbWUKCmlmIHJjIFw9IDAgdGhlbiBkbwogICAgc2F5ICdFcnJvciBhbCBjb25lY3RhciBhIGxhIGJhc2UgZGUgZGF0b3MnCiAgICBleGl0CmVuZAoKLyogQ3JlYXIgbGEgdGFibGEgcHJvZHVjdG9zICovCmNyZWF0ZV90YWJsZV9xdWVyeSA9ICdDUkVBVEUgVEFCTEUgcHJvZHVjdG9zIChpZCBJTlQsIG5vbWJyZSBWQVJDSEFSKDUwKSwgcHJlY2lvIERFQ0lNQUwoMTAsMikpJwpjYWxsIFNRTEV4ZWNEaXJlY3QgY3JlYXRlX3RhYmxlX3F1ZXJ5CgppZiByYyBcPSAwIHRoZW4gZG8KICAgIHNheSAnRXJyb3IgYWwgY3JlYXIgbGEgdGFibGEnCiAgICBleGl0CmVuZAoKLyogSW5zZXJ0YXIgcmVnaXN0cm9zICovCmluc2VydF9xdWVyeTEgPSAiSU5TRVJUIElOVE8gcHJvZHVjdG9zIChpZCwgbm9tYnJlLCBwcmVjaW8pIFZBTFVFUyAoMSwgJ1Byb2R1Y3RvMScsIDEwLjAwKSIKaW5zZXJ0X3F1ZXJ5MiA9ICJJTlNFUlQgSU5UTyBwcm9kdWN0b3MgKGlkLCBub21icmUsIHByZWNpbykgVkFMVUVTICgyLCAnUHJvZHVjdG8yJywgMjAuMDApIgppbnNlcnRfcXVlcnkzID0gIklOU0VSVCBJTlRPIHByb2R1Y3RvcyAoaWQsIG5vbWJyZSwgcHJlY2lvKSBWQUxVRVMgKDMsICdQcm9kdWN0bzMnLCAzMC4wMCkiCgpjYWxsIFNRTEV4ZWNEaXJlY3QgaW5zZXJ0X3F1ZXJ5MQpjYWxsIFNRTEV4ZWNEaXJlY3QgaW5zZXJ0X3F1ZXJ5MgpjYWxsIFNRTEV4ZWNEaXJlY3QgaW5zZXJ0X3F1ZXJ5MwoKaWYgcmMgXD0gMCB0aGVuIGRvCiAgICBzYXkgJ0Vycm9yIGFsIGluc2VydGFyIGxvcyByZWdpc3Ryb3MnCiAgICBleGl0CmVuZAoKLyogUmVjdXBlcmFyIHkgbW9zdHJhciByZWdpc3Ryb3MgKi8Kc2VsZWN0X3F1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gcHJvZHVjdG9zJwpjYWxsIFNRTEV4ZWNEaXJlY3Qgc2VsZWN0X3F1ZXJ5CgppZiByYyA9IDAgdGhlbiBkbwogICAgZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgICAgICBzYXkgJ0lEOicgU1FMR2V0RGF0YSgxKSAnTm9tYnJlOicgU1FMR2V0RGF0YSgyKSAnUHJlY2lvOicgU1FMR2V0RGF0YSgzKQogICAgZW5kCmVuZAplbHNlCiAgICBzYXkgJ0Vycm9yIGFsIHJlY3VwZXJhciBsb3MgcmVnaXN0cm9zJwoKLyogQWN0dWFsaXphciBlbCBwcmVjaW8gZGUgdW4gcHJvZHVjdG8gKi8KdXBkYXRlX3F1ZXJ5ID0gIlVQREFURSBwcm9kdWN0b3MgU0VUIHByZWNpbyA9IDI1LjAwIFdIRVJFIGlkID0gMiIKY2FsbCBTUUxFeGVjRGlyZWN0IHVwZGF0ZV9xdWVyeQoKaWYgcmMgXD0gMCB0aGVuIGRvCiAgICBzYXkgJ0Vycm9yIGFsIGFjdHVhbGl6YXIgZWwgcmVnaXN0cm8nCiAgICBleGl0CmVuZAoKLyogRWxpbWluYXIgdW4gcHJvZHVjdG8gKi8KZGVsZXRlX3F1ZXJ5ID0gIkRFTEVURSBGUk9NIHByb2R1Y3RvcyBXSEVSRSBpZCA9IDMiCmNhbGwgU1FMRXhlY0RpcmVjdCBkZWxldGVfcXVlcnkKCmlmIHJjIFw9IDAgdGhlbiBkbwogICAgc2F5ICdFcnJvciBhbCBlbGltaW5hciBlbCByZWdpc3RybycKICAgIGV4aXQKZW5kCgpzYXkgJ09wZXJhY2lvbmVzIGNvbXBsZXRhZGFzIGV4aXRvc2FtZW50ZSc="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Conexi&oacute;n a la base de datos */
db_host = 'localhost'
db_user = 'usuario'
db_pass = 'contrase&ntilde;a'
db_name = 'nombre_base_datos'

call rxfuncadd 'SQLConnect', 'rxsql', 'SQLConnect'
call SQLConnect db_host, db_user, db_pass, db_name

if rc \= 0 then do
    say 'Error al conectar a la base de datos'
    exit
end

/* Crear la tabla productos */
create_table_query = 'CREATE TABLE productos (id INT, nombre VARCHAR(50), precio DECIMAL(10,2))'
call SQLExecDirect create_table_query

if rc \= 0 then do
    say 'Error al crear la tabla'
    exit
end

/* Insertar registros */
insert_query1 = &quot;INSERT INTO productos (id, nombre, precio) VALUES (1, 'Producto1', 10.00)&quot;
insert_query2 = &quot;INSERT INTO productos (id, nombre, precio) VALUES (2, 'Producto2', 20.00)&quot;
insert_query3 = &quot;INSERT INTO productos (id, nombre, precio) VALUES (3, 'Producto3', 30.00)&quot;

call SQLExecDirect insert_query1
call SQLExecDirect insert_query2
call SQLExecDirect insert_query3

if rc \= 0 then do
    say 'Error al insertar los registros'
    exit
end

/* Recuperar y mostrar registros */
select_query = 'SELECT * FROM productos'
call SQLExecDirect select_query

if rc = 0 then do
    do while SQLFetch() = 0
        say 'ID:' SQLGetData(1) 'Nombre:' SQLGetData(2) 'Precio:' SQLGetData(3)
    end
end
else
    say 'Error al recuperar los registros'

/* Actualizar el precio de un producto */
update_query = &quot;UPDATE productos SET precio = 25.00 WHERE id = 2&quot;
call SQLExecDirect update_query

if rc \= 0 then do
    say 'Error al actualizar el registro'
    exit
end

/* Eliminar un producto */
delete_query = &quot;DELETE FROM productos WHERE id = 3&quot;
call SQLExecDirect delete_query

if rc \= 0 then do
    say 'Error al eliminar el registro'
    exit
end

say 'Operaciones completadas exitosamente'</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>En este módulo, hemos aprendido cómo conectar REXX a una base de datos, ejecutar consultas SQL, manipular datos y manejar errores. Estos conocimientos son fundamentales para desarrollar aplicaciones que interactúen con bases de datos de manera eficiente. En el próximo módulo, exploraremos la programación web con REXX, donde aplicaremos estos conceptos en un contexto más amplio.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-02-creating-utilities' title="Creación de Utilidades REXX" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-02-creating-utilities' title="Creación de Utilidades REXX" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='05-04-web-programming' title="Programación Web con REXX" class="py-2 px-3 btn btn-primary"
				data-read-mod="rexx" data-read-unit="5-3">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='05-04-web-programming' title="Programación Web con REXX" class="py-2 px-3 btn btn-primary" 
				data-read-mod="rexx" data-read-unit="5-3">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
						
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curso de Programación REXX</h1>
<h2>Módulo 1: Introducción a REXX</h2>
<ul>
<li><a href="01-01-what-is-rexx">¿Qué es REXX?</a></li>
<li><a href="01-02-setting-up-environment">Configuración del Entorno REXX</a></li>
<li><a href="01-03-hello-world">Hola Mundo en REXX</a></li>
<li><a href="01-04-basic-syntax">Sintaxis y Estructura Básica</a></li>
<li><a href="01-05-variables-data-types">Variables y Tipos de Datos</a></li>
</ul>
<h2>Módulo 2: Conceptos Básicos de Programación</h2>
<ul>
<li><a href="02-01-operators-expressions">Operadores y Expresiones</a></li>
<li><a href="02-02-control-structures-if">Estructuras de Control: IF/THEN/ELSE</a></li>
<li><a href="02-03-loops-do-leave">Bucles: DO y LEAVE</a></li>
<li><a href="02-04-input-output">Entrada y Salida</a></li>
<li><a href="02-05-basic-string-manipulation">Manipulación Básica de Cadenas</a></li>
</ul>
<h2>Módulo 3: Programación Intermedia en REXX</h2>
<ul>
<li><a href="03-01-functions-subroutines">Funciones y Subrutinas</a></li>
<li><a href="03-02-built-in-functions">Funciones Integradas</a></li>
<li><a href="03-03-error-handling">Manejo de Errores</a></li>
<li><a href="03-04-file-io-operations">Operaciones de Entrada/Salida de Archivos</a></li>
<li><a href="03-05-working-with-arrays">Trabajando con Arreglos</a></li>
</ul>
<h2>Módulo 4: Programación Avanzada en REXX</h2>
<ul>
<li><a href="04-01-advanced-string-manipulation">Manipulación Avanzada de Cadenas</a></li>
<li><a href="04-02-parsing-techniques">Técnicas de Análisis</a></li>
<li><a href="04-03-interfacing-external-programs">Interfaz con Programas Externos</a></li>
<li><a href="04-04-rexx-macros">Macros en REXX</a></li>
<li><a href="04-05-performance-optimization">Optimización del Rendimiento</a></li>
</ul>
<h2>Módulo 5: Aplicaciones Prácticas y Proyectos</h2>
<ul>
<li><a href="05-01-automating-tasks">Automatización de Tareas con REXX</a></li>
<li><a href="05-02-creating-utilities">Creación de Utilidades REXX</a></li>
<li><a href="05-03-database-access">Acceso a Bases de Datos con REXX</a></li>
<li><a href="05-04-web-programming">Programación Web con REXX</a></li>
<li><a href="05-05-final-project">Proyecto Final: Aplicación Integral en REXX</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuario no autenticado</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="d-none alert alert-danger"></div>
            	<div id="mensaje_info" class="d-none alert alert-success"></div>
            	
            	<div id="modal-body-main">
					<div class="mt-4 d-none" id="forgotPasswordSection">
						<div class="mb-3">
    <label for="recovery-email" class="form-label">Correo electrónico</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Introduce tu correo electrónico">
</div>
<button class="btn btn-primary" id="btnRecover">Enviar enlace de recuperación</button>

					</div>
									
					<div class="mt-4 d-none" id="deleteUserSection">	
						<div class="mb-3 alert alert-danger">
	¡Atención! Estás a punto de eliminar todos los datos de registro y progreso.<br><b>Esta acción no se puede deshacer.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Introduce tu contraseña">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Eliminar usuario</button>

					</div>
					
					<div class="mt-4 d-none" id="changePassordSection">
						<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Introduce el password actual">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Introduce el nuevo password">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repite el nuevo password">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Cambiar el password</button>

					</div>
					
					<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
						<p><b>Falta verificar correu</b></p>
						<a id="btnVerifyEmail" href="#">Enviar enlace de verificación</a>

					</div>
					
					<div class="mt-4 d-none" id="disconnectUserSection">
						<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Desconectar</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Cambiar el password</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Eliminar usuario</a>
</div>

					</div>
	            
	            	<div class="mt-4 d-none" id="modalTabsSection">
	            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Iniciar sesión
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Registrarse
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Correo electrónico</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Introduce tu correo electrónico">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Contraseña</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Introduce tu contraseña">
</div>
<button class="btn btn-primary" id="btnLogin">Iniciar sesión</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">¿Has olvidado tu contraseña?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Correo electrónico</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Introduce tu correo electrónico">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Contraseña</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Introduce tu contraseña">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Nombre</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Introduce tu nombre">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        He leído y acepto la <a href="/privacity" target="blank">Política de Privacidad</a> y los <a href="/licence" target="blank">Términos y Condiciones de Uso</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        Deseo recibir noticias y actualizaciones sobre los cursos (opcional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Registrarse</button>
    </div>
</div>
	            	</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
