<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceso a Bases de Datos con REXX</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rexx/05-03-database-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rexx/05-03-database-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rexx/05-03-database-access" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/rexx/05-03-database-access" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/rexx/05-03-database-access" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-creating-utilities' title="Creación de Utilidades REXX">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Acceso a Bases de Datos con REXX</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-web-programming' title="Programación Web con REXX">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos cómo interactuar con bases de datos utilizando REXX. Este conocimiento es crucial para desarrollar aplicaciones que requieran almacenamiento y recuperación de datos de manera eficiente.</p>
</div><h1><p>Objetivos del Módulo</p>
</h1>
<div class='content'><ul>
<li>Comprender los conceptos básicos de acceso a bases de datos.</li>
<li>Aprender a conectar REXX con una base de datos.</li>
<li>Ejecutar consultas SQL desde REXX.</li>
<li>Manipular datos (insertar, actualizar, eliminar) en una base de datos.</li>
<li>Manejar errores comunes en operaciones de bases de datos.</li>
</ul>
</div><h1><p>Contenido</p>
</h1>
<div class='content'><ol>
<li><a href="#conceptos-basicos-de-bases-de-datos">Conceptos Básicos de Bases de Datos</a></li>
<li><a href="#configuracion-del-entorno-para-acceso-a-bases-de-datos">Configuración del Entorno para Acceso a Bases de Datos</a></li>
<li><a href="#conexion-a-una-base-de-datos">Conexión a una Base de Datos</a></li>
<li><a href="#ejecutar-consultas-sql">Ejecutar Consultas SQL</a></li>
<li><a href="#manipulacion-de-datos">Manipulación de Datos</a></li>
<li><a href="#manejo-de-errores">Manejo de Errores</a></li>
<li><a href="#ejercicio-practico">Ejercicio Práctico</a></li>
<li><a href="#conclusion">Conclusión</a></li>
</ol>
</div><h1><p>Conceptos Básicos de Bases de Datos</p>
</h1>
<div class='content'><p>Antes de comenzar con la programación, es importante entender algunos conceptos básicos sobre bases de datos:</p>
<ul>
<li><strong>Base de Datos (BD):</strong> Colección organizada de datos que se pueden acceder, gestionar y actualizar.</li>
<li><strong>SQL (Structured Query Language):</strong> Lenguaje estándar para gestionar y manipular bases de datos.</li>
<li><strong>Tabla:</strong> Estructura dentro de una base de datos que organiza los datos en filas y columnas.</li>
<li><strong>Registro:</strong> Fila en una tabla que contiene datos específicos.</li>
<li><strong>Campo:</strong> Columna en una tabla que contiene un tipo específico de datos.</li>
</ul>
</div><h1><p>Configuración del Entorno para Acceso a Bases de Datos</p>
</h1>
<div class='content'><p>Para interactuar con una base de datos desde REXX, necesitamos configurar el entorno adecuadamente. Esto incluye instalar y configurar un controlador de base de datos compatible con REXX.</p>
</div><h2><p>Pasos de Configuración</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Instalar el Controlador de Base de Datos:</strong></p>
<ul>
<li>Dependiendo de la base de datos que estés utilizando (por ejemplo, DB2, MySQL, Oracle), necesitarás instalar el controlador correspondiente.</li>
<li>Asegúrate de que el controlador esté correctamente instalado y configurado en tu sistema.</li>
</ul>
</li>
<li>
<p><strong>Configurar el Archivo de Conexión:</strong></p>
<ul>
<li>Crea un archivo de configuración que contenga los detalles de la conexión a la base de datos, como el nombre del servidor, el nombre de la base de datos, el usuario y la contraseña.</li>
</ul>
</li>
</ol>
</div><h1><p>Conexión a una Base de Datos</p>
</h1>
<div class='content'><p>Para conectar REXX a una base de datos, utilizaremos una biblioteca específica que permita la conexión y ejecución de comandos SQL. A continuación, se muestra un ejemplo de cómo establecer una conexión:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogQ29uZXhpw7NuIGEgdW5hIGJhc2UgZGUgZGF0b3MgTXlTUUwgKi8KZGJfaG9zdCA9ICdsb2NhbGhvc3QnCmRiX3VzZXIgPSAndXN1YXJpbycKZGJfcGFzcyA9ICdjb250cmFzZcOxYScKZGJfbmFtZSA9ICdub21icmVfYmFzZV9kYXRvcycKCi8qIENhcmdhciBsYSBiaWJsaW90ZWNhIGRlIGNvbmV4acOzbiAqLwpjYWxsIHJ4ZnVuY2FkZCAnU1FMQ29ubmVjdCcsICdyeHNxbCcsICdTUUxDb25uZWN0JwoKLyogRXN0YWJsZWNlciBsYSBjb25leGnDs24gKi8KY2FsbCBTUUxDb25uZWN0IGRiX2hvc3QsIGRiX3VzZXIsIGRiX3Bhc3MsIGRiX25hbWUKCmlmIHJjID0gMCB0aGVuCiAgICBzYXkgJ0NvbmV4acOzbiBleGl0b3NhIGEgbGEgYmFzZSBkZSBkYXRvcycKZWxzZQogICAgc2F5ICdFcnJvciBhbCBjb25lY3RhciBhIGxhIGJhc2UgZGUgZGF0b3Mn"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Conexi&oacute;n a una base de datos MySQL */
db_host = 'localhost'
db_user = 'usuario'
db_pass = 'contrase&ntilde;a'
db_name = 'nombre_base_datos'

/* Cargar la biblioteca de conexi&oacute;n */
call rxfuncadd 'SQLConnect', 'rxsql', 'SQLConnect'

/* Establecer la conexi&oacute;n */
call SQLConnect db_host, db_user, db_pass, db_name

if rc = 0 then
    say 'Conexi&oacute;n exitosa a la base de datos'
else
    say 'Error al conectar a la base de datos'</pre></div><div class='content'></div><h2><p>Explicación del Código</p>
</h2>
<div class='content'><ul>
<li><strong>db_host, db_user, db_pass, db_name:</strong> Variables que almacenan los detalles de la conexión.</li>
<li><strong>rxfuncadd:</strong> Función que agrega una función externa (en este caso, <code>SQLConnect</code>) al entorno REXX.</li>
<li><strong>SQLConnect:</strong> Función que establece la conexión a la base de datos utilizando los detalles proporcionados.</li>
</ul>
</div><h1><p>Ejecutar Consultas SQL</p>
</h1>
<div class='content'><p>Una vez establecida la conexión, podemos ejecutar consultas SQL para recuperar datos de la base de datos. A continuación, se muestra un ejemplo de cómo ejecutar una consulta SELECT:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogRWplY3V0YXIgdW5hIGNvbnN1bHRhIFNFTEVDVCAqLwpxdWVyeSA9ICdTRUxFQ1QgKiBGUk9NIGVtcGxlYWRvcycKCi8qIENhcmdhciBsYSBiaWJsaW90ZWNhIGRlIGVqZWN1Y2nDs24gZGUgY29uc3VsdGFzICovCmNhbGwgcnhmdW5jYWRkICdTUUxFeGVjRGlyZWN0JywgJ3J4c3FsJywgJ1NRTEV4ZWNEaXJlY3QnCgovKiBFamVjdXRhciBsYSBjb25zdWx0YSAqLwpjYWxsIFNRTEV4ZWNEaXJlY3QgcXVlcnkKCmlmIHJjID0gMCB0aGVuIGRvCiAgICAvKiBQcm9jZXNhciBsb3MgcmVzdWx0YWRvcyAqLwogICAgZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgICAgICBzYXkgJ0lEOicgU1FMR2V0RGF0YSgxKSAnTm9tYnJlOicgU1FMR2V0RGF0YSgyKSAnQXBlbGxpZG86JyBTUUxHZXREYXRhKDMpCiAgICBlbmQKZW5kCmVsc2UKICAgIHNheSAnRXJyb3IgYWwgZWplY3V0YXIgbGEgY29uc3VsdGEn"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Ejecutar una consulta SELECT */
query = 'SELECT * FROM empleados'

/* Cargar la biblioteca de ejecuci&oacute;n de consultas */
call rxfuncadd 'SQLExecDirect', 'rxsql', 'SQLExecDirect'

/* Ejecutar la consulta */
call SQLExecDirect query

if rc = 0 then do
    /* Procesar los resultados */
    do while SQLFetch() = 0
        say 'ID:' SQLGetData(1) 'Nombre:' SQLGetData(2) 'Apellido:' SQLGetData(3)
    end
end
else
    say 'Error al ejecutar la consulta'</pre></div><div class='content'></div><h2><p>Explicación del Código</p>
</h2>
<div class='content'><ul>
<li><strong>query:</strong> Variable que almacena la consulta SQL.</li>
<li><strong>SQLExecDirect:</strong> Función que ejecuta la consulta SQL.</li>
<li><strong>SQLFetch:</strong> Función que recupera la siguiente fila de resultados.</li>
<li><strong>SQLGetData:</strong> Función que obtiene los datos de una columna específica en la fila actual.</li>
</ul>
</div><h1><p>Manipulación de Datos</p>
</h1>
<div class='content'><p>Además de recuperar datos, también podemos insertar, actualizar y eliminar datos en la base de datos. A continuación, se muestra un ejemplo de cómo insertar un nuevo registro:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogSW5zZXJ0YXIgdW4gbnVldm8gcmVnaXN0cm8gKi8KaW5zZXJ0X3F1ZXJ5ID0gIklOU0VSVCBJTlRPIGVtcGxlYWRvcyAoaWQsIG5vbWJyZSwgYXBlbGxpZG8pIFZBTFVFUyAoNCwgJ0p1YW4nLCAnUMOpcmV6JykiCgovKiBFamVjdXRhciBsYSBjb25zdWx0YSBkZSBpbnNlcmNpw7NuICovCmNhbGwgU1FMRXhlY0RpcmVjdCBpbnNlcnRfcXVlcnkKCmlmIHJjID0gMCB0aGVuCiAgICBzYXkgJ1JlZ2lzdHJvIGluc2VydGFkbyBleGl0b3NhbWVudGUnCmVsc2UKICAgIHNheSAnRXJyb3IgYWwgaW5zZXJ0YXIgZWwgcmVnaXN0cm8n"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Insertar un nuevo registro */
insert_query = &quot;INSERT INTO empleados (id, nombre, apellido) VALUES (4, 'Juan', 'P&eacute;rez')&quot;

/* Ejecutar la consulta de inserci&oacute;n */
call SQLExecDirect insert_query

if rc = 0 then
    say 'Registro insertado exitosamente'
else
    say 'Error al insertar el registro'</pre></div><div class='content'></div><h2><p>Explicación del Código</p>
</h2>
<div class='content'><ul>
<li><strong>insert_query:</strong> Variable que almacena la consulta SQL de inserción.</li>
<li><strong>SQLExecDirect:</strong> Función que ejecuta la consulta SQL.</li>
</ul>
</div><h1><p>Manejo de Errores</p>
</h1>
<div class='content'><p>Es importante manejar los errores que puedan ocurrir durante las operaciones de base de datos. A continuación, se muestra un ejemplo de cómo manejar errores:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogRWplY3V0YXIgdW5hIGNvbnN1bHRhIGNvbiBtYW5lam8gZGUgZXJyb3JlcyAqLwpxdWVyeSA9ICdTRUxFQ1QgKiBGUk9NIGVtcGxlYWRvcycKCmNhbGwgU1FMRXhlY0RpcmVjdCBxdWVyeQoKaWYgcmMgXD0gMCB0aGVuIGRvCiAgICBzYXkgJ0Vycm9yIGFsIGVqZWN1dGFyIGxhIGNvbnN1bHRhJwogICAgY2FsbCBTUUxHZXRFcnJvcgogICAgc2F5ICdDw7NkaWdvIGRlIGVycm9yOicgU1FMR2V0RXJyb3JDb2RlKCkKICAgIHNheSAnTWVuc2FqZSBkZSBlcnJvcjonIFNRTEdldEVycm9yTWVzc2FnZSgpCmVuZAplbHNlIGRvCiAgICAvKiBQcm9jZXNhciBsb3MgcmVzdWx0YWRvcyAqLwogICAgZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgICAgICBzYXkgJ0lEOicgU1FMR2V0RGF0YSgxKSAnTm9tYnJlOicgU1FMR2V0RGF0YSgyKSAnQXBlbGxpZG86JyBTUUxHZXREYXRhKDMpCiAgICBlbmQKZW5k"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Ejecutar una consulta con manejo de errores */
query = 'SELECT * FROM empleados'

call SQLExecDirect query

if rc \= 0 then do
    say 'Error al ejecutar la consulta'
    call SQLGetError
    say 'C&oacute;digo de error:' SQLGetErrorCode()
    say 'Mensaje de error:' SQLGetErrorMessage()
end
else do
    /* Procesar los resultados */
    do while SQLFetch() = 0
        say 'ID:' SQLGetData(1) 'Nombre:' SQLGetData(2) 'Apellido:' SQLGetData(3)
    end
end</pre></div><div class='content'></div><h2><p>Explicación del Código</p>
</h2>
<div class='content'><ul>
<li><strong>SQLGetError:</strong> Función que obtiene los detalles del error.</li>
<li><strong>SQLGetErrorCode:</strong> Función que obtiene el código del error.</li>
<li><strong>SQLGetErrorMessage:</strong> Función que obtiene el mensaje del error.</li>
</ul>
</div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio</p>
</h2>
<div class='content'><ol>
<li>Conéctate a una base de datos de prueba.</li>
<li>Crea una tabla llamada <code>productos</code> con las columnas <code>id</code>, <code>nombre</code> y <code>precio</code>.</li>
<li>Inserta tres registros en la tabla <code>productos</code>.</li>
<li>Recupera y muestra todos los registros de la tabla <code>productos</code>.</li>
<li>Actualiza el precio de uno de los productos.</li>
<li>Elimina uno de los productos.</li>
</ol>
</div><h2><p>Solución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LyogQ29uZXhpw7NuIGEgbGEgYmFzZSBkZSBkYXRvcyAqLwpkYl9ob3N0ID0gJ2xvY2FsaG9zdCcKZGJfdXNlciA9ICd1c3VhcmlvJwpkYl9wYXNzID0gJ2NvbnRyYXNlw7FhJwpkYl9uYW1lID0gJ25vbWJyZV9iYXNlX2RhdG9zJwoKY2FsbCByeGZ1bmNhZGQgJ1NRTENvbm5lY3QnLCAncnhzcWwnLCAnU1FMQ29ubmVjdCcKY2FsbCBTUUxDb25uZWN0IGRiX2hvc3QsIGRiX3VzZXIsIGRiX3Bhc3MsIGRiX25hbWUKCmlmIHJjIFw9IDAgdGhlbiBkbwogICAgc2F5ICdFcnJvciBhbCBjb25lY3RhciBhIGxhIGJhc2UgZGUgZGF0b3MnCiAgICBleGl0CmVuZAoKLyogQ3JlYXIgbGEgdGFibGEgcHJvZHVjdG9zICovCmNyZWF0ZV90YWJsZV9xdWVyeSA9ICdDUkVBVEUgVEFCTEUgcHJvZHVjdG9zIChpZCBJTlQsIG5vbWJyZSBWQVJDSEFSKDUwKSwgcHJlY2lvIERFQ0lNQUwoMTAsMikpJwpjYWxsIFNRTEV4ZWNEaXJlY3QgY3JlYXRlX3RhYmxlX3F1ZXJ5CgppZiByYyBcPSAwIHRoZW4gZG8KICAgIHNheSAnRXJyb3IgYWwgY3JlYXIgbGEgdGFibGEnCiAgICBleGl0CmVuZAoKLyogSW5zZXJ0YXIgcmVnaXN0cm9zICovCmluc2VydF9xdWVyeTEgPSAiSU5TRVJUIElOVE8gcHJvZHVjdG9zIChpZCwgbm9tYnJlLCBwcmVjaW8pIFZBTFVFUyAoMSwgJ1Byb2R1Y3RvMScsIDEwLjAwKSIKaW5zZXJ0X3F1ZXJ5MiA9ICJJTlNFUlQgSU5UTyBwcm9kdWN0b3MgKGlkLCBub21icmUsIHByZWNpbykgVkFMVUVTICgyLCAnUHJvZHVjdG8yJywgMjAuMDApIgppbnNlcnRfcXVlcnkzID0gIklOU0VSVCBJTlRPIHByb2R1Y3RvcyAoaWQsIG5vbWJyZSwgcHJlY2lvKSBWQUxVRVMgKDMsICdQcm9kdWN0bzMnLCAzMC4wMCkiCgpjYWxsIFNRTEV4ZWNEaXJlY3QgaW5zZXJ0X3F1ZXJ5MQpjYWxsIFNRTEV4ZWNEaXJlY3QgaW5zZXJ0X3F1ZXJ5MgpjYWxsIFNRTEV4ZWNEaXJlY3QgaW5zZXJ0X3F1ZXJ5MwoKaWYgcmMgXD0gMCB0aGVuIGRvCiAgICBzYXkgJ0Vycm9yIGFsIGluc2VydGFyIGxvcyByZWdpc3Ryb3MnCiAgICBleGl0CmVuZAoKLyogUmVjdXBlcmFyIHkgbW9zdHJhciByZWdpc3Ryb3MgKi8Kc2VsZWN0X3F1ZXJ5ID0gJ1NFTEVDVCAqIEZST00gcHJvZHVjdG9zJwpjYWxsIFNRTEV4ZWNEaXJlY3Qgc2VsZWN0X3F1ZXJ5CgppZiByYyA9IDAgdGhlbiBkbwogICAgZG8gd2hpbGUgU1FMRmV0Y2goKSA9IDAKICAgICAgICBzYXkgJ0lEOicgU1FMR2V0RGF0YSgxKSAnTm9tYnJlOicgU1FMR2V0RGF0YSgyKSAnUHJlY2lvOicgU1FMR2V0RGF0YSgzKQogICAgZW5kCmVuZAplbHNlCiAgICBzYXkgJ0Vycm9yIGFsIHJlY3VwZXJhciBsb3MgcmVnaXN0cm9zJwoKLyogQWN0dWFsaXphciBlbCBwcmVjaW8gZGUgdW4gcHJvZHVjdG8gKi8KdXBkYXRlX3F1ZXJ5ID0gIlVQREFURSBwcm9kdWN0b3MgU0VUIHByZWNpbyA9IDI1LjAwIFdIRVJFIGlkID0gMiIKY2FsbCBTUUxFeGVjRGlyZWN0IHVwZGF0ZV9xdWVyeQoKaWYgcmMgXD0gMCB0aGVuIGRvCiAgICBzYXkgJ0Vycm9yIGFsIGFjdHVhbGl6YXIgZWwgcmVnaXN0cm8nCiAgICBleGl0CmVuZAoKLyogRWxpbWluYXIgdW4gcHJvZHVjdG8gKi8KZGVsZXRlX3F1ZXJ5ID0gIkRFTEVURSBGUk9NIHByb2R1Y3RvcyBXSEVSRSBpZCA9IDMiCmNhbGwgU1FMRXhlY0RpcmVjdCBkZWxldGVfcXVlcnkKCmlmIHJjIFw9IDAgdGhlbiBkbwogICAgc2F5ICdFcnJvciBhbCBlbGltaW5hciBlbCByZWdpc3RybycKICAgIGV4aXQKZW5kCgpzYXkgJ09wZXJhY2lvbmVzIGNvbXBsZXRhZGFzIGV4aXRvc2FtZW50ZSc="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/* Conexi&oacute;n a la base de datos */
db_host = 'localhost'
db_user = 'usuario'
db_pass = 'contrase&ntilde;a'
db_name = 'nombre_base_datos'

call rxfuncadd 'SQLConnect', 'rxsql', 'SQLConnect'
call SQLConnect db_host, db_user, db_pass, db_name

if rc \= 0 then do
    say 'Error al conectar a la base de datos'
    exit
end

/* Crear la tabla productos */
create_table_query = 'CREATE TABLE productos (id INT, nombre VARCHAR(50), precio DECIMAL(10,2))'
call SQLExecDirect create_table_query

if rc \= 0 then do
    say 'Error al crear la tabla'
    exit
end

/* Insertar registros */
insert_query1 = &quot;INSERT INTO productos (id, nombre, precio) VALUES (1, 'Producto1', 10.00)&quot;
insert_query2 = &quot;INSERT INTO productos (id, nombre, precio) VALUES (2, 'Producto2', 20.00)&quot;
insert_query3 = &quot;INSERT INTO productos (id, nombre, precio) VALUES (3, 'Producto3', 30.00)&quot;

call SQLExecDirect insert_query1
call SQLExecDirect insert_query2
call SQLExecDirect insert_query3

if rc \= 0 then do
    say 'Error al insertar los registros'
    exit
end

/* Recuperar y mostrar registros */
select_query = 'SELECT * FROM productos'
call SQLExecDirect select_query

if rc = 0 then do
    do while SQLFetch() = 0
        say 'ID:' SQLGetData(1) 'Nombre:' SQLGetData(2) 'Precio:' SQLGetData(3)
    end
end
else
    say 'Error al recuperar los registros'

/* Actualizar el precio de un producto */
update_query = &quot;UPDATE productos SET precio = 25.00 WHERE id = 2&quot;
call SQLExecDirect update_query

if rc \= 0 then do
    say 'Error al actualizar el registro'
    exit
end

/* Eliminar un producto */
delete_query = &quot;DELETE FROM productos WHERE id = 3&quot;
call SQLExecDirect delete_query

if rc \= 0 then do
    say 'Error al eliminar el registro'
    exit
end

say 'Operaciones completadas exitosamente'</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En este módulo, hemos aprendido cómo conectar REXX a una base de datos, ejecutar consultas SQL, manipular datos y manejar errores. Estos conocimientos son fundamentales para desarrollar aplicaciones que interactúen con bases de datos de manera eficiente. En el próximo módulo, exploraremos la programación web con REXX, donde aplicaremos estos conceptos en un contexto más amplio.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='05-02-creating-utilities' title="Creación de Utilidades REXX">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='05-04-web-programming' title="Programación Web con REXX">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
