<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ViewModel y LiveData en Kotlin</title>

    <link rel="alternate" href="https://campusempresa.com/mod/kotlin/viewmodel-and-livedata" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/kotlin/viewmodel-and-livedata" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/kotlin/viewmodel-and-livedata" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/kotlin/viewmodel-and-livedata" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/kotlin/viewmodel-and-livedata" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='kotlin-android-extensions'>&#x25C4;Extensiones de Kotlin para Android</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">ViewModel y LiveData en Kotlin</a>
	</div>
	<div class='col-4 text-end'>
					<a href='kotlin-multiplatform'>Kotlin Multiplataforma &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En esta sección, exploraremos los conceptos de ViewModel y LiveData en Kotlin, que son componentes esenciales de los componentes de arquitectura de Android. Estas herramientas ayudan a gestionar los datos relacionados con la interfaz de usuario de una manera consciente del ciclo de vida, asegurando que los datos sobrevivan a cambios de configuración como las rotaciones de pantalla.</p>
</div><h1>ViewModel</h1>
<div class='content'><p>La clase ViewModel está diseñada para almacenar y gestionar datos relacionados con la interfaz de usuario de una manera consciente del ciclo de vida. Permite que los datos sobrevivan a cambios de configuración como las rotaciones de pantalla.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Conciencia del Ciclo de Vida</strong>: Los objetos ViewModel se retienen automáticamente durante los cambios de configuración.</li>
<li><strong>Separación de Responsabilidades</strong>: Ayuda a separar los datos de la interfaz de usuario de los controladores de la interfaz de usuario como Actividades y Fragmentos.</li>
</ul>
</div><h2>Ejemplo</h2>
<div class='content'><p>Vamos a crear un simple ViewModel para gestionar un contador.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ291bnRlclZpZXdNb2RlbC5rdAppbXBvcnQgYW5kcm9pZHgubGlmZWN5Y2xlLlZpZXdNb2RlbAoKY2xhc3MgQ291bnRlclZpZXdNb2RlbCA6IFZpZXdNb2RlbCgpIHsKICAgIHZhciBjb3VudGVyOiBJbnQgPSAwCgogICAgZnVuIGluY3JlbWVudENvdW50ZXIoKSB7CiAgICAgICAgY291bnRlcisrCiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// CounterViewModel.kt
import androidx.lifecycle.ViewModel

class CounterViewModel : ViewModel() {
    var counter: Int = 0

    fun incrementCounter() {
        counter++
    }
}</pre></div><div class='content'><p>En tu Actividad o Fragmento, puedes usar este ViewModel de la siguiente manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTWFpbkFjdGl2aXR5Lmt0CmltcG9ydCBhbmRyb2lkLm9zLkJ1bmRsZQppbXBvcnQgYW5kcm9pZHguYWN0aXZpdHkudmlld01vZGVscwppbXBvcnQgYW5kcm9pZHguYXBwY29tcGF0LmFwcC5BcHBDb21wYXRBY3Rpdml0eQppbXBvcnQgYW5kcm9pZHgubGlmZWN5Y2xlLlZpZXdNb2RlbFByb3ZpZGVyCmltcG9ydCBrb3RsaW54LmFuZHJvaWQuc3ludGhldGljLm1haW4uYWN0aXZpdHlfbWFpbi4qCgpjbGFzcyBNYWluQWN0aXZpdHkgOiBBcHBDb21wYXRBY3Rpdml0eSgpIHsKICAgIHByaXZhdGUgdmFsIHZpZXdNb2RlbDogQ291bnRlclZpZXdNb2RlbCBieSB2aWV3TW9kZWxzKCkKCiAgICBvdmVycmlkZSBmdW4gb25DcmVhdGUoc2F2ZWRJbnN0YW5jZVN0YXRlOiBCdW5kbGU/KSB7CiAgICAgICAgc3VwZXIub25DcmVhdGUoc2F2ZWRJbnN0YW5jZVN0YXRlKQogICAgICAgIHNldENvbnRlbnRWaWV3KFIubGF5b3V0LmFjdGl2aXR5X21haW4pCgogICAgICAgIGJ1dHRvbl9pbmNyZW1lbnQuc2V0T25DbGlja0xpc3RlbmVyIHsKICAgICAgICAgICAgdmlld01vZGVsLmluY3JlbWVudENvdW50ZXIoKQogICAgICAgICAgICB0ZXh0Vmlld19jb3VudGVyLnRleHQgPSB2aWV3TW9kZWwuY291bnRlci50b1N0cmluZygpCiAgICAgICAgfQogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MainActivity.kt
import android.os.Bundle
import androidx.activity.viewModels
import androidx.appcompat.app.AppCompatActivity
import androidx.lifecycle.ViewModelProvider
import kotlinx.android.synthetic.main.activity_main.*

class MainActivity : AppCompatActivity() {
    private val viewModel: CounterViewModel by viewModels()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        button_increment.setOnClickListener {
            viewModel.incrementCounter()
            textView_counter.text = viewModel.counter.toString()
        }
    }
}</pre></div><div class='content'></div><h1>LiveData</h1>
<div class='content'><p>LiveData es una clase contenedora de datos observable. A diferencia de un observable regular, LiveData es consciente del ciclo de vida, lo que significa que respeta el ciclo de vida de otros componentes de la aplicación, como actividades, fragmentos o servicios.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Conciencia del Ciclo de Vida</strong>: LiveData solo actualiza los observadores de componentes de la aplicación que están en un estado de ciclo de vida activo.</li>
<li><strong>Limpieza Automática</strong>: Los observadores se eliminan automáticamente cuando su ciclo de vida asociado se destruye.</li>
<li><strong>Sin Fugas de Memoria</strong>: Los observadores están vinculados a objetos de ciclo de vida y se limpian cuando el ciclo de vida se destruye.</li>
</ul>
</div><h2>Ejemplo</h2>
<div class='content'><p>Vamos a modificar nuestro ejemplo anterior para usar LiveData.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ291bnRlclZpZXdNb2RlbC5rdAppbXBvcnQgYW5kcm9pZHgubGlmZWN5Y2xlLkxpdmVEYXRhCmltcG9ydCBhbmRyb2lkeC5saWZlY3ljbGUuTXV0YWJsZUxpdmVEYXRhCmltcG9ydCBhbmRyb2lkeC5saWZlY3ljbGUuVmlld01vZGVsCgpjbGFzcyBDb3VudGVyVmlld01vZGVsIDogVmlld01vZGVsKCkgewogICAgcHJpdmF0ZSB2YWwgX2NvdW50ZXIgPSBNdXRhYmxlTGl2ZURhdGE8SW50PigpCiAgICB2YWwgY291bnRlcjogTGl2ZURhdGE8SW50PiBnZXQoKSA9IF9jb3VudGVyCgogICAgaW5pdCB7CiAgICAgICAgX2NvdW50ZXIudmFsdWUgPSAwCiAgICB9CgogICAgZnVuIGluY3JlbWVudENvdW50ZXIoKSB7CiAgICAgICAgX2NvdW50ZXIudmFsdWUgPSAoX2NvdW50ZXIudmFsdWUgPzogMCkgKyAxCiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// CounterViewModel.kt
import androidx.lifecycle.LiveData
import androidx.lifecycle.MutableLiveData
import androidx.lifecycle.ViewModel

class CounterViewModel : ViewModel() {
    private val _counter = MutableLiveData&lt;Int&gt;()
    val counter: LiveData&lt;Int&gt; get() = _counter

    init {
        _counter.value = 0
    }

    fun incrementCounter() {
        _counter.value = (_counter.value ?: 0) + 1
    }
}</pre></div><div class='content'><p>En tu Actividad o Fragmento, puedes observar el LiveData de la siguiente manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTWFpbkFjdGl2aXR5Lmt0CmltcG9ydCBhbmRyb2lkLm9zLkJ1bmRsZQppbXBvcnQgYW5kcm9pZHguYWN0aXZpdHkudmlld01vZGVscwppbXBvcnQgYW5kcm9pZHguYXBwY29tcGF0LmFwcC5BcHBDb21wYXRBY3Rpdml0eQppbXBvcnQgYW5kcm9pZHgubGlmZWN5Y2xlLk9ic2VydmVyCmltcG9ydCBrb3RsaW54LmFuZHJvaWQuc3ludGhldGljLm1haW4uYWN0aXZpdHlfbWFpbi4qCgpjbGFzcyBNYWluQWN0aXZpdHkgOiBBcHBDb21wYXRBY3Rpdml0eSgpIHsKICAgIHByaXZhdGUgdmFsIHZpZXdNb2RlbDogQ291bnRlclZpZXdNb2RlbCBieSB2aWV3TW9kZWxzKCkKCiAgICBvdmVycmlkZSBmdW4gb25DcmVhdGUoc2F2ZWRJbnN0YW5jZVN0YXRlOiBCdW5kbGU/KSB7CiAgICAgICAgc3VwZXIub25DcmVhdGUoc2F2ZWRJbnN0YW5jZVN0YXRlKQogICAgICAgIHNldENvbnRlbnRWaWV3KFIubGF5b3V0LmFjdGl2aXR5X21haW4pCgogICAgICAgIHZpZXdNb2RlbC5jb3VudGVyLm9ic2VydmUodGhpcywgT2JzZXJ2ZXIgeyBuZXdDb3VudGVyVmFsdWUgLT4KICAgICAgICAgICAgdGV4dFZpZXdfY291bnRlci50ZXh0ID0gbmV3Q291bnRlclZhbHVlLnRvU3RyaW5nKCkKICAgICAgICB9KQoKICAgICAgICBidXR0b25faW5jcmVtZW50LnNldE9uQ2xpY2tMaXN0ZW5lciB7CiAgICAgICAgICAgIHZpZXdNb2RlbC5pbmNyZW1lbnRDb3VudGVyKCkKICAgICAgICB9CiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MainActivity.kt
import android.os.Bundle
import androidx.activity.viewModels
import androidx.appcompat.app.AppCompatActivity
import androidx.lifecycle.Observer
import kotlinx.android.synthetic.main.activity_main.*

class MainActivity : AppCompatActivity() {
    private val viewModel: CounterViewModel by viewModels()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        viewModel.counter.observe(this, Observer { newCounterValue -&gt;
            textView_counter.text = newCounterValue.toString()
        })

        button_increment.setOnClickListener {
            viewModel.incrementCounter()
        }
    }
}</pre></div><div class='content'></div><h1>Combinando ViewModel y LiveData</h1>
<div class='content'><p>Combinar ViewModel y LiveData proporciona una forma robusta de gestionar datos relacionados con la interfaz de usuario de una manera consciente del ciclo de vida. El ViewModel mantiene los datos, y LiveData asegura que la interfaz de usuario se actualice cada vez que los datos cambien.</p>
</div><h2>Ejemplo</h2>
<div class='content'><p>Vamos a crear un ejemplo más complejo donde obtenemos datos de un repositorio.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVXNlclJlcG9zaXRvcnkua3QKY2xhc3MgVXNlclJlcG9zaXRvcnkgewogICAgZnVuIGdldFVzZXIoKTogTGl2ZURhdGE8VXNlcj4gewogICAgICAgIHZhbCB1c2VyID0gTXV0YWJsZUxpdmVEYXRhPFVzZXI+KCkKICAgICAgICAvLyBTaW11bGFyIHVuYSBsbGFtYWRhIGRlIHJlZCBvIHVuYSBvYnRlbmNpw7NuIGRlIGJhc2UgZGUgZGF0b3MKICAgICAgICB1c2VyLnZhbHVlID0gVXNlcigiSm9obiBEb2UiLCAzMCkKICAgICAgICByZXR1cm4gdXNlcgogICAgfQp9CgovLyBVc2VyVmlld01vZGVsLmt0CmltcG9ydCBhbmRyb2lkeC5saWZlY3ljbGUuTGl2ZURhdGEKaW1wb3J0IGFuZHJvaWR4LmxpZmVjeWNsZS5WaWV3TW9kZWwKCmNsYXNzIFVzZXJWaWV3TW9kZWwgOiBWaWV3TW9kZWwoKSB7CiAgICBwcml2YXRlIHZhbCB1c2VyUmVwb3NpdG9yeSA9IFVzZXJSZXBvc2l0b3J5KCkKICAgIHZhbCB1c2VyOiBMaXZlRGF0YTxVc2VyPiA9IHVzZXJSZXBvc2l0b3J5LmdldFVzZXIoKQp9CgovLyBVc2VyLmt0CmRhdGEgY2xhc3MgVXNlcih2YWwgbmFtZTogU3RyaW5nLCB2YWwgYWdlOiBJbnQp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// UserRepository.kt
class UserRepository {
    fun getUser(): LiveData&lt;User&gt; {
        val user = MutableLiveData&lt;User&gt;()
        // Simular una llamada de red o una obtenci&oacute;n de base de datos
        user.value = User(&quot;John Doe&quot;, 30)
        return user
    }
}

// UserViewModel.kt
import androidx.lifecycle.LiveData
import androidx.lifecycle.ViewModel

class UserViewModel : ViewModel() {
    private val userRepository = UserRepository()
    val user: LiveData&lt;User&gt; = userRepository.getUser()
}

// User.kt
data class User(val name: String, val age: Int)</pre></div><div class='content'><p>En tu Actividad o Fragmento, observa los datos del usuario:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gTWFpbkFjdGl2aXR5Lmt0CmltcG9ydCBhbmRyb2lkLm9zLkJ1bmRsZQppbXBvcnQgYW5kcm9pZHguYWN0aXZpdHkudmlld01vZGVscwppbXBvcnQgYW5kcm9pZHguYXBwY29tcGF0LmFwcC5BcHBDb21wYXRBY3Rpdml0eQppbXBvcnQgYW5kcm9pZHgubGlmZWN5Y2xlLk9ic2VydmVyCmltcG9ydCBrb3RsaW54LmFuZHJvaWQuc3ludGhldGljLm1haW4uYWN0aXZpdHlfbWFpbi4qCgpjbGFzcyBNYWluQWN0aXZpdHkgOiBBcHBDb21wYXRBY3Rpdml0eSgpIHsKICAgIHByaXZhdGUgdmFsIHZpZXdNb2RlbDogVXNlclZpZXdNb2RlbCBieSB2aWV3TW9kZWxzKCkKCiAgICBvdmVycmlkZSBmdW4gb25DcmVhdGUoc2F2ZWRJbnN0YW5jZVN0YXRlOiBCdW5kbGU/KSB7CiAgICAgICAgc3VwZXIub25DcmVhdGUoc2F2ZWRJbnN0YW5jZVN0YXRlKQogICAgICAgIHNldENvbnRlbnRWaWV3KFIubGF5b3V0LmFjdGl2aXR5X21haW4pCgogICAgICAgIHZpZXdNb2RlbC51c2VyLm9ic2VydmUodGhpcywgT2JzZXJ2ZXIgeyB1c2VyIC0+CiAgICAgICAgICAgIHRleHRWaWV3X25hbWUudGV4dCA9IHVzZXIubmFtZQogICAgICAgICAgICB0ZXh0Vmlld19hZ2UudGV4dCA9IHVzZXIuYWdlLnRvU3RyaW5nKCkKICAgICAgICB9KQogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// MainActivity.kt
import android.os.Bundle
import androidx.activity.viewModels
import androidx.appcompat.app.AppCompatActivity
import androidx.lifecycle.Observer
import kotlinx.android.synthetic.main.activity_main.*

class MainActivity : AppCompatActivity() {
    private val viewModel: UserViewModel by viewModels()

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        setContentView(R.layout.activity_main)

        viewModel.user.observe(this, Observer { user -&gt;
            textView_name.text = user.name
            textView_age.text = user.age.toString()
        })
    }
}</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>ViewModel y LiveData son herramientas poderosas para gestionar datos relacionados con la interfaz de usuario de una manera consciente del ciclo de vida en aplicaciones Android. Al usar estos componentes, puedes asegurar que los datos de tu aplicación sobrevivan a cambios de configuración y que tu interfaz de usuario esté siempre actualizada con los últimos datos. Esta separación de responsabilidades también hace que tu código sea más modular y más fácil de probar.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='kotlin-android-extensions'>&#x25C4;Extensiones de Kotlin para Android</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">ViewModel y LiveData en Kotlin</a>
	</div>
	<div class='col-4 text-end'>
					<a href='kotlin-multiplatform'>Kotlin Multiplataforma &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
