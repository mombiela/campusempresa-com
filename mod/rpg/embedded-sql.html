<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL embebido en RPG</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/embedded-sql" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/embedded-sql" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/embedded-sql" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/rpg/embedded-sql" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/rpg/embedded-sql" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atención!</b> Ha habido un error en la generación del curso y puede contener errores de traducción.Estamos trabajando para solucinarlo por lo que se deben usar los contenidos con cuidado.Se puede consultar el contenido correcto en otro idioma en el siguiente enlace:<br>
						<a href="https://enterprisecampus.net/mod/rpg/embedded-sql">https://enterprisecampus.net/mod/rpg/embedded-sql</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='sql-in-rpg'>&#x25C4;Introducción a SQL en RPG</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">SQL embebido en RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='dynamic-sql'>SQL Dinámico &#x25BA;</a>
			</div>
</div>
<div class='content'><p>El SQL embebido permite que los programas RPG ejecuten sentencias SQL directamente dentro del código. Esta integración proporciona potentes capacidades de manipulación de bases de datos, combinando las fortalezas de SQL con la lógica procedimental de RPG.</p>
</div><h1>Introducción al SQL embebido</h1>
<div class='content'><ul>
<li><strong>Definición</strong>: El SQL embebido se refiere a la inclusión de sentencias SQL dentro de un programa RPG.</li>
<li><strong>Propósito</strong>: Aprovechar las capacidades de manipulación de datos de SQL directamente dentro de las aplicaciones RPG.</li>
<li><strong>Beneficios</strong>:
<ul>
<li>Simplifica la recuperación y manipulación de datos complejos.</li>
<li>Mejora el rendimiento al reducir la necesidad de múltiples llamadas a la base de datos.</li>
<li>Proporciona una base de código más legible y mantenible.</li>
</ul>
</li>
</ul>
</div><h1>Conceptos básicos</h1>
<div class='content'></div><h2>Precompilador SQL</h2>
<div class='content'><ul>
<li><strong>Rol</strong>: El precompilador SQL procesa las sentencias SQL embebidas antes que el compilador RPG.</li>
<li><strong>Función</strong>: Convierte las sentencias SQL en llamadas a la biblioteca de tiempo de ejecución de SQL.</li>
</ul>
</div><h2>SQLCA (Área de Comunicación SQL)</h2>
<div class='content'><ul>
<li><strong>Propósito</strong>: Una estructura utilizada para almacenar información sobre la ejecución de sentencias SQL.</li>
<li><strong>Campos clave</strong>:
<ul>
<li><code>SQLCODE</code>: Indica el éxito o fracaso de una sentencia SQL.</li>
<li><code>SQLSTATE</code>: Proporciona información detallada de error o estado.</li>
</ul>
</li>
</ul>
</div><h2>Declarar SQL en RPG</h2>
<div class='content'><ul>
<li><strong>Sintaxis</strong>: Las sentencias SQL se embeben dentro de RPG usando las palabras clave <code>EXEC SQL</code> y <code>END-EXEC</code>.</li>
<li><strong>Ejemplo</strong>:
<pre><code class="language-rpg">EXEC SQL
  SELECT COUNT(*) INTO :recordCount FROM myTable;
END-EXEC;
</code></pre>
</li>
</ul>
</div><h1>Operaciones básicas</h1>
<div class='content'></div><h2>Conectarse a una base de datos</h2>
<div class='content'><ul>
<li><strong>Sintaxis</strong>:
<pre><code class="language-rpg">EXEC SQL
  CONNECT TO myDatabase USER myUser USING myPassword;
END-EXEC;
</code></pre>
</li>
<li><strong>Explicación</strong>: Establece una conexión con la base de datos especificada utilizando las credenciales proporcionadas.</li>
</ul>
</div><h2>Sentencia SELECT simple</h2>
<div class='content'><ul>
<li><strong>Sintaxis</strong>:
<pre><code class="language-rpg">DCL-S recordCount INT(10);

EXEC SQL
  SELECT COUNT(*) INTO :recordCount FROM myTable;
END-EXEC;
</code></pre>
</li>
<li><strong>Explicación</strong>: Recupera el conteo de registros de <code>myTable</code> y lo almacena en la variable <code>recordCount</code>.</li>
</ul>
</div><h2>Insertar datos</h2>
<div class='content'><ul>
<li><strong>Sintaxis</strong>:
<pre><code class="language-rpg">DCL-S myValue CHAR(50);

myValue = 'Sample Data';

EXEC SQL
  INSERT INTO myTable (myColumn) VALUES (:myValue);
END-EXEC;
</code></pre>
</li>
<li><strong>Explicación</strong>: Inserta un nuevo registro en <code>myTable</code> con el valor de <code>myValue</code>.</li>
</ul>
</div><h1>Operaciones avanzadas</h1>
<div class='content'></div><h2>Uso de cursores</h2>
<div class='content'><ul>
<li>
<p><strong>Definición</strong>: Los cursores permiten el procesamiento fila por fila de los resultados de una consulta.</p>
</li>
<li>
<p><strong>Pasos</strong>:</p>
<ol>
<li>Declarar el cursor.</li>
<li>Abrir el cursor.</li>
<li>Recuperar filas del cursor.</li>
<li>Cerrar el cursor.</li>
</ol>
</li>
<li>
<p><strong>Ejemplo</strong>:</p>
<pre><code class="language-rpg">DCL-S myColumn CHAR(50);

EXEC SQL
  DECLARE myCursor CURSOR FOR
  SELECT myColumn FROM myTable;
END-EXEC;

EXEC SQL
  OPEN myCursor;
END-EXEC;

DOU SQLCODE &lt;&gt; 0;
  EXEC SQL
    FETCH myCursor INTO :myColumn;
  END-EXEC;

  // Procesar la fila recuperada
ENDDO;

EXEC SQL
  CLOSE myCursor;
END-EXEC;
</code></pre>
</li>
</ul>
</div><h2>Manejo de errores</h2>
<div class='content'><ul>
<li>
<p><strong>Usando SQLCODE</strong>:</p>
<pre><code class="language-rpg">EXEC SQL
  SELECT myColumn INTO :myValue FROM myTable WHERE myID = 1;
END-EXEC;

IF SQLCODE &lt;&gt; 0;
  // Manejar error
ENDIF;
</code></pre>
</li>
<li>
<p><strong>Usando SQLSTATE</strong>:</p>
<pre><code class="language-rpg">DCL-S sqlState CHAR(5);

EXEC SQL
  SELECT myColumn INTO :myValue FROM myTable WHERE myID = 1;
END-EXEC;

sqlState = SQLSTATE;

IF sqlState &lt;&gt; '00000';
  // Manejar error
ENDIF;
</code></pre>
</li>
</ul>
</div><h1>Consideraciones de rendimiento</h1>
<div class='content'><ul>
<li><strong>Uso de índices</strong>: Asegúrese de que las consultas utilicen índices para mejorar el rendimiento.</li>
<li><strong>Procesamiento por lotes</strong>: Use el procesamiento por lotes para manipulaciones de datos grandes para reducir la sobrecarga.</li>
<li><strong>Optimización</strong>: Revise y optimice regularmente las sentencias SQL para un mejor rendimiento.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El SQL embebido en RPG proporciona una forma poderosa de interactuar con bases de datos directamente dentro de sus programas RPG. Al comprender y utilizar el SQL embebido, puede escribir código más eficiente, legible y mantenible. Este tema cubrió los conceptos básicos del SQL embebido, incluyendo la conexión a una base de datos, la ejecución de operaciones SQL simples y avanzadas, y el manejo de errores. A medida que avance, considere explorar operaciones SQL más complejas y técnicas de optimización de rendimiento para aprovechar al máximo el poder del SQL embebido en RPG.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='sql-in-rpg'>&#x25C4;Introducción a SQL en RPG</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">SQL embebido en RPG</a>
	</div>
	<div class='col-4 text-end'>
					<a href='dynamic-sql'>SQL Dinámico &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
