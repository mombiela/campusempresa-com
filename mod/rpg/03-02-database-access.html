<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acceso a Bases de Datos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rpg/03-02-database-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rpg/03-02-database-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rpg/03-02-database-access" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/rpg/03-02-database-access" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/rpg/03-02-database-access" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-file-handling' title="Manejo de Archivos">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Acceso a Bases de Datos</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-data-structures' title="Estructuras de Datos">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos cómo interactuar con bases de datos utilizando RPG. Este es un aspecto crucial para cualquier aplicación empresarial, ya que la mayoría de las aplicaciones necesitan almacenar y recuperar datos de una base de datos.</p>
</div><h1>Objetivos del Módulo</h1>
<div class='content'><ul>
<li>Comprender los conceptos básicos de las bases de datos.</li>
<li>Aprender a conectarse a una base de datos desde un programa RPG.</li>
<li>Realizar operaciones básicas de CRUD (Crear, Leer, Actualizar, Eliminar) en una base de datos.</li>
<li>Manejar errores comunes y optimizar el acceso a la base de datos.</li>
</ul>
</div><h1>Conceptos Básicos de Bases de Datos</h1>
<div class='content'></div><h2>¿Qué es una Base de Datos?</h2>
<div class='content'><p>Una base de datos es una colección organizada de datos que se pueden acceder, gestionar y actualizar fácilmente. Las bases de datos se utilizan para almacenar información de manera estructurada y permiten realizar operaciones de consulta y manipulación de datos.</p>
</div><h2>Tipos de Bases de Datos</h2>
<div class='content'><ul>
<li><strong>Relacionales (RDBMS)</strong>: Utilizan tablas para almacenar datos y se basan en el modelo relacional. Ejemplos: MySQL, PostgreSQL, SQL Server.</li>
<li><strong>NoSQL</strong>: Utilizan diferentes modelos de datos como documentos, grafos, etc. Ejemplos: MongoDB, Cassandra.</li>
</ul>
</div><h1>Conectarse a una Base de Datos desde RPG</h1>
<div class='content'></div><h2>Configuración del Entorno</h2>
<div class='content'><p>Antes de comenzar a programar, asegúrate de tener acceso a una base de datos y las credenciales necesarias para conectarte a ella. También necesitarás un entorno de desarrollo configurado para RPG.</p>
</div><h2>Ejemplo de Conexión a una Base de Datos</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgZGJOYW1lIENoYXIoMTApIElueignTVlEQicpOwpEY2wtUyB1c2VyTmFtZSBDaGFyKDEwKSBJbnooJ215dXNlcicpOwpEY2wtUyBwYXNzd29yZCBDaGFyKDEwKSBJbnooJ215cGFzc3dvcmQnKTsKRGNsLVMgc3FsU3RhdGUgQ2hhcig1KTsKRGNsLVMgc3FsQ29kZSBJbnQoMTApOwoKRXhlYyBTUUwKICBDT05ORUNUIFRPIDpkYk5hbWUgVVNFUiA6dXNlck5hbWUgVVNJTkcgOnBhc3N3b3JkOwoKSWYgU1FMQ09ERSA8PiAwOwogIC8vIE1hbmVqbyBkZSBlcnJvcmVzCiAgRHNwbHkgKCdFcnJvciBhbCBjb25lY3RhciBhIGxhIGJhc2UgZGUgZGF0b3M6ICcgKyAlQ2hhcihTUUxDT0RFKSk7CiAgUmV0dXJuOwpFbmRJZjsKCkRzcGx5ICgnQ29uZXhpw7NuIGV4aXRvc2EgYSBsYSBiYXNlIGRlIGRhdG9zJyk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S dbName Char(10) Inz('MYDB');
Dcl-S userName Char(10) Inz('myuser');
Dcl-S password Char(10) Inz('mypassword');
Dcl-S sqlState Char(5);
Dcl-S sqlCode Int(10);

Exec SQL
  CONNECT TO :dbName USER :userName USING :password;

If SQLCODE &lt;&gt; 0;
  // Manejo de errores
  Dsply ('Error al conectar a la base de datos: ' + %Char(SQLCODE));
  Return;
EndIf;

Dsply ('Conexi&oacute;n exitosa a la base de datos');</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ul>
<li><strong>Dcl-S</strong>: Declara variables.</li>
<li><strong>Exec SQL CONNECT</strong>: Comando SQL para conectarse a la base de datos.</li>
<li><strong>If SQLCODE &lt;&gt; 0</strong>: Verifica si hubo un error en la conexión.</li>
<li><strong>Dsply</strong>: Muestra un mensaje en la pantalla.</li>
</ul>
</div><h1>Operaciones CRUD</h1>
<div class='content'></div><h2>Crear (INSERT)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgZW1wSWQgSW50KDEwKSBJbnooMTAwMSk7CkRjbC1TIGVtcE5hbWUgQ2hhcig1MCkgSW56KCdKb2huIERvZScpOwpEY2wtUyBlbXBEZXB0IENoYXIoMTApIElueignSFInKTsKCkV4ZWMgU1FMCiAgSU5TRVJUIElOVE8gZW1wbG95ZWVzIChpZCwgbmFtZSwgZGVwYXJ0bWVudCkKICBWQUxVRVMgKDplbXBJZCwgOmVtcE5hbWUsIDplbXBEZXB0KTsKCklmIFNRTENPREUgPD4gMDsKICBEc3BseSAoJ0Vycm9yIGFsIGluc2VydGFyIGRhdG9zOiAnICsgJUNoYXIoU1FMQ09ERSkpOwpFbHNlOwogIERzcGx5ICgnRGF0b3MgaW5zZXJ0YWRvcyBjb3JyZWN0YW1lbnRlJyk7CkVuZElmOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S empId Int(10) Inz(1001);
Dcl-S empName Char(50) Inz('John Doe');
Dcl-S empDept Char(10) Inz('HR');

Exec SQL
  INSERT INTO employees (id, name, department)
  VALUES (:empId, :empName, :empDept);

If SQLCODE &lt;&gt; 0;
  Dsply ('Error al insertar datos: ' + %Char(SQLCODE));
Else;
  Dsply ('Datos insertados correctamente');
EndIf;</pre></div><div class='content'></div><h2>Leer (SELECT)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgZW1wSWQgSW50KDEwKSBJbnooMTAwMSk7CkRjbC1TIGVtcE5hbWUgQ2hhcig1MCk7CkRjbC1TIGVtcERlcHQgQ2hhcigxMCk7CgpFeGVjIFNRTAogIFNFTEVDVCBuYW1lLCBkZXBhcnRtZW50IElOVE8gOmVtcE5hbWUsIDplbXBEZXB0CiAgRlJPTSBlbXBsb3llZXMKICBXSEVSRSBpZCA9IDplbXBJZDsKCklmIFNRTENPREUgPD4gMDsKICBEc3BseSAoJ0Vycm9yIGFsIGxlZXIgZGF0b3M6ICcgKyAlQ2hhcihTUUxDT0RFKSk7CkVsc2U7CiAgRHNwbHkgKCdOb21icmU6ICcgKyBlbXBOYW1lICsgJywgRGVwYXJ0YW1lbnRvOiAnICsgZW1wRGVwdCk7CkVuZElmOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S empId Int(10) Inz(1001);
Dcl-S empName Char(50);
Dcl-S empDept Char(10);

Exec SQL
  SELECT name, department INTO :empName, :empDept
  FROM employees
  WHERE id = :empId;

If SQLCODE &lt;&gt; 0;
  Dsply ('Error al leer datos: ' + %Char(SQLCODE));
Else;
  Dsply ('Nombre: ' + empName + ', Departamento: ' + empDept);
EndIf;</pre></div><div class='content'></div><h2>Actualizar (UPDATE)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgZW1wSWQgSW50KDEwKSBJbnooMTAwMSk7CkRjbC1TIG5ld0RlcHQgQ2hhcigxMCkgSW56KCdJVCcpOwoKRXhlYyBTUUwKICBVUERBVEUgZW1wbG95ZWVzCiAgU0VUIGRlcGFydG1lbnQgPSA6bmV3RGVwdAogIFdIRVJFIGlkID0gOmVtcElkOwoKSWYgU1FMQ09ERSA8PiAwOwogIERzcGx5ICgnRXJyb3IgYWwgYWN0dWFsaXphciBkYXRvczogJyArICVDaGFyKFNRTENPREUpKTsKRWxzZTsKICBEc3BseSAoJ0RhdG9zIGFjdHVhbGl6YWRvcyBjb3JyZWN0YW1lbnRlJyk7CkVuZElmOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S empId Int(10) Inz(1001);
Dcl-S newDept Char(10) Inz('IT');

Exec SQL
  UPDATE employees
  SET department = :newDept
  WHERE id = :empId;

If SQLCODE &lt;&gt; 0;
  Dsply ('Error al actualizar datos: ' + %Char(SQLCODE));
Else;
  Dsply ('Datos actualizados correctamente');
EndIf;</pre></div><div class='content'></div><h2>Eliminar (DELETE)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgZW1wSWQgSW50KDEwKSBJbnooMTAwMSk7CgpFeGVjIFNRTAogIERFTEVURSBGUk9NIGVtcGxveWVlcwogIFdIRVJFIGlkID0gOmVtcElkOwoKSWYgU1FMQ09ERSA8PiAwOwogIERzcGx5ICgnRXJyb3IgYWwgZWxpbWluYXIgZGF0b3M6ICcgKyAlQ2hhcihTUUxDT0RFKSk7CkVsc2U7CiAgRHNwbHkgKCdEYXRvcyBlbGltaW5hZG9zIGNvcnJlY3RhbWVudGUnKTsKRW5kSWY7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S empId Int(10) Inz(1001);

Exec SQL
  DELETE FROM employees
  WHERE id = :empId;

If SQLCODE &lt;&gt; 0;
  Dsply ('Error al eliminar datos: ' + %Char(SQLCODE));
Else;
  Dsply ('Datos eliminados correctamente');
EndIf;</pre></div><div class='content'></div><h1>Manejo de Errores Comunes</h1>
<div class='content'></div><h2>Errores de Conexión</h2>
<div class='content'><ul>
<li><strong>SQLCODE -104</strong>: Error de sintaxis en la instrucción SQL.</li>
<li><strong>SQLCODE -204</strong>: Objeto no encontrado en la base de datos.</li>
</ul>
</div><h2>Errores de Operación</h2>
<div class='content'><ul>
<li><strong>SQLCODE -803</strong>: Violación de clave única.</li>
<li><strong>SQLCODE -530</strong>: Violación de restricción de clave foránea.</li>
</ul>
</div><h1>Consejos Adicionales</h1>
<div class='content'><ul>
<li><strong>Optimización</strong>: Utiliza índices en las tablas para mejorar el rendimiento de las consultas.</li>
<li><strong>Seguridad</strong>: Nunca almacenes contraseñas en texto plano y utiliza conexiones seguras.</li>
</ul>
</div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><ol>
<li>Conéctate a una base de datos.</li>
<li>Crea una tabla llamada <code>products</code> con las columnas <code>id</code>, <code>name</code>, y <code>price</code>.</li>
<li>Inserta tres registros en la tabla <code>products</code>.</li>
<li>Realiza una consulta para obtener todos los productos cuyo precio sea mayor a 50.</li>
<li>Actualiza el precio de un producto específico.</li>
<li>Elimina un producto de la tabla.</li>
</ol>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29uZXhpw7NuIGEgbGEgYmFzZSBkZSBkYXRvcwpFeGVjIFNRTAogIENPTk5FQ1QgVE8gOmRiTmFtZSBVU0VSIDp1c2VyTmFtZSBVU0lORyA6cGFzc3dvcmQ7CgovLyBDcmVhciB0YWJsYQpFeGVjIFNRTAogIENSRUFURSBUQUJMRSBwcm9kdWN0cyAoCiAgICBpZCBJTlQgUFJJTUFSWSBLRVksCiAgICBuYW1lIENIQVIoNTApLAogICAgcHJpY2UgREVDSU1BTCgxMCwgMikKICApOwoKLy8gSW5zZXJ0YXIgcmVnaXN0cm9zCkV4ZWMgU1FMCiAgSU5TRVJUIElOVE8gcHJvZHVjdHMgKGlkLCBuYW1lLCBwcmljZSkgVkFMVUVTICgxLCAnUHJvZHVjdCBBJywgMzAuMDApOwpFeGVjIFNRTAogIElOU0VSVCBJTlRPIHByb2R1Y3RzIChpZCwgbmFtZSwgcHJpY2UpIFZBTFVFUyAoMiwgJ1Byb2R1Y3QgQicsIDYwLjAwKTsKRXhlYyBTUUwKICBJTlNFUlQgSU5UTyBwcm9kdWN0cyAoaWQsIG5hbWUsIHByaWNlKSBWQUxVRVMgKDMsICdQcm9kdWN0IEMnLCA5MC4wMCk7CgovLyBDb25zdWx0YXIgcHJvZHVjdG9zIGNvbiBwcmVjaW8gbWF5b3IgYSA1MApFeGVjIFNRTAogIFNFTEVDVCBuYW1lLCBwcmljZSBJTlRPIDpwcm9kTmFtZSwgOnByb2RQcmljZQogIEZST00gcHJvZHVjdHMKICBXSEVSRSBwcmljZSA+IDUwOwoKLy8gQWN0dWFsaXphciBwcmVjaW8gZGUgdW4gcHJvZHVjdG8KRXhlYyBTUUwKICBVUERBVEUgcHJvZHVjdHMKICBTRVQgcHJpY2UgPSA3MC4wMAogIFdIRVJFIGlkID0gMjsKCi8vIEVsaW1pbmFyIHVuIHByb2R1Y3RvCkV4ZWMgU1FMCiAgREVMRVRFIEZST00gcHJvZHVjdHMKICBXSEVSRSBpZCA9IDE7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Conexi&oacute;n a la base de datos
Exec SQL
  CONNECT TO :dbName USER :userName USING :password;

// Crear tabla
Exec SQL
  CREATE TABLE products (
    id INT PRIMARY KEY,
    name CHAR(50),
    price DECIMAL(10, 2)
  );

// Insertar registros
Exec SQL
  INSERT INTO products (id, name, price) VALUES (1, 'Product A', 30.00);
Exec SQL
  INSERT INTO products (id, name, price) VALUES (2, 'Product B', 60.00);
Exec SQL
  INSERT INTO products (id, name, price) VALUES (3, 'Product C', 90.00);

// Consultar productos con precio mayor a 50
Exec SQL
  SELECT name, price INTO :prodName, :prodPrice
  FROM products
  WHERE price &gt; 50;

// Actualizar precio de un producto
Exec SQL
  UPDATE products
  SET price = 70.00
  WHERE id = 2;

// Eliminar un producto
Exec SQL
  DELETE FROM products
  WHERE id = 1;</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>En este módulo, hemos aprendido cómo conectarnos a una base de datos desde un programa RPG y realizar operaciones básicas de CRUD. También hemos visto cómo manejar errores comunes y optimizar el acceso a la base de datos. Estos conocimientos son fundamentales para desarrollar aplicaciones empresariales robustas y eficientes.</p>
<p>En el próximo módulo, exploraremos las estructuras de datos y cómo utilizarlas eficazmente en RPG.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-01-file-handling' title="Manejo de Archivos">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-03-data-structures' title="Estructuras de Datos">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
