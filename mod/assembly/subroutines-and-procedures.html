<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subrutinas y Procedimientos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/assembly/subroutines-and-procedures" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/assembly/subroutines-and-procedures" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/assembly/subroutines-and-procedures" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/assembly/subroutines-and-procedures" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/assembly/subroutines-and-procedures" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atención!</b> Ha habido un error en la generación del curso y puede contener errores de traducción.Estamos trabajando para solucinarlo por lo que se deben usar los contenidos con cuidado.Se puede consultar el contenido correcto en otro idioma en el siguiente enlace:<br>
						<a href="https://enterprisecampus.net/mod/assembly/subroutines-and-procedures">https://enterprisecampus.net/mod/assembly/subroutines-and-procedures</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='loops-and-iteration'>&#x25C4;Bucles e Iteración</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Subrutinas y Procedimientos</a>
	</div>
	<div class='col-4 text-end'>
					<a href='stack-operations'>Operaciones con la Pila &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a Subrutinas y Procedimientos</h1>
<div class='content'><p>Las subrutinas y procedimientos son conceptos fundamentales en la programación en lenguaje ensamblador. Permiten descomponer tareas complejas en piezas más pequeñas y manejables, haciendo que tu código sea más modular, legible y mantenible.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Subrutina</strong>: Una secuencia de instrucciones diseñada para realizar una tarea específica, que puede ser llamada desde diferentes partes de un programa.</li>
<li><strong>Procedimiento</strong>: Otro término para subrutina, a menudo usado indistintamente.</li>
<li><strong>Llamada</strong>: La instrucción utilizada para invocar una subrutina.</li>
<li><strong>Retorno</strong>: La instrucción utilizada para devolver el control al código que llamó después de que la subrutina haya terminado de ejecutarse.</li>
<li><strong>Pila</strong>: Una estructura de memoria especial utilizada para almacenar direcciones de retorno y variables locales durante las llamadas a subrutinas.</li>
</ul>
</div><h1>Estructura Básica de una Subrutina</h1>
<div class='content'><p>Una subrutina típicamente consiste en:</p>
<ol>
<li><strong>Prólogo</strong>: Código que configura la subrutina, como guardar registros y configurar el marco de la pila.</li>
<li><strong>Cuerpo</strong>: El código principal de la subrutina que realiza la tarea específica.</li>
<li><strong>Epilogo</strong>: Código que limpia, restaura registros y devuelve el control al código que llamó.</li>
</ol>
</div><h2>Ejemplo: Subrutina Simple en Ensamblador x86</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAuZGF0YQogICAgbXNnIGRiICfCoUhvbGEsIE11bmRvIScsIDAKCnNlY3Rpb24gLnRleHQKICAgIGdsb2JhbCBfc3RhcnQKCl9zdGFydDoKICAgIGNhbGwgcHJpbnRfbWVzc2FnZQogICAgOyBTYWxpciBkZWwgcHJvZ3JhbWEKICAgIG1vdiBlYXgsIDYwICAgICAgICAgOyBzeXNjYWxsOiBleGl0CiAgICB4b3IgZWRpLCBlZGkgICAgICAgIDsgZXN0YWRvOiAwCiAgICBzeXNjYWxsCgpwcmludF9tZXNzYWdlOgogICAgOyBQcsOzbG9nbwogICAgcHVzaCByYnAgICAgICAgICAgICA7IEd1YXJkYXIgcHVudGVybyBiYXNlCiAgICBtb3YgcmJwLCByc3AgICAgICAgIDsgQ29uZmlndXJhciBwdW50ZXJvIGJhc2UgYWwgcHVudGVybyBkZSBsYSBwaWxhCgogICAgOyBDdWVycG8KICAgIG1vdiByYXgsIDEgICAgICAgICAgOyBzeXNjYWxsOiB3cml0ZQogICAgbW92IHJkaSwgMSAgICAgICAgICA7IGRlc2NyaXB0b3IgZGUgYXJjaGl2bzogc3Rkb3V0CiAgICBtb3YgcnNpLCBtc2cgICAgICAgIDsgbWVuc2FqZSBhIGVzY3JpYmlyCiAgICBtb3YgcmR4LCAxMyAgICAgICAgIDsgbG9uZ2l0dWQgZGVsIG1lbnNhamUKICAgIHN5c2NhbGwKCiAgICA7IEVww61sb2dvCiAgICBtb3YgcnNwLCByYnAgICAgICAgIDsgUmVzdGF1cmFyIHB1bnRlcm8gZGUgbGEgcGlsYQogICAgcG9wIHJicCAgICAgICAgICAgICA7IFJlc3RhdXJhciBwdW50ZXJvIGJhc2UKICAgIHJldCAgICAgICAgICAgICAgICAgOyBEZXZvbHZlciBjb250cm9sIGFsIGxsYW1hZG9y"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .data
    msg db '&iexcl;Hola, Mundo!', 0

section .text
    global _start

_start:
    call print_message
    ; Salir del programa
    mov eax, 60         ; syscall: exit
    xor edi, edi        ; estado: 0
    syscall

print_message:
    ; Pr&oacute;logo
    push rbp            ; Guardar puntero base
    mov rbp, rsp        ; Configurar puntero base al puntero de la pila

    ; Cuerpo
    mov rax, 1          ; syscall: write
    mov rdi, 1          ; descriptor de archivo: stdout
    mov rsi, msg        ; mensaje a escribir
    mov rdx, 13         ; longitud del mensaje
    syscall

    ; Ep&iacute;logo
    mov rsp, rbp        ; Restaurar puntero de la pila
    pop rbp             ; Restaurar puntero base
    ret                 ; Devolver control al llamador</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>Prólogo</strong>: <code>push rbp</code> y <code>mov rbp, rsp</code> guardan el puntero base y configuran el marco de la pila.</li>
<li><strong>Cuerpo</strong>: El código entre el prólogo y el epílogo realiza la tarea de imprimir un mensaje.</li>
<li><strong>Epílogo</strong>: <code>mov rsp, rbp</code> y <code>pop rbp</code> restauran el puntero de la pila y el puntero base, y <code>ret</code> devuelve el control al llamador.</li>
</ul>
</div><h1>Conceptos Avanzados de Subrutinas</h1>
<h2>Pasar Argumentos</h2>
<div class='content'><p>Los argumentos pueden ser pasados a las subrutinas utilizando registros o la pila. En x86-64, los primeros seis argumentos enteros o punteros se pasan típicamente en los registros <code>rdi</code>, <code>rsi</code>, <code>rdx</code>, <code>rcx</code>, <code>r8</code>, y <code>r9</code>.</p>
</div><h2>Ejemplo: Subrutina con Argumentos</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAudGV4dAogICAgZ2xvYmFsIF9zdGFydAoKX3N0YXJ0OgogICAgbW92IHJkaSwgNSAgICAgICAgICA7IFByaW1lciBhcmd1bWVudG8KICAgIG1vdiByc2ksIDMgICAgICAgICAgOyBTZWd1bmRvIGFyZ3VtZW50bwogICAgY2FsbCBhZGRfbnVtYmVycwogICAgOyBTYWxpciBkZWwgcHJvZ3JhbWEKICAgIG1vdiBlYXgsIDYwICAgICAgICAgOyBzeXNjYWxsOiBleGl0CiAgICB4b3IgZWRpLCBlZGkgICAgICAgIDsgZXN0YWRvOiAwCiAgICBzeXNjYWxsCgphZGRfbnVtYmVyczoKICAgIDsgUHLDs2xvZ28KICAgIHB1c2ggcmJwCiAgICBtb3YgcmJwLCByc3AKCiAgICA7IEN1ZXJwbwogICAgbW92IHJheCwgcmRpICAgICAgICA7IENhcmdhciBwcmltZXIgYXJndW1lbnRvIGVuIHJheAogICAgYWRkIHJheCwgcnNpICAgICAgICA7IFN1bWFyIHNlZ3VuZG8gYXJndW1lbnRvIGEgcmF4CgogICAgOyBFcMOtbG9nbwogICAgbW92IHJzcCwgcmJwCiAgICBwb3AgcmJwCiAgICByZXQ="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .text
    global _start

_start:
    mov rdi, 5          ; Primer argumento
    mov rsi, 3          ; Segundo argumento
    call add_numbers
    ; Salir del programa
    mov eax, 60         ; syscall: exit
    xor edi, edi        ; estado: 0
    syscall

add_numbers:
    ; Pr&oacute;logo
    push rbp
    mov rbp, rsp

    ; Cuerpo
    mov rax, rdi        ; Cargar primer argumento en rax
    add rax, rsi        ; Sumar segundo argumento a rax

    ; Ep&iacute;logo
    mov rsp, rbp
    pop rbp
    ret</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li>Los argumentos <code>5</code> y <code>3</code> se pasan a la subrutina <code>add_numbers</code> utilizando los registros <code>rdi</code> y <code>rsi</code>.</li>
<li>La subrutina suma estos dos números y almacena el resultado en <code>rax</code>.</li>
</ul>
</div><h2>Variables Locales</h2>
<div class='content'><p>Las variables locales pueden ser almacenadas en la pila. Esto se hace ajustando el puntero de la pila en el prólogo y el epílogo.</p>
</div><h2>Ejemplo: Subrutina con Variables Locales</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VjdGlvbiAudGV4dAogICAgZ2xvYmFsIF9zdGFydAoKX3N0YXJ0OgogICAgY2FsbCBjYWxjdWxhdGUKICAgIDsgU2FsaXIgZGVsIHByb2dyYW1hCiAgICBtb3YgZWF4LCA2MCAgICAgICAgIDsgc3lzY2FsbDogZXhpdAogICAgeG9yIGVkaSwgZWRpICAgICAgICA7IGVzdGFkbzogMAogICAgc3lzY2FsbAoKY2FsY3VsYXRlOgogICAgOyBQcsOzbG9nbwogICAgcHVzaCByYnAKICAgIG1vdiByYnAsIHJzcAogICAgc3ViIHJzcCwgMTYgICAgICAgICA7IEFzaWduYXIgZXNwYWNpbyBwYXJhIHZhcmlhYmxlcyBsb2NhbGVzCgogICAgOyBDdWVycG8KICAgIG1vdiBkd29yZCBbcmJwLTRdLCAxMCAgIDsgVmFyaWFibGUgbG9jYWwgeCA9IDEwCiAgICBtb3YgZHdvcmQgW3JicC04XSwgMjAgICA7IFZhcmlhYmxlIGxvY2FsIHkgPSAyMAogICAgbW92IGVheCwgW3JicC00XSAgICAgICAgOyBDYXJnYXIgeCBlbiBlYXgKICAgIGFkZCBlYXgsIFtyYnAtOF0gICAgICAgIDsgU3VtYXIgeSBhIGVheAoKICAgIDsgRXDDrWxvZ28KICAgIG1vdiByc3AsIHJicAogICAgcG9wIHJicAogICAgcmV0"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>section .text
    global _start

_start:
    call calculate
    ; Salir del programa
    mov eax, 60         ; syscall: exit
    xor edi, edi        ; estado: 0
    syscall

calculate:
    ; Pr&oacute;logo
    push rbp
    mov rbp, rsp
    sub rsp, 16         ; Asignar espacio para variables locales

    ; Cuerpo
    mov dword [rbp-4], 10   ; Variable local x = 10
    mov dword [rbp-8], 20   ; Variable local y = 20
    mov eax, [rbp-4]        ; Cargar x en eax
    add eax, [rbp-8]        ; Sumar y a eax

    ; Ep&iacute;logo
    mov rsp, rbp
    pop rbp
    ret</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li>El puntero de la pila se ajusta con <code>sub rsp, 16</code> para asignar espacio para variables locales.</li>
<li>Las variables locales <code>x</code> y <code>y</code> se almacenan en <code>[rbp-4]</code> y <code>[rbp-8]</code>, respectivamente.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Las subrutinas y procedimientos son esenciales para escribir código ensamblador modular y mantenible. Al entender cómo estructurar subrutinas, pasar argumentos y usar variables locales, puedes crear programas más complejos y eficientes. Practica escribiendo y llamando subrutinas para volverte competente en estas técnicas.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='loops-and-iteration'>&#x25C4;Bucles e Iteración</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Subrutinas y Procedimientos</a>
	</div>
	<div class='col-4 text-end'>
					<a href='stack-operations'>Operaciones con la Pila &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
