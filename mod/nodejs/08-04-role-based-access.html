<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Control de Acceso Basado en Roles</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/08-04-role-based-access" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/08-04-role-based-access" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/08-04-role-based-access" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/nodejs/08-04-role-based-access" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/nodejs/08-04-role-based-access" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contenido del curso
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contenido del curso
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-jwt-authentication' title="Autenticación JWT">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Control de Acceso Basado en Roles</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-01-introduction-testing' title="Introducción a las Pruebas">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>El control de acceso basado en roles (RBAC, por sus siglas en inglés) es una metodología de seguridad que restringe el acceso a los recursos del sistema en función de los roles asignados a los usuarios. En una aplicación Node.js, RBAC se puede implementar para asegurar que solo los usuarios con los permisos adecuados puedan acceder a ciertas rutas o realizar acciones específicas.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ol>
<li><strong>Roles</strong>: Un conjunto de permisos que se asignan a los usuarios. Ejemplos comunes incluyen &quot;admin&quot;, &quot;editor&quot; y &quot;viewer&quot;.</li>
<li><strong>Permisos</strong>: Acciones específicas que un rol puede realizar, como &quot;crear&quot;, &quot;leer&quot;, &quot;actualizar&quot; y &quot;eliminar&quot;.</li>
<li><strong>Usuarios</strong>: Entidades que se autentican en el sistema y se les asignan roles.</li>
</ol>
</div><h1>Implementación de RBAC en Node.js</h1>
<div class='content'></div><h2>Paso 1: Definir Roles y Permisos</h2>
<div class='content'><p>Primero, definimos los roles y los permisos asociados. Esto se puede hacer en un archivo de configuración o directamente en el código.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgcm9sZXMgPSB7CiAgYWRtaW46IFsnY3JlYXRlJywgJ3JlYWQnLCAndXBkYXRlJywgJ2RlbGV0ZSddLAogIGVkaXRvcjogWydjcmVhdGUnLCAncmVhZCcsICd1cGRhdGUnXSwKICB2aWV3ZXI6IFsncmVhZCddCn07"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const roles = {
  admin: ['create', 'read', 'update', 'delete'],
  editor: ['create', 'read', 'update'],
  viewer: ['read']
};</pre></div><div class='content'></div><h2>Paso 2: Middleware de Autorización</h2>
<div class='content'><p>Creamos un middleware que verifique si el usuario tiene el rol necesario para acceder a una ruta específica.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgYXV0aG9yaXplID0gKHJlcXVpcmVkUm9sZSkgPT4gewogIHJldHVybiAocmVxLCByZXMsIG5leHQpID0+IHsKICAgIGNvbnN0IHVzZXJSb2xlID0gcmVxLnVzZXIucm9sZTsgLy8gQXN1bWltb3MgcXVlIGVsIHJvbCBkZWwgdXN1YXJpbyBlc3TDoSBlbiByZXEudXNlci5yb2xlCgogICAgaWYgKHJvbGVzW3VzZXJSb2xlXSAmJiByb2xlc1t1c2VyUm9sZV0uaW5jbHVkZXMocmVxdWlyZWRSb2xlKSkgewogICAgICBuZXh0KCk7IC8vIEVsIHVzdWFyaW8gdGllbmUgZWwgcGVybWlzbyBuZWNlc2FyaW8KICAgIH0gZWxzZSB7CiAgICAgIHJlcy5zdGF0dXMoNDAzKS5qc29uKHsgbWVzc2FnZTogJ0FjY2VzbyBkZW5lZ2FkbycgfSk7CiAgICB9CiAgfTsKfTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const authorize = (requiredRole) =&gt; {
  return (req, res, next) =&gt; {
    const userRole = req.user.role; // Asumimos que el rol del usuario est&aacute; en req.user.role

    if (roles[userRole] &amp;&amp; roles[userRole].includes(requiredRole)) {
      next(); // El usuario tiene el permiso necesario
    } else {
      res.status(403).json({ message: 'Acceso denegado' });
    }
  };
};</pre></div><div class='content'></div><h2>Paso 3: Aplicar el Middleware a las Rutas</h2>
<div class='content'><p>Utilizamos el middleware de autorización en las rutas que queremos proteger.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYXBwID0gZXhwcmVzcygpOwoKLy8gTWlkZGxld2FyZSBkZSBhdXRlbnRpY2FjacOzbiAoZWplbXBsbykKYXBwLnVzZSgocmVxLCByZXMsIG5leHQpID0+IHsKICAvLyBTaW11bGFtb3MgdW4gdXN1YXJpbyBhdXRlbnRpY2FkbwogIHJlcS51c2VyID0geyByb2xlOiAnZWRpdG9yJyB9OyAvLyBFc3RvIG5vcm1hbG1lbnRlIHNlIGhhcsOtYSBtZWRpYW50ZSB1biBtaWRkbGV3YXJlIGRlIGF1dGVudGljYWNpw7NuIHJlYWwKICBuZXh0KCk7Cn0pOwoKYXBwLnBvc3QoJy9jcmVhdGUnLCBhdXRob3JpemUoJ2NyZWF0ZScpLCAocmVxLCByZXMpID0+IHsKICByZXMuc2VuZCgnUmVjdXJzbyBjcmVhZG8nKTsKfSk7CgphcHAuZ2V0KCcvcmVhZCcsIGF1dGhvcml6ZSgncmVhZCcpLCAocmVxLCByZXMpID0+IHsKICByZXMuc2VuZCgnUmVjdXJzbyBsZcOtZG8nKTsKfSk7CgphcHAucHV0KCcvdXBkYXRlJywgYXV0aG9yaXplKCd1cGRhdGUnKSwgKHJlcSwgcmVzKSA9PiB7CiAgcmVzLnNlbmQoJ1JlY3Vyc28gYWN0dWFsaXphZG8nKTsKfSk7CgphcHAuZGVsZXRlKCcvZGVsZXRlJywgYXV0aG9yaXplKCdkZWxldGUnKSwgKHJlcSwgcmVzKSA9PiB7CiAgcmVzLnNlbmQoJ1JlY3Vyc28gZWxpbWluYWRvJyk7Cn0pOwoKYXBwLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgY29uc29sZS5sb2coJ1NlcnZpZG9yIGVzY3VjaGFuZG8gZW4gZWwgcHVlcnRvIDMwMDAnKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const app = express();

// Middleware de autenticaci&oacute;n (ejemplo)
app.use((req, res, next) =&gt; {
  // Simulamos un usuario autenticado
  req.user = { role: 'editor' }; // Esto normalmente se har&iacute;a mediante un middleware de autenticaci&oacute;n real
  next();
});

app.post('/create', authorize('create'), (req, res) =&gt; {
  res.send('Recurso creado');
});

app.get('/read', authorize('read'), (req, res) =&gt; {
  res.send('Recurso le&iacute;do');
});

app.put('/update', authorize('update'), (req, res) =&gt; {
  res.send('Recurso actualizado');
});

app.delete('/delete', authorize('delete'), (req, res) =&gt; {
  res.send('Recurso eliminado');
});

app.listen(3000, () =&gt; {
  console.log('Servidor escuchando en el puerto 3000');
});</pre></div><div class='content'></div><h2>Ejercicio Práctico</h2>
<div class='content'><p><strong>Objetivo</strong>: Implementar un sistema de control de acceso basado en roles en una aplicación Node.js.</p>
<ol>
<li><strong>Definir Roles y Permisos</strong>: Crea un archivo <code>roles.js</code> y define los roles y permisos.</li>
<li><strong>Middleware de Autorización</strong>: Crea un middleware <code>authorize.js</code> que verifique los permisos del usuario.</li>
<li><strong>Aplicar Middleware</strong>: Protege las rutas de tu aplicación utilizando el middleware de autorización.</li>
</ol>
<p><strong>Solución</strong>:</p>
<ol>
<li>
<p><strong>roles.js</strong>:</p>
<pre><code class="language-javascript">const roles = {
  admin: ['create', 'read', 'update', 'delete'],
  editor: ['create', 'read', 'update'],
  viewer: ['read']
};

module.exports = roles;
</code></pre>
</li>
<li>
<p><strong>authorize.js</strong>:</p>
<pre><code class="language-javascript">const roles = require('./roles');

const authorize = (requiredRole) =&gt; {
  return (req, res, next) =&gt; {
    const userRole = req.user.role;

    if (roles[userRole] &amp;&amp; roles[userRole].includes(requiredRole)) {
      next();
    } else {
      res.status(403).json({ message: 'Acceso denegado' });
    }
  };
};

module.exports = authorize;
</code></pre>
</li>
<li>
<p><strong>app.js</strong>:</p>
<pre><code class="language-javascript">const express = require('express');
const authorize = require('./authorize');
const app = express();

app.use((req, res, next) =&gt; {
  req.user = { role: 'editor' };
  next();
});

app.post('/create', authorize('create'), (req, res) =&gt; {
  res.send('Recurso creado');
});

app.get('/read', authorize('read'), (req, res) =&gt; {
  res.send('Recurso leído');
});

app.put('/update', authorize('update'), (req, res) =&gt; {
  res.send('Recurso actualizado');
});

app.delete('/delete', authorize('delete'), (req, res) =&gt; {
  res.send('Recurso eliminado');
});

app.listen(3000, () =&gt; {
  console.log('Servidor escuchando en el puerto 3000');
});
</code></pre>
</li>
</ol>
</div><h2>Errores Comunes y Consejos</h2>
<div class='content'><ol>
<li><strong>Olvidar Asignar Roles a los Usuarios</strong>: Asegúrate de que cada usuario tenga un rol asignado. Esto generalmente se hace durante el proceso de autenticación.</li>
<li><strong>Roles Mal Definidos</strong>: Verifica que los roles y permisos estén correctamente definidos y que no haya errores tipográficos.</li>
<li><strong>No Proteger Rutas Críticas</strong>: Asegúrate de aplicar el middleware de autorización a todas las rutas que requieren protección.</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>El control de acceso basado en roles es una técnica esencial para asegurar que solo los usuarios autorizados puedan realizar ciertas acciones en tu aplicación. Al implementar RBAC en Node.js, puedes mejorar significativamente la seguridad y la gestión de permisos en tu aplicación. En el siguiente módulo, exploraremos cómo realizar pruebas y depuración en aplicaciones Node.js para asegurar su correcto funcionamiento.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-03-jwt-authentication' title="Autenticación JWT">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-01-introduction-testing' title="Introducción a las Pruebas">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curso de Node.js</h1>
<h2>Módulo 1: Introducción a Node.js</h2>
<ul>
<li><a href="01-01-what-is-nodejs">¿Qué es Node.js?</a></li>
<li><a href="01-02-setting-up-nodejs">Configuración de Node.js</a></li>
<li><a href="01-03-first-nodejs-program">Tu Primer Programa en Node.js</a></li>
<li><a href="01-04-nodejs-repl">Node.js REPL</a></li>
</ul>
<h2>Módulo 2: Conceptos Básicos</h2>
<ul>
<li><a href="02-01-nodejs-architecture">Arquitectura de Node.js</a></li>
<li><a href="02-02-event-loop">Event Loop</a></li>
<li><a href="02-03-callbacks-async">Callbacks y Programación Asíncrona</a></li>
<li><a href="02-04-modules-require">Módulos y require()</a></li>
</ul>
<h2>Módulo 3: Sistema de Archivos y E/S</h2>
<ul>
<li><a href="03-01-reading-writing-files">Lectura y Escritura de Archivos</a></li>
<li><a href="03-02-working-with-streams">Trabajando con Streams</a></li>
<li><a href="03-03-file-system-module">Módulo del Sistema de Archivos</a></li>
<li><a href="03-04-path-module">Módulo Path</a></li>
</ul>
<h2>Módulo 4: HTTP y Servidores Web</h2>
<ul>
<li><a href="04-01-simple-http-server">Creando un Servidor HTTP Simple</a></li>
<li><a href="04-02-handling-requests-responses">Manejo de Solicitudes y Respuestas</a></li>
<li><a href="04-03-serving-static-files">Sirviendo Archivos Estáticos</a></li>
<li><a href="04-04-routing">Enrutamiento</a></li>
</ul>
<h2>Módulo 5: NPM y Gestión de Paquetes</h2>
<ul>
<li><a href="05-01-introduction-to-npm">Introducción a NPM</a></li>
<li><a href="05-02-installing-using-packages">Instalación y Uso de Paquetes</a></li>
<li><a href="05-03-creating-publishing-packages">Creación y Publicación de Paquetes</a></li>
<li><a href="05-04-semantic-versioning">Versionado Semántico</a></li>
</ul>
<h2>Módulo 6: Framework Express.js</h2>
<ul>
<li><a href="06-01-introduction-to-express">Introducción a Express.js</a></li>
<li><a href="06-02-setting-up-express">Configuración de una Aplicación Express</a></li>
<li><a href="06-03-middleware">Middleware</a></li>
<li><a href="06-04-routing-express">Enrutamiento en Express</a></li>
<li><a href="06-05-error-handling">Manejo de Errores</a></li>
</ul>
<h2>Módulo 7: Bases de Datos y ORMs</h2>
<ul>
<li><a href="07-01-introduction-databases">Introducción a las Bases de Datos</a></li>
<li><a href="07-02-mongodb-mongoose">Usando MongoDB con Mongoose</a></li>
<li><a href="07-03-sql-sequelize">Usando Bases de Datos SQL con Sequelize</a></li>
<li><a href="07-04-crud-operations">Operaciones CRUD</a></li>
</ul>
<h2>Módulo 8: Autenticación y Autorización</h2>
<ul>
<li><a href="08-01-introduction-authentication">Introducción a la Autenticación</a></li>
<li><a href="08-02-using-passport">Usando Passport.js</a></li>
<li><a href="08-03-jwt-authentication">Autenticación JWT</a></li>
<li><a href="08-04-role-based-access">Control de Acceso Basado en Roles</a></li>
</ul>
<h2>Módulo 9: Pruebas y Depuración</h2>
<ul>
<li><a href="09-01-introduction-testing">Introducción a las Pruebas</a></li>
<li><a href="09-02-unit-testing-mocha-chai">Pruebas Unitarias con Mocha y Chai</a></li>
<li><a href="09-03-integration-testing">Pruebas de Integración</a></li>
<li><a href="09-04-debugging-nodejs">Depuración de Aplicaciones Node.js</a></li>
</ul>
<h2>Módulo 10: Temas Avanzados</h2>
<ul>
<li><a href="10-01-cluster-module">Módulo Cluster</a></li>
<li><a href="10-02-worker-threads">Hilos de Trabajo</a></li>
<li><a href="10-03-performance-optimization">Optimización del Rendimiento</a></li>
<li><a href="10-04-building-restful-apis">Construcción de APIs RESTful</a></li>
<li><a href="10-05-graphql-nodejs">GraphQL con Node.js</a></li>
</ul>
<h2>Módulo 11: Despliegue y DevOps</h2>
<ul>
<li><a href="11-01-environment-variables">Variables de Entorno</a></li>
<li><a href="11-02-using-pm2">Usando PM2 para la Gestión de Procesos</a></li>
<li><a href="11-03-deploying-heroku">Desplegando en Heroku</a></li>
<li><a href="11-04-ci-cd">Integración y Despliegue Continuos</a></li>
</ul>
<h2>Módulo 12: Proyectos del Mundo Real</h2>
<ul>
<li><a href="12-01-building-chat-app">Construcción de una Aplicación de Chat</a></li>
<li><a href="12-02-creating-ecommerce-api">Creación de una API de Comercio Electrónico</a></li>
<li><a href="12-03-developing-blogging-platform">Desarrollo de una Plataforma de Blogs</a></li>
<li><a href="12-04-building-task-management">Construcción de una Herramienta de Gestión de Tareas</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
