<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pruebas de Integración</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/09-03-integration-testing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/09-03-integration-testing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/09-03-integration-testing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/nodejs/09-03-integration-testing" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/nodejs/09-03-integration-testing" class="px-2">CA</a>
<br>
			<cite>Construyendo la sociedad de hoy y del mañana</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Lenguajes de Programación</a>
				 					<a href="/categ/frameworks">Frameworks y Librerías</a>
				 					<a href="/categ/tech-tools">Herramientas Técnicas</a>
				 					<a href="/categ/foundations">Fundamentos Teóricos</a>
				 					<a href="/categ/soft-skills">Habilidades Sociales</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-02-unit-testing-mocha-chai' title="Pruebas Unitarias con Mocha y Chai">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Pruebas de Integración</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-04-debugging-nodejs' title="Depuración de Aplicaciones Node.js">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Las pruebas de integración son un tipo de pruebas de software que se centran en verificar la interacción entre diferentes módulos o componentes de una aplicación. En el contexto de Node.js, esto puede incluir la interacción entre diferentes partes de tu aplicación, como controladores, servicios, bases de datos y APIs externas.</p>
</div><h1><p>Objetivos de las Pruebas de Integración</p>
</h1>
<div class='content'><ul>
<li><strong>Verificar la interacción entre módulos:</strong> Asegurarse de que los diferentes módulos de la aplicación funcionan correctamente cuando se combinan.</li>
<li><strong>Detectar errores de integración:</strong> Identificar problemas que pueden surgir cuando los módulos individuales se integran.</li>
<li><strong>Validar flujos de trabajo completos:</strong> Probar flujos de trabajo completos que abarcan múltiples módulos para garantizar que funcionan como se espera.</li>
</ul>
</div><h1><p>Herramientas Comunes para Pruebas de Integración en Node.js</p>
</h1>
<div class='content'><ul>
<li><strong>Mocha:</strong> Un framework de pruebas flexible y ampliamente utilizado.</li>
<li><strong>Chai:</strong> Una biblioteca de aserciones que se puede usar con Mocha para realizar afirmaciones en las pruebas.</li>
<li><strong>Supertest:</strong> Una biblioteca para probar APIs HTTP, que se puede usar junto con Mocha y Chai.</li>
</ul>
</div><h1><p>Configuración del Entorno de Pruebas</p>
</h1>
<div class='content'></div><h2><p>Instalación de Dependencias</p>
</h2>
<div class='content'><p>Primero, necesitas instalar las dependencias necesarias para realizar pruebas de integración. Puedes hacerlo usando npm:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgLS1zYXZlLWRldiBtb2NoYSBjaGFpIHN1cGVydGVzdA=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install --save-dev mocha chai supertest</pre></div><div class='content'></div><h2><p>Estructura del Proyecto</p>
</h2>
<div class='content'><p>Una estructura de proyecto típica para pruebas de integración podría verse así:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("L215LW5vZGUtYXBwCiAgL3NyYwogICAgL2NvbnRyb2xsZXJzCiAgICAvbW9kZWxzCiAgICAvcm91dGVzCiAgICAvc2VydmljZXMKICAvdGVzdAogICAgL2ludGVncmF0aW9uCiAgICAgIHVzZXIudGVzdC5qcwogIGFwcC5qcwogIHBhY2thZ2UuanNvbg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/my-node-app
  /src
    /controllers
    /models
    /routes
    /services
  /test
    /integration
      user.test.js
  app.js
  package.json</pre></div><div class='content'></div><h1><p>Ejemplo Práctico: Pruebas de Integración de una API de Usuarios</p>
</h1>
<div class='content'></div><h2><p>Paso 1: Configurar el Servidor para Pruebas</p>
</h2>
<div class='content'><p>Asegúrate de que tu servidor pueda ser configurado para pruebas. Esto generalmente implica exportar tu aplicación desde <code>app.js</code> para que pueda ser utilizada en las pruebas.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gYXBwLmpzCmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7CmNvbnN0IGFwcCA9IGV4cHJlc3MoKTsKCi8vIENvbmZpZ3VyYWNpw7NuIGRlIG1pZGRsZXdhcmVzIHkgcnV0YXMKLy8gLi4uCgptb2R1bGUuZXhwb3J0cyA9IGFwcDs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// app.js
const express = require('express');
const app = express();

// Configuraci&oacute;n de middlewares y rutas
// ...

module.exports = app;</pre></div><div class='content'></div><h2><p>Paso 2: Crear un Archivo de Pruebas de Integración</p>
</h2>
<div class='content'><p>Crea un archivo de pruebas en el directorio <code>test/integration</code>. En este ejemplo, probaremos una API de usuarios.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdGVzdC9pbnRlZ3JhdGlvbi91c2VyLnRlc3QuanMKY29uc3QgcmVxdWVzdCA9IHJlcXVpcmUoJ3N1cGVydGVzdCcpOwpjb25zdCBhcHAgPSByZXF1aXJlKCcuLi8uLi9hcHAnKTsKY29uc3QgY2hhaSA9IHJlcXVpcmUoJ2NoYWknKTsKY29uc3QgZXhwZWN0ID0gY2hhaS5leHBlY3Q7CgpkZXNjcmliZSgnVXNlciBBUEkgSW50ZWdyYXRpb24gVGVzdHMnLCAoKSA9PiB7CiAgaXQoJ3Nob3VsZCBjcmVhdGUgYSBuZXcgdXNlcicsIChkb25lKSA9PiB7CiAgICByZXF1ZXN0KGFwcCkKICAgICAgLnBvc3QoJy9hcGkvdXNlcnMnKQogICAgICAuc2VuZCh7IG5hbWU6ICdKb2huIERvZScsIGVtYWlsOiAnam9obkBleGFtcGxlLmNvbScsIHBhc3N3b3JkOiAnMTIzNDU2JyB9KQogICAgICAuZXhwZWN0KDIwMSkKICAgICAgLmVuZCgoZXJyLCByZXMpID0+IHsKICAgICAgICBpZiAoZXJyKSByZXR1cm4gZG9uZShlcnIpOwogICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnaWQnKTsKICAgICAgICBleHBlY3QocmVzLmJvZHkubmFtZSkudG8uZXF1YWwoJ0pvaG4gRG9lJyk7CiAgICAgICAgZG9uZSgpOwogICAgICB9KTsKICB9KTsKCiAgaXQoJ3Nob3VsZCBnZXQgYSB1c2VyIGJ5IElEJywgKGRvbmUpID0+IHsKICAgIGNvbnN0IHVzZXJJZCA9IDE7IC8vIEFzdW1lIHF1ZSBlc3RlIElEIGV4aXN0ZSBlbiBsYSBiYXNlIGRlIGRhdG9zCiAgICByZXF1ZXN0KGFwcCkKICAgICAgLmdldChgL2FwaS91c2Vycy8ke3VzZXJJZH1gKQogICAgICAuZXhwZWN0KDIwMCkKICAgICAgLmVuZCgoZXJyLCByZXMpID0+IHsKICAgICAgICBpZiAoZXJyKSByZXR1cm4gZG9uZShlcnIpOwogICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnaWQnLCB1c2VySWQpOwogICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnbmFtZScpOwogICAgICAgIGRvbmUoKTsKICAgICAgfSk7CiAgfSk7CgogIC8vIE3DoXMgcHJ1ZWJhcyBkZSBpbnRlZ3JhY2nDs24uLi4KfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// test/integration/user.test.js
const request = require('supertest');
const app = require('../../app');
const chai = require('chai');
const expect = chai.expect;

describe('User API Integration Tests', () =&gt; {
  it('should create a new user', (done) =&gt; {
    request(app)
      .post('/api/users')
      .send({ name: 'John Doe', email: 'john@example.com', password: '123456' })
      .expect(201)
      .end((err, res) =&gt; {
        if (err) return done(err);
        expect(res.body).to.have.property('id');
        expect(res.body.name).to.equal('John Doe');
        done();
      });
  });

  it('should get a user by ID', (done) =&gt; {
    const userId = 1; // Asume que este ID existe en la base de datos
    request(app)
      .get(`/api/users/${userId}`)
      .expect(200)
      .end((err, res) =&gt; {
        if (err) return done(err);
        expect(res.body).to.have.property('id', userId);
        expect(res.body).to.have.property('name');
        done();
      });
  });

  // M&aacute;s pruebas de integraci&oacute;n...
});</pre></div><div class='content'></div><h2><p>Paso 3: Ejecutar las Pruebas</p>
</h2>
<div class='content'><p>Puedes ejecutar las pruebas usando el comando <code>mocha</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnB4IG1vY2hhIHRlc3QvaW50ZWdyYXRpb24vKiovKi50ZXN0Lmpz"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npx mocha test/integration/**/*.test.js</pre></div><div class='content'></div><h1><p>Ejercicios Prácticos</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Prueba de Creación de Usuario</p>
</h2>
<div class='content'><p>Escribe una prueba de integración para verificar que un usuario puede ser creado correctamente a través de la API.</p>
<h4>Solución:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXQoJ3Nob3VsZCBjcmVhdGUgYSBuZXcgdXNlcicsIChkb25lKSA9PiB7CiAgcmVxdWVzdChhcHApCiAgICAucG9zdCgnL2FwaS91c2VycycpCiAgICAuc2VuZCh7IG5hbWU6ICdKYW5lIERvZScsIGVtYWlsOiAnamFuZUBleGFtcGxlLmNvbScsIHBhc3N3b3JkOiAnYWJjZGVmJyB9KQogICAgLmV4cGVjdCgyMDEpCiAgICAuZW5kKChlcnIsIHJlcykgPT4gewogICAgICBpZiAoZXJyKSByZXR1cm4gZG9uZShlcnIpOwogICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ2lkJyk7CiAgICAgIGV4cGVjdChyZXMuYm9keS5uYW1lKS50by5lcXVhbCgnSmFuZSBEb2UnKTsKICAgICAgZG9uZSgpOwogICAgfSk7Cn0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>it('should create a new user', (done) =&gt; {
  request(app)
    .post('/api/users')
    .send({ name: 'Jane Doe', email: 'jane@example.com', password: 'abcdef' })
    .expect(201)
    .end((err, res) =&gt; {
      if (err) return done(err);
      expect(res.body).to.have.property('id');
      expect(res.body.name).to.equal('Jane Doe');
      done();
    });
});</pre></div><div class='content'></div><h2><p>Ejercicio 2: Prueba de Obtención de Usuario</p>
</h2>
<div class='content'><p>Escribe una prueba de integración para verificar que un usuario puede ser obtenido por su ID a través de la API.</p>
<h4>Solución:</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aXQoJ3Nob3VsZCBnZXQgYSB1c2VyIGJ5IElEJywgKGRvbmUpID0+IHsKICBjb25zdCB1c2VySWQgPSAyOyAvLyBBc3VtZSBxdWUgZXN0ZSBJRCBleGlzdGUgZW4gbGEgYmFzZSBkZSBkYXRvcwogIHJlcXVlc3QoYXBwKQogICAgLmdldChgL2FwaS91c2Vycy8ke3VzZXJJZH1gKQogICAgLmV4cGVjdCgyMDApCiAgICAuZW5kKChlcnIsIHJlcykgPT4gewogICAgICBpZiAoZXJyKSByZXR1cm4gZG9uZShlcnIpOwogICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ2lkJywgdXNlcklkKTsKICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCduYW1lJyk7CiAgICAgIGRvbmUoKTsKICAgIH0pOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>it('should get a user by ID', (done) =&gt; {
  const userId = 2; // Asume que este ID existe en la base de datos
  request(app)
    .get(`/api/users/${userId}`)
    .expect(200)
    .end((err, res) =&gt; {
      if (err) return done(err);
      expect(res.body).to.have.property('id', userId);
      expect(res.body).to.have.property('name');
      done();
    });
});</pre></div><div class='content'></div><h1><p>Errores Comunes y Consejos</p>
</h1>
<div class='content'></div><h2><p>Errores Comunes</p>
</h2>
<div class='content'><ul>
<li><strong>No limpiar la base de datos entre pruebas:</strong> Esto puede causar que las pruebas fallen debido a datos residuales. Usa herramientas como <code>beforeEach</code> y <code>afterEach</code> para limpiar la base de datos.</li>
<li><strong>No manejar correctamente las promesas:</strong> Asegúrate de manejar correctamente las promesas y los callbacks para evitar que las pruebas se queden colgadas.</li>
</ul>
</div><h2><p>Consejos</p>
</h2>
<div class='content'><ul>
<li><strong>Usa una base de datos de prueba:</strong> Configura una base de datos separada para las pruebas para evitar afectar los datos de producción.</li>
<li><strong>Automatiza las pruebas:</strong> Integra las pruebas en tu pipeline de CI/CD para asegurarte de que se ejecuten automáticamente en cada cambio de código.</li>
</ul>
</div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>Las pruebas de integración son esenciales para garantizar que los diferentes módulos de tu aplicación Node.js funcionen correctamente juntos. Usando herramientas como Mocha, Chai y Supertest, puedes escribir y ejecutar pruebas de integración de manera efectiva. Asegúrate de seguir las mejores prácticas y de manejar correctamente los errores comunes para obtener los mejores resultados.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-02-unit-testing-mocha-chai' title="Pruebas Unitarias con Mocha y Chai">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='09-04-debugging-nodejs' title="Depuración de Aplicaciones Node.js">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicidad</h1>
<p>Este espacio está destinado a publicidad.</p>
<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>¡Gracias por colaborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
