<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JWT (JSON Web Tokens)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/jwt" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/jwt" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/jwt" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/nodejs/jwt" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/nodejs/jwt" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atención!</b> Ha habido un error en la generación del curso y puede contener errores de traducción.Estamos trabajando para solucinarlo por lo que se deben usar los contenidos con cuidado.Se puede consultar el contenido correcto en otro idioma en el siguiente enlace:<br>
						<a href="https://enterprisecampus.net/mod/nodejs/jwt">https://enterprisecampus.net/mod/nodejs/jwt</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='passport-js'>&#x25C4;Usando Passport.js</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">JWT (JSON Web Tokens)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='role-based-access-control'>Control de Acceso Basado en Roles &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a JWT</h1>
<div class='content'><p>JSON Web Tokens (JWT) son un medio compacto y seguro para representar afirmaciones que se transfieren entre dos partes. Las afirmaciones en un JWT se codifican como un objeto JSON que se utiliza como la carga útil de una estructura JSON Web Signature (JWS) o como el texto sin formato de una estructura JSON Web Encryption (JWE), lo que permite que las afirmaciones se firmen digitalmente o se protejan con un Código de Autenticación de Mensajes (MAC) y/o se cifren.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Estructura del Token</strong>: Los JWTs constan de tres partes: Encabezado, Carga útil y Firma.</li>
<li><strong>Encabezado</strong>: Contiene metadatos sobre el tipo de token y los algoritmos criptográficos utilizados.</li>
<li><strong>Carga útil</strong>: Contiene las afirmaciones. Las afirmaciones son declaraciones sobre una entidad (típicamente, el usuario) y datos adicionales.</li>
<li><strong>Firma</strong>: Se utiliza para verificar la integridad del token y asegurar que no ha sido manipulado.</li>
</ul>
</div><h1>Estructura de JWT</h1>
<div class='content'><p>Un JWT se estructura típicamente de la siguiente manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGVhZGVyLnBheWxvYWQuc2lnbmF0dXJl"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>header.payload.signature</pre></div><div class='content'></div><h2>Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJhbGciOiAiSFMyNTYiLAogICJ0eXAiOiAiSldUIgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;alg&quot;: &quot;HS256&quot;,
  &quot;typ&quot;: &quot;JWT&quot;
}</pre></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ewogICJzdWIiOiAiMTIzNDU2Nzg5MCIsCiAgIm5hbWUiOiAiSm9obiBEb2UiLAogICJpYXQiOiAxNTE2MjM5MDIyCn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>{
  &quot;sub&quot;: &quot;1234567890&quot;,
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;iat&quot;: 1516239022
}</pre></div><div class='content'></div><h2>JWT Codificado</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZXlKaGJHY2lPaUpJVXpJMU5pSXNJblI1Y0NJNklrcFhWQ0o5LmV5SnpkV0lpT2lJeE1qTTBOVFkzT0Rrd0lpd2libUZ0WlNJNklrcHZhRzRnUkc5bElpd2lhV0YwSWpveE5URTJNak01TURJeWZRLlNmbEt4d1JKU01lS0tGMlFUNGZ3cE1lSmYzNlBPazZ5SlZfYWRRc3N3NWM="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</pre></div><div class='content'></div><h1>Creando JWTs en Node.js</h1>
<div class='content'><p>Para crear JWTs en Node.js, puedes usar la biblioteca <code>jsonwebtoken</code>.</p>
</div><h2>Instalación</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwganNvbndlYnRva2Vu"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install jsonwebtoken</pre></div><div class='content'></div><h2>Creando un Token</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7Cgpjb25zdCBwYXlsb2FkID0gewogIHN1YjogJzEyMzQ1Njc4OTAnLAogIG5hbWU6ICdKb2huIERvZScsCiAgaWF0OiBNYXRoLmZsb29yKERhdGUubm93KCkgLyAxMDAwKSAtIDMwCn07Cgpjb25zdCBzZWNyZXQgPSAneW91ci0yNTYtYml0LXNlY3JldCc7Cgpjb25zdCB0b2tlbiA9IGp3dC5zaWduKHBheWxvYWQsIHNlY3JldCk7CmNvbnNvbGUubG9nKHRva2VuKTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const jwt = require('jsonwebtoken');

const payload = {
  sub: '1234567890',
  name: 'John Doe',
  iat: Math.floor(Date.now() / 1000) - 30
};

const secret = 'your-256-bit-secret';

const token = jwt.sign(payload, secret);
console.log(token);</pre></div><div class='content'></div><h2>Verificando un Token</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgdG9rZW4gPSAneW91ci5qd3QudG9rZW4uaGVyZSc7Cgpqd3QudmVyaWZ5KHRva2VuLCBzZWNyZXQsIChlcnIsIGRlY29kZWQpID0+IHsKICBpZiAoZXJyKSB7CiAgICBjb25zb2xlLmxvZygnVG9rZW4gaXMgbm90IHZhbGlkOicsIGVycik7CiAgfSBlbHNlIHsKICAgIGNvbnNvbGUubG9nKCdEZWNvZGVkIHRva2VuOicsIGRlY29kZWQpOwogIH0KfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const token = 'your.jwt.token.here';

jwt.verify(token, secret, (err, decoded) =&gt; {
  if (err) {
    console.log('Token is not valid:', err);
  } else {
    console.log('Decoded token:', decoded);
  }
});</pre></div><div class='content'></div><h1>Usando JWT para Autenticación</h1>
<div class='content'><p>Los JWTs se usan comúnmente para la autenticación en aplicaciones web. Aquí tienes un ejemplo simple de cómo usar JWTs para la autenticación de usuarios en una aplicación Node.js.</p>
</div><h2>Ejemplo: Inicio de Sesión de Usuario y Generación de Token</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7CmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpOwoKY29uc3QgYXBwID0gZXhwcmVzcygpOwphcHAudXNlKGJvZHlQYXJzZXIuanNvbigpKTsKCmNvbnN0IHVzZXJzID0gWwogIHsgaWQ6IDEsIHVzZXJuYW1lOiAnam9obicsIHBhc3N3b3JkOiAncGFzc3dvcmQxMjMnIH0KXTsKCmNvbnN0IHNlY3JldCA9ICd5b3VyLTI1Ni1iaXQtc2VjcmV0JzsKCmFwcC5wb3N0KCcvbG9naW4nLCAocmVxLCByZXMpID0+IHsKICBjb25zdCB7IHVzZXJuYW1lLCBwYXNzd29yZCB9ID0gcmVxLmJvZHk7CiAgY29uc3QgdXNlciA9IHVzZXJzLmZpbmQodSA9PiB1LnVzZXJuYW1lID09PSB1c2VybmFtZSAmJiB1LnBhc3N3b3JkID09PSBwYXNzd29yZCk7CgogIGlmICh1c2VyKSB7CiAgICBjb25zdCB0b2tlbiA9IGp3dC5zaWduKHsgc3ViOiB1c2VyLmlkIH0sIHNlY3JldCwgeyBleHBpcmVzSW46ICcxaCcgfSk7CiAgICByZXMuanNvbih7IHRva2VuIH0pOwogIH0gZWxzZSB7CiAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnVXNlcm5hbWUgb3IgcGFzc3dvcmQgaW5jb3JyZWN0Jyk7CiAgfQp9KTsKCmFwcC5saXN0ZW4oMzAwMCwgKCkgPT4gewogIGNvbnNvbGUubG9nKCdTZXJ2ZXIgc3RhcnRlZCBvbiBwb3J0IDMwMDAnKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const jwt = require('jsonwebtoken');
const bodyParser = require('body-parser');

const app = express();
app.use(bodyParser.json());

const users = [
  { id: 1, username: 'john', password: 'password123' }
];

const secret = 'your-256-bit-secret';

app.post('/login', (req, res) =&gt; {
  const { username, password } = req.body;
  const user = users.find(u =&gt; u.username === username &amp;&amp; u.password === password);

  if (user) {
    const token = jwt.sign({ sub: user.id }, secret, { expiresIn: '1h' });
    res.json({ token });
  } else {
    res.status(401).send('Username or password incorrect');
  }
});

app.listen(3000, () =&gt; {
  console.log('Server started on port 3000');
});</pre></div><div class='content'></div><h2>Ejemplo: Protegiendo Rutas</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7Cgpjb25zdCBhcHAgPSBleHByZXNzKCk7CmNvbnN0IHNlY3JldCA9ICd5b3VyLTI1Ni1iaXQtc2VjcmV0JzsKCmNvbnN0IGF1dGhlbnRpY2F0ZUpXVCA9IChyZXEsIHJlcywgbmV4dCkgPT4gewogIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcignQXV0aG9yaXphdGlvbicpLnNwbGl0KCcgJylbMV07CgogIGlmICh0b2tlbikgewogICAgand0LnZlcmlmeSh0b2tlbiwgc2VjcmV0LCAoZXJyLCB1c2VyKSA9PiB7CiAgICAgIGlmIChlcnIpIHsKICAgICAgICByZXR1cm4gcmVzLnNlbmRTdGF0dXMoNDAzKTsKICAgICAgfQogICAgICByZXEudXNlciA9IHVzZXI7CiAgICAgIG5leHQoKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICByZXMuc2VuZFN0YXR1cyg0MDEpOwogIH0KfTsKCmFwcC5nZXQoJy9wcm90ZWN0ZWQnLCBhdXRoZW50aWNhdGVKV1QsIChyZXEsIHJlcykgPT4gewogIHJlcy5zZW5kKCdUaGlzIGlzIGEgcHJvdGVjdGVkIHJvdXRlJyk7Cn0pOwoKYXBwLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgY29uc29sZS5sb2coJ1NlcnZlciBzdGFydGVkIG9uIHBvcnQgMzAwMCcpOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const jwt = require('jsonwebtoken');

const app = express();
const secret = 'your-256-bit-secret';

const authenticateJWT = (req, res, next) =&gt; {
  const token = req.header('Authorization').split(' ')[1];

  if (token) {
    jwt.verify(token, secret, (err, user) =&gt; {
      if (err) {
        return res.sendStatus(403);
      }
      req.user = user;
      next();
    });
  } else {
    res.sendStatus(401);
  }
};

app.get('/protected', authenticateJWT, (req, res) =&gt; {
  res.send('This is a protected route');
});

app.listen(3000, () =&gt; {
  console.log('Server started on port 3000');
});</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Los JWTs son una herramienta poderosa para la autenticación e intercambio de información en aplicaciones web. Proporcionan una forma segura y eficiente de transmitir información entre partes. Al comprender la estructura y el uso de los JWTs, puedes implementar mecanismos de autenticación robustos en tus aplicaciones Node.js. Recuerda siempre mantener tus claves secretas seguras y validar y verificar los tokens adecuadamente para asegurar la seguridad de tu aplicación.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='passport-js'>&#x25C4;Usando Passport.js</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">JWT (JSON Web Tokens)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='role-based-access-control'>Control de Acceso Basado en Roles &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
