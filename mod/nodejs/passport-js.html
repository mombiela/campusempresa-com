<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usando Passport.js</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/passport-js" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/passport-js" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/passport-js" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/nodejs/passport-js" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/nodejs/passport-js" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atención!</b> Ha habido un error en la generación del curso y puede contener errores de traducción.Estamos trabajando para solucinarlo por lo que se deben usar los contenidos con cuidado.Se puede consultar el contenido correcto en otro idioma en el siguiente enlace:<br>
						<a href="https://enterprisecampus.net/mod/nodejs/passport-js">https://enterprisecampus.net/mod/nodejs/passport-js</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='intro-to-authentication'>&#x25C4;Introducción a la Autenticación</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Usando Passport.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='jwt'>JWT (JSON Web Tokens) &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a Passport.js</h1>
<div class='content'><p>Passport.js es un middleware de autenticación popular para Node.js. Está diseñado para ser simple y discreto, lo que facilita su integración en cualquier aplicación de Node.js. Passport.js admite varios mecanismos de autenticación, conocidos como estrategias, incluyendo autenticación local, OAuth y OpenID.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Middleware</strong>: Passport.js actúa como middleware en una aplicación de Node.js, manejando solicitudes de autenticación.</li>
<li><strong>Estrategias</strong>: Passport.js utiliza estrategias para autenticar solicitudes. Las estrategias pueden ser locales (nombre de usuario y contraseña) o externas (proveedores de OAuth como Google, Facebook).</li>
<li><strong>Sesiones</strong>: Passport.js puede gestionar sesiones de usuario, permitiendo a los usuarios permanecer conectados a través de múltiples solicitudes.</li>
</ul>
</div><h1>Configuración de Passport.js</h1>
<div class='content'><p>Para comenzar con Passport.js, necesitas instalarlo junto con las estrategias necesarias.</p>
</div><h2>Instalación</h2>
<div class='content'><p>Primero, instala Passport.js y la estrategia local usando npm:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgcGFzc3BvcnQgcGFzc3BvcnQtbG9jYWw="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install passport passport-local</pre></div><div class='content'></div><h2>Configuración Básica</h2>
<div class='content'><p>Crea una configuración básica para Passport.js en tu aplicación de Node.js.</p>
<ol>
<li>
<p><strong>Inicializar Passport.js</strong>:</p>
<pre><code class="language-javascript">const passport = require('passport');
const LocalStrategy = require('passport-local').Strategy;

app.use(passport.initialize());
app.use(passport.session());
</code></pre>
</li>
<li>
<p><strong>Definir la Estrategia Local</strong>:</p>
<pre><code class="language-javascript">passport.use(new LocalStrategy(
  function(username, password, done) {
    // Reemplaza esto con tu lógica de búsqueda de usuario
    User.findOne({ username: username }, function (err, user) {
      if (err) { return done(err); }
      if (!user) { return done(null, false, { message: 'Nombre de usuario incorrecto.' }); }
      if (!user.verifyPassword(password)) { return done(null, false, { message: 'Contraseña incorrecta.' }); }
      return done(null, user);
    });
  }
));
</code></pre>
</li>
<li>
<p><strong>Serializar y Deserializar Usuario</strong>:</p>
<pre><code class="language-javascript">passport.serializeUser(function(user, done) {
  done(null, user.id);
});

passport.deserializeUser(function(id, done) {
  User.findById(id, function(err, user) {
    done(err, user);
  });
});
</code></pre>
</li>
</ol>
</div><h1>Usando Passport.js en Rutas</h1>
<div class='content'><p>Para proteger rutas y manejar la autenticación, puedes usar Passport.js en tus definiciones de rutas.</p>
</div><h2>Ruta de Inicio de Sesión</h2>
<div class='content'><p>Crea una ruta de inicio de sesión que use Passport.js para autenticar usuarios:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLnBvc3QoJy9sb2dpbicsIHBhc3Nwb3J0LmF1dGhlbnRpY2F0ZSgnbG9jYWwnLCB7CiAgc3VjY2Vzc1JlZGlyZWN0OiAnL2Rhc2hib2FyZCcsCiAgZmFpbHVyZVJlZGlyZWN0OiAnL2xvZ2luJywKICBmYWlsdXJlRmxhc2g6IHRydWUKfSkpOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.post('/login', passport.authenticate('local', {
  successRedirect: '/dashboard',
  failureRedirect: '/login',
  failureFlash: true
}));</pre></div><div class='content'></div><h2>Ruta Protegida</h2>
<div class='content'><p>Protege rutas asegurándote de que el usuario esté autenticado:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gZW5zdXJlQXV0aGVudGljYXRlZChyZXEsIHJlcywgbmV4dCkgewogIGlmIChyZXEuaXNBdXRoZW50aWNhdGVkKCkpIHsKICAgIHJldHVybiBuZXh0KCk7CiAgfQogIHJlcy5yZWRpcmVjdCgnL2xvZ2luJyk7Cn0KCmFwcC5nZXQoJy9kYXNoYm9hcmQnLCBlbnN1cmVBdXRoZW50aWNhdGVkLCAocmVxLCByZXMpID0+IHsKICByZXMuc2VuZCgnwqFCaWVudmVuaWRvIGEgdHUgcGFuZWwgZGUgY29udHJvbCEnKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function ensureAuthenticated(req, res, next) {
  if (req.isAuthenticated()) {
    return next();
  }
  res.redirect('/login');
}

app.get('/dashboard', ensureAuthenticated, (req, res) =&gt; {
  res.send('&iexcl;Bienvenido a tu panel de control!');
});</pre></div><div class='content'></div><h1>Usando Estrategias OAuth</h1>
<div class='content'><p>Passport.js admite varias estrategias OAuth, como Google, Facebook y GitHub. Aquí tienes un ejemplo de configuración de OAuth de Google.</p>
</div><h2>Instalación</h2>
<div class='content'><p>Instala la estrategia OAuth de Google:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgcGFzc3BvcnQtZ29vZ2xlLW9hdXRoMjA="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install passport-google-oauth20</pre></div><div class='content'></div><h2>Configuración</h2>
<div class='content'><p>Configura la estrategia OAuth de Google:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgR29vZ2xlU3RyYXRlZ3kgPSByZXF1aXJlKCdwYXNzcG9ydC1nb29nbGUtb2F1dGgyMCcpLlN0cmF0ZWd5OwoKcGFzc3BvcnQudXNlKG5ldyBHb29nbGVTdHJhdGVneSh7CiAgICBjbGllbnRJRDogJ1RVX0lEX0RFX0NMSUVOVEVfREVfR09PR0xFJywKICAgIGNsaWVudFNlY3JldDogJ1RVX1NFQ1JFVE9fREVfQ0xJRU5URV9ERV9HT09HTEUnLAogICAgY2FsbGJhY2tVUkw6ICdodHRwOi8vd3d3LmV4YW1wbGUuY29tL2F1dGgvZ29vZ2xlL2NhbGxiYWNrJwogIH0sCiAgZnVuY3Rpb24odG9rZW4sIHRva2VuU2VjcmV0LCBwcm9maWxlLCBkb25lKSB7CiAgICBVc2VyLmZpbmRPckNyZWF0ZSh7IGdvb2dsZUlkOiBwcm9maWxlLmlkIH0sIGZ1bmN0aW9uIChlcnIsIHVzZXIpIHsKICAgICAgcmV0dXJuIGRvbmUoZXJyLCB1c2VyKTsKICAgIH0pOwogIH0KKSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const GoogleStrategy = require('passport-google-oauth20').Strategy;

passport.use(new GoogleStrategy({
    clientID: 'TU_ID_DE_CLIENTE_DE_GOOGLE',
    clientSecret: 'TU_SECRETO_DE_CLIENTE_DE_GOOGLE',
    callbackURL: 'http://www.example.com/auth/google/callback'
  },
  function(token, tokenSecret, profile, done) {
    User.findOrCreate({ googleId: profile.id }, function (err, user) {
      return done(err, user);
    });
  }
));</pre></div><div class='content'></div><h2>Rutas para OAuth de Google</h2>
<div class='content'><p>Define rutas para manejar la autenticación OAuth de Google:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLmdldCgnL2F1dGgvZ29vZ2xlJywKICBwYXNzcG9ydC5hdXRoZW50aWNhdGUoJ2dvb2dsZScsIHsgc2NvcGU6IFsnaHR0cHM6Ly93d3cuZ29vZ2xlYXBpcy5jb20vYXV0aC9wbHVzLmxvZ2luJ10gfSkpOwoKYXBwLmdldCgnL2F1dGgvZ29vZ2xlL2NhbGxiYWNrJywgCiAgcGFzc3BvcnQuYXV0aGVudGljYXRlKCdnb29nbGUnLCB7IGZhaWx1cmVSZWRpcmVjdDogJy9sb2dpbicgfSksCiAgZnVuY3Rpb24ocmVxLCByZXMpIHsKICAgIC8vIEF1dGVudGljYWNpw7NuIGV4aXRvc2EsIHJlZGlyaWdpciBhIGluaWNpby4KICAgIHJlcy5yZWRpcmVjdCgnLycpOwogIH0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.get('/auth/google',
  passport.authenticate('google', { scope: ['https://www.googleapis.com/auth/plus.login'] }));

app.get('/auth/google/callback', 
  passport.authenticate('google', { failureRedirect: '/login' }),
  function(req, res) {
    // Autenticaci&oacute;n exitosa, redirigir a inicio.
    res.redirect('/');
  });</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Passport.js es un middleware de autenticación poderoso y flexible para Node.js. Al comprender sus conceptos básicos y aprender a configurar y usar varias estrategias, puedes integrar fácilmente la autenticación en tus aplicaciones de Node.js. Ya sea que necesites una autenticación local simple o integraciones complejas de OAuth, Passport.js proporciona una solución robusta para satisfacer tus necesidades.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='intro-to-authentication'>&#x25C4;Introducción a la Autenticación</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Usando Passport.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='jwt'>JWT (JSON Web Tokens) &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
