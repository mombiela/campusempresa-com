<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usando MySQL con Sequelize</title>

    <link rel="alternate" href="https://campusempresa.com/mod/nodejs/mysql-sequelize" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/nodejs/mysql-sequelize" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/nodejs/mysql-sequelize" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/nodejs/mysql-sequelize" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/nodejs/mysql-sequelize" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='mongodb-mongoose'>&#x25C4;Usando MongoDB con Mongoose</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Usando MySQL con Sequelize</a>
	</div>
	<div class='col-4 text-end'>
					<a href='crud-operations'>Realizando Operaciones CRUD &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a Sequelize</h1>
<div class='content'><p>Sequelize es un ORM (Mapeo Objeto-Relacional) basado en promesas para Node.js que funciona con Postgres, MySQL, MariaDB, SQLite y Microsoft SQL Server. Ofrece soporte sólido para transacciones, relaciones, carga ansiosa y perezosa, replicación de lectura y más.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>ORM (Mapeo Objeto-Relacional)</strong>: Una técnica que te permite consultar y manipular datos de una base de datos utilizando un paradigma orientado a objetos.</li>
<li><strong>Modelos</strong>: Representan tablas en tu base de datos.</li>
<li><strong>Instancias</strong>: Representan filas en tu base de datos.</li>
<li><strong>Consultas</strong>: Métodos para interactuar con la base de datos.</li>
</ul>
</div><h1>Configuración de Sequelize con MySQL</h1>
<div class='content'></div><h2>Instalación</h2>
<div class='content'><p>Primero, necesitas instalar Sequelize y el controlador de MySQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgc2VxdWVsaXplIG15c3FsMg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install sequelize mysql2</pre></div><div class='content'></div><h2>Inicializando Sequelize</h2>
<div class='content'><p>Crea una nueva instancia de Sequelize y conéctala a tu base de datos MySQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBTZXF1ZWxpemUgfSA9IHJlcXVpcmUoJ3NlcXVlbGl6ZScpOwoKY29uc3Qgc2VxdWVsaXplID0gbmV3IFNlcXVlbGl6ZSgnZGF0YWJhc2UnLCAndXNlcm5hbWUnLCAncGFzc3dvcmQnLCB7CiAgaG9zdDogJ2xvY2FsaG9zdCcsCiAgZGlhbGVjdDogJ215c3FsJwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { Sequelize } = require('sequelize');

const sequelize = new Sequelize('database', 'username', 'password', {
  host: 'localhost',
  dialect: 'mysql'
});</pre></div><div class='content'></div><h2>Probando la Conexión</h2>
<div class='content'><p>Puedes probar la conexión para asegurarte de que todo esté configurado correctamente.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VxdWVsaXplLmF1dGhlbnRpY2F0ZSgpCiAgLnRoZW4oKCkgPT4gewogICAgY29uc29sZS5sb2coJ0xhIGNvbmV4acOzbiBzZSBoYSBlc3RhYmxlY2lkbyBjb3JyZWN0YW1lbnRlLicpOwogIH0pCiAgLmNhdGNoKGVyciA9PiB7CiAgICBjb25zb2xlLmVycm9yKCdObyBzZSBwdWVkZSBjb25lY3RhciBhIGxhIGJhc2UgZGUgZGF0b3M6JywgZXJyKTsKICB9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sequelize.authenticate()
  .then(() =&gt; {
    console.log('La conexi&oacute;n se ha establecido correctamente.');
  })
  .catch(err =&gt; {
    console.error('No se puede conectar a la base de datos:', err);
  });</pre></div><div class='content'></div><h1>Definiendo Modelos</h1>
<div class='content'><p>Los modelos son la esencia de Sequelize. Representan tablas en tu base de datos.</p>
</div><h2>Creando un Modelo</h2>
<div class='content'><p>Define un modelo para una tabla <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgVXNlciA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1VzZXInLCB7CiAgdXNlcm5hbWU6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcsCiAgICBhbGxvd051bGw6IGZhbHNlCiAgfSwKICBiaXJ0aGRheTogewogICAgdHlwZTogU2VxdWVsaXplLkRBVEUKICB9Cn0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const User = sequelize.define('User', {
  username: {
    type: Sequelize.STRING,
    allowNull: false
  },
  birthday: {
    type: Sequelize.DATE
  }
});</pre></div><div class='content'></div><h2>Sincronizando Modelos</h2>
<div class='content'><p>Sincroniza el modelo con la base de datos para crear la tabla.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VxdWVsaXplLnN5bmMoKQogIC50aGVuKCgpID0+IHsKICAgIGNvbnNvbGUubG9nKCdMYSB0YWJsYSBVc2VyIGhhIHNpZG8gY3JlYWRhLicpOwogIH0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sequelize.sync()
  .then(() =&gt; {
    console.log('La tabla User ha sido creada.');
  });</pre></div><div class='content'></div><h1>Operaciones CRUD</h1>
<div class='content'></div><h2>Creando Registros</h2>
<div class='content'><p>Agrega un nuevo usuario a la tabla <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci5jcmVhdGUoewogIHVzZXJuYW1lOiAnam9obl9kb2UnLAogIGJpcnRoZGF5OiBuZXcgRGF0ZSgxOTkwLCAxLCAxKQp9KS50aGVuKHVzZXIgPT4gewogIGNvbnNvbGUubG9nKCdVc3VhcmlvIGNyZWFkbzonLCB1c2VyLnRvSlNPTigpKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.create({
  username: 'john_doe',
  birthday: new Date(1990, 1, 1)
}).then(user =&gt; {
  console.log('Usuario creado:', user.toJSON());
});</pre></div><div class='content'></div><h2>Leyendo Registros</h2>
<div class='content'><p>Recupera todos los usuarios de la tabla <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci5maW5kQWxsKCkudGhlbih1c2VycyA9PiB7CiAgY29uc29sZS5sb2coJ1RvZG9zIGxvcyB1c3VhcmlvczonLCBKU09OLnN0cmluZ2lmeSh1c2VycywgbnVsbCwgMikpOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.findAll().then(users =&gt; {
  console.log('Todos los usuarios:', JSON.stringify(users, null, 2));
});</pre></div><div class='content'></div><h2>Actualizando Registros</h2>
<div class='content'><p>Actualiza la información de un usuario.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci51cGRhdGUoeyB1c2VybmFtZTogJ2phbmVfZG9lJyB9LCB7CiAgd2hlcmU6IHsKICAgIHVzZXJuYW1lOiAnam9obl9kb2UnCiAgfQp9KS50aGVuKCgpID0+IHsKICBjb25zb2xlLmxvZygnVXN1YXJpbyBhY3R1YWxpemFkby4nKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.update({ username: 'jane_doe' }, {
  where: {
    username: 'john_doe'
  }
}).then(() =&gt; {
  console.log('Usuario actualizado.');
});</pre></div><div class='content'></div><h2>Eliminando Registros</h2>
<div class='content'><p>Elimina un usuario de la tabla <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci5kZXN0cm95KHsKICB3aGVyZTogewogICAgdXNlcm5hbWU6ICdqYW5lX2RvZScKICB9Cn0pLnRoZW4oKCkgPT4gewogIGNvbnNvbGUubG9nKCdVc3VhcmlvIGVsaW1pbmFkby4nKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.destroy({
  where: {
    username: 'jane_doe'
  }
}).then(() =&gt; {
  console.log('Usuario eliminado.');
});</pre></div><div class='content'></div><h1>Asociaciones</h1>
<div class='content'><p>Sequelize soporta varios tipos de asociaciones para definir relaciones entre modelos.</p>
</div><h2>Uno a Uno</h2>
<div class='content'><p>Define una relación uno a uno entre <code>User</code> y <code>Profile</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgUHJvZmlsZSA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1Byb2ZpbGUnLCB7CiAgYmlvOiB7CiAgICB0eXBlOiBTZXF1ZWxpemUuU1RSSU5HCiAgfQp9KTsKClVzZXIuaGFzT25lKFByb2ZpbGUpOwpQcm9maWxlLmJlbG9uZ3NUbyhVc2VyKTsKCnNlcXVlbGl6ZS5zeW5jKCk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Profile = sequelize.define('Profile', {
  bio: {
    type: Sequelize.STRING
  }
});

User.hasOne(Profile);
Profile.belongsTo(User);

sequelize.sync();</pre></div><div class='content'></div><h2>Uno a Muchos</h2>
<div class='content'><p>Define una relación uno a muchos entre <code>User</code> y <code>Post</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgUG9zdCA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1Bvc3QnLCB7CiAgdGl0bGU6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcKICB9LAogIGNvbnRlbnQ6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5URVhUCiAgfQp9KTsKClVzZXIuaGFzTWFueShQb3N0KTsKUG9zdC5iZWxvbmdzVG8oVXNlcik7CgpzZXF1ZWxpemUuc3luYygpOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Post = sequelize.define('Post', {
  title: {
    type: Sequelize.STRING
  },
  content: {
    type: Sequelize.TEXT
  }
});

User.hasMany(Post);
Post.belongsTo(User);

sequelize.sync();</pre></div><div class='content'></div><h2>Muchos a Muchos</h2>
<div class='content'><p>Define una relación muchos a muchos entre <code>User</code> y <code>Project</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgUHJvamVjdCA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1Byb2plY3QnLCB7CiAgbmFtZTogewogICAgdHlwZTogU2VxdWVsaXplLlNUUklORwogIH0KfSk7Cgpjb25zdCBVc2VyUHJvamVjdCA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1VzZXJQcm9qZWN0Jywge30pOwoKVXNlci5iZWxvbmdzVG9NYW55KFByb2plY3QsIHsgdGhyb3VnaDogVXNlclByb2plY3QgfSk7ClByb2plY3QuYmVsb25nc1RvTWFueShVc2VyLCB7IHRocm91Z2g6IFVzZXJQcm9qZWN0IH0pOwoKc2VxdWVsaXplLnN5bmMoKTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Project = sequelize.define('Project', {
  name: {
    type: Sequelize.STRING
  }
});

const UserProject = sequelize.define('UserProject', {});

User.belongsToMany(Project, { through: UserProject });
Project.belongsToMany(User, { through: UserProject });

sequelize.sync();</pre></div><div class='content'></div><h1>Temas Avanzados</h1>
<div class='content'></div><h2>Transacciones</h2>
<div class='content'><p>Las transacciones son esenciales para asegurar la integridad de los datos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VxdWVsaXplLnRyYW5zYWN0aW9uKHQgPT4gewogIHJldHVybiBVc2VyLmNyZWF0ZSh7CiAgICB1c2VybmFtZTogJ2FsaWNlJywKICAgIGJpcnRoZGF5OiBuZXcgRGF0ZSgxOTg1LCA2LCAyMCkKICB9LCB7IHRyYW5zYWN0aW9uOiB0IH0pLnRoZW4odXNlciA9PiB7CiAgICByZXR1cm4gUHJvZmlsZS5jcmVhdGUoewogICAgICBiaW86ICdQZXJmaWwgZGUgQWxpY2UnLAogICAgICBVc2VySWQ6IHVzZXIuaWQKICAgIH0sIHsgdHJhbnNhY3Rpb246IHQgfSk7CiAgfSk7Cn0pLnRoZW4ocmVzdWx0ID0+IHsKICBjb25zb2xlLmxvZygnTGEgdHJhbnNhY2Npw7NuIGhhIHNpZG8gY29uZmlybWFkYS4nKTsKfSkuY2F0Y2goZXJyID0+IHsKICBjb25zb2xlLmVycm9yKCdMYSB0cmFuc2FjY2nDs24gaGEgc2lkbyByZXZlcnRpZGE6JywgZXJyKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sequelize.transaction(t =&gt; {
  return User.create({
    username: 'alice',
    birthday: new Date(1985, 6, 20)
  }, { transaction: t }).then(user =&gt; {
    return Profile.create({
      bio: 'Perfil de Alice',
      UserId: user.id
    }, { transaction: t });
  });
}).then(result =&gt; {
  console.log('La transacci&oacute;n ha sido confirmada.');
}).catch(err =&gt; {
  console.error('La transacci&oacute;n ha sido revertida:', err);
});</pre></div><div class='content'></div><h2>Alcances</h2>
<div class='content'><p>Los alcances te permiten definir consultas reutilizables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgVXNlciA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1VzZXInLCB7CiAgdXNlcm5hbWU6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcsCiAgICBhbGxvd051bGw6IGZhbHNlCiAgfSwKICBiaXJ0aGRheTogewogICAgdHlwZTogU2VxdWVsaXplLkRBVEUKICB9Cn0sIHsKICBzY29wZXM6IHsKICAgIGFkdWx0czogewogICAgICB3aGVyZTogewogICAgICAgIGJpcnRoZGF5OiB7CiAgICAgICAgICBbU2VxdWVsaXplLk9wLmx0ZV06IG5ldyBEYXRlKG5ldyBEYXRlKCkgLSAxOCAqIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9KTsKClVzZXIuc2NvcGUoJ2FkdWx0cycpLmZpbmRBbGwoKS50aGVuKHVzZXJzID0+IHsKICBjb25zb2xlLmxvZygnVG9kb3MgbG9zIHVzdWFyaW9zIGFkdWx0b3M6JywgSlNPTi5zdHJpbmdpZnkodXNlcnMsIG51bGwsIDIpKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const User = sequelize.define('User', {
  username: {
    type: Sequelize.STRING,
    allowNull: false
  },
  birthday: {
    type: Sequelize.DATE
  }
}, {
  scopes: {
    adults: {
      where: {
        birthday: {
          [Sequelize.Op.lte]: new Date(new Date() - 18 * 365 * 24 * 60 * 60 * 1000)
        }
      }
    }
  }
});

User.scope('adults').findAll().then(users =&gt; {
  console.log('Todos los usuarios adultos:', JSON.stringify(users, null, 2));
});</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Usar Sequelize con MySQL en un entorno Node.js simplifica las interacciones con la base de datos al proporcionar un ORM que abstrae consultas SQL complejas en código JavaScript manejable. Al entender cómo configurar Sequelize, definir modelos, realizar operaciones CRUD y gestionar asociaciones, puedes manejar eficientemente tus operaciones de base de datos. Las características avanzadas como transacciones y alcances mejoran aún más tu capacidad para mantener la integridad de los datos y crear consultas reutilizables.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='mongodb-mongoose'>&#x25C4;Usando MongoDB con Mongoose</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Usando MySQL con Sequelize</a>
	</div>
	<div class='col-4 text-end'>
					<a href='crud-operations'>Realizando Operaciones CRUD &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
