<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cloud Pub/Sub</title>

    <link rel="alternate" href="https://campusempresa.com/mod/gcp/04-04-cloud-pubsub" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/gcp/04-04-cloud-pubsub" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/gcp/04-04-cloud-pubsub" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/gcp/04-04-cloud-pubsub" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/gcp/04-04-cloud-pubsub" class="px-2">CA</a>
								</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contenido del curso</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competencias técnicas</a>
				<a href="/all/conocimientos">Conocimientos</a>
				<a href="/all/soft_skills">Competencias sociales</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-03-cloud-dataproc' title="Cloud Dataproc">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Cloud Pub/Sub</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-05-cloud-data-fusion' title="Cloud Data Fusion">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducción</p>
</h1>
<div class='content'><p>Cloud Pub/Sub es un servicio de mensajería en tiempo real de Google Cloud Platform que permite la comunicación entre aplicaciones mediante el intercambio de mensajes de manera asíncrona. Es ideal para sistemas distribuidos y microservicios, donde la comunicación eficiente y escalable es crucial.</p>
</div><h1><p>Conceptos Clave</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Publicadores y Suscriptores</strong>:</p>
<ul>
<li><strong>Publicador</strong>: Una aplicación que envía mensajes a un tema.</li>
<li><strong>Suscriptor</strong>: Una aplicación que recibe mensajes de una suscripción.</li>
</ul>
</li>
<li>
<p><strong>Temas y Suscripciones</strong>:</p>
<ul>
<li><strong>Tema</strong>: Un canal de comunicación al que los publicadores envían mensajes.</li>
<li><strong>Suscripción</strong>: Una configuración que permite a los suscriptores recibir mensajes de un tema.</li>
</ul>
</li>
<li>
<p><strong>Mensajes</strong>:</p>
<ul>
<li><strong>Mensaje</strong>: La unidad de datos que se envía desde el publicador al suscriptor. Contiene un payload y atributos opcionales.</li>
</ul>
</li>
</ol>
</div><h1><p>Arquitectura de Cloud Pub/Sub</p>
</h1>
<div class='content'><p>La arquitectura de Cloud Pub/Sub se basa en un modelo de publicación-suscripción, donde los mensajes se envían a temas y se entregan a suscriptores a través de suscripciones.</p>
<p><img src="https://cloud.google.com/pubsub/images/pubsub-architecture.svg" alt="Arquitectura de Cloud Pub/Sub" /></p>
</div><h1><p>Configuración Inicial</p>
</h1>
<div class='content'></div><h2><p>Paso 1: Crear un Tema</p>
</h2>
<div class='content'><ol>
<li>Accede a la consola de GCP.</li>
<li>Navega a <strong>Pub/Sub</strong> en el menú de navegación.</li>
<li>Haz clic en <strong>Crear tema</strong>.</li>
<li>Ingresa un nombre para el tema y haz clic en <strong>Crear</strong>.</li>
</ol>
</div><h2><p>Paso 2: Crear una Suscripción</p>
</h2>
<div class='content'><ol>
<li>En la consola de Pub/Sub, selecciona el tema que creaste.</li>
<li>Haz clic en <strong>Crear suscripción</strong>.</li>
<li>Ingresa un nombre para la suscripción.</li>
<li>Selecciona el tipo de entrega (Pull o Push).</li>
<li>Haz clic en <strong>Crear</strong>.</li>
</ol>
</div><h1><p>Ejemplo Práctico</p>
</h1>
<div class='content'></div><h2><p>Publicar un Mensaje</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBDb25maWd1cmEgZWwgY2xpZW50ZSBkZSBQdWIvU3ViCnB1Ymxpc2hlciA9IHB1YnN1Yl92MS5QdWJsaXNoZXJDbGllbnQoKQp0b3BpY19wYXRoID0gcHVibGlzaGVyLnRvcGljX3BhdGgoJ3lvdXItcHJvamVjdC1pZCcsICd5b3VyLXRvcGljLW5hbWUnKQoKIyBNZW5zYWplIGEgcHVibGljYXIKbWVzc2FnZSA9ICJIZWxsbywgUHViL1N1YiEiCgojIFB1YmxpY2EgZWwgbWVuc2FqZQpmdXR1cmUgPSBwdWJsaXNoZXIucHVibGlzaCh0b3BpY19wYXRoLCBtZXNzYWdlLmVuY29kZSgndXRmLTgnKSkKcHJpbnQoZidNZXNzYWdlIElEOiB7ZnV0dXJlLnJlc3VsdCgpfScp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Configura el cliente de Pub/Sub
publisher = pubsub_v1.PublisherClient()
topic_path = publisher.topic_path('your-project-id', 'your-topic-name')

# Mensaje a publicar
message = &quot;Hello, Pub/Sub!&quot;

# Publica el mensaje
future = publisher.publish(topic_path, message.encode('utf-8'))
print(f'Message ID: {future.result()}')</pre></div><div class='content'></div><h2><p>Suscribirse y Recibir Mensajes</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKIyBDb25maWd1cmEgZWwgY2xpZW50ZSBkZSBQdWIvU3ViCnN1YnNjcmliZXIgPSBwdWJzdWJfdjEuU3Vic2NyaWJlckNsaWVudCgpCnN1YnNjcmlwdGlvbl9wYXRoID0gc3Vic2NyaWJlci5zdWJzY3JpcHRpb25fcGF0aCgneW91ci1wcm9qZWN0LWlkJywgJ3lvdXItc3Vic2NyaXB0aW9uLW5hbWUnKQoKZGVmIGNhbGxiYWNrKG1lc3NhZ2UpOgogICAgcHJpbnQoZidSZWNlaXZlZCBtZXNzYWdlOiB7bWVzc2FnZS5kYXRhfScpCiAgICBtZXNzYWdlLmFjaygpCgojIEVzY3VjaGEgbG9zIG1lbnNhamVzCnN0cmVhbWluZ19wdWxsX2Z1dHVyZSA9IHN1YnNjcmliZXIuc3Vic2NyaWJlKHN1YnNjcmlwdGlvbl9wYXRoLCBjYWxsYmFjaz1jYWxsYmFjaykKcHJpbnQoZidMaXN0ZW5pbmcgZm9yIG1lc3NhZ2VzIG9uIHtzdWJzY3JpcHRpb25fcGF0aH0nKQoKdHJ5OgogICAgc3RyZWFtaW5nX3B1bGxfZnV0dXJlLnJlc3VsdCgpCmV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgIHN0cmVhbWluZ19wdWxsX2Z1dHVyZS5jYW5jZWwoKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import pubsub_v1

# Configura el cliente de Pub/Sub
subscriber = pubsub_v1.SubscriberClient()
subscription_path = subscriber.subscription_path('your-project-id', 'your-subscription-name')

def callback(message):
    print(f'Received message: {message.data}')
    message.ack()

# Escucha los mensajes
streaming_pull_future = subscriber.subscribe(subscription_path, callback=callback)
print(f'Listening for messages on {subscription_path}')

try:
    streaming_pull_future.result()
except KeyboardInterrupt:
    streaming_pull_future.cancel()</pre></div><div class='content'></div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Publicar y Suscribirse a Mensajes</p>
</h2>
<div class='content'><ol>
<li><strong>Objetivo</strong>: Crear un tema y una suscripción, luego publicar y recibir mensajes.</li>
<li><strong>Pasos</strong>:
<ul>
<li>Crea un tema llamado <code>test-topic</code>.</li>
<li>Crea una suscripción llamada <code>test-subscription</code> para el tema <code>test-topic</code>.</li>
<li>Publica un mensaje &quot;Hello, World!&quot; en <code>test-topic</code>.</li>
<li>Configura un suscriptor para recibir mensajes de <code>test-subscription</code>.</li>
</ul>
</li>
</ol>
</div><h2><p>Solución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQdWJsaWNhciB1biBtZW5zYWplCmZyb20gZ29vZ2xlLmNsb3VkIGltcG9ydCBwdWJzdWJfdjEKCnB1Ymxpc2hlciA9IHB1YnN1Yl92MS5QdWJsaXNoZXJDbGllbnQoKQp0b3BpY19wYXRoID0gcHVibGlzaGVyLnRvcGljX3BhdGgoJ3lvdXItcHJvamVjdC1pZCcsICd0ZXN0LXRvcGljJykKCm1lc3NhZ2UgPSAiSGVsbG8sIFdvcmxkISIKZnV0dXJlID0gcHVibGlzaGVyLnB1Ymxpc2godG9waWNfcGF0aCwgbWVzc2FnZS5lbmNvZGUoJ3V0Zi04JykpCnByaW50KGYnTWVzc2FnZSBJRDoge2Z1dHVyZS5yZXN1bHQoKX0nKQoKIyBTdXNjcmliaXJzZSB5IHJlY2liaXIgbWVuc2FqZXMKZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IHB1YnN1Yl92MQoKc3Vic2NyaWJlciA9IHB1YnN1Yl92MS5TdWJzY3JpYmVyQ2xpZW50KCkKc3Vic2NyaXB0aW9uX3BhdGggPSBzdWJzY3JpYmVyLnN1YnNjcmlwdGlvbl9wYXRoKCd5b3VyLXByb2plY3QtaWQnLCAndGVzdC1zdWJzY3JpcHRpb24nKQoKZGVmIGNhbGxiYWNrKG1lc3NhZ2UpOgogICAgcHJpbnQoZidSZWNlaXZlZCBtZXNzYWdlOiB7bWVzc2FnZS5kYXRhfScpCiAgICBtZXNzYWdlLmFjaygpCgpzdHJlYW1pbmdfcHVsbF9mdXR1cmUgPSBzdWJzY3JpYmVyLnN1YnNjcmliZShzdWJzY3JpcHRpb25fcGF0aCwgY2FsbGJhY2s9Y2FsbGJhY2spCnByaW50KGYnTGlzdGVuaW5nIGZvciBtZXNzYWdlcyBvbiB7c3Vic2NyaXB0aW9uX3BhdGh9JykKCnRyeToKICAgIHN0cmVhbWluZ19wdWxsX2Z1dHVyZS5yZXN1bHQoKQpleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICBzdHJlYW1pbmdfcHVsbF9mdXR1cmUuY2FuY2VsKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Publicar un mensaje
from google.cloud import pubsub_v1

publisher = pubsub_v1.PublisherClient()
topic_path = publisher.topic_path('your-project-id', 'test-topic')

message = &quot;Hello, World!&quot;
future = publisher.publish(topic_path, message.encode('utf-8'))
print(f'Message ID: {future.result()}')

# Suscribirse y recibir mensajes
from google.cloud import pubsub_v1

subscriber = pubsub_v1.SubscriberClient()
subscription_path = subscriber.subscription_path('your-project-id', 'test-subscription')

def callback(message):
    print(f'Received message: {message.data}')
    message.ack()

streaming_pull_future = subscriber.subscribe(subscription_path, callback=callback)
print(f'Listening for messages on {subscription_path}')

try:
    streaming_pull_future.result()
except KeyboardInterrupt:
    streaming_pull_future.cancel()</pre></div><div class='content'></div><h1><p>Errores Comunes y Consejos</p>
</h1>
<div class='content'><ol>
<li><strong>Permisos Insuficientes</strong>: Asegúrate de que tu cuenta de servicio tenga los permisos necesarios para publicar y suscribirse a mensajes.</li>
<li><strong>Configuración Incorrecta del Cliente</strong>: Verifica que el ID del proyecto y los nombres de los temas y suscripciones sean correctos.</li>
<li><strong>Manejo de Errores</strong>: Implementa manejo de errores para situaciones como mensajes no reconocidos o problemas de red.</li>
</ol>
</div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, aprendiste los conceptos básicos de Cloud Pub/Sub, cómo configurar temas y suscripciones, y cómo publicar y recibir mensajes. Estos conocimientos son fundamentales para construir sistemas distribuidos y microservicios eficientes en Google Cloud Platform. En el próximo módulo, exploraremos otros servicios de datos y análisis en GCP.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-03-cloud-dataproc' title="Cloud Dataproc">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-05-cloud-data-fusion' title="Cloud Data Fusion">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
