<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manejo de Cursores</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/08-04-handling-cursors" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/08-04-handling-cursors" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/08-04-handling-cursors" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/cobol/08-04-handling-cursors" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/cobol/08-04-handling-cursors" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-03-database-operations' title="Operaciones de Base de Datos">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Manejo de Cursores</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-01-object-oriented-cobol' title="COBOL Orientado a Objetos">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este tema, aprenderemos sobre el manejo de cursores en COBOL cuando trabajamos con bases de datos. Los cursores son una herramienta esencial para manejar conjuntos de resultados de consultas SQL de manera eficiente. A través de este módulo, cubriremos los conceptos básicos de los cursores, cómo declararlos, abrirlos, usarlos para recuperar datos y cerrarlos.</p>
</div><h1>Conceptos Básicos de Cursores</h1>
<div class='content'><p>Un cursor es un mecanismo que permite recorrer fila por fila un conjunto de resultados de una consulta SQL. Los cursores son útiles cuando necesitas procesar cada fila individualmente en lugar de trabajar con el conjunto completo de resultados a la vez.</p>
</div><h2>Tipos de Cursores</h2>
<div class='content'><ol>
<li><strong>Cursores Estáticos</strong>: Capturan un conjunto de resultados en el momento en que se abre el cursor y no reflejan cambios posteriores en la base de datos.</li>
<li><strong>Cursores Dinámicos</strong>: Reflejan los cambios en la base de datos mientras se recorren las filas.</li>
<li><strong>Cursores de Solo Adelante</strong>: Permiten moverse solo hacia adelante a través del conjunto de resultados.</li>
</ol>
</div><h1>Declaración de Cursores</h1>
<div class='content'><p>Para usar un cursor en COBOL, primero debes declararlo en la sección de SQL embebido. Aquí hay un ejemplo básico de cómo declarar un cursor:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIERFQ0xBUkUgY3Vyc29yX25hbWUgQ1VSU09SIEZPUgogICAgU0VMRUNUIGNvbHVtbjEsIGNvbHVtbjIKICAgIEZST00gdGFibGVfbmFtZQogICAgV0hFUkUgY29uZGl0aW9uCkVORC1FWEVDLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    DECLARE cursor_name CURSOR FOR
    SELECT column1, column2
    FROM table_name
    WHERE condition
END-EXEC.</pre></div><div class='content'></div><h2>Ejemplo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIERFQ0xBUkUgZW1wbG95ZWVfY3Vyc29yIENVUlNPUiBGT1IKICAgIFNFTEVDVCBlbXBfaWQsIGVtcF9uYW1lLCBlbXBfc2FsYXJ5CiAgICBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgZW1wX2RlcGFydG1lbnQgPSAnSVQnCkVORC1FWEVDLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    DECLARE employee_cursor CURSOR FOR
    SELECT emp_id, emp_name, emp_salary
    FROM employees
    WHERE emp_department = 'IT'
END-EXEC.</pre></div><div class='content'></div><h1>Apertura de Cursores</h1>
<div class='content'><p>Después de declarar un cursor, debes abrirlo para ejecutar la consulta y preparar el conjunto de resultados.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIE9QRU4gY3Vyc29yX25hbWUKRU5ELUVYRUMu"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    OPEN cursor_name
END-EXEC.</pre></div><div class='content'></div><h2>Ejemplo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIE9QRU4gZW1wbG95ZWVfY3Vyc29yCkVORC1FWEVDLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    OPEN employee_cursor
END-EXEC.</pre></div><div class='content'></div><h1>Recuperación de Datos</h1>
<div class='content'><p>Para recuperar datos de un cursor, utilizamos la sentencia <code>FETCH</code>. Esto mueve el cursor a la siguiente fila del conjunto de resultados y copia los valores de las columnas en las variables COBOL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIEZFVENIIGN1cnNvcl9uYW1lIElOVE8gOnZhcmlhYmxlMSwgOnZhcmlhYmxlMgpFTkQtRVhFQy4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    FETCH cursor_name INTO :variable1, :variable2
END-EXEC.</pre></div><div class='content'></div><h2>Ejemplo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIEZFVENIIGVtcGxveWVlX2N1cnNvciBJTlRPIDplbXAtaWQsIDplbXAtbmFtZSwgOmVtcC1zYWxhcnkKRU5ELUVYRUMu"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    FETCH employee_cursor INTO :emp-id, :emp-name, :emp-salary
END-EXEC.</pre></div><div class='content'></div><h1>Cierre de Cursores</h1>
<div class='content'><p>Una vez que hayas terminado de usar un cursor, debes cerrarlo para liberar los recursos asociados.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIENMT1NFIGN1cnNvcl9uYW1lCkVORC1FWEVDLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    CLOSE cursor_name
END-EXEC.</pre></div><div class='content'></div><h2>Ejemplo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIENMT1NFIGVtcGxveWVlX2N1cnNvcgpFTkQtRVhFQy4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    CLOSE employee_cursor
END-EXEC.</pre></div><div class='content'></div><h1>Ejemplo Completo</h1>
<div class='content'><p>A continuación, se muestra un ejemplo completo que incluye la declaración, apertura, recuperación de datos y cierre de un cursor.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEN1cnNvckV4YW1wbGUuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgIEVNUC1JRCAgICAgIFBJQyA5KDUpLgowMSAgRU1QLU5BTUUgICAgUElDIFgoMjApLgowMSAgRU1QLVNBTEFSWSAgUElDIDkoNylWOTkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIERFQ0xBUkUgZW1wbG95ZWVfY3Vyc29yIENVUlNPUiBGT1IKICAgICAgICBTRUxFQ1QgZW1wX2lkLCBlbXBfbmFtZSwgZW1wX3NhbGFyeQogICAgICAgIEZST00gZW1wbG95ZWVzCiAgICAgICAgV0hFUkUgZW1wX2RlcGFydG1lbnQgPSAnSVQnCiAgICBFTkQtRVhFQy4KCiAgICBFWEVDIFNRTAogICAgICAgIE9QRU4gZW1wbG95ZWVfY3Vyc29yCiAgICBFTkQtRVhFQy4KCiAgICBQRVJGT1JNIFVOVElMIFNRTENPREUgTk9UID0gMAogICAgICAgIEVYRUMgU1FMCiAgICAgICAgICAgIEZFVENIIGVtcGxveWVlX2N1cnNvciBJTlRPIDpFTVAtSUQsIDpFTVAtTkFNRSwgOkVNUC1TQUxBUlkKICAgICAgICBFTkQtRVhFQwoKICAgICAgICBJRiBTUUxDT0RFID0gMAogICAgICAgICAgICBESVNQTEFZICdFbXBsb3llZSBJRDogJyBFTVAtSUQKICAgICAgICAgICAgRElTUExBWSAnRW1wbG95ZWUgTmFtZTogJyBFTVAtTkFNRQogICAgICAgICAgICBESVNQTEFZICdFbXBsb3llZSBTYWxhcnk6ICcgRU1QLVNBTEFSWQogICAgICAgIEVORC1JRgogICAgRU5ELVBFUkZPUk0uCgogICAgRVhFQyBTUUwKICAgICAgICBDTE9TRSBlbXBsb3llZV9jdXJzb3IKICAgIEVORC1FWEVDLgoKICAgIFNUT1AgUlVOLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. CursorExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  EMP-ID      PIC 9(5).
01  EMP-NAME    PIC X(20).
01  EMP-SALARY  PIC 9(7)V99.

PROCEDURE DIVISION.
    EXEC SQL
        DECLARE employee_cursor CURSOR FOR
        SELECT emp_id, emp_name, emp_salary
        FROM employees
        WHERE emp_department = 'IT'
    END-EXEC.

    EXEC SQL
        OPEN employee_cursor
    END-EXEC.

    PERFORM UNTIL SQLCODE NOT = 0
        EXEC SQL
            FETCH employee_cursor INTO :EMP-ID, :EMP-NAME, :EMP-SALARY
        END-EXEC

        IF SQLCODE = 0
            DISPLAY 'Employee ID: ' EMP-ID
            DISPLAY 'Employee Name: ' EMP-NAME
            DISPLAY 'Employee Salary: ' EMP-SALARY
        END-IF
    END-PERFORM.

    EXEC SQL
        CLOSE employee_cursor
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><ol>
<li>Declara un cursor para seleccionar todos los productos de una tabla <code>products</code> donde el <code>category</code> sea 'Electronics'.</li>
<li>Abre el cursor y recupera los datos de cada producto.</li>
<li>Muestra el <code>product_id</code>, <code>product_name</code> y <code>price</code> de cada producto.</li>
<li>Cierra el cursor al finalizar.</li>
</ol>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFByb2R1Y3RDdXJzb3JFeGFtcGxlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxICBQUk9EVUNULUlEICAgIFBJQyA5KDUpLgowMSAgUFJPRFVDVC1OQU1FICBQSUMgWCgzMCkuCjAxICBQUklDRSAgICAgICAgIFBJQyA5KDUpVjk5LgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBERUNMQVJFIHByb2R1Y3RfY3Vyc29yIENVUlNPUiBGT1IKICAgICAgICBTRUxFQ1QgcHJvZHVjdF9pZCwgcHJvZHVjdF9uYW1lLCBwcmljZQogICAgICAgIEZST00gcHJvZHVjdHMKICAgICAgICBXSEVSRSBjYXRlZ29yeSA9ICdFbGVjdHJvbmljcycKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgT1BFTiBwcm9kdWN0X2N1cnNvcgogICAgRU5ELUVYRUMuCgogICAgUEVSRk9STSBVTlRJTCBTUUxDT0RFIE5PVCA9IDAKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBGRVRDSCBwcm9kdWN0X2N1cnNvciBJTlRPIDpQUk9EVUNULUlELCA6UFJPRFVDVC1OQU1FLCA6UFJJQ0UKICAgICAgICBFTkQtRVhFQwoKICAgICAgICBJRiBTUUxDT0RFID0gMAogICAgICAgICAgICBESVNQTEFZICdQcm9kdWN0IElEOiAnIFBST0RVQ1QtSUQKICAgICAgICAgICAgRElTUExBWSAnUHJvZHVjdCBOYW1lOiAnIFBST0RVQ1QtTkFNRQogICAgICAgICAgICBESVNQTEFZICdQcmljZTogJyBQUklDRQogICAgICAgIEVORC1JRgogICAgRU5ELVBFUkZPUk0uCgogICAgRVhFQyBTUUwKICAgICAgICBDTE9TRSBwcm9kdWN0X2N1cnNvcgogICAgRU5ELUVYRUMuCgogICAgU1RPUCBSVU4u"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ProductCursorExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  PRODUCT-ID    PIC 9(5).
01  PRODUCT-NAME  PIC X(30).
01  PRICE         PIC 9(5)V99.

PROCEDURE DIVISION.
    EXEC SQL
        DECLARE product_cursor CURSOR FOR
        SELECT product_id, product_name, price
        FROM products
        WHERE category = 'Electronics'
    END-EXEC.

    EXEC SQL
        OPEN product_cursor
    END-EXEC.

    PERFORM UNTIL SQLCODE NOT = 0
        EXEC SQL
            FETCH product_cursor INTO :PRODUCT-ID, :PRODUCT-NAME, :PRICE
        END-EXEC

        IF SQLCODE = 0
            DISPLAY 'Product ID: ' PRODUCT-ID
            DISPLAY 'Product Name: ' PRODUCT-NAME
            DISPLAY 'Price: ' PRICE
        END-IF
    END-PERFORM.

    EXEC SQL
        CLOSE product_cursor
    END-EXEC.

    STOP RUN.</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>En este tema, hemos aprendido cómo manejar cursores en COBOL para trabajar con conjuntos de resultados de consultas SQL. Hemos cubierto la declaración, apertura, recuperación de datos y cierre de cursores, y hemos visto un ejemplo completo y un ejercicio práctico para reforzar los conceptos. Con esta base, estarás preparado para manejar conjuntos de datos más complejos y realizar operaciones detalladas en tus programas COBOL.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-03-database-operations' title="Operaciones de Base de Datos">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-01-object-oriented-cobol' title="COBOL Orientado a Objetos">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
