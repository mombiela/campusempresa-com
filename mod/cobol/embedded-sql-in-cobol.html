<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL embebido en COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cobol/embedded-sql-in-cobol" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cobol/embedded-sql-in-cobol" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cobol/embedded-sql-in-cobol" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/cobol/embedded-sql-in-cobol" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/cobol/embedded-sql-in-cobol" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-cobol-and-databases'>&#x25C4;Introducción a COBOL y Bases de Datos</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">SQL embebido en COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='database-access-techniques'>Técnicas de Acceso a Bases de Datos &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción al SQL embebido</h1>
<div class='content'><p>El SQL embebido permite que los programas COBOL ejecuten sentencias SQL directamente dentro del código COBOL. Esta integración permite que las aplicaciones COBOL interactúen con bases de datos relacionales de manera fluida.</p>
</div><h2>Conceptos clave</h2>
<div class='content'><ul>
<li><strong>SQL embebido</strong>: Sentencias SQL embebidas dentro de un programa en un lenguaje anfitrión (COBOL).</li>
<li><strong>Variables anfitrionas</strong>: Variables COBOL utilizadas para pasar datos entre el programa COBOL y las sentencias SQL.</li>
<li><strong>EXEC SQL</strong>: La palabra clave utilizada para iniciar una sentencia SQL embebida.</li>
<li><strong>END-EXEC</strong>: La palabra clave utilizada para finalizar una sentencia SQL embebida.</li>
</ul>
</div><h1>Configuración del SQL embebido en COBOL</h1>
<div class='content'><p>Para usar SQL embebido en COBOL, necesitas:</p>
<ol>
<li><strong>Incluir el SQLCA (Área de Comunicación SQL)</strong>: Esta es una estructura que proporciona retroalimentación sobre la ejecución de las sentencias SQL.</li>
<li><strong>Declarar Variables Anfitrionas</strong>: Estas son variables COBOL que se usarán en las sentencias SQL.</li>
<li><strong>Usar EXEC SQL y END-EXEC</strong>: Para embeber sentencias SQL dentro del código COBOL.</li>
</ol>
</div><h2>Ejemplo: Configuración básica</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVtYmVkZGVkU1FMRXhhbXBsZS4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgpFWEVDIFNRTCBJTkNMVURFIFNRTENBIEVORC1FWEVDLgoKMDEgRU1QLUlEIFBJQyA5KDQpLgowMSBFTVAtTkFNRSBQSUMgWCgyMCkuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIFNFTEVDVCBFTVBfTkFNRQogICAgICAgIElOVE8gOkVNUC1OQU1FCiAgICAgICAgRlJPTSBFTVBMT1lFRVMKICAgICAgICBXSEVSRSBFTVBfSUQgPSA6RU1QLUlECiAgICBFTkQtRVhFQy4KCiAgICBESVNQTEFZICdFbXBsb3llZSBOYW1lOiAnIEVNUC1OQU1FLgogICAgU1RPUCBSVU4u"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. EmbeddedSQLExample.

DATA DIVISION.
WORKING-STORAGE SECTION.
EXEC SQL INCLUDE SQLCA END-EXEC.

01 EMP-ID PIC 9(4).
01 EMP-NAME PIC X(20).

PROCEDURE DIVISION.
    EXEC SQL
        SELECT EMP_NAME
        INTO :EMP-NAME
        FROM EMPLOYEES
        WHERE EMP_ID = :EMP-ID
    END-EXEC.

    DISPLAY 'Employee Name: ' EMP-NAME.
    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>SQLCA</strong>: Incluido para manejar la retroalimentación de la ejecución SQL.</li>
<li><strong>Variables Anfitrionas</strong>: <code>EMP-ID</code> y <code>EMP-NAME</code> se usan para pasar datos entre COBOL y SQL.</li>
</ul>
</div><h1>Operaciones SQL comunes en COBOL</h1>
<div class='content'></div><h2>Sentencia SELECT</h2>
<div class='content'><p>La sentencia <code>SELECT</code> recupera datos de la base de datos.</p>
<h4>Ejemplo: Sentencia SELECT</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNFTEVDVCBFTVBfTkFNRQogICAgSU5UTyA6RU1QLU5BTUUKICAgIEZST00gRU1QTE9ZRUVTCiAgICBXSEVSRSBFTVBfSUQgPSA6RU1QLUlECkVORC1FWEVDLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SELECT EMP_NAME
    INTO :EMP-NAME
    FROM EMPLOYEES
    WHERE EMP_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>Cláusula INTO</strong>: Especifica la variable anfitriona para almacenar el resultado.</li>
<li><strong>Cláusula WHERE</strong>: Filtra los datos basados en la condición.</li>
</ul>
</div><h2>Sentencia INSERT</h2>
<div class='content'><p>La sentencia <code>INSERT</code> añade nuevos registros a la base de datos.</p>
<h4>Ejemplo: Sentencia INSERT</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIElOU0VSVCBJTlRPIEVNUExPWUVFUyAoRU1QX0lELCBFTVBfTkFNRSkKICAgIFZBTFVFUyAoOkVNUC1JRCwgOkVNUC1OQU1FKQpFTkQtRVhFQy4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    INSERT INTO EMPLOYEES (EMP_ID, EMP_NAME)
    VALUES (:EMP-ID, :EMP-NAME)
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>Cláusula VALUES</strong>: Especifica los valores a insertar en la tabla.</li>
</ul>
</div><h2>Sentencia UPDATE</h2>
<div class='content'><p>La sentencia <code>UPDATE</code> modifica registros existentes en la base de datos.</p>
<h4>Ejemplo: Sentencia UPDATE</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFVQREFURSBFTVBMT1lFRVMKICAgIFNFVCBFTVBfTkFNRSA9IDpFTVAtTkFNRQogICAgV0hFUkUgRU1QX0lEID0gOkVNUC1JRApFTkQtRVhFQy4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    UPDATE EMPLOYEES
    SET EMP_NAME = :EMP-NAME
    WHERE EMP_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>Cláusula SET</strong>: Especifica la columna a actualizar y el nuevo valor.</li>
</ul>
</div><h2>Sentencia DELETE</h2>
<div class='content'><p>La sentencia <code>DELETE</code> elimina registros de la base de datos.</p>
<h4>Ejemplo: Sentencia DELETE</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIERFTEVURSBGUk9NIEVNUExPWUVFUwogICAgV0hFUkUgRU1QX0lEID0gOkVNUC1JRApFTkQtRVhFQy4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    DELETE FROM EMPLOYEES
    WHERE EMP_ID = :EMP-ID
END-EXEC.</pre></div><div class='content'><ul>
<li><strong>Cláusula WHERE</strong>: Especifica la condición para identificar qué registros eliminar.</li>
</ul>
</div><h1>Manejo de errores SQL</h1>
<div class='content'><p>Los errores SQL pueden ser manejados usando la estructura SQLCA. El campo <code>SQLCODE</code> en SQLCA indica el resultado de la operación SQL.</p>
</div><h2>Ejemplo: Manejo de errores</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhFQyBTUUwKICAgIFNFTEVDVCBFTVBfTkFNRQogICAgSU5UTyA6RU1QLU5BTUUKICAgIEZST00gRU1QTE9ZRUVTCiAgICBXSEVSRSBFTVBfSUQgPSA6RU1QLUlECkVORC1FWEVDLgoKSUYgU1FMQ09ERSBOT1QgPSAwCiAgICBESVNQTEFZICdFcnJvcjogJyBTUUxDT0RFCkVMU0UKICAgIERJU1BMQVkgJ0VtcGxveWVlIE5hbWU6ICcgRU1QLU5BTUUu"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXEC SQL
    SELECT EMP_NAME
    INTO :EMP-NAME
    FROM EMPLOYEES
    WHERE EMP_ID = :EMP-ID
END-EXEC.

IF SQLCODE NOT = 0
    DISPLAY 'Error: ' SQLCODE
ELSE
    DISPLAY 'Employee Name: ' EMP-NAME.</pre></div><div class='content'><ul>
<li><strong>SQLCODE</strong>: Un campo en SQLCA que contiene el resultado de la operación SQL. Un valor de 0 indica éxito, mientras que otros valores indican diferentes tipos de errores.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El SQL embebido en COBOL permite interacciones poderosas con bases de datos directamente dentro de los programas COBOL. Al entender la configuración básica, las operaciones SQL comunes y el manejo de errores, puedes integrar efectivamente SQL con COBOL para gestionar y manipular datos en bases de datos relacionales. Practica estos conceptos con varias operaciones SQL para volverte competente en el uso de SQL embebido en COBOL.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-cobol-and-databases'>&#x25C4;Introducción a COBOL y Bases de Datos</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">SQL embebido en COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='database-access-techniques'>Técnicas de Acceso a Bases de Datos &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
