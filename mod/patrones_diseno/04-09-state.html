<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>State</title>

    <link rel="alternate" href="https://campusempresa.com/mod/patrones_diseno/04-09-state" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/patrones_diseno/04-09-state" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/patrones_diseno/04-09-state" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/patrones_diseno/04-09-state" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/patrones_diseno/04-09-state" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='04-08-observer' title="Observer">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">State</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='04-10-strategy' title="Strategy">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción al Patrón State</h1>
<div class='content'><p>El patrón State es un patrón de diseño de comportamiento que permite a un objeto cambiar su comportamiento cuando su estado interno cambia. Este patrón es particularmente útil cuando un objeto debe cambiar su comportamiento en tiempo de ejecución dependiendo de su estado.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Contexto</strong>: El objeto que contiene el estado y cuyo comportamiento cambia.</li>
<li><strong>Estado</strong>: Una interfaz o clase abstracta que define el comportamiento asociado con un estado particular del contexto.</li>
<li><strong>Estados Concretos</strong>: Implementaciones específicas de la interfaz de estado que definen el comportamiento para un estado particular del contexto.</li>
</ul>
</div><h1>Ejemplo Práctico</h1>
<div class='content'><p>Vamos a implementar un ejemplo sencillo de una máquina expendedora que cambia su comportamiento basado en su estado (sin moneda, con moneda, vendiendo producto).</p>
</div><h2>Diagrama de Clases</h2>
<div class='content'><table>
<thead>
<tr>
<th>Clase</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td>VendingMachine</td>
<td>Clase Contexto que mantiene una referencia al estado actual.</td>
</tr>
<tr>
<td>State</td>
<td>Interfaz que define el comportamiento común para todos los estados.</td>
</tr>
<tr>
<td>NoCoinState</td>
<td>Estado concreto que representa la máquina sin moneda.</td>
</tr>
<tr>
<td>HasCoinState</td>
<td>Estado concreto que representa la máquina con una moneda insertada.</td>
</tr>
<tr>
<td>SoldState</td>
<td>Estado concreto que representa la máquina vendiendo un producto.</td>
</tr>
</tbody>
</table>
</div><h2>Código</h2>
<div class='content'><h4>Interfaz State</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGludGVyZmFjZSBTdGF0ZSB7CiAgICB2b2lkIGluc2VydENvaW4oKTsKICAgIHZvaWQgZWplY3RDb2luKCk7CiAgICB2b2lkIHByZXNzQnV0dG9uKCk7CiAgICB2b2lkIGRpc3BlbnNlKCk7Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public interface State {
    void insertCoin();
    void ejectCoin();
    void pressButton();
    void dispense();
}</pre></div><div class='content'><h4>Clase Contexto: VendingMachine</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFZlbmRpbmdNYWNoaW5lIHsKICAgIHByaXZhdGUgU3RhdGUgbm9Db2luU3RhdGU7CiAgICBwcml2YXRlIFN0YXRlIGhhc0NvaW5TdGF0ZTsKICAgIHByaXZhdGUgU3RhdGUgc29sZFN0YXRlOwogICAgCiAgICBwcml2YXRlIFN0YXRlIGN1cnJlbnRTdGF0ZTsKICAgIAogICAgcHVibGljIFZlbmRpbmdNYWNoaW5lKCkgewogICAgICAgIG5vQ29pblN0YXRlID0gbmV3IE5vQ29pblN0YXRlKHRoaXMpOwogICAgICAgIGhhc0NvaW5TdGF0ZSA9IG5ldyBIYXNDb2luU3RhdGUodGhpcyk7CiAgICAgICAgc29sZFN0YXRlID0gbmV3IFNvbGRTdGF0ZSh0aGlzKTsKICAgICAgICAKICAgICAgICBjdXJyZW50U3RhdGUgPSBub0NvaW5TdGF0ZTsgLy8gRXN0YWRvIGluaWNpYWwKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgc2V0U3RhdGUoU3RhdGUgc3RhdGUpIHsKICAgICAgICBjdXJyZW50U3RhdGUgPSBzdGF0ZTsKICAgIH0KICAgIAogICAgcHVibGljIFN0YXRlIGdldE5vQ29pblN0YXRlKCkgewogICAgICAgIHJldHVybiBub0NvaW5TdGF0ZTsKICAgIH0KICAgIAogICAgcHVibGljIFN0YXRlIGdldEhhc0NvaW5TdGF0ZSgpIHsKICAgICAgICByZXR1cm4gaGFzQ29pblN0YXRlOwogICAgfQogICAgCiAgICBwdWJsaWMgU3RhdGUgZ2V0U29sZFN0YXRlKCkgewogICAgICAgIHJldHVybiBzb2xkU3RhdGU7CiAgICB9CiAgICAKICAgIHB1YmxpYyB2b2lkIGluc2VydENvaW4oKSB7CiAgICAgICAgY3VycmVudFN0YXRlLmluc2VydENvaW4oKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgZWplY3RDb2luKCkgewogICAgICAgIGN1cnJlbnRTdGF0ZS5lamVjdENvaW4oKTsKICAgIH0KICAgIAogICAgcHVibGljIHZvaWQgcHJlc3NCdXR0b24oKSB7CiAgICAgICAgY3VycmVudFN0YXRlLnByZXNzQnV0dG9uKCk7CiAgICAgICAgY3VycmVudFN0YXRlLmRpc3BlbnNlKCk7CiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class VendingMachine {
    private State noCoinState;
    private State hasCoinState;
    private State soldState;
    
    private State currentState;
    
    public VendingMachine() {
        noCoinState = new NoCoinState(this);
        hasCoinState = new HasCoinState(this);
        soldState = new SoldState(this);
        
        currentState = noCoinState; // Estado inicial
    }
    
    public void setState(State state) {
        currentState = state;
    }
    
    public State getNoCoinState() {
        return noCoinState;
    }
    
    public State getHasCoinState() {
        return hasCoinState;
    }
    
    public State getSoldState() {
        return soldState;
    }
    
    public void insertCoin() {
        currentState.insertCoin();
    }
    
    public void ejectCoin() {
        currentState.ejectCoin();
    }
    
    public void pressButton() {
        currentState.pressButton();
        currentState.dispense();
    }
}</pre></div><div class='content'><h4>Estados Concretos</h4>
<h5>NoCoinState</h5>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE5vQ29pblN0YXRlIGltcGxlbWVudHMgU3RhdGUgewogICAgcHJpdmF0ZSBWZW5kaW5nTWFjaGluZSB2ZW5kaW5nTWFjaGluZTsKICAgIAogICAgcHVibGljIE5vQ29pblN0YXRlKFZlbmRpbmdNYWNoaW5lIHZlbmRpbmdNYWNoaW5lKSB7CiAgICAgICAgdGhpcy52ZW5kaW5nTWFjaGluZSA9IHZlbmRpbmdNYWNoaW5lOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGluc2VydENvaW4oKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJDb2luIGluc2VydGVkLiIpOwogICAgICAgIHZlbmRpbmdNYWNoaW5lLnNldFN0YXRlKHZlbmRpbmdNYWNoaW5lLmdldEhhc0NvaW5TdGF0ZSgpKTsKICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBlamVjdENvaW4oKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJObyBjb2luIHRvIGVqZWN0LiIpOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHByZXNzQnV0dG9uKCkgewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiSW5zZXJ0IGNvaW4gZmlyc3QuIik7CiAgICB9CiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgZGlzcGVuc2UoKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJObyBjb2luIGluc2VydGVkLiIpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class NoCoinState implements State {
    private VendingMachine vendingMachine;
    
    public NoCoinState(VendingMachine vendingMachine) {
        this.vendingMachine = vendingMachine;
    }
    
    @Override
    public void insertCoin() {
        System.out.println(&quot;Coin inserted.&quot;);
        vendingMachine.setState(vendingMachine.getHasCoinState());
    }
    
    @Override
    public void ejectCoin() {
        System.out.println(&quot;No coin to eject.&quot;);
    }
    
    @Override
    public void pressButton() {
        System.out.println(&quot;Insert coin first.&quot;);
    }
    
    @Override
    public void dispense() {
        System.out.println(&quot;No coin inserted.&quot;);
    }
}</pre></div><div class='content'><h5>HasCoinState</h5>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEhhc0NvaW5TdGF0ZSBpbXBsZW1lbnRzIFN0YXRlIHsKICAgIHByaXZhdGUgVmVuZGluZ01hY2hpbmUgdmVuZGluZ01hY2hpbmU7CiAgICAKICAgIHB1YmxpYyBIYXNDb2luU3RhdGUoVmVuZGluZ01hY2hpbmUgdmVuZGluZ01hY2hpbmUpIHsKICAgICAgICB0aGlzLnZlbmRpbmdNYWNoaW5lID0gdmVuZGluZ01hY2hpbmU7CiAgICB9CiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgaW5zZXJ0Q29pbigpIHsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkNvaW4gYWxyZWFkeSBpbnNlcnRlZC4iKTsKICAgIH0KICAgIAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBlamVjdENvaW4oKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJDb2luIGVqZWN0ZWQuIik7CiAgICAgICAgdmVuZGluZ01hY2hpbmUuc2V0U3RhdGUodmVuZGluZ01hY2hpbmUuZ2V0Tm9Db2luU3RhdGUoKSk7CiAgICB9CiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcHJlc3NCdXR0b24oKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJCdXR0b24gcHJlc3NlZC4iKTsKICAgICAgICB2ZW5kaW5nTWFjaGluZS5zZXRTdGF0ZSh2ZW5kaW5nTWFjaGluZS5nZXRTb2xkU3RhdGUoKSk7CiAgICB9CiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgZGlzcGVuc2UoKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJObyBwcm9kdWN0IGRpc3BlbnNlZC4iKTsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class HasCoinState implements State {
    private VendingMachine vendingMachine;
    
    public HasCoinState(VendingMachine vendingMachine) {
        this.vendingMachine = vendingMachine;
    }
    
    @Override
    public void insertCoin() {
        System.out.println(&quot;Coin already inserted.&quot;);
    }
    
    @Override
    public void ejectCoin() {
        System.out.println(&quot;Coin ejected.&quot;);
        vendingMachine.setState(vendingMachine.getNoCoinState());
    }
    
    @Override
    public void pressButton() {
        System.out.println(&quot;Button pressed.&quot;);
        vendingMachine.setState(vendingMachine.getSoldState());
    }
    
    @Override
    public void dispense() {
        System.out.println(&quot;No product dispensed.&quot;);
    }
}</pre></div><div class='content'><h5>SoldState</h5>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFNvbGRTdGF0ZSBpbXBsZW1lbnRzIFN0YXRlIHsKICAgIHByaXZhdGUgVmVuZGluZ01hY2hpbmUgdmVuZGluZ01hY2hpbmU7CiAgICAKICAgIHB1YmxpYyBTb2xkU3RhdGUoVmVuZGluZ01hY2hpbmUgdmVuZGluZ01hY2hpbmUpIHsKICAgICAgICB0aGlzLnZlbmRpbmdNYWNoaW5lID0gdmVuZGluZ01hY2hpbmU7CiAgICB9CiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgaW5zZXJ0Q29pbigpIHsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlBsZWFzZSB3YWl0LCB3ZSdyZSBhbHJlYWR5IGdpdmluZyB5b3UgYSBwcm9kdWN0LiIpOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGVqZWN0Q29pbigpIHsKICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIlNvcnJ5LCB5b3UgYWxyZWFkeSBwcmVzc2VkIHRoZSBidXR0b24uIik7CiAgICB9CiAgICAKICAgIEBPdmVycmlkZQogICAgcHVibGljIHZvaWQgcHJlc3NCdXR0b24oKSB7CiAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJCdXR0b24gYWxyZWFkeSBwcmVzc2VkLiIpOwogICAgfQogICAgCiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIGRpc3BlbnNlKCkgewogICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiRGlzcGVuc2luZyBwcm9kdWN0LiIpOwogICAgICAgIHZlbmRpbmdNYWNoaW5lLnNldFN0YXRlKHZlbmRpbmdNYWNoaW5lLmdldE5vQ29pblN0YXRlKCkpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class SoldState implements State {
    private VendingMachine vendingMachine;
    
    public SoldState(VendingMachine vendingMachine) {
        this.vendingMachine = vendingMachine;
    }
    
    @Override
    public void insertCoin() {
        System.out.println(&quot;Please wait, we're already giving you a product.&quot;);
    }
    
    @Override
    public void ejectCoin() {
        System.out.println(&quot;Sorry, you already pressed the button.&quot;);
    }
    
    @Override
    public void pressButton() {
        System.out.println(&quot;Button already pressed.&quot;);
    }
    
    @Override
    public void dispense() {
        System.out.println(&quot;Dispensing product.&quot;);
        vendingMachine.setState(vendingMachine.getNoCoinState());
    }
}</pre></div><div class='content'></div><h2>Ejercicio Práctico</h2>
<div class='content'><h4>Ejercicio</h4>
<p>Implementa una máquina de café que tiene los siguientes estados: <code>NoCoinState</code>, <code>HasCoinState</code>, <code>BrewingState</code>, y <code>SoldOutState</code>. La máquina debe permitir insertar una moneda, devolver la moneda, seleccionar un tipo de café y dispensar el café.</p>
<h4>Solución</h4>
<ol>
<li>Define la interfaz <code>State</code> con los métodos necesarios.</li>
<li>Implementa la clase <code>CoffeeMachine</code> que actúa como el contexto.</li>
<li>Implementa los estados concretos (<code>NoCoinState</code>, <code>HasCoinState</code>, <code>BrewingState</code>, <code>SoldOutState</code>).</li>
</ol>
</div><h2>Retroalimentación y Errores Comunes</h2>
<div class='content'><ul>
<li>
<p><strong>Error Común</strong>: No cambiar el estado del contexto después de una acción.</p>
<ul>
<li><strong>Solución</strong>: Asegúrate de que cada acción en un estado concreto cambie el estado del contexto si es necesario.</li>
</ul>
</li>
<li>
<p><strong>Error Común</strong>: Implementar lógica específica del estado en el contexto.</p>
<ul>
<li><strong>Solución</strong>: Mantén la lógica específica del estado dentro de las clases de estado concreto.</li>
</ul>
</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El patrón State es una poderosa herramienta para manejar cambios en el comportamiento de un objeto basado en su estado interno. Al separar los estados en clases concretas, se mejora la mantenibilidad y extensibilidad del código. En el siguiente módulo, exploraremos el patrón Strategy, que permite definir una familia de algoritmos y hacer que sean intercambiables.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='04-08-observer' title="Observer">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='04-10-strategy' title="Strategy">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
