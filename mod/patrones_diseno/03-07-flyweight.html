<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Flyweight</title>

    <link rel="alternate" href="https://campusempresa.com/mod/patrones_diseno/03-07-flyweight" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/patrones_diseno/03-07-flyweight" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/patrones_diseno/03-07-flyweight" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/patrones_diseno/03-07-flyweight" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/patrones_diseno/03-07-flyweight" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Todo el conocimiento a tu alcance</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					 				<a href="/"><i class="bi bi-house-fill"></i> HOME</a>
											</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-06-facade' title="Facade">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Flyweight</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-08-proxy' title="Proxy">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>El patrón Flyweight es un patrón estructural que se utiliza para minimizar el uso de memoria al compartir la mayor cantidad de datos posible con objetos similares. Este patrón es especialmente útil cuando se necesita crear un gran número de objetos similares, ya que permite reducir significativamente el consumo de memoria.</p>
</div><h2>Objetivos del Patrón Flyweight</h2>
<div class='content'><ul>
<li><strong>Reducir el uso de memoria:</strong> Compartir datos comunes entre múltiples objetos para minimizar el consumo de memoria.</li>
<li><strong>Mejorar el rendimiento:</strong> Reducir la sobrecarga de memoria puede mejorar el rendimiento de la aplicación.</li>
</ul>
</div><h1>Conceptos Clave</h1>
<div class='content'></div><h2>Estado Intrínseco vs. Estado Extrínseco</h2>
<div class='content'><ul>
<li><strong>Estado Intrínseco:</strong> Parte del estado del objeto que es compartida entre todos los objetos similares. Este estado es inmutable y se almacena en el objeto Flyweight.</li>
<li><strong>Estado Extrínseco:</strong> Parte del estado del objeto que varía entre los objetos. Este estado no se almacena en el objeto Flyweight y se pasa al método que lo utiliza.</li>
</ul>
</div><h2>Estructura del Patrón Flyweight</h2>
<div class='content'><ol>
<li><strong>Flyweight:</strong> Define una interfaz a través de la cual los objetos Flyweight pueden recibir datos extrínsecos.</li>
<li><strong>ConcreteFlyweight:</strong> Implementa la interfaz Flyweight y almacena el estado intrínseco.</li>
<li><strong>FlyweightFactory:</strong> Crea y gestiona los objetos Flyweight. Asegura que los objetos Flyweight se compartan adecuadamente.</li>
</ol>
</div><h1>Ejemplo Práctico</h1>
<div class='content'><p>Imaginemos que estamos desarrollando un editor de texto que necesita manejar una gran cantidad de caracteres. En lugar de crear un objeto para cada carácter, podemos utilizar el patrón Flyweight para compartir los objetos de caracteres comunes.</p>
</div><h2>Implementación en Python</h2>
<div class='content'><h4>Flyweight Interface</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBhYmMgaW1wb3J0IEFCQywgYWJzdHJhY3RtZXRob2QKCmNsYXNzIEZseXdlaWdodChBQkMpOgogICAgQGFic3RyYWN0bWV0aG9kCiAgICBkZWYgcmVuZGVyKHNlbGYsIGV4dHJpbnNpY19zdGF0ZSk6CiAgICAgICAgcGFzcw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from abc import ABC, abstractmethod

class Flyweight(ABC):
    @abstractmethod
    def render(self, extrinsic_state):
        pass</pre></div><div class='content'><h4>ConcreteFlyweight</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgQ2hhcmFjdGVyRmx5d2VpZ2h0KEZseXdlaWdodCk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaW50cmluc2ljX3N0YXRlKToKICAgICAgICBzZWxmLmludHJpbnNpY19zdGF0ZSA9IGludHJpbnNpY19zdGF0ZQoKICAgIGRlZiByZW5kZXIoc2VsZiwgZXh0cmluc2ljX3N0YXRlKToKICAgICAgICBwcmludChmIkNoYXJhY3Rlcjoge3NlbGYuaW50cmluc2ljX3N0YXRlfSwgUG9zaXRpb246IHtleHRyaW5zaWNfc3RhdGV9Iik="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class CharacterFlyweight(Flyweight):
    def __init__(self, intrinsic_state):
        self.intrinsic_state = intrinsic_state

    def render(self, extrinsic_state):
        print(f&quot;Character: {self.intrinsic_state}, Position: {extrinsic_state}&quot;)</pre></div><div class='content'><h4>FlyweightFactory</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgRmx5d2VpZ2h0RmFjdG9yeToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzZWxmLmZseXdlaWdodHMgPSB7fQoKICAgIGRlZiBnZXRfZmx5d2VpZ2h0KHNlbGYsIGludHJpbnNpY19zdGF0ZSk6CiAgICAgICAgaWYgaW50cmluc2ljX3N0YXRlIG5vdCBpbiBzZWxmLmZseXdlaWdodHM6CiAgICAgICAgICAgIHNlbGYuZmx5d2VpZ2h0c1tpbnRyaW5zaWNfc3RhdGVdID0gQ2hhcmFjdGVyRmx5d2VpZ2h0KGludHJpbnNpY19zdGF0ZSkKICAgICAgICByZXR1cm4gc2VsZi5mbHl3ZWlnaHRzW2ludHJpbnNpY19zdGF0ZV0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class FlyweightFactory:
    def __init__(self):
        self.flyweights = {}

    def get_flyweight(self, intrinsic_state):
        if intrinsic_state not in self.flyweights:
            self.flyweights[intrinsic_state] = CharacterFlyweight(intrinsic_state)
        return self.flyweights[intrinsic_state]</pre></div><div class='content'><h4>Uso del Patrón Flyweight</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aWYgX19uYW1lX18gPT0gIl9fbWFpbl9fIjoKICAgIGZhY3RvcnkgPSBGbHl3ZWlnaHRGYWN0b3J5KCkKCiAgICAjIENyZWFyIHkgdXNhciBmbHl3ZWlnaHRzCiAgICBmbHl3ZWlnaHRfYSA9IGZhY3RvcnkuZ2V0X2ZseXdlaWdodCgnQScpCiAgICBmbHl3ZWlnaHRfYS5yZW5kZXIoMSkKCiAgICBmbHl3ZWlnaHRfYiA9IGZhY3RvcnkuZ2V0X2ZseXdlaWdodCgnQicpCiAgICBmbHl3ZWlnaHRfYi5yZW5kZXIoMikKCiAgICAjIFJldXRpbGl6YXIgZmx5d2VpZ2h0IGV4aXN0ZW50ZQogICAgZmx5d2VpZ2h0X2EyID0gZmFjdG9yeS5nZXRfZmx5d2VpZ2h0KCdBJykKICAgIGZseXdlaWdodF9hMi5yZW5kZXIoMykKCiAgICAjIFZlcmlmaWNhciBxdWUgc2UgcmV1dGlsaXphIGVsIG1pc21vIG9iamV0bwogICAgcHJpbnQoZmx5d2VpZ2h0X2EgaXMgZmx5d2VpZ2h0X2EyKSAgIyBUcnVl"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>if __name__ == &quot;__main__&quot;:
    factory = FlyweightFactory()

    # Crear y usar flyweights
    flyweight_a = factory.get_flyweight('A')
    flyweight_a.render(1)

    flyweight_b = factory.get_flyweight('B')
    flyweight_b.render(2)

    # Reutilizar flyweight existente
    flyweight_a2 = factory.get_flyweight('A')
    flyweight_a2.render(3)

    # Verificar que se reutiliza el mismo objeto
    print(flyweight_a is flyweight_a2)  # True</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ol>
<li><strong>Flyweight Interface:</strong> Define el método <code>render</code> que toma el estado extrínseco.</li>
<li><strong>ConcreteFlyweight:</strong> Implementa la interfaz Flyweight y almacena el estado intrínseco (el carácter).</li>
<li><strong>FlyweightFactory:</strong> Gestiona la creación y el almacenamiento de objetos Flyweight. Si un objeto Flyweight con el estado intrínseco solicitado ya existe, lo reutiliza.</li>
<li><strong>Uso del Patrón Flyweight:</strong> Se crean y utilizan objetos Flyweight para los caracteres 'A' y 'B'. Se demuestra que el objeto Flyweight para 'A' se reutiliza.</li>
</ol>
</div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><p>Implementa un sistema de gestión de árboles en un bosque utilizando el patrón Flyweight. Cada árbol tiene un tipo (estado intrínseco) y una posición (estado extrínseco).</p>
<h4>Solución</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgVHJlZUZseXdlaWdodChGbHl3ZWlnaHQpOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIHRyZWVfdHlwZSk6CiAgICAgICAgc2VsZi50cmVlX3R5cGUgPSB0cmVlX3R5cGUKCiAgICBkZWYgcmVuZGVyKHNlbGYsIHBvc2l0aW9uKToKICAgICAgICBwcmludChmIlRyZWUgdHlwZToge3NlbGYudHJlZV90eXBlfSwgUG9zaXRpb246IHtwb3NpdGlvbn0iKQoKY2xhc3MgVHJlZUZhY3Rvcnk6CiAgICBkZWYgX19pbml0X18oc2VsZik6CiAgICAgICAgc2VsZi50cmVlcyA9IHt9CgogICAgZGVmIGdldF90cmVlKHNlbGYsIHRyZWVfdHlwZSk6CiAgICAgICAgaWYgdHJlZV90eXBlIG5vdCBpbiBzZWxmLnRyZWVzOgogICAgICAgICAgICBzZWxmLnRyZWVzW3RyZWVfdHlwZV0gPSBUcmVlRmx5d2VpZ2h0KHRyZWVfdHlwZSkKICAgICAgICByZXR1cm4gc2VsZi50cmVlc1t0cmVlX3R5cGVdCgppZiBfX25hbWVfXyA9PSAiX19tYWluX18iOgogICAgdHJlZV9mYWN0b3J5ID0gVHJlZUZhY3RvcnkoKQoKICAgICMgQ3JlYXIgeSB1c2FyIGZseXdlaWdodHMKICAgIG9ha190cmVlID0gdHJlZV9mYWN0b3J5LmdldF90cmVlKCdPYWsnKQogICAgb2FrX3RyZWUucmVuZGVyKCgxMCwgMjApKQoKICAgIHBpbmVfdHJlZSA9IHRyZWVfZmFjdG9yeS5nZXRfdHJlZSgnUGluZScpCiAgICBwaW5lX3RyZWUucmVuZGVyKCgxNSwgMjUpKQoKICAgICMgUmV1dGlsaXphciBmbHl3ZWlnaHQgZXhpc3RlbnRlCiAgICBvYWtfdHJlZTIgPSB0cmVlX2ZhY3RvcnkuZ2V0X3RyZWUoJ09haycpCiAgICBvYWtfdHJlZTIucmVuZGVyKCgzMCwgNDApKQoKICAgICMgVmVyaWZpY2FyIHF1ZSBzZSByZXV0aWxpemEgZWwgbWlzbW8gb2JqZXRvCiAgICBwcmludChvYWtfdHJlZSBpcyBvYWtfdHJlZTIpICAjIFRydWU="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class TreeFlyweight(Flyweight):
    def __init__(self, tree_type):
        self.tree_type = tree_type

    def render(self, position):
        print(f&quot;Tree type: {self.tree_type}, Position: {position}&quot;)

class TreeFactory:
    def __init__(self):
        self.trees = {}

    def get_tree(self, tree_type):
        if tree_type not in self.trees:
            self.trees[tree_type] = TreeFlyweight(tree_type)
        return self.trees[tree_type]

if __name__ == &quot;__main__&quot;:
    tree_factory = TreeFactory()

    # Crear y usar flyweights
    oak_tree = tree_factory.get_tree('Oak')
    oak_tree.render((10, 20))

    pine_tree = tree_factory.get_tree('Pine')
    pine_tree.render((15, 25))

    # Reutilizar flyweight existente
    oak_tree2 = tree_factory.get_tree('Oak')
    oak_tree2.render((30, 40))

    # Verificar que se reutiliza el mismo objeto
    print(oak_tree is oak_tree2)  # True</pre></div><div class='content'></div><h2>Retroalimentación</h2>
<div class='content'><ul>
<li><strong>Error Común:</strong> No diferenciar entre estado intrínseco y extrínseco. Asegúrate de que el estado intrínseco es compartido y el extrínseco es pasado en tiempo de ejecución.</li>
<li><strong>Consejo:</strong> Utiliza un <code>FlyweightFactory</code> para gestionar la creación y reutilización de objetos Flyweight.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El patrón Flyweight es una poderosa herramienta para optimizar el uso de memoria en aplicaciones que manejan un gran número de objetos similares. Al compartir el estado intrínseco y gestionar adecuadamente el estado extrínseco, se puede reducir significativamente el consumo de memoria y mejorar el rendimiento de la aplicación.</p>
<p>En el siguiente módulo, exploraremos el patrón Proxy, que proporciona una forma de controlar el acceso a objetos.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-06-facade' title="Facade">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-08-proxy' title="Proxy">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicidad</h1>
<p>Este espacio está destinado a publicidad.</p>
<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>¡Gracias por colaborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
			









		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
