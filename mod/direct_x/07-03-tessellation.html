<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teselación</title>

    <link rel="alternate" href="https://campusempresa.com/mod/direct_x/07-03-tessellation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/direct_x/07-03-tessellation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/direct_x/07-03-tessellation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/direct_x/07-03-tessellation" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/direct_x/07-03-tessellation" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-02-post-processing-effects' title="Efectos de Post-Procesamiento">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Teselación</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-04-ray-tracing' title="Trazado de Rayos">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La teselación es una técnica avanzada de renderizado que permite subdividir primitivas geométricas en partes más pequeñas para mejorar la calidad visual de los modelos 3D. Esta técnica es especialmente útil para crear superficies más detalladas y suaves sin necesidad de aumentar significativamente la carga de trabajo del CPU.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ol>
<li><strong>Primitivas de Teselación</strong>: Las primitivas geométricas básicas que se subdividen, como triángulos y cuadriláteros.</li>
<li><strong>Etapas de Teselación</strong>:
<ul>
<li><strong>Hull Shader</strong>: Define cómo se subdividen las primitivas.</li>
<li><strong>Tessellator</strong>: Realiza la subdivisión real de las primitivas.</li>
<li><strong>Domain Shader</strong>: Calcula las posiciones finales de los vértices teselados.</li>
</ul>
</li>
<li><strong>Factores de Teselación</strong>: Controlan el nivel de subdivisión de las primitivas.</li>
</ol>
</div><h1>Configuración Inicial</h1>
<div class='content'><p>Antes de comenzar con la teselación, asegúrate de tener configurado tu entorno de desarrollo con DirectX 11 o superior, ya que la teselación no está disponible en versiones anteriores.</p>
</div><h2>Ejemplo de Código: Configuración de Teselación</h2>
<div class='content'><p>A continuación, se muestra un ejemplo básico de cómo configurar la teselación en DirectX:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGVmaW5pY2nDs24gZGVsIEh1bGwgU2hhZGVyCmNvbnN0IGNoYXIqIGh1bGxTaGFkZXJDb2RlID0gUiIoCiAgICBzdHJ1Y3QgSFNfSU5QVVQgewogICAgICAgIGZsb2F0MyBwb3MgOiBQT1NJVElPTjsKICAgIH07CgogICAgc3RydWN0IEhTX09VVFBVVCB7CiAgICAgICAgZmxvYXQzIHBvcyA6IFBPU0lUSU9OOwogICAgfTsKCiAgICBzdHJ1Y3QgSFNfQ09OU1RBTlRfREFUQV9PVVRQVVQgewogICAgICAgIGZsb2F0IGVkZ2VzWzNdIDogU1ZfVGVzc0ZhY3RvcjsKICAgICAgICBmbG9hdCBpbnNpZGUgOiBTVl9JbnNpZGVUZXNzRmFjdG9yOwogICAgfTsKCiAgICBIU19DT05TVEFOVF9EQVRBX09VVFBVVCBIU0NvbnN0YW50RGF0YShJbnB1dFBhdGNoPEhTX0lOUFVULCAzPiBpbnB1dFBhdGNoKSB7CiAgICAgICAgSFNfQ09OU1RBTlRfREFUQV9PVVRQVVQgb3V0cHV0OwogICAgICAgIG91dHB1dC5lZGdlc1swXSA9IDMuMGY7IC8vIEZhY3RvciBkZSB0ZXNlbGFjacOzbiBwYXJhIGVsIHByaW1lciBib3JkZQogICAgICAgIG91dHB1dC5lZGdlc1sxXSA9IDMuMGY7IC8vIEZhY3RvciBkZSB0ZXNlbGFjacOzbiBwYXJhIGVsIHNlZ3VuZG8gYm9yZGUKICAgICAgICBvdXRwdXQuZWRnZXNbMl0gPSAzLjBmOyAvLyBGYWN0b3IgZGUgdGVzZWxhY2nDs24gcGFyYSBlbCB0ZXJjZXIgYm9yZGUKICAgICAgICBvdXRwdXQuaW5zaWRlID0gMy4wZjsgICAvLyBGYWN0b3IgZGUgdGVzZWxhY2nDs24gaW50ZXJubwogICAgICAgIHJldHVybiBvdXRwdXQ7CiAgICB9CgogICAgW2RvbWFpbigidHJpIildCiAgICBbcGFydGl0aW9uaW5nKCJpbnRlZ2VyIildCiAgICBbb3V0cHV0dG9wb2xvZ3koInRyaWFuZ2xlX2N3IildCiAgICBbb3V0cHV0Y29udHJvbHBvaW50cygzKV0KICAgIFtwYXRjaGNvbnN0YW50ZnVuYygiSFNDb25zdGFudERhdGEiKV0KICAgIEhTX09VVFBVVCBtYWluKElucHV0UGF0Y2g8SFNfSU5QVVQsIDM+IGlucHV0UGF0Y2gsIHVpbnQgaSA6IFNWX091dHB1dENvbnRyb2xQb2ludElEKSB7CiAgICAgICAgSFNfT1VUUFVUIG91dHB1dDsKICAgICAgICBvdXRwdXQucG9zID0gaW5wdXRQYXRjaFtpXS5wb3M7CiAgICAgICAgcmV0dXJuIG91dHB1dDsKICAgIH0KKSI7CgovLyBEZWZpbmljacOzbiBkZWwgRG9tYWluIFNoYWRlcgpjb25zdCBjaGFyKiBkb21haW5TaGFkZXJDb2RlID0gUiIoCiAgICBzdHJ1Y3QgRFNfSU5QVVQgewogICAgICAgIGZsb2F0MyBwb3MgOiBQT1NJVElPTjsKICAgIH07CgogICAgc3RydWN0IERTX09VVFBVVCB7CiAgICAgICAgZmxvYXQ0IHBvcyA6IFNWX1BPU0lUSU9OOwogICAgfTsKCiAgICBbZG9tYWluKCJ0cmkiKV0KICAgIERTX09VVFBVVCBtYWluKEhTX0NPTlNUQU5UX0RBVEFfT1VUUFVUIGlucHV0LCBmbG9hdDMgYmFyeWNlbnRyaWNDb29yZHMgOiBTVl9Eb21haW5Mb2NhdGlvbiwgY29uc3QgT3V0cHV0UGF0Y2g8RFNfSU5QVVQsIDM+IHBhdGNoKSB7CiAgICAgICAgRFNfT1VUUFVUIG91dHB1dDsKICAgICAgICBmbG9hdDMgcG9zID0gYmFyeWNlbnRyaWNDb29yZHMueCAqIHBhdGNoWzBdLnBvcyArIGJhcnljZW50cmljQ29vcmRzLnkgKiBwYXRjaFsxXS5wb3MgKyBiYXJ5Y2VudHJpY0Nvb3Jkcy56ICogcGF0Y2hbMl0ucG9zOwogICAgICAgIG91dHB1dC5wb3MgPSBmbG9hdDQocG9zLCAxLjBmKTsKICAgICAgICByZXR1cm4gb3V0cHV0OwogICAgfQopIjs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Definici&oacute;n del Hull Shader
const char* hullShaderCode = R&quot;(
    struct HS_INPUT {
        float3 pos : POSITION;
    };

    struct HS_OUTPUT {
        float3 pos : POSITION;
    };

    struct HS_CONSTANT_DATA_OUTPUT {
        float edges[3] : SV_TessFactor;
        float inside : SV_InsideTessFactor;
    };

    HS_CONSTANT_DATA_OUTPUT HSConstantData(InputPatch&lt;HS_INPUT, 3&gt; inputPatch) {
        HS_CONSTANT_DATA_OUTPUT output;
        output.edges[0] = 3.0f; // Factor de teselaci&oacute;n para el primer borde
        output.edges[1] = 3.0f; // Factor de teselaci&oacute;n para el segundo borde
        output.edges[2] = 3.0f; // Factor de teselaci&oacute;n para el tercer borde
        output.inside = 3.0f;   // Factor de teselaci&oacute;n interno
        return output;
    }

    [domain(&quot;tri&quot;)]
    [partitioning(&quot;integer&quot;)]
    [outputtopology(&quot;triangle_cw&quot;)]
    [outputcontrolpoints(3)]
    [patchconstantfunc(&quot;HSConstantData&quot;)]
    HS_OUTPUT main(InputPatch&lt;HS_INPUT, 3&gt; inputPatch, uint i : SV_OutputControlPointID) {
        HS_OUTPUT output;
        output.pos = inputPatch[i].pos;
        return output;
    }
)&quot;;

// Definici&oacute;n del Domain Shader
const char* domainShaderCode = R&quot;(
    struct DS_INPUT {
        float3 pos : POSITION;
    };

    struct DS_OUTPUT {
        float4 pos : SV_POSITION;
    };

    [domain(&quot;tri&quot;)]
    DS_OUTPUT main(HS_CONSTANT_DATA_OUTPUT input, float3 barycentricCoords : SV_DomainLocation, const OutputPatch&lt;DS_INPUT, 3&gt; patch) {
        DS_OUTPUT output;
        float3 pos = barycentricCoords.x * patch[0].pos + barycentricCoords.y * patch[1].pos + barycentricCoords.z * patch[2].pos;
        output.pos = float4(pos, 1.0f);
        return output;
    }
)&quot;;</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ol>
<li>
<p><strong>Hull Shader</strong>:</p>
<ul>
<li>Define los factores de teselación para los bordes y el interior de la primitiva.</li>
<li><code>HSConstantData</code> es una función que establece estos factores.</li>
<li><code>main</code> es la función principal que pasa los datos de entrada a la siguiente etapa.</li>
</ul>
</li>
<li>
<p><strong>Domain Shader</strong>:</p>
<ul>
<li>Calcula las posiciones finales de los vértices teselados utilizando coordenadas baricéntricas.</li>
<li><code>main</code> es la función principal que combina las posiciones de los vértices originales según las coordenadas baricéntricas.</li>
</ul>
</li>
</ol>
</div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio: Implementar Teselación en un Triángulo</h2>
<div class='content'><p><strong>Objetivo</strong>: Implementar la teselación en un triángulo y renderizarlo en pantalla.</p>
<p><strong>Pasos</strong>:</p>
<ol>
<li>Configura tu entorno de desarrollo con DirectX 11 o superior.</li>
<li>Define y compila los shaders de Hull y Domain.</li>
<li>Configura el pipeline de renderizado para usar los shaders de teselación.</li>
<li>Renderiza un triángulo teselado en pantalla.</li>
</ol>
<p><strong>Código Base</strong>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ29uZmlndXJhY2nDs24gZGVsIHBpcGVsaW5lIGRlIHJlbmRlcml6YWRvCnZvaWQgU2V0dXBQaXBlbGluZSgpIHsKICAgIC8vIENvbXBpbGFyIHkgY3JlYXIgc2hhZGVycwogICAgSUQzRDExSHVsbFNoYWRlciogaHVsbFNoYWRlcjsKICAgIElEM0QxMURvbWFpblNoYWRlciogZG9tYWluU2hhZGVyOwogICAgLy8gLi4uIChjw7NkaWdvIHBhcmEgY29tcGlsYXIgeSBjcmVhciBzaGFkZXJzKQoKICAgIC8vIENvbmZpZ3VyYXIgZWwgcGlwZWxpbmUKICAgIGRldmljZUNvbnRleHQtPkhTU2V0U2hhZGVyKGh1bGxTaGFkZXIsIG51bGxwdHIsIDApOwogICAgZGV2aWNlQ29udGV4dC0+RFNTZXRTaGFkZXIoZG9tYWluU2hhZGVyLCBudWxscHRyLCAwKTsKICAgIC8vIC4uLiAoY29uZmlndXJhY2nDs24gYWRpY2lvbmFsIGRlbCBwaXBlbGluZSkKfQoKLy8gUmVuZGVyaXphZG8gZGVsIHRyacOhbmd1bG8Kdm9pZCBSZW5kZXIoKSB7CiAgICAvLyBMaW1waWFyIGVsIGJ1ZmZlcgogICAgZmxvYXQgY2xlYXJDb2xvcls0XSA9IHsgMC4wZiwgMC4yZiwgMC40ZiwgMS4wZiB9OwogICAgZGV2aWNlQ29udGV4dC0+Q2xlYXJSZW5kZXJUYXJnZXRWaWV3KHJlbmRlclRhcmdldFZpZXcsIGNsZWFyQ29sb3IpOwoKICAgIC8vIERpYnVqYXIgZWwgdHJpw6FuZ3VsbyB0ZXNlbGFkbwogICAgZGV2aWNlQ29udGV4dC0+RHJhdygzLCAwKTsKCiAgICAvLyBQcmVzZW50YXIgZWwgYnVmZmVyCiAgICBzd2FwQ2hhaW4tPlByZXNlbnQoMCwgMCk7Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Configuraci&oacute;n del pipeline de renderizado
void SetupPipeline() {
    // Compilar y crear shaders
    ID3D11HullShader* hullShader;
    ID3D11DomainShader* domainShader;
    // ... (c&oacute;digo para compilar y crear shaders)

    // Configurar el pipeline
    deviceContext-&gt;HSSetShader(hullShader, nullptr, 0);
    deviceContext-&gt;DSSetShader(domainShader, nullptr, 0);
    // ... (configuraci&oacute;n adicional del pipeline)
}

// Renderizado del tri&aacute;ngulo
void Render() {
    // Limpiar el buffer
    float clearColor[4] = { 0.0f, 0.2f, 0.4f, 1.0f };
    deviceContext-&gt;ClearRenderTargetView(renderTargetView, clearColor);

    // Dibujar el tri&aacute;ngulo teselado
    deviceContext-&gt;Draw(3, 0);

    // Presentar el buffer
    swapChain-&gt;Present(0, 0);
}</pre></div><div class='content'></div><h2>Solución</h2>
<div class='content'><ol>
<li>
<p><strong>Compilar y Crear Shaders</strong>:</p>
<ul>
<li>Usa el compilador de shaders de DirectX para compilar los shaders de Hull y Domain.</li>
<li>Crea los objetos de shader correspondientes (<code>ID3D11HullShader</code> y <code>ID3D11DomainShader</code>).</li>
</ul>
</li>
<li>
<p><strong>Configurar el Pipeline</strong>:</p>
<ul>
<li>Establece los shaders de Hull y Domain en el contexto del dispositivo.</li>
<li>Configura cualquier estado adicional necesario para la teselación.</li>
</ul>
</li>
<li>
<p><strong>Renderizar el Triángulo</strong>:</p>
<ul>
<li>Limpia el buffer de renderizado.</li>
<li>Usa <code>Draw</code> para renderizar el triángulo teselado.</li>
<li>Presenta el buffer en pantalla.</li>
</ul>
</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>La teselación es una técnica poderosa que permite mejorar la calidad visual de los modelos 3D mediante la subdivisión de primitivas geométricas. Al comprender y aplicar los conceptos de Hull Shader, Tessellator y Domain Shader, puedes crear superficies más detalladas y suaves en tus aplicaciones DirectX.</p>
<p>En el siguiente tema, exploraremos el trazado de rayos, una técnica avanzada que permite simular efectos de iluminación realistas mediante el seguimiento de los rayos de luz en una escena.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-02-post-processing-effects' title="Efectos de Post-Procesamiento">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-04-ray-tracing' title="Trazado de Rayos">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
