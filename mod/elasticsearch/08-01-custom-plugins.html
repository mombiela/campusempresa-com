<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plugins Personalizados</title>

    <link rel="alternate" href="https://campusempresa.com/mod/elasticsearch/08-01-custom-plugins" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/elasticsearch/08-01-custom-plugins" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/elasticsearch/08-01-custom-plugins" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/elasticsearch/08-01-custom-plugins" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/elasticsearch/08-01-custom-plugins" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-04-elasticsearch-other-tools' title="Elasticsearch con Otras Herramientas">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Plugins Personalizados</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-02-machine-learning-elasticsearch' title="Aprendizaje Automático en Elasticsearch">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos cómo extender la funcionalidad de Elasticsearch mediante la creación de plugins personalizados. Los plugins permiten a los desarrolladores añadir nuevas características, modificar el comportamiento existente y optimizar el rendimiento de Elasticsearch para casos de uso específicos.</p>
</div><h1><p>¿Qué es un Plugin en Elasticsearch?</p>
</h1>
<div class='content'><p>Un plugin en Elasticsearch es un componente adicional que se puede instalar para extender o modificar la funcionalidad del núcleo de Elasticsearch. Los plugins pueden proporcionar nuevas funcionalidades, como analizadores personalizados, tipos de búsqueda, scripts, y más.</p>
</div><h2><p>Tipos de Plugins</p>
</h2>
<div class='content'><ol>
<li><strong>Plugins de Análisis</strong>: Añaden nuevos analizadores, tokenizadores y filtros de tokens.</li>
<li><strong>Plugins de Búsqueda</strong>: Introducen nuevas consultas y tipos de búsqueda.</li>
<li><strong>Plugins de Ingestión</strong>: Añaden nuevos procesadores para pipelines de ingestión.</li>
<li><strong>Plugins de Seguridad</strong>: Mejoran las capacidades de seguridad, como autenticación y autorización.</li>
<li><strong>Plugins de Monitoreo</strong>: Proveen nuevas métricas y capacidades de monitoreo.</li>
</ol>
</div><h1><p>Creando un Plugin Personalizado</p>
</h1>
<div class='content'></div><h2><p>Requisitos Previos</p>
</h2>
<div class='content'><ul>
<li>Conocimientos básicos de Java.</li>
<li>Entorno de desarrollo configurado con JDK y Maven.</li>
<li>Elasticsearch instalado y funcionando.</li>
</ul>
</div><h2><p>Estructura de un Plugin</p>
</h2>
<div class='content'><p>Un plugin de Elasticsearch generalmente sigue una estructura de proyecto Maven. Aquí hay un ejemplo de la estructura básica:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXktY3VzdG9tLXBsdWdpbi8K4pSc4pSA4pSAIHNyYy8K4pSCICAg4pSc4pSA4pSAIG1haW4vCuKUgiAgIOKUgiAgIOKUnOKUgOKUgCBqYXZhLwrilIIgICDilIIgICDilIIgICDilJTilIDilIAgb3JnLwrilIIgICDilIIgICDilIIgICAgICAg4pSU4pSA4pSAIGV4YW1wbGUvCuKUgiAgIOKUgiAgIOKUgiAgICAgICAgICAg4pSU4pSA4pSAIE15Q3VzdG9tUGx1Z2luLmphdmEK4pSCICAg4pSCICAg4pSU4pSA4pSAIHJlc291cmNlcy8K4pSCICAg4pSCICAgICAgIOKUlOKUgOKUgCBwbHVnaW4tZGVzY3JpcHRvci5wcm9wZXJ0aWVzCuKUnOKUgOKUgCBwb20ueG1s"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>my-custom-plugin/
├── src/
│   ├── main/
│   │   ├── java/
│   │   │   └── org/
│   │   │       └── example/
│   │   │           └── MyCustomPlugin.java
│   │   └── resources/
│   │       └── plugin-descriptor.properties
├── pom.xml</pre></div><div class='content'></div><h2><p>Paso 1: Configurar el Proyecto Maven</p>
</h2>
<div class='content'><p>Crea un archivo <code>pom.xml</code> en la raíz del proyecto con el siguiente contenido:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PHByb2plY3QgeG1sbnM9Imh0dHA6Ly9tYXZlbi5hcGFjaGUub3JnL1BPTS80LjAuMCIKICAgICAgICAgeG1sbnM6eHNpPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxL1hNTFNjaGVtYS1pbnN0YW5jZSIKICAgICAgICAgeHNpOnNjaGVtYUxvY2F0aW9uPSJodHRwOi8vbWF2ZW4uYXBhY2hlLm9yZy9QT00vNC4wLjAgaHR0cDovL21hdmVuLmFwYWNoZS5vcmcveHNkL21hdmVuLTQuMC4wLnhzZCI+CiAgICA8bW9kZWxWZXJzaW9uPjQuMC4wPC9tb2RlbFZlcnNpb24+CiAgICA8Z3JvdXBJZD5vcmcuZXhhbXBsZTwvZ3JvdXBJZD4KICAgIDxhcnRpZmFjdElkPm15LWN1c3RvbS1wbHVnaW48L2FydGlmYWN0SWQ+CiAgICA8dmVyc2lvbj4xLjAuMDwvdmVyc2lvbj4KICAgIDxwYWNrYWdpbmc+amFyPC9wYWNrYWdpbmc+CgogICAgPGRlcGVuZGVuY2llcz4KICAgICAgICA8ZGVwZW5kZW5jeT4KICAgICAgICAgICAgPGdyb3VwSWQ+b3JnLmVsYXN0aWNzZWFyY2g8L2dyb3VwSWQ+CiAgICAgICAgICAgIDxhcnRpZmFjdElkPmVsYXN0aWNzZWFyY2g8L2FydGlmYWN0SWQ+CiAgICAgICAgICAgIDx2ZXJzaW9uPjcuMTAuMDwvdmVyc2lvbj4KICAgICAgICAgICAgPHNjb3BlPnByb3ZpZGVkPC9zY29wZT4KICAgICAgICA8L2RlcGVuZGVuY3k+CiAgICA8L2RlcGVuZGVuY2llcz4KCiAgICA8YnVpbGQ+CiAgICAgICAgPHBsdWdpbnM+CiAgICAgICAgICAgIDxwbHVnaW4+CiAgICAgICAgICAgICAgICA8Z3JvdXBJZD5vcmcuYXBhY2hlLm1hdmVuLnBsdWdpbnM8L2dyb3VwSWQ+CiAgICAgICAgICAgICAgICA8YXJ0aWZhY3RJZD5tYXZlbi1jb21waWxlci1wbHVnaW48L2FydGlmYWN0SWQ+CiAgICAgICAgICAgICAgICA8dmVyc2lvbj4zLjguMTwvdmVyc2lvbj4KICAgICAgICAgICAgICAgIDxjb25maWd1cmF0aW9uPgogICAgICAgICAgICAgICAgICAgIDxzb3VyY2U+MS44PC9zb3VyY2U+CiAgICAgICAgICAgICAgICAgICAgPHRhcmdldD4xLjg8L3RhcmdldD4KICAgICAgICAgICAgICAgIDwvY29uZmlndXJhdGlvbj4KICAgICAgICAgICAgPC9wbHVnaW4+CiAgICAgICAgPC9wbHVnaW5zPgogICAgPC9idWlsZD4KPC9wcm9qZWN0Pg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot;
         xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
         xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;
    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;
    &lt;groupId&gt;org.example&lt;/groupId&gt;
    &lt;artifactId&gt;my-custom-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;packaging&gt;jar&lt;/packaging&gt;

    &lt;dependencies&gt;
        &lt;dependency&gt;
            &lt;groupId&gt;org.elasticsearch&lt;/groupId&gt;
            &lt;artifactId&gt;elasticsearch&lt;/artifactId&gt;
            &lt;version&gt;7.10.0&lt;/version&gt;
            &lt;scope&gt;provided&lt;/scope&gt;
        &lt;/dependency&gt;
    &lt;/dependencies&gt;

    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
                &lt;version&gt;3.8.1&lt;/version&gt;
                &lt;configuration&gt;
                    &lt;source&gt;1.8&lt;/source&gt;
                    &lt;target&gt;1.8&lt;/target&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;
&lt;/project&gt;</pre></div><div class='content'></div><h2><p>Paso 2: Crear el Descriptor del Plugin</p>
</h2>
<div class='content'><p>Crea un archivo <code>plugin-descriptor.properties</code> en <code>src/main/resources</code> con el siguiente contenido:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVzY3JpcHRpb249TXkgQ3VzdG9tIFBsdWdpbgp2ZXJzaW9uPTEuMC4wCm5hbWU9bXktY3VzdG9tLXBsdWdpbgpjbGFzc25hbWU9b3JnLmV4YW1wbGUuTXlDdXN0b21QbHVnaW4KamF2YS52ZXJzaW9uPTEuOAplbGFzdGljc2VhcmNoLnZlcnNpb249Ny4xMC4w"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>description=My Custom Plugin
version=1.0.0
name=my-custom-plugin
classname=org.example.MyCustomPlugin
java.version=1.8
elasticsearch.version=7.10.0</pre></div><div class='content'></div><h2><p>Paso 3: Implementar la Clase del Plugin</p>
</h2>
<div class='content'><p>Crea la clase principal del plugin <code>MyCustomPlugin.java</code> en <code>src/main/java/org/example</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBvcmcuZXhhbXBsZTsKCmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5wbHVnaW5zLlBsdWdpbjsKCnB1YmxpYyBjbGFzcyBNeUN1c3RvbVBsdWdpbiBleHRlbmRzIFBsdWdpbiB7CiAgICAvLyBBcXXDrSBwdWVkZXMgYcOxYWRpciBsYSBsw7NnaWNhIGRlIHR1IHBsdWdpbgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package org.example;

import org.elasticsearch.plugins.Plugin;

public class MyCustomPlugin extends Plugin {
    // Aqu&iacute; puedes a&ntilde;adir la l&oacute;gica de tu plugin
}</pre></div><div class='content'></div><h2><p>Paso 4: Compilar y Empaquetar el Plugin</p>
</h2>
<div class='content'><p>Ejecuta el siguiente comando Maven para compilar y empaquetar el plugin:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bXZuIGNsZWFuIHBhY2thZ2U="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>mvn clean package</pre></div><div class='content'><p>Esto generará un archivo JAR en el directorio <code>target</code>.</p>
</div><h2><p>Paso 5: Instalar el Plugin en Elasticsearch</p>
</h2>
<div class='content'><p>Copia el archivo JAR generado al directorio de plugins de Elasticsearch y reinicia el servicio:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y3AgdGFyZ2V0L215LWN1c3RvbS1wbHVnaW4tMS4wLjAuamFyICRFU19IT01FL3BsdWdpbnMvbXktY3VzdG9tLXBsdWdpbi8KJEVTX0hPTUUvYmluL2VsYXN0aWNzZWFyY2gtcGx1Z2luIGluc3RhbGwgZmlsZTovLyRFU19IT01FL3BsdWdpbnMvbXktY3VzdG9tLXBsdWdpbi9teS1jdXN0b20tcGx1Z2luLTEuMC4wLmphcgokRVNfSE9NRS9iaW4vZWxhc3RpY3NlYXJjaCAtZA=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>cp target/my-custom-plugin-1.0.0.jar $ES_HOME/plugins/my-custom-plugin/
$ES_HOME/bin/elasticsearch-plugin install file://$ES_HOME/plugins/my-custom-plugin/my-custom-plugin-1.0.0.jar
$ES_HOME/bin/elasticsearch -d</pre></div><div class='content'></div><h1><p>Ejemplo Práctico: Añadiendo un Analizador Personalizado</p>
</h1>
<div class='content'><p>Vamos a extender nuestro plugin para añadir un analizador personalizado.</p>
</div><h2><p>Paso 1: Implementar el Analizador</p>
</h2>
<div class='content'><p>Añade la siguiente clase <code>MyCustomAnalyzer.java</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBvcmcuZXhhbXBsZTsKCmltcG9ydCBvcmcuYXBhY2hlLmx1Y2VuZS5hbmFseXNpcy5BbmFseXplcjsKaW1wb3J0IG9yZy5hcGFjaGUubHVjZW5lLmFuYWx5c2lzLlRva2VuU3RyZWFtOwppbXBvcnQgb3JnLmFwYWNoZS5sdWNlbmUuYW5hbHlzaXMuY29yZS5XaGl0ZXNwYWNlVG9rZW5pemVyOwoKcHVibGljIGNsYXNzIE15Q3VzdG9tQW5hbHl6ZXIgZXh0ZW5kcyBBbmFseXplciB7CiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBUb2tlblN0cmVhbUNvbXBvbmVudHMgY3JlYXRlQ29tcG9uZW50cyhTdHJpbmcgZmllbGROYW1lKSB7CiAgICAgICAgV2hpdGVzcGFjZVRva2VuaXplciB0b2tlbml6ZXIgPSBuZXcgV2hpdGVzcGFjZVRva2VuaXplcigpOwogICAgICAgIHJldHVybiBuZXcgVG9rZW5TdHJlYW1Db21wb25lbnRzKHRva2VuaXplcik7CiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package org.example;

import org.apache.lucene.analysis.Analyzer;
import org.apache.lucene.analysis.TokenStream;
import org.apache.lucene.analysis.core.WhitespaceTokenizer;

public class MyCustomAnalyzer extends Analyzer {
    @Override
    protected TokenStreamComponents createComponents(String fieldName) {
        WhitespaceTokenizer tokenizer = new WhitespaceTokenizer();
        return new TokenStreamComponents(tokenizer);
    }
}</pre></div><div class='content'></div><h2><p>Paso 2: Registrar el Analizador en el Plugin</p>
</h2>
<div class='content'><p>Modifica <code>MyCustomPlugin.java</code> para registrar el analizador:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBvcmcuZXhhbXBsZTsKCmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5pbmRleC5hbmFseXNpcy5BbmFseXplclByb3ZpZGVyOwppbXBvcnQgb3JnLmVsYXN0aWNzZWFyY2guaW5kZXguYW5hbHlzaXMuUHJlQnVpbHRBbmFseXplclByb3ZpZGVyRmFjdG9yeTsKaW1wb3J0IG9yZy5lbGFzdGljc2VhcmNoLmluZGljZXMuYW5hbHlzaXMuQW5hbHlzaXNNb2R1bGU7CmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5wbHVnaW5zLkFuYWx5c2lzUGx1Z2luOwppbXBvcnQgb3JnLmVsYXN0aWNzZWFyY2gucGx1Z2lucy5QbHVnaW47CgppbXBvcnQgamF2YS51dGlsLkhhc2hNYXA7CmltcG9ydCBqYXZhLnV0aWwuTWFwOwoKcHVibGljIGNsYXNzIE15Q3VzdG9tUGx1Z2luIGV4dGVuZHMgUGx1Z2luIGltcGxlbWVudHMgQW5hbHlzaXNQbHVnaW4gewogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgTWFwPFN0cmluZywgQW5hbHlzaXNNb2R1bGUuQW5hbHlzaXNQcm92aWRlcjxBbmFseXplclByb3ZpZGVyPD8+Pj4gZ2V0QW5hbHl6ZXJzKCkgewogICAgICAgIE1hcDxTdHJpbmcsIEFuYWx5c2lzTW9kdWxlLkFuYWx5c2lzUHJvdmlkZXI8QW5hbHl6ZXJQcm92aWRlcjw/Pj4+IGFuYWx5emVycyA9IG5ldyBIYXNoTWFwPD4oKTsKICAgICAgICBhbmFseXplcnMucHV0KCJteV9jdXN0b21fYW5hbHl6ZXIiLCAoaW5kZXhTZXR0aW5ncywgZW52aXJvbm1lbnQsIG5hbWUsIHNldHRpbmdzKSAtPgogICAgICAgICAgICAgICAgbmV3IFByZUJ1aWx0QW5hbHl6ZXJQcm92aWRlckZhY3RvcnkobmFtZSwgQW5hbHl6ZXJTY29wZS5HTE9CQUwsIG5ldyBNeUN1c3RvbUFuYWx5emVyKCkpLmdldCgpKTsKICAgICAgICByZXR1cm4gYW5hbHl6ZXJzOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package org.example;

import org.elasticsearch.index.analysis.AnalyzerProvider;
import org.elasticsearch.index.analysis.PreBuiltAnalyzerProviderFactory;
import org.elasticsearch.indices.analysis.AnalysisModule;
import org.elasticsearch.plugins.AnalysisPlugin;
import org.elasticsearch.plugins.Plugin;

import java.util.HashMap;
import java.util.Map;

public class MyCustomPlugin extends Plugin implements AnalysisPlugin {
    @Override
    public Map&lt;String, AnalysisModule.AnalysisProvider&lt;AnalyzerProvider&lt;?&gt;&gt;&gt; getAnalyzers() {
        Map&lt;String, AnalysisModule.AnalysisProvider&lt;AnalyzerProvider&lt;?&gt;&gt;&gt; analyzers = new HashMap&lt;&gt;();
        analyzers.put(&quot;my_custom_analyzer&quot;, (indexSettings, environment, name, settings) -&gt;
                new PreBuiltAnalyzerProviderFactory(name, AnalyzerScope.GLOBAL, new MyCustomAnalyzer()).get());
        return analyzers;
    }
}</pre></div><div class='content'></div><h2><p>Paso 3: Recompilar e Instalar el Plugin</p>
</h2>
<div class='content'><p>Recompila el plugin y reinstálalo en Elasticsearch siguiendo los pasos anteriores.</p>
</div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio</p>
</h2>
<div class='content'><ol>
<li>Crea un plugin que añada un nuevo tipo de búsqueda personalizada.</li>
<li>Implementa la lógica de la búsqueda en una clase separada.</li>
<li>Registra la búsqueda en la clase principal del plugin.</li>
<li>Compila, empaqueta e instala el plugin en Elasticsearch.</li>
<li>Realiza una búsqueda utilizando tu nuevo tipo de búsqueda.</li>
</ol>
</div><h2><p>Solución</p>
</h2>
<div class='content'><ol>
<li><strong>Implementar la Búsqueda Personalizada</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBvcmcuZXhhbXBsZTsKCmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5pbmRleC5xdWVyeS5RdWVyeUJ1aWxkZXI7CmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5pbmRleC5xdWVyeS5RdWVyeUJ1aWxkZXJzOwppbXBvcnQgb3JnLmVsYXN0aWNzZWFyY2guaW5kZXgucXVlcnkuUXVlcnlTaGFyZENvbnRleHQ7CmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5wbHVnaW5zLlNlYXJjaFBsdWdpbjsKaW1wb3J0IG9yZy5lbGFzdGljc2VhcmNoLnNlYXJjaC5pbnRlcm5hbC5TZWFyY2hDb250ZXh0OwoKcHVibGljIGNsYXNzIE15Q3VzdG9tUXVlcnlCdWlsZGVyIGV4dGVuZHMgUXVlcnlCdWlsZGVyIHsKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgZG9YQ29udGVudChYQ29udGVudEJ1aWxkZXIgYnVpbGRlciwgUGFyYW1zIHBhcmFtcykgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBJbXBsZW1lbnRhIGxhIGzDs2dpY2EgZGUgc2VyaWFsaXphY2nDs24gYXF1w60KICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBRdWVyeSBkb1RvUXVlcnkoUXVlcnlTaGFyZENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uIHsKICAgICAgICAvLyBJbXBsZW1lbnRhIGxhIGzDs2dpY2EgZGUgbGEgYsO6c3F1ZWRhIGFxdcOtCiAgICAgICAgcmV0dXJuIFF1ZXJ5QnVpbGRlcnMubWF0Y2hBbGxRdWVyeSgpLnRvUXVlcnkoY29udGV4dCk7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwcm90ZWN0ZWQgYm9vbGVhbiBkb0VxdWFscyhRdWVyeUJ1aWxkZXIgb3RoZXIpIHsKICAgICAgICByZXR1cm4gb3RoZXIgaW5zdGFuY2VvZiBNeUN1c3RvbVF1ZXJ5QnVpbGRlcjsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCBpbnQgZG9IYXNoQ29kZSgpIHsKICAgICAgICByZXR1cm4gMDsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package org.example;

import org.elasticsearch.index.query.QueryBuilder;
import org.elasticsearch.index.query.QueryBuilders;
import org.elasticsearch.index.query.QueryShardContext;
import org.elasticsearch.plugins.SearchPlugin;
import org.elasticsearch.search.internal.SearchContext;

public class MyCustomQueryBuilder extends QueryBuilder {
    @Override
    protected void doXContent(XContentBuilder builder, Params params) throws IOException {
        // Implementa la l&oacute;gica de serializaci&oacute;n aqu&iacute;
    }

    @Override
    protected Query doToQuery(QueryShardContext context) throws IOException {
        // Implementa la l&oacute;gica de la b&uacute;squeda aqu&iacute;
        return QueryBuilders.matchAllQuery().toQuery(context);
    }

    @Override
    protected boolean doEquals(QueryBuilder other) {
        return other instanceof MyCustomQueryBuilder;
    }

    @Override
    protected int doHashCode() {
        return 0;
    }
}</pre></div><div class='content'><ol start="2">
<li><strong>Registrar la Búsqueda en el Plugin</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGFja2FnZSBvcmcuZXhhbXBsZTsKCmltcG9ydCBvcmcuZWxhc3RpY3NlYXJjaC5wbHVnaW5zLlBsdWdpbjsKaW1wb3J0IG9yZy5lbGFzdGljc2VhcmNoLnBsdWdpbnMuU2VhcmNoUGx1Z2luOwoKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKcHVibGljIGNsYXNzIE15Q3VzdG9tUGx1Z2luIGV4dGVuZHMgUGx1Z2luIGltcGxlbWVudHMgU2VhcmNoUGx1Z2luIHsKICAgIEBPdmVycmlkZQogICAgcHVibGljIExpc3Q8UXVlcnlTcGVjPD8+PiBnZXRRdWVyaWVzKCkgewogICAgICAgIHJldHVybiBMaXN0Lm9mKG5ldyBRdWVyeVNwZWM8PigibXlfY3VzdG9tX3F1ZXJ5IiwgTXlDdXN0b21RdWVyeUJ1aWxkZXI6Om5ldywgTXlDdXN0b21RdWVyeUJ1aWxkZXI6OmZyb21YQ29udGVudCkpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>package org.example;

import org.elasticsearch.plugins.Plugin;
import org.elasticsearch.plugins.SearchPlugin;

import java.util.List;

public class MyCustomPlugin extends Plugin implements SearchPlugin {
    @Override
    public List&lt;QuerySpec&lt;?&gt;&gt; getQueries() {
        return List.of(new QuerySpec&lt;&gt;(&quot;my_custom_query&quot;, MyCustomQueryBuilder::new, MyCustomQueryBuilder::fromXContent));
    }
}</pre></div><div class='content'><ol start="3">
<li><strong>Compilar e Instalar</strong>:</li>
</ol>
<p>Sigue los pasos anteriores para compilar e instalar el plugin.</p>
<ol start="4">
<li><strong>Realizar una Búsqueda</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UE9TVCAvbXlfaW5kZXgvX3NlYXJjaAp7CiAgInF1ZXJ5IjogewogICAgIm15X2N1c3RvbV9xdWVyeSI6IHt9CiAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>POST /my_index/_search
{
  &quot;query&quot;: {
    &quot;my_custom_query&quot;: {}
  }
}</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En este módulo, hemos aprendido cómo crear y registrar un plugin personalizado en Elasticsearch. Los plugins son una poderosa herramienta para extender las capacidades de Elasticsearch y adaptarlo a necesidades específicas. Con esta base, puedes explorar y desarrollar plugins más complejos para mejorar tus soluciones de búsqueda y análisis.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-04-elasticsearch-other-tools' title="Elasticsearch con Otras Herramientas">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-02-machine-learning-elasticsearch' title="Aprendizaje Automático en Elasticsearch">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
