<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Programación Basada en Eventos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/04-05-event-driven-programming" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/04-05-event-driven-programming" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/04-05-event-driven-programming" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/vba/04-05-event-driven-programming" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/vba/04-05-event-driven-programming" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contenido del curso
	</a>

			</div>
		</div>
	</div>
</div>

<!--  
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contenido del curso
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>
 -->				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-04-working-with-userforms' title="Trabajando con UserForms">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Programación Basada en Eventos</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-01-automating-word-vba' title="Automatizando Word con VBA">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>La programación basada en eventos es un paradigma de programación en el que el flujo del programa está determinado por eventos, como acciones del usuario (clics del ratón, pulsaciones de teclas), mensajes de otros programas o cambios en el estado del sistema. En VBA, la programación basada en eventos es fundamental para crear aplicaciones interactivas y dinámicas.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ol>
<li><strong>Eventos</strong>: Son acciones o sucesos que ocurren en el sistema, como el clic de un botón o la apertura de un libro de Excel.</li>
<li><strong>Manejadores de Eventos</strong>: Son procedimientos que se ejecutan en respuesta a un evento específico.</li>
<li><strong>Objetos de Eventos</strong>: Son los objetos que pueden generar eventos, como formularios, controles de formulario, libros de trabajo, etc.</li>
</ol>
</div><h1>Ejemplo Práctico: Manejando Eventos en un UserForm</h1>
<div class='content'></div><h2>Paso 1: Crear un UserForm</h2>
<div class='content'><ol>
<li>Abre el Editor de VBA (Alt + F11).</li>
<li>Inserta un nuevo UserForm (Insert &gt; UserForm).</li>
<li>Agrega un botón de comando (CommandButton) al UserForm.</li>
</ol>
</div><h2>Paso 2: Escribir el Manejador de Eventos</h2>
<div class='content'><ol>
<li>Haz doble clic en el botón de comando para abrir la ventana de código del UserForm.</li>
<li>Escribe el siguiente código en el manejador de eventos <code>CommandButton1_Click</code>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgQ29tbWFuZEJ1dHRvbjFfQ2xpY2soKQogICAgTXNnQm94ICLCoUJvdMOzbiBjbGljYWRvISIKRW5kIFN1Yg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub CommandButton1_Click()
    MsgBox &quot;&iexcl;Bot&oacute;n clicado!&quot;
End Sub</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ul>
<li><code>Private Sub CommandButton1_Click()</code>: Este es el manejador de eventos para el evento <code>Click</code> del <code>CommandButton1</code>. Se ejecuta cuando el usuario hace clic en el botón.</li>
<li><code>MsgBox &quot;¡Botón clicado!&quot;</code>: Muestra un cuadro de mensaje con el texto &quot;¡Botón clicado!&quot;.</li>
</ul>
</div><h2>Paso 3: Probar el UserForm</h2>
<div class='content'><ol>
<li>Cierra la ventana de código y vuelve al UserForm.</li>
<li>Ejecuta el UserForm (F5).</li>
<li>Haz clic en el botón y observa el cuadro de mensaje que aparece.</li>
</ol>
</div><h1>Eventos Comunes en VBA</h1>
<div class='content'></div><h2>Eventos de Workbook (Libro de Trabajo)</h2>
<div class='content'><ul>
<li><strong>Workbook_Open</strong>: Se ejecuta cuando se abre el libro de trabajo.</li>
<li><strong>Workbook_BeforeClose</strong>: Se ejecuta antes de cerrar el libro de trabajo.</li>
</ul>
</div><h2>Ejemplo: Workbook_Open</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgV29ya2Jvb2tfT3BlbigpCiAgICBNc2dCb3ggIsKhQmllbnZlbmlkbyBhbCBsaWJybyBkZSB0cmFiYWpvISIKRW5kIFN1Yg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub Workbook_Open()
    MsgBox &quot;&iexcl;Bienvenido al libro de trabajo!&quot;
End Sub</pre></div><div class='content'></div><h2>Eventos de Worksheet (Hoja de Cálculo)</h2>
<div class='content'><ul>
<li><strong>Worksheet_Change</strong>: Se ejecuta cuando cambia una celda en la hoja de cálculo.</li>
<li><strong>Worksheet_SelectionChange</strong>: Se ejecuta cuando cambia la selección en la hoja de cálculo.</li>
</ul>
</div><h2>Ejemplo: Worksheet_Change</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgV29ya3NoZWV0X0NoYW5nZShCeVZhbCBUYXJnZXQgQXMgUmFuZ2UpCiAgICBJZiBOb3QgSW50ZXJzZWN0KFRhcmdldCwgUmFuZ2UoIkExOkExMCIpKSBJcyBOb3RoaW5nIFRoZW4KICAgICAgICBNc2dCb3ggIkhhcyBjYW1iaWFkbyB1bmEgY2VsZGEgZW4gZWwgcmFuZ28gQTE6QTEwIgogICAgRW5kIElmCkVuZCBTdWI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Range(&quot;A1:A10&quot;)) Is Nothing Then
        MsgBox &quot;Has cambiado una celda en el rango A1:A10&quot;
    End If
End Sub</pre></div><div class='content'></div><h2>Eventos de UserForm</h2>
<div class='content'><ul>
<li><strong>UserForm_Initialize</strong>: Se ejecuta cuando se inicializa el UserForm.</li>
<li><strong>UserForm_Terminate</strong>: Se ejecuta cuando se cierra el UserForm.</li>
</ul>
</div><h2>Ejemplo: UserForm_Initialize</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgVXNlckZvcm1fSW5pdGlhbGl6ZSgpCiAgICBNc2dCb3ggIkVsIGZvcm11bGFyaW8gc2UgaGEgaW5pY2lhbGl6YWRvIgpFbmQgU3Vi"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub UserForm_Initialize()
    MsgBox &quot;El formulario se ha inicializado&quot;
End Sub</pre></div><div class='content'></div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio 1: Crear un Manejador de Eventos para un ComboBox</h2>
<div class='content'><ol>
<li>Crea un UserForm y agrega un ComboBox.</li>
<li>Llena el ComboBox con algunos elementos en el evento <code>UserForm_Initialize</code>.</li>
<li>Muestra un mensaje cuando se selecciona un elemento del ComboBox.</li>
</ol>
<h4>Solución</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgVXNlckZvcm1fSW5pdGlhbGl6ZSgpCiAgICBDb21ib0JveDEuQWRkSXRlbSAiT3BjacOzbiAxIgogICAgQ29tYm9Cb3gxLkFkZEl0ZW0gIk9wY2nDs24gMiIKICAgIENvbWJvQm94MS5BZGRJdGVtICJPcGNpw7NuIDMiCkVuZCBTdWIKClByaXZhdGUgU3ViIENvbWJvQm94MV9DaGFuZ2UoKQogICAgTXNnQm94ICJIYXMgc2VsZWNjaW9uYWRvOiAiICYgQ29tYm9Cb3gxLlZhbHVlCkVuZCBTdWI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub UserForm_Initialize()
    ComboBox1.AddItem &quot;Opci&oacute;n 1&quot;
    ComboBox1.AddItem &quot;Opci&oacute;n 2&quot;
    ComboBox1.AddItem &quot;Opci&oacute;n 3&quot;
End Sub

Private Sub ComboBox1_Change()
    MsgBox &quot;Has seleccionado: &quot; &amp; ComboBox1.Value
End Sub</pre></div><div class='content'></div><h2>Ejercicio 2: Manejador de Eventos para Worksheet_Change</h2>
<div class='content'><ol>
<li>En una hoja de cálculo, escribe un manejador de eventos que muestre un mensaje cuando se cambie una celda en la columna B.</li>
</ol>
<h4>Solución</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgV29ya3NoZWV0X0NoYW5nZShCeVZhbCBUYXJnZXQgQXMgUmFuZ2UpCiAgICBJZiBOb3QgSW50ZXJzZWN0KFRhcmdldCwgQ29sdW1ucygiQiIpKSBJcyBOb3RoaW5nIFRoZW4KICAgICAgICBNc2dCb3ggIkhhcyBjYW1iaWFkbyB1bmEgY2VsZGEgZW4gbGEgY29sdW1uYSBCIgogICAgRW5kIElmCkVuZCBTdWI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub Worksheet_Change(ByVal Target As Range)
    If Not Intersect(Target, Columns(&quot;B&quot;)) Is Nothing Then
        MsgBox &quot;Has cambiado una celda en la columna B&quot;
    End If
End Sub</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>La programación basada en eventos en VBA permite crear aplicaciones interactivas y dinámicas que responden a las acciones del usuario y otros eventos del sistema. Al dominar los eventos y sus manejadores, puedes mejorar significativamente la funcionalidad y la usabilidad de tus aplicaciones VBA.</p>
<p>En el siguiente módulo, exploraremos cómo interactuar con otras aplicaciones de Microsoft Office utilizando VBA, lo que te permitirá automatizar tareas complejas y mejorar tu productividad.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-04-working-with-userforms' title="Trabajando con UserForms">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-01-automating-word-vba' title="Automatizando Word con VBA">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curso de VBA (Visual Basic for Applications)</h1>
<h2>Módulo 1: Introducción a VBA</h2>
<ul>
<li><a href="01-01-what-is-vba">¿Qué es VBA?</a></li>
<li><a href="01-02-setting-up-vba-environment">Configuración del Entorno de VBA</a></li>
<li><a href="01-03-first-vba-program">Primer Programa en VBA</a></li>
<li><a href="01-04-understanding-vba-editor">Entendiendo el Editor de VBA</a></li>
</ul>
<h2>Módulo 2: Conceptos Básicos de VBA</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables y Tipos de Datos</a></li>
<li><a href="02-02-operators-in-vba">Operadores en VBA</a></li>
<li><a href="02-03-control-structures-if-then-else">Estructuras de Control: If...Then...Else</a></li>
<li><a href="02-04-loops-for-while-do-until">Bucles: For, While, Do Until</a></li>
<li><a href="02-05-working-with-arrays">Trabajando con Arrays</a></li>
</ul>
<h2>Módulo 3: Trabajando con Objetos de Excel</h2>
<ul>
<li><a href="03-01-understanding-excel-object-model">Entendiendo el Modelo de Objetos de Excel</a></li>
<li><a href="03-02-working-with-workbooks-worksheets">Trabajando con Libros y Hojas de Cálculo</a></li>
<li><a href="03-03-manipulating-cells-ranges">Manipulando Celdas y Rangos</a></li>
<li><a href="03-04-using-range-object">Usando el Objeto Range</a></li>
<li><a href="03-05-formatting-cells-vba">Formateando Celdas con VBA</a></li>
</ul>
<h2>Módulo 4: Programación Avanzada en VBA</h2>
<ul>
<li><a href="04-01-creating-using-functions">Creación y Uso de Funciones</a></li>
<li><a href="04-02-error-handling-vba">Manejo de Errores en VBA</a></li>
<li><a href="04-03-debugging-techniques">Técnicas de Depuración</a></li>
<li><a href="04-04-working-with-userforms">Trabajando con UserForms</a></li>
<li><a href="04-05-event-driven-programming">Programación Basada en Eventos</a></li>
</ul>
<h2>Módulo 5: Interacción con Otras Aplicaciones</h2>
<ul>
<li><a href="05-01-automating-word-vba">Automatizando Word con VBA</a></li>
<li><a href="05-02-automating-outlook-vba">Automatizando Outlook con VBA</a></li>
<li><a href="05-03-accessing-databases-vba">Accediendo a Bases de Datos con VBA</a></li>
<li><a href="05-04-using-vba-control-powerpoint">Usando VBA para Controlar PowerPoint</a></li>
</ul>
<h2>Módulo 6: Mejores Prácticas y Optimización</h2>
<ul>
<li><a href="06-01-writing-efficient-vba-code">Escribiendo Código VBA Eficiente</a></li>
<li><a href="06-02-code-refactoring-techniques">Técnicas de Refactorización de Código</a></li>
<li><a href="06-03-documenting-your-code">Documentando tu Código</a></li>
<li><a href="06-04-version-control-vba-projects">Control de Versiones para Proyectos VBA</a></li>
</ul>
<h2>Módulo 7: Proyectos del Mundo Real</h2>
<ul>
<li><a href="07-01-automating-reports-excel">Automatizando Informes en Excel</a></li>
<li><a href="07-02-creating-custom-excel-addin">Creando un Complemento Personalizado de Excel</a></li>
<li><a href="07-03-building-data-entry-form">Construyendo un Formulario de Entrada de Datos</a></li>
<li><a href="07-04-developing-dashboard-vba">Desarrollando un Tablero de Control con VBA</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
