<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Técnicas de Depuración</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/debugging-techniques" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/debugging-techniques" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/debugging-techniques" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/vba/debugging-techniques" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/vba/debugging-techniques" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='optimizing-vba-code'>&#x25C4;Optimizando el Código VBA</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Técnicas de Depuración</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-the-immediate-window'>Usando la Ventana Inmediata &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La depuración es una habilidad esencial para cualquier programador. En esta sección, cubriremos varias técnicas de depuración en VBA (Visual Basic for Applications) que van desde niveles principiantes hasta avanzados. Al final de este tema, serás capaz de identificar y corregir errores en tu código VBA de manera eficiente.</p>
</div><h1>Introducción a la Depuración</h1>
<div class='content'><p>Antes de sumergirnos en técnicas específicas, es importante entender qué es la depuración y por qué es crucial.</p>
<ul>
<li><strong>Depuración</strong>: El proceso de identificar, analizar y eliminar errores (bugs) de tu código.</li>
<li><strong>Tipos de Errores</strong>:
<ul>
<li><strong>Errores de Sintaxis</strong>: Errores en el código que impiden que se ejecute.</li>
<li><strong>Errores de Ejecución</strong>: Errores que ocurren mientras el código se está ejecutando.</li>
<li><strong>Errores Lógicos</strong>: Errores en la lógica que producen resultados incorrectos.</li>
</ul>
</li>
</ul>
</div><h1>Técnicas Básicas de Depuración</h1>
<div class='content'></div><h2>Uso de la Ventana Inmediata</h2>
<div class='content'><p>La Ventana Inmediata es una herramienta poderosa para probar y depurar tu código.</p>
<ul>
<li>
<p><strong>Imprimir Valores</strong>: Puedes imprimir valores de variables en la Ventana Inmediata para verificar su estado.</p>
<pre><code class="language-vba">Debug.Print &quot;¡Hola, Mundo!&quot;
Debug.Print miVariable
</code></pre>
</li>
<li>
<p><strong>Ejecutar Código</strong>: Puedes ejecutar sentencias VBA directamente en la Ventana Inmediata.</p>
<pre><code class="language-vba">? 1 + 1
</code></pre>
</li>
</ul>
</div><h2>Puntos de Interrupción</h2>
<div class='content'><p>Los puntos de interrupción te permiten pausar la ejecución de tu código en puntos específicos.</p>
<ul>
<li><strong>Establecer Puntos de Interrupción</strong>: Haz clic en el margen junto a la línea de código donde deseas establecer un punto de interrupción.</li>
<li><strong>Eliminar Puntos de Interrupción</strong>: Haz clic nuevamente en el punto de interrupción o usa el menú Depurar.</li>
</ul>
</div><h2>Paso a Paso en el Código</h2>
<div class='content'><p>El paso a paso en tu código te ayuda a entender su flujo e identificar dónde falla.</p>
<ul>
<li><strong>Paso a Paso (F8)</strong>: Ejecuta el código línea por línea.</li>
<li><strong>Paso Sobre (Shift + F8)</strong>: Ejecuta la línea actual y pasa a la siguiente, omitiendo llamadas a funciones.</li>
<li><strong>Paso Fuera (Ctrl + Shift + F8)</strong>: Ejecuta el resto del procedimiento actual y pausa en la siguiente línea del procedimiento que lo llamó.</li>
</ul>
</div><h1>Técnicas Intermedias de Depuración</h1>
<div class='content'></div><h2>Ventana de Inspección</h2>
<div class='content'><p>La Ventana de Inspección te permite monitorear los valores de variables y expresiones mientras tu código se ejecuta.</p>
<ul>
<li><strong>Agregar Inspecciones</strong>: Haz clic derecho en una variable o expresión y selecciona &quot;Agregar Inspección&quot;.</li>
<li><strong>Tipos de Inspecciones</strong>:
<ul>
<li><strong>Expresión de Inspección</strong>: Monitorea el valor de una variable o expresión.</li>
<li><strong>Interrumpir Cuando Cambie el Valor</strong>: Pausa la ejecución cuando el valor cambia.</li>
<li><strong>Interrumpir Cuando Sea Verdadero</strong>: Pausa la ejecución cuando la expresión se evalúa como Verdadera.</li>
</ul>
</li>
</ul>
</div><h2>Manejo de Errores</h2>
<div class='content'><p>El manejo adecuado de errores puede hacer tu código más robusto y fácil de depurar.</p>
<ul>
<li>
<p><strong>Instrucción On Error</strong>: Dirige el flujo del programa cuando ocurre un error.</p>
<pre><code class="language-vba">On Error Resume Next
' Código que podría causar un error
If Err.Number &lt;&gt; 0 Then
    Debug.Print &quot;Error: &quot; &amp; Err.Description
End If
On Error GoTo 0
</code></pre>
</li>
<li>
<p><strong>On Error GoTo</strong>: Redirige a una rutina de manejo de errores.</p>
<pre><code class="language-vba">On Error GoTo ManejadorDeErrores
' Código que podría causar un error
Exit Sub
ManejadorDeErrores:
    Debug.Print &quot;Error: &quot; &amp; Err.Description
End Sub
</code></pre>
</li>
</ul>
</div><h1>Técnicas Avanzadas de Depuración</h1>
<div class='content'></div><h2>Manejo de Errores Personalizado</h2>
<div class='content'><p>Crear rutinas de manejo de errores personalizadas puede ayudarte a gestionar proyectos complejos.</p>
<ul>
<li><strong>Manejo Centralizado de Errores</strong>: Usa un manejador de errores centralizado para gestionar errores en múltiples procedimientos.
<pre><code class="language-vba">Sub ProcedimientoPrincipal()
    On Error GoTo ManejadorDeErrores
    ' Código principal
    Exit Sub
ManejadorDeErrores:
    Call ManejarError(Err.Number, Err.Description)
End Sub

Sub ManejarError(ByVal NumErr As Long, ByVal DescErr As String)
    Debug.Print &quot;Número de Error: &quot; &amp; NumErr &amp; &quot; - &quot; &amp; DescErr
    ' Código adicional de manejo de errores
End Sub
</code></pre>
</li>
</ul>
</div><h2>Depuración de Proyectos Complejos</h2>
<div class='content'><p>Para proyectos más grandes, considera usar herramientas y técnicas de depuración más avanzadas.</p>
<ul>
<li>
<p><strong>Registro de Logs</strong>: Crea registros para rastrear el flujo y estado de tu aplicación.</p>
<pre><code class="language-vba">Sub RegistrarMensaje(ByVal Mensaje As String)
    Dim ArchivoLog As String
    ArchivoLog = &quot;C:\ruta\a\archivoLog.txt&quot;
    Open ArchivoLog For Append As #1
    Print #1, Now &amp; &quot; - &quot; &amp; Mensaje
    Close #1
End Sub
</code></pre>
</li>
<li>
<p><strong>Pruebas Unitarias</strong>: Implementa pruebas unitarias para validar la funcionalidad de componentes individuales.</p>
<pre><code class="language-vba">Sub ProbarFunción()
    Dim resultado As Boolean
    resultado = MiFunción(5)
    Debug.Assert resultado = True
End Sub
</code></pre>
</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>La depuración es una habilidad crítica para cualquier programador de VBA. Al dominar estas técnicas, puedes identificar y resolver errores en tu código de manera eficiente. Comienza con técnicas básicas como el uso de la Ventana Inmediata y la configuración de puntos de interrupción, luego avanza a métodos más avanzados como el manejo de errores personalizado y el registro de logs. Con práctica, te volverás competente en la depuración y en el mantenimiento de código VBA de alta calidad.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='optimizing-vba-code'>&#x25C4;Optimizando el Código VBA</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Técnicas de Depuración</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-the-immediate-window'>Usando la Ventana Inmediata &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
