<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manejo de Errores en VBA</title>

    <link rel="alternate" href="https://campusempresa.com/mod/vba/error-handling" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/vba/error-handling" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/vba/error-handling" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/vba/error-handling" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/vba/error-handling" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='scope-and-lifetime-of-variables'>&#x25C4;Ámbito y Duración de las Variables</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Manejo de Errores en VBA</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-user-forms'>Introducción a los Formularios de Usuario &#x25BA;</a>
			</div>
</div>
<div class='content'><p>El manejo de errores es un aspecto crucial de la programación que asegura que tu código pueda manejar situaciones inesperadas de manera elegante. En VBA, el manejo de errores te permite gestionar errores en tiempo de ejecución de manera efectiva, proporcionando una mejor experiencia de usuario y haciendo tu código más robusto.</p>
</div><h1>Introducción al Manejo de Errores</h1>
<div class='content'><ul>
<li><strong>Definición</strong>: El manejo de errores es el proceso de anticipar, detectar y resolver errores de programación.</li>
<li><strong>Importancia</strong>: Ayuda en la depuración, mejora la experiencia del usuario y asegura que el programa funcione sin problemas incluso cuando surgen problemas inesperados.</li>
</ul>
</div><h1>Técnicas Básicas de Manejo de Errores</h1>
<div class='content'></div><h2>Instrucción On Error</h2>
<div class='content'><p>La instrucción <code>On Error</code> es la base del manejo de errores en VBA. Dirige al programa sobre qué hacer cuando ocurre un error.</p>
<ul>
<li>
<p><strong>Sintaxis</strong>:</p>
<pre><code class="language-vba">On Error GoTo [label]
On Error Resume Next
On Error GoTo 0
</code></pre>
</li>
<li>
<p><strong>Explicación</strong>:</p>
<ul>
<li><code>On Error GoTo [label]</code>: Transfiere el control a una etiqueta de línea especificada cuando ocurre un error.</li>
<li><code>On Error Resume Next</code>: Continúa la ejecución con la instrucción inmediatamente posterior a la que causó el error.</li>
<li><code>On Error GoTo 0</code>: Desactiva cualquier manejador de errores habilitado en el procedimiento actual.</li>
</ul>
</li>
</ul>
</div><h2>Ejemplo: Manejo Básico de Errores</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEJhc2ljRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgoKICAgIERpbSB4IEFzIEludGVnZXIKICAgIHggPSAxIC8gMCAgJyBFc3RvIGNhdXNhcsOhIHVuIGVycm9yIGRlIGRpdmlzacOzbiBwb3IgY2VybwoKICAgIEV4aXQgU3ViCgpFcnJvckhhbmRsZXI6CiAgICBNc2dCb3ggIk9jdXJyacOzIHVuIGVycm9yOiAiICYgRXJyLkRlc2NyaXB0aW9uCkVuZCBTdWI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub BasicErrorHandling()
    On Error GoTo ErrorHandler

    Dim x As Integer
    x = 1 / 0  ' Esto causar&aacute; un error de divisi&oacute;n por cero

    Exit Sub

ErrorHandler:
    MsgBox &quot;Ocurri&oacute; un error: &quot; &amp; Err.Description
End Sub</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li>La instrucción <code>On Error GoTo ErrorHandler</code> le dice a VBA que salte a la etiqueta <code>ErrorHandler</code> si ocurre un error.</li>
<li>La función <code>MsgBox</code> muestra un cuadro de mensaje con la descripción del error.</li>
</ul>
</li>
</ul>
</div><h1>Técnicas Avanzadas de Manejo de Errores</h1>
<div class='content'></div><h2>Objeto Err</h2>
<div class='content'><p>El objeto <code>Err</code> proporciona información detallada sobre los errores en tiempo de ejecución.</p>
<ul>
<li><strong>Propiedades</strong>:
<ul>
<li><code>Number</code>: El número del error.</li>
<li><code>Description</code>: Una descripción del error.</li>
<li><code>Source</code>: El nombre del objeto o aplicación que generó el error.</li>
<li><code>HelpFile</code>: La ruta al archivo de ayuda asociado con el error.</li>
<li><code>HelpContext</code>: El ID de contexto para un tema en el archivo de ayuda.</li>
</ul>
</li>
</ul>
</div><h2>Ejemplo: Usando el Objeto Err</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEFkdmFuY2VkRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgoKICAgIERpbSB4IEFzIEludGVnZXIKICAgIHggPSAxIC8gMCAgJyBFc3RvIGNhdXNhcsOhIHVuIGVycm9yIGRlIGRpdmlzacOzbiBwb3IgY2VybwoKICAgIEV4aXQgU3ViCgpFcnJvckhhbmRsZXI6CiAgICBNc2dCb3ggIk7Dum1lcm8gZGUgRXJyb3I6ICIgJiBFcnIuTnVtYmVyICYgdmJDckxmICYgXwogICAgICAgICAgICJEZXNjcmlwY2nDs246ICIgJiBFcnIuRGVzY3JpcHRpb24gJiB2YkNyTGYgJiBfCiAgICAgICAgICAgIkZ1ZW50ZTogIiAmIEVyci5Tb3VyY2UKRW5kIFN1Yg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub AdvancedErrorHandling()
    On Error GoTo ErrorHandler

    Dim x As Integer
    x = 1 / 0  ' Esto causar&aacute; un error de divisi&oacute;n por cero

    Exit Sub

ErrorHandler:
    MsgBox &quot;N&uacute;mero de Error: &quot; &amp; Err.Number &amp; vbCrLf &amp; _
           &quot;Descripci&oacute;n: &quot; &amp; Err.Description &amp; vbCrLf &amp; _
           &quot;Fuente: &quot; &amp; Err.Source
End Sub</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li>El objeto <code>Err</code> se utiliza para recuperar y mostrar información detallada sobre el error.</li>
</ul>
</li>
</ul>
</div><h2>Manejo de Errores Personalizado</h2>
<div class='content'><p>Puedes crear mensajes de error personalizados y manejar errores específicos de manera diferente.</p>
<ul>
<li><strong>Ejemplo</strong>:</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEN1c3RvbUVycm9ySGFuZGxpbmcoKQogICAgT24gRXJyb3IgR29UbyBFcnJvckhhbmRsZXIKCiAgICBEaW0geCBBcyBJbnRlZ2VyCiAgICB4ID0gMSAvIDAgICcgRXN0byBjYXVzYXLDoSB1biBlcnJvciBkZSBkaXZpc2nDs24gcG9yIGNlcm8KCiAgICBFeGl0IFN1YgoKRXJyb3JIYW5kbGVyOgogICAgU2VsZWN0IENhc2UgRXJyLk51bWJlcgogICAgICAgIENhc2UgMTEgICcgRGl2aXNpw7NuIHBvciBjZXJvCiAgICAgICAgICAgIE1zZ0JveCAiTm8gc2UgcHVlZGUgZGl2aWRpciBwb3IgY2Vyby4gUG9yIGZhdm9yLCB2ZXJpZmljYSB0dXMgZW50cmFkYXMuIgogICAgICAgIENhc2UgRWxzZQogICAgICAgICAgICBNc2dCb3ggIk9jdXJyacOzIHVuIGVycm9yIGluZXNwZXJhZG86ICIgJiBFcnIuRGVzY3JpcHRpb24KICAgIEVuZCBTZWxlY3QKRW5kIFN1Yg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub CustomErrorHandling()
    On Error GoTo ErrorHandler

    Dim x As Integer
    x = 1 / 0  ' Esto causar&aacute; un error de divisi&oacute;n por cero

    Exit Sub

ErrorHandler:
    Select Case Err.Number
        Case 11  ' Divisi&oacute;n por cero
            MsgBox &quot;No se puede dividir por cero. Por favor, verifica tus entradas.&quot;
        Case Else
            MsgBox &quot;Ocurri&oacute; un error inesperado: &quot; &amp; Err.Description
    End Select
End Sub</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li>La instrucción <code>Select Case</code> se utiliza para manejar errores específicos de manera diferente según el número del error.</li>
</ul>
</li>
</ul>
</div><h1>Mejores Prácticas para el Manejo de Errores</h1>
<div class='content'><ul>
<li><strong>Usa Siempre el Manejo de Errores</strong>: Asegúrate de que cada procedimiento tenga alguna forma de manejo de errores.</li>
<li><strong>Limpia los Manejadores de Errores</strong>: Usa <code>On Error GoTo 0</code> para limpiar los manejadores de errores cuando ya no sean necesarios.</li>
<li><strong>Proporciona Mensajes Útiles</strong>: Muestra mensajes de error significativos para ayudar a los usuarios a entender y resolver problemas.</li>
<li><strong>Registra Errores</strong>: Considera registrar errores en un archivo o base de datos para un análisis posterior.</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>El manejo de errores en VBA es esencial para crear aplicaciones robustas y fáciles de usar. Usando la instrucción <code>On Error</code>, el objeto <code>Err</code> y técnicas de manejo de errores personalizadas, puedes gestionar errores en tiempo de ejecución de manera efectiva. Sigue siempre las mejores prácticas para asegurar que tu manejo de errores sea eficiente e informativo.</p>
<p>Al dominar el manejo de errores, puedes mejorar significativamente la fiabilidad y mantenibilidad de tu código VBA.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='scope-and-lifetime-of-variables'>&#x25C4;Ámbito y Duración de las Variables</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Manejo de Errores en VBA</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-user-forms'>Introducción a los Formularios de Usuario &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
