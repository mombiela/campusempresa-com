<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perfiles de PowerShell</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/07-01-powershell-profiles" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/07-01-powershell-profiles" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/07-01-powershell-profiles" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 px-0 py-2 py-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 px-0 py-2 py-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/powershell/07-01-powershell-profiles" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/powershell/07-01-powershell-profiles" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-05-security-considerations' title="Consideraciones de Seguridad">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Perfiles de PowerShell</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-02-customizing-environment' title="Personalización del Entorno de PowerShell">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Los perfiles de PowerShell son archivos de script que se ejecutan automáticamente cada vez que se inicia una nueva sesión de PowerShell. Estos perfiles permiten personalizar el entorno de PowerShell, cargar módulos, definir funciones y alias, y establecer configuraciones específicas que se aplican a todas las sesiones.</p>
</div><h1>Tipos de Perfiles</h1>
<div class='content'><p>PowerShell admite varios tipos de perfiles, cada uno con un alcance diferente:</p>
<ol>
<li>
<p><strong>Perfil de la Consola de PowerShell para el Usuario Actual</strong>:</p>
<ul>
<li>Ubicación: <code>$HOME\Documents\WindowsPowerShell\Microsoft.PowerShell_profile.ps1</code></li>
<li>Se aplica solo a la consola de PowerShell y solo para el usuario actual.</li>
</ul>
</li>
<li>
<p><strong>Perfil de la Consola de PowerShell para Todos los Usuarios</strong>:</p>
<ul>
<li>Ubicación: <code>$PSHOME\Microsoft.PowerShell_profile.ps1</code></li>
<li>Se aplica a la consola de PowerShell para todos los usuarios del sistema.</li>
</ul>
</li>
<li>
<p><strong>Perfil de PowerShell ISE para el Usuario Actual</strong>:</p>
<ul>
<li>Ubicación: <code>$HOME\Documents\WindowsPowerShell\Microsoft.PowerShellISE_profile.ps1</code></li>
<li>Se aplica solo a PowerShell ISE y solo para el usuario actual.</li>
</ul>
</li>
<li>
<p><strong>Perfil de PowerShell ISE para Todos los Usuarios</strong>:</p>
<ul>
<li>Ubicación: <code>$PSHOME\Microsoft.PowerShellISE_profile.ps1</code></li>
<li>Se aplica a PowerShell ISE para todos los usuarios del sistema.</li>
</ul>
</li>
</ol>
</div><h1>Creación y Edición de Perfiles</h1>
<div class='content'><p>Para crear o editar un perfil, puedes utilizar el siguiente comando en PowerShell:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBWZXJpZmljYXIgc2kgZWwgcGVyZmlsIGV4aXN0ZQppZiAoIShUZXN0LVBhdGggLVBhdGggJFBST0ZJTEUpKSB7CiAgICAjIENyZWFyIGVsIGFyY2hpdm8gZGUgcGVyZmlsIHNpIG5vIGV4aXN0ZQogICAgTmV3LUl0ZW0gLVR5cGUgRmlsZSAtUGF0aCAkUFJPRklMRSAtRm9yY2UKfQoKIyBBYnJpciBlbCBwZXJmaWwgZW4gZWwgZWRpdG9yIHByZWRldGVybWluYWRvCm5vdGVwYWQgJFBST0ZJTEU="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Verificar si el perfil existe
if (!(Test-Path -Path $PROFILE)) {
    # Crear el archivo de perfil si no existe
    New-Item -Type File -Path $PROFILE -Force
}

# Abrir el perfil en el editor predeterminado
notepad $PROFILE</pre></div><div class='content'><p>Este comando verifica si el perfil del usuario actual para la consola de PowerShell existe y, si no es así, lo crea. Luego, abre el perfil en el Bloc de notas para su edición.</p>
</div><h1>Personalización del Perfil</h1>
<div class='content'><p>Puedes agregar varias personalizaciones a tu perfil de PowerShell. Aquí hay algunos ejemplos comunes:</p>
</div><h2>Cargar Módulos Automáticamente</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgZWwgbcOzZHVsbyBkZSBBY3RpdmUgRGlyZWN0b3J5IGF1dG9tw6F0aWNhbWVudGUKSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3Rvcnk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar el m&oacute;dulo de Active Directory autom&aacute;ticamente
Import-Module ActiveDirectory</pre></div><div class='content'></div><h2>Definir Alias</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciB1biBhbGlhcyBwYXJhIHVuIGNvbWFuZG8gbGFyZ28KU2V0LUFsaWFzIGxsIEdldC1DaGlsZEl0ZW0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear un alias para un comando largo
Set-Alias ll Get-ChildItem</pre></div><div class='content'></div><h2>Definir Funciones</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZWZpbmlyIHVuYSBmdW5jacOzbiBwZXJzb25hbGl6YWRhCmZ1bmN0aW9uIFNob3ctRGF0ZSB7CiAgICBHZXQtRGF0ZSAtRm9ybWF0ICJkZGRkLCBNTU1NIGRkLCB5eXl5IEhIOm1tOnNzIgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Definir una funci&oacute;n personalizada
function Show-Date {
    Get-Date -Format &quot;dddd, MMMM dd, yyyy HH:mm:ss&quot;
}</pre></div><div class='content'></div><h2>Configurar el Prompt</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQZXJzb25hbGl6YXIgZWwgcHJvbXB0IGRlIFBvd2VyU2hlbGwKZnVuY3Rpb24gcHJvbXB0IHsKICAgICJQUyAkKEdldC1Mb2NhdGlvbik+ICIKfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Personalizar el prompt de PowerShell
function prompt {
    &quot;PS $(Get-Location)&gt; &quot;
}</pre></div><div class='content'></div><h1>Ejemplo Completo de un Perfil</h1>
<div class='content'><p>A continuación, se muestra un ejemplo completo de un perfil de PowerShell que incluye varias personalizaciones:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgbcOzZHVsb3MKSW1wb3J0LU1vZHVsZSBBY3RpdmVEaXJlY3RvcnkKSW1wb3J0LU1vZHVsZSBBegoKIyBEZWZpbmlyIGFsaWFzClNldC1BbGlhcyBsbCBHZXQtQ2hpbGRJdGVtClNldC1BbGlhcyBnY2kgR2V0LUNoaWxkSXRlbQoKIyBEZWZpbmlyIGZ1bmNpb25lcwpmdW5jdGlvbiBTaG93LURhdGUgewogICAgR2V0LURhdGUgLUZvcm1hdCAiZGRkZCwgTU1NTSBkZCwgeXl5eSBISDptbTpzcyIKfQoKZnVuY3Rpb24gR2V0LVByb2Nlc3NJbmZvIHsKICAgIHBhcmFtICgKICAgICAgICBbc3RyaW5nXSRQcm9jZXNzTmFtZQogICAgKQogICAgR2V0LVByb2Nlc3MgLU5hbWUgJFByb2Nlc3NOYW1lIHwgU2VsZWN0LU9iamVjdCBOYW1lLCBJZCwgQ1BVLCBTdGFydFRpbWUKfQoKIyBDb25maWd1cmFyIGVsIHByb21wdApmdW5jdGlvbiBwcm9tcHQgewogICAgIlBTICQoR2V0LUxvY2F0aW9uKT4gIgp9CgojIE1vc3RyYXIgdW4gbWVuc2FqZSBkZSBiaWVudmVuaWRhCldyaXRlLUhvc3QgIldlbGNvbWUgdG8gUG93ZXJTaGVsbCwgJChHZXQtVXNlck5hbWUpISIgLUZvcmVncm91bmRDb2xvciBHcmVlbg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar m&oacute;dulos
Import-Module ActiveDirectory
Import-Module Az

# Definir alias
Set-Alias ll Get-ChildItem
Set-Alias gci Get-ChildItem

# Definir funciones
function Show-Date {
    Get-Date -Format &quot;dddd, MMMM dd, yyyy HH:mm:ss&quot;
}

function Get-ProcessInfo {
    param (
        [string]$ProcessName
    )
    Get-Process -Name $ProcessName | Select-Object Name, Id, CPU, StartTime
}

# Configurar el prompt
function prompt {
    &quot;PS $(Get-Location)&gt; &quot;
}

# Mostrar un mensaje de bienvenida
Write-Host &quot;Welcome to PowerShell, $(Get-UserName)!&quot; -ForegroundColor Green</pre></div><div class='content'></div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio 1: Crear y Personalizar un Perfil</h2>
<div class='content'><ol>
<li>
<p><strong>Crear el Perfil</strong>:</p>
<ul>
<li>Usa el comando proporcionado anteriormente para crear y abrir tu perfil de PowerShell.</li>
</ul>
</li>
<li>
<p><strong>Agregar Personalizaciones</strong>:</p>
<ul>
<li>Añade las siguientes personalizaciones a tu perfil:
<ul>
<li>Carga automática del módulo <code>Az</code>.</li>
<li>Definición de un alias <code>ls</code> para <code>Get-ChildItem</code>.</li>
<li>Definición de una función <code>Get-Weather</code> que muestra un mensaje ficticio del clima.</li>
<li>Personalización del prompt para que muestre la hora actual.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Guardar y Probar</strong>:</p>
<ul>
<li>Guarda el archivo de perfil y abre una nueva sesión de PowerShell para verificar que las personalizaciones se aplican correctamente.</li>
</ul>
</li>
</ol>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgbcOzZHVsb3MKSW1wb3J0LU1vZHVsZSBBegoKIyBEZWZpbmlyIGFsaWFzClNldC1BbGlhcyBscyBHZXQtQ2hpbGRJdGVtCgojIERlZmluaXIgZnVuY2lvbmVzCmZ1bmN0aW9uIEdldC1XZWF0aGVyIHsKICAgIFdyaXRlLUhvc3QgIlRoZSB3ZWF0aGVyIHRvZGF5IGlzIHN1bm55IHdpdGggYSBjaGFuY2Ugb2YgY29kZSEiCn0KCiMgQ29uZmlndXJhciBlbCBwcm9tcHQKZnVuY3Rpb24gcHJvbXB0IHsKICAgICIkKEdldC1EYXRlIC1Gb3JtYXQgIkhIOm1tOnNzIikgUFMgJChHZXQtTG9jYXRpb24pPiAiCn0KCiMgTW9zdHJhciB1biBtZW5zYWplIGRlIGJpZW52ZW5pZGEKV3JpdGUtSG9zdCAiV2VsY29tZSB0byB5b3VyIGN1c3RvbWl6ZWQgUG93ZXJTaGVsbCBlbnZpcm9ubWVudCEiIC1Gb3JlZ3JvdW5kQ29sb3IgR3JlZW4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar m&oacute;dulos
Import-Module Az

# Definir alias
Set-Alias ls Get-ChildItem

# Definir funciones
function Get-Weather {
    Write-Host &quot;The weather today is sunny with a chance of code!&quot;
}

# Configurar el prompt
function prompt {
    &quot;$(Get-Date -Format &quot;HH:mm:ss&quot;) PS $(Get-Location)&gt; &quot;
}

# Mostrar un mensaje de bienvenida
Write-Host &quot;Welcome to your customized PowerShell environment!&quot; -ForegroundColor Green</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Los perfiles de PowerShell son una herramienta poderosa para personalizar y optimizar tu entorno de trabajo. Al aprender a crear y modificar perfiles, puedes automatizar tareas repetitivas, cargar módulos necesarios y definir configuraciones que mejoren tu productividad. En el próximo tema, exploraremos cómo personalizar aún más el entorno de PowerShell.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-05-security-considerations' title="Consideraciones de Seguridad">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-02-customizing-environment' title="Personalización del Entorno de PowerShell">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
