<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Configuración del Remoting</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/06-02-setting-up-remoting" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/06-02-setting-up-remoting" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/06-02-setting-up-remoting" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/powershell/06-02-setting-up-remoting" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/powershell/06-02-setting-up-remoting" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Construyendo la sociedad de hoy y del mañana</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Lenguajes</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Herramientas</a>
				 					<a href="/categ/foundations">Fundamentos</a>
				 					<a href="/categ/soft-skills">Competencias</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-01-introduction-remoting' title="Introducción al Remoting">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Configuración del Remoting</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-03-using-invoke-command' title="Uso de Invoke-Command">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En este tema, aprenderás cómo configurar PowerShell Remoting, una característica poderosa que permite ejecutar comandos y scripts en computadoras remotas. Esta capacidad es esencial para la administración de sistemas y la automatización de tareas en entornos de red.</p>
</div><h1><ol>
<li>Introducción a PowerShell Remoting</li>
</ol>
</h1>
<div class='content'><p>PowerShell Remoting permite a los administradores ejecutar comandos en una o más computadoras remotas. Utiliza el protocolo WS-Management para la comunicación y puede ser configurado para trabajar en diferentes entornos de red.</p>
</div><h2><p>Conceptos Clave:</p>
</h2>
<div class='content'><ul>
<li><strong>WS-Management (WSMan):</strong> Protocolo utilizado por PowerShell Remoting para la comunicación.</li>
<li><strong>WinRM (Windows Remote Management):</strong> Servicio que implementa WS-Management en Windows.</li>
<li><strong>Sesión Remota:</strong> Conexión establecida entre la máquina local y la remota para ejecutar comandos.</li>
</ul>
</div><h1><ol start="2">
<li>Habilitar PowerShell Remoting</li>
</ol>
</h1>
<div class='content'><p>Para habilitar PowerShell Remoting en una máquina, se utiliza el cmdlet <code>Enable-PSRemoting</code>. Este cmdlet configura el servicio WinRM y ajusta las reglas del firewall para permitir la comunicación remota.</p>
</div><h2><p>Pasos para Habilitar Remoting:</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Abrir PowerShell como Administrador:</strong></p>
<ul>
<li>En el menú de inicio, busca &quot;PowerShell&quot;.</li>
<li>Haz clic derecho en &quot;Windows PowerShell&quot; y selecciona &quot;Ejecutar como administrador&quot;.</li>
</ul>
</li>
<li>
<p><strong>Ejecutar el Cmdlet <code>Enable-PSRemoting</code>:</strong></p>
<pre><code class="language-powershell">Enable-PSRemoting -Force
</code></pre>
<ul>
<li>El parámetro <code>-Force</code> omite las confirmaciones y realiza todas las configuraciones necesarias automáticamente.</li>
</ul>
</li>
</ol>
</div><h2><p>Explicación del Cmdlet:</p>
</h2>
<div class='content'><ul>
<li><code>Enable-PSRemoting</code>: Habilita PowerShell Remoting en la máquina local.</li>
<li><code>-Force</code>: Omite las confirmaciones y realiza todas las configuraciones necesarias automáticamente.</li>
</ul>
</div><h1><ol start="3">
<li>Configuración del Servicio WinRM</li>
</ol>
</h1>
<div class='content'><p>El servicio WinRM debe estar en ejecución para que PowerShell Remoting funcione correctamente. Puedes verificar y configurar el estado del servicio WinRM con los siguientes comandos:</p>
</div><h2><p>Verificar el Estado del Servicio WinRM:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LVNlcnZpY2UgLU5hbWUgV2luUk0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-Service -Name WinRM</pre></div><div class='content'></div><h2><p>Iniciar el Servicio WinRM (si no está en ejecución):</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3RhcnQtU2VydmljZSAtTmFtZSBXaW5STQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Start-Service -Name WinRM</pre></div><div class='content'></div><h2><p>Configurar el Servicio WinRM para Iniciar Automáticamente:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LVNlcnZpY2UgLU5hbWUgV2luUk0gLVN0YXJ0dXBUeXBlIEF1dG9tYXRpYw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-Service -Name WinRM -StartupType Automatic</pre></div><div class='content'></div><h1><ol start="4">
<li>Configuración del Firewall</li>
</ol>
</h1>
<div class='content'><p>PowerShell Remoting requiere que ciertas reglas del firewall estén habilitadas para permitir la comunicación remota. El cmdlet <code>Enable-PSRemoting</code> configura automáticamente estas reglas, pero puedes verificar y ajustar las reglas manualmente si es necesario.</p>
</div><h2><p>Verificar las Reglas del Firewall:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("R2V0LU5ldEZpcmV3YWxsUnVsZSAtRGlzcGxheUdyb3VwICJXaW5kb3dzIFJlbW90ZSBNYW5hZ2VtZW50Ig=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Get-NetFirewallRule -DisplayGroup &quot;Windows Remote Management&quot;</pre></div><div class='content'></div><h2><p>Habilitar las Reglas del Firewall (si es necesario):</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RW5hYmxlLU5ldEZpcmV3YWxsUnVsZSAtRGlzcGxheUdyb3VwICJXaW5kb3dzIFJlbW90ZSBNYW5hZ2VtZW50Ig=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Enable-NetFirewallRule -DisplayGroup &quot;Windows Remote Management&quot;</pre></div><div class='content'></div><h1><ol start="5">
<li>Configuración de TrustedHosts</li>
</ol>
</h1>
<div class='content'><p>En entornos donde no se utiliza un dominio, es posible que necesites configurar la lista de <code>TrustedHosts</code> para permitir la comunicación con máquinas específicas.</p>
</div><h2><p>Agregar una Máquina a TrustedHosts:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LUl0ZW0gV1NNYW46XGxvY2FsaG9zdFxDbGllbnRcVHJ1c3RlZEhvc3RzIC1WYWx1ZSAiTm9tYnJlRGVMYU3DoXF1aW5hIg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-Item WSMan:\localhost\Client\TrustedHosts -Value &quot;NombreDeLaM&aacute;quina&quot;</pre></div><div class='content'></div><h2><p>Permitir Todas las Máquinas (no recomendado por razones de seguridad):</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LUl0ZW0gV1NNYW46XGxvY2FsaG9zdFxDbGllbnRcVHJ1c3RlZEhvc3RzIC1WYWx1ZSAiKiI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-Item WSMan:\localhost\Client\TrustedHosts -Value &quot;*&quot;</pre></div><div class='content'></div><h1><ol start="6">
<li>Prueba de Conexión Remota</li>
</ol>
</h1>
<div class='content'><p>Una vez configurado PowerShell Remoting, puedes probar la conexión a una máquina remota utilizando el cmdlet <code>Test-WSMan</code>.</p>
</div><h2><p>Probar la Conexión a una Máquina Remota:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VGVzdC1XU01hbiAtQ29tcHV0ZXJOYW1lIE5vbWJyZURlTGFNw6FxdWluYQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Test-WSMan -ComputerName NombreDeLaM&aacute;quina</pre></div><div class='content'></div><h2><p>Ejemplo de Conexión Remota:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VGVzdC1XU01hbiAtQ29tcHV0ZXJOYW1lIFNlcnZlcjAx"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Test-WSMan -ComputerName Server01</pre></div><div class='content'></div><h1><ol start="7">
<li>Ejecución de Comandos Remotos</li>
</ol>
</h1>
<div class='content'><p>Con PowerShell Remoting habilitado y configurado, puedes ejecutar comandos en máquinas remotas utilizando el cmdlet <code>Invoke-Command</code>.</p>
</div><h2><p>Ejemplo de Ejecución de Comando Remoto:</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSBTZXJ2ZXIwMSAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName Server01 -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2><p>Explicación del Cmdlet:</p>
</h2>
<div class='content'><ul>
<li><code>Invoke-Command</code>: Ejecuta comandos en una o más computadoras remotas.</li>
<li><code>-ComputerName</code>: Especifica el nombre de la computadora remota.</li>
<li><code>-ScriptBlock</code>: Define el bloque de script que se ejecutará en la computadora remota.</li>
</ul>
</div><h1><ol start="8">
<li>Ejercicio Práctico</li>
</ol>
</h1>
<div class='content'></div><h2><p>Ejercicio:</p>
</h2>
<div class='content'><ol>
<li>Habilita PowerShell Remoting en tu máquina local.</li>
<li>Configura el servicio WinRM para que inicie automáticamente.</li>
<li>Verifica y habilita las reglas del firewall necesarias.</li>
<li>Agrega una máquina remota a la lista de <code>TrustedHosts</code>.</li>
<li>Prueba la conexión a la máquina remota.</li>
<li>Ejecuta un comando simple en la máquina remota utilizando <code>Invoke-Command</code>.</li>
</ol>
</div><h2><p>Solución:</p>
</h2>
<div class='content'><ol>
<li>
<p>Habilitar PowerShell Remoting:</p>
<pre><code class="language-powershell">Enable-PSRemoting -Force
</code></pre>
</li>
<li>
<p>Configurar el servicio WinRM:</p>
<pre><code class="language-powershell">Set-Service -Name WinRM -StartupType Automatic
Start-Service -Name WinRM
</code></pre>
</li>
<li>
<p>Verificar y habilitar las reglas del firewall:</p>
<pre><code class="language-powershell">Get-NetFirewallRule -DisplayGroup &quot;Windows Remote Management&quot;
Enable-NetFirewallRule -DisplayGroup &quot;Windows Remote Management&quot;
</code></pre>
</li>
<li>
<p>Agregar una máquina remota a TrustedHosts:</p>
<pre><code class="language-powershell">Set-Item WSMan:\localhost\Client\TrustedHosts -Value &quot;Server01&quot;
</code></pre>
</li>
<li>
<p>Probar la conexión a la máquina remota:</p>
<pre><code class="language-powershell">Test-WSMan -ComputerName Server01
</code></pre>
</li>
<li>
<p>Ejecutar un comando en la máquina remota:</p>
<pre><code class="language-powershell">Invoke-Command -ComputerName Server01 -ScriptBlock { Get-Process }
</code></pre>
</li>
</ol>
</div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, has aprendido cómo configurar PowerShell Remoting, una herramienta esencial para la administración remota de sistemas. Has visto cómo habilitar remoting, configurar el servicio WinRM, ajustar las reglas del firewall y probar la conexión remota. Además, has practicado la ejecución de comandos en máquinas remotas. Con estos conocimientos, estás preparado para administrar sistemas de manera más eficiente y automatizar tareas en entornos de red.</p>
<p>En el próximo tema, exploraremos el uso de <code>Invoke-Command</code> en mayor detalle, incluyendo cómo gestionar sesiones remotas y ejecutar scripts complejos en múltiples máquinas.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-01-introduction-remoting' title="Introducción al Remoting">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-03-using-invoke-command' title="Uso de Invoke-Command">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicidad</h1>
<p>Este espacio está destinado a publicidad.</p>
<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>¡Gracias por colaborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
