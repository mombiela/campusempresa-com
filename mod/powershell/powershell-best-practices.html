<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mejores Prácticas de PowerShell</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/powershell-best-practices" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/powershell-best-practices" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/powershell-best-practices" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/powershell/powershell-best-practices" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/powershell/powershell-best-practices" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='infrastructure-as-code-with-powershell'>&#x25C4;Infraestructura como Código con PowerShell</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Mejores Prácticas de PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-efficient-powershell-code'>Escribiendo Código Eficiente en PowerShell &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>PowerShell es un potente lenguaje de scripting y shell de línea de comandos diseñado para la automatización de tareas y la gestión de configuraciones. Para aprovechar al máximo PowerShell, es esencial seguir las mejores prácticas que aseguren que tus scripts sean eficientes, mantenibles y seguros. Esta sección cubrirá las mejores prácticas para escribir scripts de PowerShell, desde niveles principiantes hasta avanzados.</p>
</div><h1>Mejores Prácticas Generales</h1>
<div class='content'><ul>
<li><strong>Usa Nombres Descriptivos</strong>: Siempre usa nombres descriptivos para variables, funciones y scripts para hacer tu código más legible.</li>
<li><strong>Comenta Tu Código</strong>: Usa comentarios para explicar el propósito de tu código, especialmente la lógica compleja.</li>
<li><strong>Formato Consistente</strong>: Sigue un estilo consistente para la indentación, el espaciado y las llaves para mejorar la legibilidad.</li>
<li><strong>Manejo de Errores</strong>: Implementa un manejo de errores adecuado para hacer tus scripts robustos y fáciles de usar.</li>
</ul>
</div><h2>Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFc3RhIGZ1bmNpw7NuIGNhbGN1bGEgZWwgZmFjdG9yaWFsIGRlIHVuIG7Dum1lcm8KZnVuY3Rpb24gR2V0LUZhY3RvcmlhbCB7CiAgICBwYXJhbSAoCiAgICAgICAgW2ludF0kTnVtYmVyCiAgICApCiAgICAKICAgIGlmICgkTnVtYmVyIC1sdCAwKSB7CiAgICAgICAgdGhyb3cgIkVsIG7Dum1lcm8gZGViZSBzZXIgbm8gbmVnYXRpdm8iCiAgICB9CgogICAgJHJlc3VsdCA9IDEKICAgIGZvciAoJGkgPSAxOyAkaSAtbGUgJE51bWJlcjsgJGkrKykgewogICAgICAgICRyZXN1bHQgKj0gJGkKICAgIH0KCiAgICByZXR1cm4gJHJlc3VsdAp9Cgp0cnkgewogICAgJGZhY3RvcmlhbCA9IEdldC1GYWN0b3JpYWwgLU51bWJlciA1CiAgICBXcml0ZS1PdXRwdXQgIkZhY3RvcmlhbDogJGZhY3RvcmlhbCIKfSBjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAiT2N1cnJpw7MgdW4gZXJyb3I6ICRfIgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Esta funci&oacute;n calcula el factorial de un n&uacute;mero
function Get-Factorial {
    param (
        [int]$Number
    )
    
    if ($Number -lt 0) {
        throw &quot;El n&uacute;mero debe ser no negativo&quot;
    }

    $result = 1
    for ($i = 1; $i -le $Number; $i++) {
        $result *= $i
    }

    return $result
}

try {
    $factorial = Get-Factorial -Number 5
    Write-Output &quot;Factorial: $factorial&quot;
} catch {
    Write-Error &quot;Ocurri&oacute; un error: $_&quot;
}</pre></div><div class='content'></div><h1>Estructura del Script</h1>
<div class='content'><ul>
<li><strong>Diseño Modular</strong>: Divide tus scripts en funciones más pequeñas y reutilizables.</li>
<li><strong>Validación de Parámetros</strong>: Usa la validación de parámetros para asegurar que tus funciones reciban entradas válidas.</li>
<li><strong>Manejo de Salidas</strong>: Usa <code>Write-Output</code>, <code>Write-Error</code>, <code>Write-Verbose</code> y <code>Write-Debug</code> apropiadamente para manejar diferentes tipos de salida.</li>
</ul>
</div><h2>Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gR2V0LVNxdWFyZSB7CiAgICBwYXJhbSAoCiAgICAgICAgW1BhcmFtZXRlcihNYW5kYXRvcnk9JHRydWUpXQogICAgICAgIFtpbnRdJE51bWJlcgogICAgKQoKICAgIHJldHVybiAkTnVtYmVyICogJE51bWJlcgp9CgojIFNjcmlwdCBwcmluY2lwYWwKdHJ5IHsKICAgICRzcXVhcmUgPSBHZXQtU3F1YXJlIC1OdW1iZXIgNAogICAgV3JpdGUtT3V0cHV0ICJDdWFkcmFkbzogJHNxdWFyZSIKfSBjYXRjaCB7CiAgICBXcml0ZS1FcnJvciAiT2N1cnJpw7MgdW4gZXJyb3I6ICRfIgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function Get-Square {
    param (
        [Parameter(Mandatory=$true)]
        [int]$Number
    )

    return $Number * $Number
}

# Script principal
try {
    $square = Get-Square -Number 4
    Write-Output &quot;Cuadrado: $square&quot;
} catch {
    Write-Error &quot;Ocurri&oacute; un error: $_&quot;
}</pre></div><div class='content'></div><h1>Mejores Prácticas de Seguridad</h1>
<div class='content'><ul>
<li><strong>Evita Codificar Credenciales</strong>: Usa métodos seguros para manejar credenciales, como <code>Get-Credential</code>.</li>
<li><strong>Principio de Menor Privilegio</strong>: Ejecuta tus scripts con los menores privilegios necesarios.</li>
<li><strong>Firma de Código</strong>: Firma tus scripts para asegurar su integridad y autenticidad.</li>
</ul>
</div><h2>Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBTb2xpY2l0YXIgY3JlZGVuY2lhbGVzIGRlIGZvcm1hIHNlZ3VyYQokY3JlZGVudGlhbHMgPSBHZXQtQ3JlZGVudGlhbAoKIyBVc2EgbGFzIGNyZWRlbmNpYWxlcyBkZSBtYW5lcmEgc2VndXJhCkludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlNlcnZlcjAxIiAtQ3JlZGVudGlhbCAkY3JlZGVudGlhbHMgLVNjcmlwdEJsb2NrIHsKICAgICMgVHUgY8OzZGlnbyBhcXXDrQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Solicitar credenciales de forma segura
$credentials = Get-Credential

# Usa las credenciales de manera segura
Invoke-Command -ComputerName &quot;Server01&quot; -Credential $credentials -ScriptBlock {
    # Tu c&oacute;digo aqu&iacute;
}</pre></div><div class='content'></div><h1>Optimización del Rendimiento</h1>
<div class='content'><ul>
<li><strong>Usa Cmdlets en Lugar de Comandos Externos</strong>: Los cmdlets están optimizados para el rendimiento y deben ser preferidos sobre los comandos externos.</li>
<li><strong>Evita Bucles Innecesarios</strong>: Usa operaciones de pipeline y cmdlets integrados para manejar colecciones de manera eficiente.</li>
<li><strong>Mide el Rendimiento</strong>: Usa <code>Measure-Command</code> para medir el rendimiento de tus scripts.</li>
</ul>
</div><h2>Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBNZWRpciBlbCB0aWVtcG8gdG9tYWRvIHBhcmEgZWplY3V0YXIgdW4gY29tYW5kbwokdGltZSA9IE1lYXN1cmUtQ29tbWFuZCB7CiAgICBHZXQtUHJvY2Vzcwp9CldyaXRlLU91dHB1dCAiVGllbXBvIHRvbWFkbzogJCgkdGltZS5Ub3RhbFNlY29uZHMpIHNlZ3VuZG9zIg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Medir el tiempo tomado para ejecutar un comando
$time = Measure-Command {
    Get-Process
}
Write-Output &quot;Tiempo tomado: $($time.TotalSeconds) segundos&quot;</pre></div><div class='content'></div><h1>Técnicas Avanzadas</h1>
<div class='content'><ul>
<li><strong>Splatting</strong>: Usa splatting para pasar parámetros a funciones y cmdlets de una manera limpia y legible.</li>
<li><strong>Módulos Personalizados</strong>: Crea módulos personalizados para organizar y distribuir tus funciones.</li>
<li><strong>Funciones Avanzadas</strong>: Usa funciones avanzadas para aprovechar características como la vinculación de cmdlets y parámetros comunes.</li>
</ul>
</div><h2>Ejemplo</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFamVtcGxvIGRlIHNwbGF0dGluZwokcGFyYW1zID0gQHsKICAgIE5hbWUgPSAiTm90ZXBhZCIKICAgIENvbXB1dGVyTmFtZSA9ICJsb2NhbGhvc3QiCn0KR2V0LVByb2Nlc3MgQHBhcmFtcwoKIyBFamVtcGxvIGRlIGZ1bmNpw7NuIGF2YW56YWRhCmZ1bmN0aW9uIEdldC1BZHZhbmNlZEZhY3RvcmlhbCB7CiAgICBbQ21kbGV0QmluZGluZygpXQogICAgcGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5PSR0cnVlKV0KICAgICAgICBbaW50XSROdW1iZXIKICAgICkKCiAgICBpZiAoJE51bWJlciAtbHQgMCkgewogICAgICAgIHRocm93ICJFbCBuw7ptZXJvIGRlYmUgc2VyIG5vIG5lZ2F0aXZvIgogICAgfQoKICAgICRyZXN1bHQgPSAxCiAgICBmb3IgKCRpID0gMTsgJGkgLWxlICROdW1iZXI7ICRpKyspIHsKICAgICAgICAkcmVzdWx0ICo9ICRpCiAgICB9CgogICAgcmV0dXJuICRyZXN1bHQKfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Ejemplo de splatting
$params = @{
    Name = &quot;Notepad&quot;
    ComputerName = &quot;localhost&quot;
}
Get-Process @params

# Ejemplo de funci&oacute;n avanzada
function Get-AdvancedFactorial {
    [CmdletBinding()]
    param (
        [Parameter(Mandatory=$true)]
        [int]$Number
    )

    if ($Number -lt 0) {
        throw &quot;El n&uacute;mero debe ser no negativo&quot;
    }

    $result = 1
    for ($i = 1; $i -le $Number; $i++) {
        $result *= $i
    }

    return $result
}</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Seguir las mejores prácticas en la escritura de scripts de PowerShell asegura que tu código sea eficiente, mantenible y seguro. Usando nombres descriptivos, comentando tu código, manejando errores adecuadamente y adhiriéndose a las directrices de seguridad y rendimiento, puedes crear scripts robustos que sean fáciles de entender y mantener. A medida que avances, incorporar técnicas como splatting, módulos personalizados y funciones avanzadas mejorará aún más tus capacidades de scripting.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='infrastructure-as-code-with-powershell'>&#x25C4;Infraestructura como Código con PowerShell</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Mejores Prácticas de PowerShell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-efficient-powershell-code'>Escribiendo Código Eficiente en PowerShell &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
