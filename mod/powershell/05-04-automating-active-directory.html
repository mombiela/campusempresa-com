<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatización de Tareas de Active Directory</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/05-04-automating-active-directory" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/05-04-automating-active-directory" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/05-04-automating-active-directory" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/powershell/05-04-automating-active-directory" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/powershell/05-04-automating-active-directory" class="px-2">CA</a>
<br>
			<cite>Construyendo la sociedad de hoy y del mañana</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
									<a href="./">Contenido del curso</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competencias técnicas</a>
				<a href="/all/conocimientos">Conocimientos</a>
				<a href="/all/soft_skills">Competencias sociales</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-system-administration' title="Uso de PowerShell para Administración del Sistema">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Automatización de Tareas de Active Directory</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-05-automating-network-tasks' title="Automatización de Tareas de Red">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En este tema, aprenderás cómo utilizar PowerShell para automatizar tareas comunes de administración de Active Directory (AD). La automatización de estas tareas puede ahorrarte tiempo y reducir errores humanos, mejorando la eficiencia y la consistencia en la gestión de tu entorno de AD.</p>
</div><h1><p>Conceptos Clave</p>
</h1>
<div class='content'><ol>
<li><strong>Active Directory (AD):</strong> Un servicio de directorio desarrollado por Microsoft para redes de dominio de Windows.</li>
<li><strong>Cmdlets de Active Directory:</strong> Comandos específicos de PowerShell diseñados para interactuar con AD.</li>
<li><strong>Automatización:</strong> Uso de scripts para realizar tareas repetitivas sin intervención manual.</li>
</ol>
</div><h1><p>Cmdlets Básicos de Active Directory</p>
</h1>
<div class='content'><p>PowerShell proporciona una serie de cmdlets para gestionar AD. Aquí hay algunos de los más comunes:</p>
<table>
<thead>
<tr>
<th>Cmdlet</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Get-ADUser</code></td>
<td>Obtiene información sobre usuarios de AD.</td>
</tr>
<tr>
<td><code>New-ADUser</code></td>
<td>Crea un nuevo usuario en AD.</td>
</tr>
<tr>
<td><code>Set-ADUser</code></td>
<td>Modifica propiedades de un usuario de AD.</td>
</tr>
<tr>
<td><code>Remove-ADUser</code></td>
<td>Elimina un usuario de AD.</td>
</tr>
<tr>
<td><code>Get-ADGroup</code></td>
<td>Obtiene información sobre grupos de AD.</td>
</tr>
<tr>
<td><code>Add-ADGroupMember</code></td>
<td>Añade un usuario a un grupo de AD.</td>
</tr>
<tr>
<td><code>Remove-ADGroupMember</code></td>
<td>Elimina un usuario de un grupo de AD.</td>
</tr>
</tbody>
</table>
</div><h1><p>Ejemplos Prácticos</p>
</h1>
<div class='content'></div><h2><ol>
<li>Creación de un Nuevo Usuario</li>
</ol>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("TmV3LUFEVXNlciAtTmFtZSAiSm9obiBEb2UiIC1HaXZlbk5hbWUgIkpvaG4iIC1TdXJuYW1lICJEb2UiIC1TYW1BY2NvdW50TmFtZSAiamRvZSIgLVVzZXJQcmluY2lwYWxOYW1lICJqZG9lQGRvbWFpbi5jb20iIC1QYXRoICJPVT1Vc2VycyxEQz1kb21haW4sREM9Y29tIiAtQWNjb3VudFBhc3N3b3JkIChDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICJQQHNzdzByZCIgLUFzUGxhaW5UZXh0IC1Gb3JjZSkgLUVuYWJsZWQgJHRydWU="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>New-ADUser -Name &quot;John Doe&quot; -GivenName &quot;John&quot; -Surname &quot;Doe&quot; -SamAccountName &quot;jdoe&quot; -UserPrincipalName &quot;jdoe@domain.com&quot; -Path &quot;OU=Users,DC=domain,DC=com&quot; -AccountPassword (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -Enabled $true</pre></div><div class='content'><p><strong>Explicación:</strong></p>
<ul>
<li><code>-Name</code>: Nombre completo del usuario.</li>
<li><code>-GivenName</code>: Nombre de pila.</li>
<li><code>-Surname</code>: Apellido.</li>
<li><code>-SamAccountName</code>: Nombre de cuenta SAM.</li>
<li><code>-UserPrincipalName</code>: Nombre principal del usuario.</li>
<li><code>-Path</code>: Ruta en AD donde se creará el usuario.</li>
<li><code>-AccountPassword</code>: Contraseña de la cuenta (convertida a un objeto SecureString).</li>
<li><code>-Enabled</code>: Habilita la cuenta.</li>
</ul>
</div><h2><ol start="2">
<li>Modificación de Propiedades de un Usuario</li>
</ol>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U2V0LUFEVXNlciAtSWRlbnRpdHkgImpkb2UiIC1UaXRsZSAiU2VuaW9yIERldmVsb3BlciIgLURlcGFydG1lbnQgIklUIg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Set-ADUser -Identity &quot;jdoe&quot; -Title &quot;Senior Developer&quot; -Department &quot;IT&quot;</pre></div><div class='content'><p><strong>Explicación:</strong></p>
<ul>
<li><code>-Identity</code>: Identificador del usuario (puede ser SamAccountName, DistinguishedName, etc.).</li>
<li><code>-Title</code>: Título del usuario.</li>
<li><code>-Department</code>: Departamento del usuario.</li>
</ul>
</div><h2><ol start="3">
<li>Añadir un Usuario a un Grupo</li>
</ol>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWRkLUFER3JvdXBNZW1iZXIgLUlkZW50aXR5ICJEZXZlbG9wZXJzIiAtTWVtYmVycyAiamRvZSI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Add-ADGroupMember -Identity &quot;Developers&quot; -Members &quot;jdoe&quot;</pre></div><div class='content'><p><strong>Explicación:</strong></p>
<ul>
<li><code>-Identity</code>: Identificador del grupo.</li>
<li><code>-Members</code>: Usuario(s) a añadir al grupo.</li>
</ul>
</div><h2><ol start="4">
<li>Eliminar un Usuario</li>
</ol>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UmVtb3ZlLUFEVXNlciAtSWRlbnRpdHkgImpkb2Ui"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Remove-ADUser -Identity &quot;jdoe&quot;</pre></div><div class='content'><p><strong>Explicación:</strong></p>
<ul>
<li><code>-Identity</code>: Identificador del usuario a eliminar.</li>
</ul>
</div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Crear y Configurar un Usuario</p>
</h2>
<div class='content'><p><strong>Objetivo:</strong> Crear un nuevo usuario en AD, asignarle un título y añadirlo a un grupo.</p>
<ol>
<li>
<p><strong>Crear un nuevo usuario:</strong></p>
<ul>
<li>Nombre: Jane Smith</li>
<li>Nombre de pila: Jane</li>
<li>Apellido: Smith</li>
<li>SamAccountName: jsmith</li>
<li>UserPrincipalName: jsmith@domain.com</li>
<li>Contraseña: P@ssw0rd</li>
<li>Ruta: OU=Users,DC=domain,DC=com</li>
</ul>
</li>
<li>
<p><strong>Asignar el título &quot;Project Manager&quot; al usuario Jane Smith.</strong></p>
</li>
<li>
<p><strong>Añadir a Jane Smith al grupo &quot;Managers&quot;.</strong></p>
</li>
</ol>
<p><strong>Solución:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciBlbCBudWV2byB1c3VhcmlvCk5ldy1BRFVzZXIgLU5hbWUgIkphbmUgU21pdGgiIC1HaXZlbk5hbWUgIkphbmUiIC1TdXJuYW1lICJTbWl0aCIgLVNhbUFjY291bnROYW1lICJqc21pdGgiIC1Vc2VyUHJpbmNpcGFsTmFtZSAianNtaXRoQGRvbWFpbi5jb20iIC1QYXRoICJPVT1Vc2VycyxEQz1kb21haW4sREM9Y29tIiAtQWNjb3VudFBhc3N3b3JkIChDb252ZXJ0VG8tU2VjdXJlU3RyaW5nICJQQHNzdzByZCIgLUFzUGxhaW5UZXh0IC1Gb3JjZSkgLUVuYWJsZWQgJHRydWUKCiMgQXNpZ25hciBlbCB0w610dWxvClNldC1BRFVzZXIgLUlkZW50aXR5ICJqc21pdGgiIC1UaXRsZSAiUHJvamVjdCBNYW5hZ2VyIgoKIyBBw7FhZGlyIGFsIGdydXBvCkFkZC1BREdyb3VwTWVtYmVyIC1JZGVudGl0eSAiTWFuYWdlcnMiIC1NZW1iZXJzICJqc21pdGgi"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear el nuevo usuario
New-ADUser -Name &quot;Jane Smith&quot; -GivenName &quot;Jane&quot; -Surname &quot;Smith&quot; -SamAccountName &quot;jsmith&quot; -UserPrincipalName &quot;jsmith@domain.com&quot; -Path &quot;OU=Users,DC=domain,DC=com&quot; -AccountPassword (ConvertTo-SecureString &quot;P@ssw0rd&quot; -AsPlainText -Force) -Enabled $true

# Asignar el t&iacute;tulo
Set-ADUser -Identity &quot;jsmith&quot; -Title &quot;Project Manager&quot;

# A&ntilde;adir al grupo
Add-ADGroupMember -Identity &quot;Managers&quot; -Members &quot;jsmith&quot;</pre></div><div class='content'></div><h1><p>Errores Comunes y Consejos</p>
</h1>
<div class='content'><ol>
<li>
<p><strong>Error: &quot;Access Denied&quot;</strong></p>
<ul>
<li><strong>Solución:</strong> Asegúrate de ejecutar PowerShell con privilegios administrativos.</li>
</ul>
</li>
<li>
<p><strong>Error: &quot;User already exists&quot;</strong></p>
<ul>
<li><strong>Solución:</strong> Verifica que el <code>SamAccountName</code> y <code>UserPrincipalName</code> sean únicos antes de crear un nuevo usuario.</li>
</ul>
</li>
<li>
<p><strong>Error: &quot;Group not found&quot;</strong></p>
<ul>
<li><strong>Solución:</strong> Asegúrate de que el grupo al que intentas añadir el usuario existe en AD.</li>
</ul>
</li>
</ol>
</div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, has aprendido a utilizar PowerShell para automatizar tareas comunes de administración de Active Directory, como la creación y modificación de usuarios, y la gestión de grupos. La automatización de estas tareas puede mejorar significativamente la eficiencia y la precisión en la gestión de tu entorno de AD. En el próximo tema, exploraremos cómo automatizar tareas de red utilizando PowerShell.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='05-03-system-administration' title="Uso de PowerShell para Administración del Sistema">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='05-05-automating-network-tasks' title="Automatización de Tareas de Red">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
