<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uso de Invoke-Command</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/using-invoke-command" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/using-invoke-command" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/using-invoke-command" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/powershell/using-invoke-command" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/powershell/using-invoke-command" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atención!</b> Ha habido un error en la generación del curso y puede contener errores de traducción.Estamos trabajando para solucinarlo por lo que se deben usar los contenidos con cuidado.Se puede consultar el contenido correcto en otro idioma en el siguiente enlace:<br>
						<a href="https://enterprisecampus.net/mod/powershell/using-invoke-command">https://enterprisecampus.net/mod/powershell/using-invoke-command</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-remoting'>&#x25C4;Configuración de Remoting</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Uso de Invoke-Command</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-scheduled-jobs'>Automatizando Tareas con Trabajos Programados &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a Invoke-Command</h1>
<div class='content'><p>Invoke-Command es un cmdlet poderoso en PowerShell que te permite ejecutar comandos en computadoras locales y remotas. Esto es particularmente útil para gestionar múltiples sistemas desde un único punto de control.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Cmdlet</strong>: Un comando ligero usado en el entorno de PowerShell.</li>
<li><strong>Ejecución Remota</strong>: Ejecutar comandos en una máquina diferente a la que estás usando actualmente.</li>
<li><strong>Sesión</strong>: Una conexión persistente a una computadora remota.</li>
</ul>
</div><h1>Uso Básico de Invoke-Command</h1>
<div class='content'><p>Invoke-Command puede ser usado para ejecutar comandos simples en computadoras locales o remotas.</p>
</div><h2>Ejecutando Comandos Localmente</h2>
<div class='content'><p>Puedes usar Invoke-Command para ejecutar un comando en tu máquina local.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>-ScriptBlock</strong>: Define el bloque de código a ejecutar.</li>
<li><strong>Get-Process</strong>: Un cmdlet que recupera los procesos que se están ejecutando en la máquina local.</li>
</ul>
</div><h2>Ejecutando Comandos Remotamente</h2>
<div class='content'><p>Para ejecutar comandos en una computadora remota, necesitas especificar el nombre de la computadora.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlUEMiIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>-ComputerName</strong>: Especifica la computadora remota en la que se ejecutará el comando.</li>
</ul>
</div><h1>Uso Avanzado de Invoke-Command</h1>
<div class='content'><p>Invoke-Command ofrece características más avanzadas como ejecutar comandos en múltiples computadoras y usar credenciales.</p>
</div><h2>Ejecutando Comandos en Múltiples Computadoras</h2>
<div class='content'><p>Puedes ejecutar un comando en múltiples computadoras remotas especificando un array de nombres de computadoras.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SW52b2tlLUNvbW1hbmQgLUNvbXB1dGVyTmFtZSAiUmVtb3RlUEMxIiwgIlJlbW90ZVBDMiIgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Invoke-Command -ComputerName &quot;RemotePC1&quot;, &quot;RemotePC2&quot; -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2>Usando Credenciales</h2>
<div class='content'><p>Si la computadora remota requiere credenciales diferentes, puedes usar el parámetro -Credential.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JGNyZWQgPSBHZXQtQ3JlZGVudGlhbApJbnZva2UtQ29tbWFuZCAtQ29tcHV0ZXJOYW1lICJSZW1vdGVQQyIgLUNyZWRlbnRpYWwgJGNyZWQgLVNjcmlwdEJsb2NrIHsgR2V0LVByb2Nlc3MgfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$cred = Get-Credential
Invoke-Command -ComputerName &quot;RemotePC&quot; -Credential $cred -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>Get-Credential</strong>: Solicita un nombre de usuario y una contraseña.</li>
<li><strong>-Credential</strong>: Especifica la cuenta de usuario a usar cuando se ejecuta el comando.</li>
</ul>
</div><h2>Usando Sesiones</h2>
<div class='content'><p>Para escenarios más complejos, puedes crear una sesión persistente a una computadora remota.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIgpJbnZva2UtQ29tbWFuZCAtU2Vzc2lvbiAkc2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$session = New-PSSession -ComputerName &quot;RemotePC&quot;
Invoke-Command -Session $session -ScriptBlock { Get-Process }</pre></div><div class='content'><ul>
<li><strong>New-PSSession</strong>: Crea una nueva sesión a una computadora remota.</li>
<li><strong>-Session</strong>: Especifica la sesión a usar para el comando.</li>
</ul>
</div><h1>Manejo de Errores y Salida</h1>
<div class='content'><p>Invoke-Command proporciona mecanismos para manejar errores y capturar la salida.</p>
</div><h2>Capturando la Salida</h2>
<div class='content'><p>Puedes capturar la salida del comando en una variable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JG91dHB1dCA9IEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9CiRvdXRwdXQ="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$output = Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }
$output</pre></div><div class='content'></div><h2>Manejo de Errores</h2>
<div class='content'><p>Puedes manejar errores usando bloques try-catch.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgIEludm9rZS1Db21tYW5kIC1Db21wdXRlck5hbWUgIlJlbW90ZVBDIiAtU2NyaXB0QmxvY2sgeyBHZXQtUHJvY2VzcyB9Cn0gY2F0Y2ggewogICAgV3JpdGUtSG9zdCAiT2N1cnJpw7MgdW4gZXJyb3I6ICRfIgp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    Invoke-Command -ComputerName &quot;RemotePC&quot; -ScriptBlock { Get-Process }
} catch {
    Write-Host &quot;Ocurri&oacute; un error: $_&quot;
}</pre></div><div class='content'></div><h1>Resumen</h1>
<div class='content'><p>Invoke-Command es un cmdlet versátil en PowerShell que te permite ejecutar comandos en computadoras locales y remotas. Soporta ejecutar comandos en múltiples computadoras, usar diferentes credenciales y crear sesiones persistentes. Al dominar Invoke-Command, puedes gestionar eficientemente múltiples sistemas y automatizar tareas complejas.</p>
</div><h2>Puntos Clave</h2>
<div class='content'><ul>
<li><strong>Invoke-Command</strong>: Ejecuta comandos localmente o remotamente.</li>
<li><strong>-ScriptBlock</strong>: Define el código a ejecutar.</li>
<li><strong>-ComputerName</strong>: Especifica computadoras remotas.</li>
<li><strong>-Credential</strong>: Usa diferentes cuentas de usuario.</li>
<li><strong>New-PSSession</strong>: Crea conexiones persistentes.</li>
<li><strong>Manejo de Errores</strong>: Usa try-catch para scripts robustos.</li>
</ul>
<p>Al entender y utilizar estas características, puedes mejorar tus capacidades de scripting en PowerShell y agilizar tus tareas administrativas.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='configuring-remoting'>&#x25C4;Configuración de Remoting</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Uso de Invoke-Command</a>
	</div>
	<div class='col-4 text-end'>
					<a href='automating-tasks-with-scheduled-jobs'>Automatizando Tareas con Trabajos Programados &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
