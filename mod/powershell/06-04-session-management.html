<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Gestión de Sesiones</title>

    <link rel="alternate" href="https://campusempresa.com/mod/powershell/06-04-session-management" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/powershell/06-04-session-management" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/powershell/06-04-session-management" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=4" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>var DEVELOP = window.location.href.indexOf("localhost")!=-1 && true;</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/powershell/06-04-session-management" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/powershell/06-04-session-management" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>
		<!-- <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
					<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contenido del curso
	</a>

			</div>
		</div>
	</div>
</div>
 -->
 
<div class="top-bar container-fluid">
	<div class="container-xxl">
		<nav class="navbar navbar-expand-md p-0">
			<div class="container-fluid">
				<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<div class="navbar-nav me-auto">
							<a href="/"  class="nav-link px-3">
		<i class="bi bi-house-fill"></i>
		HOME
	</a>

	<a href="./"  class="nav-link px-3">
		<i class="bi bi-journal-bookmark"></i>
		Contenido del curso
	</a>

					</div>
				</div>			
							</div>
		</nav>
	</div>
</div>				<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-using-invoke-command' title="Uso de Invoke-Command">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<h2 style="text-decoration:underline">Gestión de Sesiones</h2>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-05-security-considerations' title="Consideraciones de Seguridad">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En este tema, aprenderemos sobre la gestión de sesiones en PowerShell Remoting. Las sesiones son una parte fundamental de PowerShell Remoting, ya que permiten mantener una conexión persistente con un equipo remoto, lo que puede mejorar la eficiencia y la gestión de recursos.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ol>
<li><strong>Sesión Remota</strong>: Una conexión persistente a un equipo remoto que permite ejecutar múltiples comandos sin necesidad de autenticarse repetidamente.</li>
<li><strong>Cmdlets de Sesión</strong>: PowerShell proporciona varios cmdlets para crear, gestionar y cerrar sesiones remotas.</li>
<li><strong>Persistencia de Sesión</strong>: Mantener una sesión abierta puede ser útil para tareas que requieren múltiples comandos o para scripts largos.</li>
</ol>
</div><h1>Cmdlets Principales para la Gestión de Sesiones</h1>
<div class='content'><table>
<thead>
<tr>
<th>Cmdlet</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>New-PSSession</code></td>
<td>Crea una nueva sesión remota.</td>
</tr>
<tr>
<td><code>Get-PSSession</code></td>
<td>Recupera las sesiones remotas activas.</td>
</tr>
<tr>
<td><code>Remove-PSSession</code></td>
<td>Cierra una o más sesiones remotas.</td>
</tr>
<tr>
<td><code>Enter-PSSession</code></td>
<td>Entra en una sesión remota interactiva.</td>
</tr>
<tr>
<td><code>Exit-PSSession</code></td>
<td>Sale de una sesión remota interactiva.</td>
</tr>
<tr>
<td><code>Invoke-Command</code></td>
<td>Ejecuta comandos en una o más sesiones remotas.</td>
</tr>
</tbody>
</table>
</div><h1>Crear y Usar Sesiones</h1>
<div class='content'></div><h2>Crear una Nueva Sesión</h2>
<div class='content'><p>Para crear una nueva sesión remota, utilizamos el cmdlet <code>New-PSSession</code>. Este cmdlet establece una conexión con el equipo remoto y devuelve un objeto de sesión que podemos usar para ejecutar comandos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDcmVhciB1bmEgbnVldmEgc2VzacOzbiByZW1vdGEKJHNlc3Npb24gPSBOZXctUFNTZXNzaW9uIC1Db21wdXRlck5hbWUgIlJlbW90ZUNvbXB1dGVyTmFtZSIgLUNyZWRlbnRpYWwgKEdldC1DcmVkZW50aWFsKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Crear una nueva sesi&oacute;n remota
$session = New-PSSession -ComputerName &quot;RemoteComputerName&quot; -Credential (Get-Credential)</pre></div><div class='content'></div><h2>Ejecutar Comandos en una Sesión</h2>
<div class='content'><p>Una vez que tenemos una sesión, podemos usar <code>Invoke-Command</code> para ejecutar comandos en esa sesión.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFamVjdXRhciB1biBjb21hbmRvIGVuIGxhIHNlc2nDs24gcmVtb3RhCkludm9rZS1Db21tYW5kIC1TZXNzaW9uICRzZXNzaW9uIC1TY3JpcHRCbG9jayB7IEdldC1Qcm9jZXNzIH0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Ejecutar un comando en la sesi&oacute;n remota
Invoke-Command -Session $session -ScriptBlock { Get-Process }</pre></div><div class='content'></div><h2>Recuperar Sesiones Activas</h2>
<div class='content'><p>Podemos listar todas las sesiones activas utilizando <code>Get-PSSession</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBPYnRlbmVyIHRvZGFzIGxhcyBzZXNpb25lcyBhY3RpdmFzCkdldC1QU1Nlc3Npb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Obtener todas las sesiones activas
Get-PSSession</pre></div><div class='content'></div><h2>Cerrar Sesiones</h2>
<div class='content'><p>Para cerrar una sesión y liberar los recursos, utilizamos <code>Remove-PSSession</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDZXJyYXIgdW5hIHNlc2nDs24gZXNwZWPDrWZpY2EKUmVtb3ZlLVBTU2Vzc2lvbiAtU2Vzc2lvbiAkc2Vzc2lvbgoKIyBDZXJyYXIgdG9kYXMgbGFzIHNlc2lvbmVzIGFjdGl2YXMKR2V0LVBTU2Vzc2lvbiB8IFJlbW92ZS1QU1Nlc3Npb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cerrar una sesi&oacute;n espec&iacute;fica
Remove-PSSession -Session $session

# Cerrar todas las sesiones activas
Get-PSSession | Remove-PSSession</pre></div><div class='content'></div><h2>Entrar y Salir de una Sesión Interactiva</h2>
<div class='content'><p>Podemos entrar en una sesión interactiva con <code>Enter-PSSession</code> y salir de ella con <code>Exit-PSSession</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbnRyYXIgZW4gdW5hIHNlc2nDs24gaW50ZXJhY3RpdmEKRW50ZXItUFNTZXNzaW9uIC1TZXNzaW9uICRzZXNzaW9uCgojIFNhbGlyIGRlIGxhIHNlc2nDs24gaW50ZXJhY3RpdmEKRXhpdC1QU1Nlc3Npb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Entrar en una sesi&oacute;n interactiva
Enter-PSSession -Session $session

# Salir de la sesi&oacute;n interactiva
Exit-PSSession</pre></div><div class='content'></div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio 1: Crear y Gestionar Sesiones</h2>
<div class='content'><ol>
<li>
<p><strong>Crear una sesión remota</strong>:</p>
<ul>
<li>Usa <code>New-PSSession</code> para crear una sesión remota con un equipo de tu red.</li>
<li>Guarda la sesión en una variable llamada <code>$mySession</code>.</li>
</ul>
</li>
<li>
<p><strong>Ejecutar un comando en la sesión</strong>:</p>
<ul>
<li>Usa <code>Invoke-Command</code> para ejecutar <code>Get-Service</code> en la sesión <code>$mySession</code>.</li>
</ul>
</li>
<li>
<p><strong>Listar todas las sesiones activas</strong>:</p>
<ul>
<li>Usa <code>Get-PSSession</code> para listar todas las sesiones activas.</li>
</ul>
</li>
<li>
<p><strong>Cerrar la sesión</strong>:</p>
<ul>
<li>Usa <code>Remove-PSSession</code> para cerrar la sesión <code>$mySession</code>.</li>
</ul>
</li>
</ol>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQYXNvIDE6IENyZWFyIHVuYSBzZXNpw7NuIHJlbW90YQokbXlTZXNzaW9uID0gTmV3LVBTU2Vzc2lvbiAtQ29tcHV0ZXJOYW1lICJSZW1vdGVDb21wdXRlck5hbWUiIC1DcmVkZW50aWFsIChHZXQtQ3JlZGVudGlhbCkKCiMgUGFzbyAyOiBFamVjdXRhciB1biBjb21hbmRvIGVuIGxhIHNlc2nDs24KSW52b2tlLUNvbW1hbmQgLVNlc3Npb24gJG15U2Vzc2lvbiAtU2NyaXB0QmxvY2sgeyBHZXQtU2VydmljZSB9CgojIFBhc28gMzogTGlzdGFyIHRvZGFzIGxhcyBzZXNpb25lcyBhY3RpdmFzCkdldC1QU1Nlc3Npb24KCiMgUGFzbyA0OiBDZXJyYXIgbGEgc2VzacOzbgpSZW1vdmUtUFNTZXNzaW9uIC1TZXNzaW9uICRteVNlc3Npb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Paso 1: Crear una sesi&oacute;n remota
$mySession = New-PSSession -ComputerName &quot;RemoteComputerName&quot; -Credential (Get-Credential)

# Paso 2: Ejecutar un comando en la sesi&oacute;n
Invoke-Command -Session $mySession -ScriptBlock { Get-Service }

# Paso 3: Listar todas las sesiones activas
Get-PSSession

# Paso 4: Cerrar la sesi&oacute;n
Remove-PSSession -Session $mySession</pre></div><div class='content'></div><h1>Errores Comunes y Consejos</h1>
<div class='content'><ol>
<li><strong>Error de Conexión</strong>: Asegúrate de que el equipo remoto está accesible y que tienes los permisos necesarios.</li>
<li><strong>Credenciales Incorrectas</strong>: Verifica que las credenciales proporcionadas son correctas.</li>
<li><strong>Sesión No Encontrada</strong>: Si intentas cerrar una sesión que ya ha sido cerrada, recibirás un error. Usa <code>Get-PSSession</code> para verificar las sesiones activas antes de intentar cerrarlas.</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>La gestión de sesiones en PowerShell Remoting es una habilidad esencial para cualquier administrador de sistemas. Las sesiones permiten ejecutar comandos de manera eficiente y mantener conexiones persistentes con equipos remotos. En este tema, hemos cubierto cómo crear, gestionar y cerrar sesiones, así como algunos errores comunes y consejos para evitarlos. Con esta base, estarás preparado para manejar tareas más complejas en entornos remotos.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-03-using-invoke-command' title="Uso de Invoke-Command">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-05-security-considerations' title="Consideraciones de Seguridad">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
				<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
	     crossorigin="anonymous"></script>
	<!-- enterprise_campus -->
	<ins class="adsbygoogle"
	     style="display:block"
	     data-ad-client="ca-pub-0611338592562725"
	     data-ad-slot="6914733106"
	     data-ad-format="auto"
	     data-full-width-responsive="true"></ins>
	<script>
	     (adsbygoogle = window.adsbygoogle || []).push({});
	</script>
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>Curso de PowerShell</h1>
<h2>Módulo 1: Introducción a PowerShell</h2>
<ul>
<li><a href="01-01-what-is-powershell">¿Qué es PowerShell?</a></li>
<li><a href="01-02-installing-setting-up">Instalación y Configuración de PowerShell</a></li>
<li><a href="01-03-console-ise">Consola de PowerShell e ISE</a></li>
<li><a href="01-04-basic-commands-syntax">Comandos Básicos y Sintaxis</a></li>
<li><a href="01-05-help-system">Sistema de Ayuda en PowerShell</a></li>
</ul>
<h2>Módulo 2: Scripting Básico</h2>
<ul>
<li><a href="02-01-variables-data-types">Variables y Tipos de Datos</a></li>
<li><a href="02-02-operators">Operadores en PowerShell</a></li>
<li><a href="02-03-conditional-statements">Sentencias Condicionales</a></li>
<li><a href="02-04-loops">Bucles en PowerShell</a></li>
<li><a href="02-05-functions-scripts">Funciones y Scripts</a></li>
</ul>
<h2>Módulo 3: Trabajando con Objetos</h2>
<ul>
<li><a href="03-01-understanding-objects">Entendiendo los Objetos</a></li>
<li><a href="03-02-properties-methods">Propiedades y Métodos de los Objetos</a></li>
<li><a href="03-03-pipelines-manipulation">Pipelines y Manipulación de Objetos</a></li>
<li><a href="03-04-filtering-selecting">Filtrado y Selección de Objetos</a></li>
<li><a href="03-05-sorting-grouping">Ordenación y Agrupación de Objetos</a></li>
</ul>
<h2>Módulo 4: Técnicas Avanzadas de Scripting</h2>
<ul>
<li><a href="04-01-error-handling">Manejo de Errores</a></li>
<li><a href="04-02-debugging-scripts">Depuración de Scripts</a></li>
<li><a href="04-03-regular-expressions">Expresiones Regulares</a></li>
<li><a href="04-04-files-directories">Trabajando con Archivos y Directorios</a></li>
<li><a href="04-05-modules-snap-ins">Uso de Módulos y Snap-ins</a></li>
</ul>
<h2>Módulo 5: Automatización y Programación de Tareas</h2>
<ul>
<li><a href="05-01-introduction-automation">Introducción a la Automatización</a></li>
<li><a href="05-02-creating-scheduled-tasks">Creación de Tareas Programadas</a></li>
<li><a href="05-03-system-administration">Uso de PowerShell para Administración del Sistema</a></li>
<li><a href="05-04-automating-active-directory">Automatización de Tareas de Active Directory</a></li>
<li><a href="05-05-automating-network-tasks">Automatización de Tareas de Red</a></li>
</ul>
<h2>Módulo 6: PowerShell Remoting</h2>
<ul>
<li><a href="06-01-introduction-remoting">Introducción al Remoting</a></li>
<li><a href="06-02-setting-up-remoting">Configuración del Remoting</a></li>
<li><a href="06-03-using-invoke-command">Uso de Invoke-Command</a></li>
<li><a href="06-04-session-management">Gestión de Sesiones</a></li>
<li><a href="06-05-security-considerations">Consideraciones de Seguridad</a></li>
</ul>
<h2>Módulo 7: Funcionalidades Avanzadas de PowerShell</h2>
<ul>
<li><a href="07-01-powershell-profiles">Perfiles de PowerShell</a></li>
<li><a href="07-02-customizing-environment">Personalización del Entorno de PowerShell</a></li>
<li><a href="07-03-creating-using-classes">Creación y Uso de Clases</a></li>
<li><a href="07-04-working-xml-json">Trabajando con XML y JSON</a></li>
<li><a href="07-05-using-rest-apis">Uso de PowerShell con REST APIs</a></li>
</ul>
<h2>Módulo 8: PowerShell y DevOps</h2>
<ul>
<li><a href="08-01-introduction-devops">Introducción a DevOps</a></li>
<li><a href="08-02-using-ci-cd-pipelines">Uso de PowerShell con Pipelines de CI/CD</a></li>
<li><a href="08-03-infrastructure-as-code">Infraestructura como Código (IaC)</a></li>
<li><a href="08-04-managing-cloud-resources">Gestión de Recursos en la Nube con PowerShell</a></li>
<li><a href="08-05-powershell-docker">PowerShell y Docker</a></li>
</ul>
<h2>Módulo 9: Mejores Prácticas y Consejos Avanzados</h2>
<ul>
<li><a href="09-01-readable-maintainable-code">Escritura de Código Legible y Mantenible</a></li>
<li><a href="09-02-performance-optimization">Optimización del Rendimiento</a></li>
<li><a href="09-03-security-best-practices">Mejores Prácticas de Seguridad</a></li>
<li><a href="09-04-version-control-git">Control de Versiones con Git</a></li>
<li><a href="09-05-community-resources">Recursos Comunitarios y Aprendizaje Adicional</a></li>
</ul>

	</div>










		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
</body>
</html>
