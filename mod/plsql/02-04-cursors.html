<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cursores</title>

    <link rel="alternate" href="https://campusempresa.com/mod/plsql/02-04-cursors" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/plsql/02-04-cursors" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/plsql/02-04-cursors" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/plsql/02-04-cursors" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/plsql/02-04-cursors" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-03-control-structures' title="Estructuras de Control">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Cursores</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='02-05-exception-handling' title="Manejo de Excepciones">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En PL/SQL, los cursores son una herramienta fundamental para manejar conjuntos de resultados de consultas SQL. Los cursores permiten a los programadores procesar filas de una consulta de manera individual, lo que es especialmente útil cuando se necesita realizar operaciones fila por fila.</p>
</div><h1>Tipos de Cursores</h1>
<div class='content'><p>En PL/SQL, existen dos tipos principales de cursores:</p>
<ol>
<li><strong>Cursores Implícitos</strong>: Son gestionados automáticamente por Oracle cuando se ejecuta una sentencia SQL que devuelve un solo resultado.</li>
<li><strong>Cursores Explícitos</strong>: Son definidos y gestionados por el programador para manejar consultas que devuelven múltiples filas.</li>
</ol>
</div><h2>Cursores Implícitos</h2>
<div class='content'><p>Los cursores implícitos son creados automáticamente por Oracle para cada sentencia SQL que se ejecuta. No requieren una declaración explícita por parte del programador. Por ejemplo, cuando se ejecuta una sentencia <code>SELECT INTO</code>, Oracle crea un cursor implícito para manejar la operación.</p>
<h4>Ejemplo de Cursor Implícito</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgdl9lbXBsb3llZV9uYW1lIFZBUkNIQVIyKDUwKTsKQkVHSU4KICAgIFNFTEVDVCBmaXJzdF9uYW1lIElOVE8gdl9lbXBsb3llZV9uYW1lCiAgICBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgZW1wbG95ZWVfaWQgPSAxMDA7CiAgICAKICAgIERCTVNfT1VUUFVULlBVVF9MSU5FKCdFbXBsb3llZSBOYW1lOiAnIHx8IHZfZW1wbG95ZWVfbmFtZSk7CkVORDsKLw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    v_employee_name VARCHAR2(50);
BEGIN
    SELECT first_name INTO v_employee_name
    FROM employees
    WHERE employee_id = 100;
    
    DBMS_OUTPUT.PUT_LINE('Employee Name: ' || v_employee_name);
END;
/</pre></div><div class='content'><p>En este ejemplo, Oracle crea un cursor implícito para la sentencia <code>SELECT INTO</code>.</p>
</div><h2>Cursores Explícitos</h2>
<div class='content'><p>Los cursores explícitos son definidos y controlados por el programador. Se utilizan cuando se necesita procesar múltiples filas de una consulta. Los pasos para trabajar con cursores explícitos son:</p>
<ol>
<li><strong>Declarar el Cursor</strong>: Definir el cursor con una sentencia <code>SELECT</code>.</li>
<li><strong>Abrir el Cursor</strong>: Ejecutar la sentencia <code>SELECT</code> y asignar el conjunto de resultados al cursor.</li>
<li><strong>Obtener Filas</strong>: Recuperar cada fila del conjunto de resultados.</li>
<li><strong>Cerrar el Cursor</strong>: Liberar los recursos asociados con el cursor.</li>
</ol>
<h4>Ejemplo de Cursor Explícito</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgQ1VSU09SIGVtcF9jdXJzb3IgSVMKICAgICAgICBTRUxFQ1QgZW1wbG95ZWVfaWQsIGZpcnN0X25hbWUsIGxhc3RfbmFtZQogICAgICAgIEZST00gZW1wbG95ZWVzOwogICAgCiAgICB2X2VtcGxveWVlX2lkIGVtcGxveWVlcy5lbXBsb3llZV9pZCVUWVBFOwogICAgdl9maXJzdF9uYW1lIGVtcGxveWVlcy5maXJzdF9uYW1lJVRZUEU7CiAgICB2X2xhc3RfbmFtZSBlbXBsb3llZXMubGFzdF9uYW1lJVRZUEU7CkJFR0lOCiAgICBPUEVOIGVtcF9jdXJzb3I7CiAgICAKICAgIExPT1AKICAgICAgICBGRVRDSCBlbXBfY3Vyc29yIElOVE8gdl9lbXBsb3llZV9pZCwgdl9maXJzdF9uYW1lLCB2X2xhc3RfbmFtZTsKICAgICAgICBFWElUIFdIRU4gZW1wX2N1cnNvciVOT1RGT1VORDsKICAgICAgICAKICAgICAgICBEQk1TX09VVFBVVC5QVVRfTElORSgnRW1wbG95ZWUgSUQ6ICcgfHwgdl9lbXBsb3llZV9pZCB8fCAnLCBOYW1lOiAnIHx8IHZfZmlyc3RfbmFtZSB8fCAnICcgfHwgdl9sYXN0X25hbWUpOwogICAgRU5EIExPT1A7CiAgICAKICAgIENMT1NFIGVtcF9jdXJzb3I7CkVORDsKLw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    CURSOR emp_cursor IS
        SELECT employee_id, first_name, last_name
        FROM employees;
    
    v_employee_id employees.employee_id%TYPE;
    v_first_name employees.first_name%TYPE;
    v_last_name employees.last_name%TYPE;
BEGIN
    OPEN emp_cursor;
    
    LOOP
        FETCH emp_cursor INTO v_employee_id, v_first_name, v_last_name;
        EXIT WHEN emp_cursor%NOTFOUND;
        
        DBMS_OUTPUT.PUT_LINE('Employee ID: ' || v_employee_id || ', Name: ' || v_first_name || ' ' || v_last_name);
    END LOOP;
    
    CLOSE emp_cursor;
END;
/</pre></div><div class='content'><p>En este ejemplo, se declara un cursor <code>emp_cursor</code> que selecciona <code>employee_id</code>, <code>first_name</code> y <code>last_name</code> de la tabla <code>employees</code>. Luego, se abre el cursor, se recuperan las filas una por una y se cierran los recursos asociados con el cursor.</p>
</div><h1>Ejercicios Prácticos</h1>
<div class='content'></div><h2>Ejercicio 1: Cursor Implícito</h2>
<div class='content'><p><strong>Instrucciones</strong>: Escribe un bloque PL/SQL que utilice un cursor implícito para seleccionar el nombre de un departamento con <code>department_id</code> igual a 10 y mostrarlo en la salida.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgdl9kZXBhcnRtZW50X25hbWUgVkFSQ0hBUjIoNTApOwpCRUdJTgogICAgU0VMRUNUIGRlcGFydG1lbnRfbmFtZSBJTlRPIHZfZGVwYXJ0bWVudF9uYW1lCiAgICBGUk9NIGRlcGFydG1lbnRzCiAgICBXSEVSRSBkZXBhcnRtZW50X2lkID0gMTA7CiAgICAKICAgIERCTVNfT1VUUFVULlBVVF9MSU5FKCdEZXBhcnRtZW50IE5hbWU6ICcgfHwgdl9kZXBhcnRtZW50X25hbWUpOwpFTkQ7Ci8="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    v_department_name VARCHAR2(50);
BEGIN
    SELECT department_name INTO v_department_name
    FROM departments
    WHERE department_id = 10;
    
    DBMS_OUTPUT.PUT_LINE('Department Name: ' || v_department_name);
END;
/</pre></div><div class='content'></div><h2>Ejercicio 2: Cursor Explícito</h2>
<div class='content'><p><strong>Instrucciones</strong>: Escribe un bloque PL/SQL que utilice un cursor explícito para seleccionar todos los empleados del departamento 20 y mostrar sus nombres y apellidos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgQ1VSU09SIGRlcHRfZW1wX2N1cnNvciBJUwogICAgICAgIFNFTEVDVCBmaXJzdF9uYW1lLCBsYXN0X25hbWUKICAgICAgICBGUk9NIGVtcGxveWVlcwogICAgICAgIFdIRVJFIGRlcGFydG1lbnRfaWQgPSAyMDsKICAgIAogICAgdl9maXJzdF9uYW1lIGVtcGxveWVlcy5maXJzdF9uYW1lJVRZUEU7CiAgICB2X2xhc3RfbmFtZSBlbXBsb3llZXMubGFzdF9uYW1lJVRZUEU7CkJFR0lOCiAgICBPUEVOIGRlcHRfZW1wX2N1cnNvcjsKICAgIAogICAgTE9PUAogICAgICAgIEZFVENIIGRlcHRfZW1wX2N1cnNvciBJTlRPIHZfZmlyc3RfbmFtZSwgdl9sYXN0X25hbWU7CiAgICAgICAgRVhJVCBXSEVOIGRlcHRfZW1wX2N1cnNvciVOT1RGT1VORDsKICAgICAgICAKICAgICAgICBEQk1TX09VVFBVVC5QVVRfTElORSgnRW1wbG95ZWUgTmFtZTogJyB8fCB2X2ZpcnN0X25hbWUgfHwgJyAnIHx8IHZfbGFzdF9uYW1lKTsKICAgIEVORCBMT09QOwogICAgCiAgICBDTE9TRSBkZXB0X2VtcF9jdXJzb3I7CkVORDsKLw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    CURSOR dept_emp_cursor IS
        SELECT first_name, last_name
        FROM employees
        WHERE department_id = 20;
    
    v_first_name employees.first_name%TYPE;
    v_last_name employees.last_name%TYPE;
BEGIN
    OPEN dept_emp_cursor;
    
    LOOP
        FETCH dept_emp_cursor INTO v_first_name, v_last_name;
        EXIT WHEN dept_emp_cursor%NOTFOUND;
        
        DBMS_OUTPUT.PUT_LINE('Employee Name: ' || v_first_name || ' ' || v_last_name);
    END LOOP;
    
    CLOSE dept_emp_cursor;
END;
/</pre></div><div class='content'></div><h1>Errores Comunes y Consejos</h1>
<div class='content'><ol>
<li><strong>No cerrar el cursor</strong>: Siempre asegúrate de cerrar el cursor después de usarlo para liberar los recursos.</li>
<li><strong>No manejar el caso de <code>%NOTFOUND</code></strong>: Asegúrate de usar <code>EXIT WHEN cursor_name%NOTFOUND</code> para evitar bucles infinitos.</li>
<li><strong>Declarar variables de tipo incorrecto</strong>: Utiliza <code>%TYPE</code> para declarar variables que coincidan con los tipos de datos de las columnas de la tabla.</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>Los cursores son una herramienta poderosa en PL/SQL para manejar conjuntos de resultados de consultas SQL. Los cursores implícitos son gestionados automáticamente por Oracle, mientras que los cursores explícitos ofrecen un mayor control al programador. Comprender cómo declarar, abrir, obtener filas y cerrar cursores es esencial para trabajar eficazmente con PL/SQL.</p>
<p>En el próximo tema, exploraremos el manejo de excepciones en PL/SQL, lo que te permitirá gestionar errores y situaciones excepcionales de manera efectiva en tus programas.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-03-control-structures' title="Estructuras de Control">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='02-05-exception-handling' title="Manejo de Excepciones">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
