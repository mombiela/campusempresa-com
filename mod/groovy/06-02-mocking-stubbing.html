<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mocking y Stubbing</title>

    <link rel="alternate" href="https://campusempresa.com/mod/groovy/06-02-mocking-stubbing" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/groovy/06-02-mocking-stubbing" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/groovy/06-02-mocking-stubbing" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/groovy/06-02-mocking-stubbing" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/groovy/06-02-mocking-stubbing" class="px-2">CA</a>
<br>
			<cite>Construyendo la sociedad de hoy y del mañana</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Lenguajes de Programación</a>
				 					<a href="/categ/frameworks">Frameworks y Librerías</a>
				 					<a href="/categ/tech-tools">Herramientas Técnicas</a>
				 					<a href="/categ/foundations">Fundamentos Teóricos</a>
				 					<a href="/categ/soft-skills">Habilidades Sociales</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-01-unit-testing' title="Pruebas Unitarias con Groovy">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Mocking y Stubbing</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-03-debugging' title="Depuración de Código Groovy">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos sobre dos técnicas fundamentales en las pruebas unitarias: Mocking y Stubbing. Estas técnicas son esenciales para aislar el código que estamos probando y simular el comportamiento de dependencias externas.</p>
</div><h1><p>¿Qué es Mocking?</p>
</h1>
<div class='content'><p>Mocking es una técnica utilizada en las pruebas unitarias para crear objetos simulados que imitan el comportamiento de objetos reales. Estos objetos simulados, conocidos como &quot;mocks&quot;, permiten verificar que ciertas interacciones ocurren como se espera.</p>
</div><h2><p>Ventajas del Mocking</p>
</h2>
<div class='content'><ul>
<li><strong>Aislamiento</strong>: Permite probar una unidad de código en aislamiento, sin depender de otras partes del sistema.</li>
<li><strong>Control</strong>: Proporciona control sobre el comportamiento de las dependencias externas.</li>
<li><strong>Verificación</strong>: Permite verificar que ciertas interacciones ocurrieron durante la prueba.</li>
</ul>
</div><h2><p>Ejemplo de Mocking en Groovy con Spock</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHNwb2NrLmxhbmcuU3BlY2lmaWNhdGlvbgoKY2xhc3MgVXNlclNlcnZpY2UgewogICAgVXNlclJlcG9zaXRvcnkgdXNlclJlcG9zaXRvcnkKCiAgICBVc2VyIGdldFVzZXJCeUlkKExvbmcgaWQpIHsKICAgICAgICByZXR1cm4gdXNlclJlcG9zaXRvcnkuZmluZEJ5SWQoaWQpCiAgICB9Cn0KCmNsYXNzIFVzZXJSZXBvc2l0b3J5IHsKICAgIFVzZXIgZmluZEJ5SWQoTG9uZyBpZCkgewogICAgICAgIC8vIEzDs2dpY2EgcGFyYSBlbmNvbnRyYXIgdW4gdXN1YXJpbyBwb3IgSUQKICAgIH0KfQoKY2xhc3MgVXNlclNlcnZpY2VTcGVjIGV4dGVuZHMgU3BlY2lmaWNhdGlvbiB7CiAgICBkZWYgInNob3VsZCByZXR1cm4gdXNlciBieSBpZCIoKSB7CiAgICAgICAgZ2l2ZW46CiAgICAgICAgZGVmIHVzZXJSZXBvc2l0b3J5ID0gTW9jayhVc2VyUmVwb3NpdG9yeSkKICAgICAgICBkZWYgdXNlclNlcnZpY2UgPSBuZXcgVXNlclNlcnZpY2UodXNlclJlcG9zaXRvcnk6IHVzZXJSZXBvc2l0b3J5KQogICAgICAgIGRlZiB1c2VyID0gbmV3IFVzZXIoaWQ6IDEsIG5hbWU6ICJKb2huIERvZSIpCgogICAgICAgIHdoZW46CiAgICAgICAgdXNlclJlcG9zaXRvcnkuZmluZEJ5SWQoMSkgPj4gdXNlcgoKICAgICAgICB0aGVuOgogICAgICAgIHVzZXJTZXJ2aWNlLmdldFVzZXJCeUlkKDEpID09IHVzZXIKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import spock.lang.Specification

class UserService {
    UserRepository userRepository

    User getUserById(Long id) {
        return userRepository.findById(id)
    }
}

class UserRepository {
    User findById(Long id) {
        // L&oacute;gica para encontrar un usuario por ID
    }
}

class UserServiceSpec extends Specification {
    def &quot;should return user by id&quot;() {
        given:
        def userRepository = Mock(UserRepository)
        def userService = new UserService(userRepository: userRepository)
        def user = new User(id: 1, name: &quot;John Doe&quot;)

        when:
        userRepository.findById(1) &gt;&gt; user

        then:
        userService.getUserById(1) == user
    }
}</pre></div><div class='content'><p>En este ejemplo:</p>
<ul>
<li>Creamos un mock de <code>UserRepository</code>.</li>
<li>Configuramos el mock para que devuelva un objeto <code>User</code> cuando se llame al método <code>findById</code> con el argumento <code>1</code>.</li>
<li>Verificamos que el método <code>getUserById</code> de <code>UserService</code> devuelve el usuario esperado.</li>
</ul>
</div><h1><p>¿Qué es Stubbing?</p>
</h1>
<div class='content'><p>Stubbing es una técnica utilizada para proporcionar respuestas predefinidas a llamadas de métodos durante una prueba. A diferencia del mocking, el stubbing no verifica las interacciones, solo proporciona datos simulados.</p>
</div><h2><p>Ventajas del Stubbing</p>
</h2>
<div class='content'><ul>
<li><strong>Simplicidad</strong>: Facilita la configuración de dependencias externas con respuestas predefinidas.</li>
<li><strong>Rapidez</strong>: Permite simular respuestas rápidas sin ejecutar lógica compleja.</li>
</ul>
</div><h2><p>Ejemplo de Stubbing en Groovy con Spock</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHNwb2NrLmxhbmcuU3BlY2lmaWNhdGlvbgoKY2xhc3MgUGF5bWVudFNlcnZpY2UgewogICAgUGF5bWVudEdhdGV3YXkgcGF5bWVudEdhdGV3YXkKCiAgICBib29sZWFuIHByb2Nlc3NQYXltZW50KGRvdWJsZSBhbW91bnQpIHsKICAgICAgICByZXR1cm4gcGF5bWVudEdhdGV3YXkuY2hhcmdlKGFtb3VudCkKICAgIH0KfQoKY2xhc3MgUGF5bWVudEdhdGV3YXkgewogICAgYm9vbGVhbiBjaGFyZ2UoZG91YmxlIGFtb3VudCkgewogICAgICAgIC8vIEzDs2dpY2EgcGFyYSBwcm9jZXNhciBlbCBwYWdvCiAgICB9Cn0KCmNsYXNzIFBheW1lbnRTZXJ2aWNlU3BlYyBleHRlbmRzIFNwZWNpZmljYXRpb24gewogICAgZGVmICJzaG91bGQgcHJvY2VzcyBwYXltZW50IHN1Y2Nlc3NmdWxseSIoKSB7CiAgICAgICAgZ2l2ZW46CiAgICAgICAgZGVmIHBheW1lbnRHYXRld2F5ID0gU3R1YihQYXltZW50R2F0ZXdheSkKICAgICAgICBkZWYgcGF5bWVudFNlcnZpY2UgPSBuZXcgUGF5bWVudFNlcnZpY2UocGF5bWVudEdhdGV3YXk6IHBheW1lbnRHYXRld2F5KQoKICAgICAgICB3aGVuOgogICAgICAgIHBheW1lbnRHYXRld2F5LmNoYXJnZSgxMDAuMCkgPj4gdHJ1ZQoKICAgICAgICB0aGVuOgogICAgICAgIHBheW1lbnRTZXJ2aWNlLnByb2Nlc3NQYXltZW50KDEwMC4wKSA9PSB0cnVlCiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import spock.lang.Specification

class PaymentService {
    PaymentGateway paymentGateway

    boolean processPayment(double amount) {
        return paymentGateway.charge(amount)
    }
}

class PaymentGateway {
    boolean charge(double amount) {
        // L&oacute;gica para procesar el pago
    }
}

class PaymentServiceSpec extends Specification {
    def &quot;should process payment successfully&quot;() {
        given:
        def paymentGateway = Stub(PaymentGateway)
        def paymentService = new PaymentService(paymentGateway: paymentGateway)

        when:
        paymentGateway.charge(100.0) &gt;&gt; true

        then:
        paymentService.processPayment(100.0) == true
    }
}</pre></div><div class='content'><p>En este ejemplo:</p>
<ul>
<li>Creamos un stub de <code>PaymentGateway</code>.</li>
<li>Configuramos el stub para que devuelva <code>true</code> cuando se llame al método <code>charge</code> con el argumento <code>100.0</code>.</li>
<li>Verificamos que el método <code>processPayment</code> de <code>PaymentService</code> devuelve <code>true</code>.</li>
</ul>
</div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Mocking</p>
</h2>
<div class='content'><ol>
<li>Crea una clase <code>OrderService</code> con un método <code>placeOrder</code> que dependa de una clase <code>InventoryService</code> para verificar el stock.</li>
<li>Usa Spock para crear un mock de <code>InventoryService</code> y verifica que <code>placeOrder</code> llama al método <code>checkStock</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgT3JkZXJTZXJ2aWNlIHsKICAgIEludmVudG9yeVNlcnZpY2UgaW52ZW50b3J5U2VydmljZQoKICAgIGJvb2xlYW4gcGxhY2VPcmRlcihTdHJpbmcgaXRlbSwgaW50IHF1YW50aXR5KSB7CiAgICAgICAgcmV0dXJuIGludmVudG9yeVNlcnZpY2UuY2hlY2tTdG9jayhpdGVtLCBxdWFudGl0eSkKICAgIH0KfQoKY2xhc3MgSW52ZW50b3J5U2VydmljZSB7CiAgICBib29sZWFuIGNoZWNrU3RvY2soU3RyaW5nIGl0ZW0sIGludCBxdWFudGl0eSkgewogICAgICAgIC8vIEzDs2dpY2EgcGFyYSB2ZXJpZmljYXIgZWwgc3RvY2sKICAgIH0KfQoKY2xhc3MgT3JkZXJTZXJ2aWNlU3BlYyBleHRlbmRzIFNwZWNpZmljYXRpb24gewogICAgZGVmICJzaG91bGQgY2hlY2sgc3RvY2sgd2hlbiBwbGFjaW5nIGFuIG9yZGVyIigpIHsKICAgICAgICBnaXZlbjoKICAgICAgICBkZWYgaW52ZW50b3J5U2VydmljZSA9IE1vY2soSW52ZW50b3J5U2VydmljZSkKICAgICAgICBkZWYgb3JkZXJTZXJ2aWNlID0gbmV3IE9yZGVyU2VydmljZShpbnZlbnRvcnlTZXJ2aWNlOiBpbnZlbnRvcnlTZXJ2aWNlKQoKICAgICAgICB3aGVuOgogICAgICAgIG9yZGVyU2VydmljZS5wbGFjZU9yZGVyKCJpdGVtMSIsIDEwKQoKICAgICAgICB0aGVuOgogICAgICAgIDEgKiBpbnZlbnRvcnlTZXJ2aWNlLmNoZWNrU3RvY2soIml0ZW0xIiwgMTApCiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class OrderService {
    InventoryService inventoryService

    boolean placeOrder(String item, int quantity) {
        return inventoryService.checkStock(item, quantity)
    }
}

class InventoryService {
    boolean checkStock(String item, int quantity) {
        // L&oacute;gica para verificar el stock
    }
}

class OrderServiceSpec extends Specification {
    def &quot;should check stock when placing an order&quot;() {
        given:
        def inventoryService = Mock(InventoryService)
        def orderService = new OrderService(inventoryService: inventoryService)

        when:
        orderService.placeOrder(&quot;item1&quot;, 10)

        then:
        1 * inventoryService.checkStock(&quot;item1&quot;, 10)
    }
}</pre></div><div class='content'></div><h2><p>Ejercicio 2: Stubbing</p>
</h2>
<div class='content'><ol>
<li>Crea una clase <code>ShippingService</code> con un método <code>calculateShippingCost</code> que dependa de una clase <code>DistanceCalculator</code> para calcular la distancia.</li>
<li>Usa Spock para crear un stub de <code>DistanceCalculator</code> y proporciona una distancia predefinida para calcular el costo de envío.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2hpcHBpbmdTZXJ2aWNlIHsKICAgIERpc3RhbmNlQ2FsY3VsYXRvciBkaXN0YW5jZUNhbGN1bGF0b3IKCiAgICBkb3VibGUgY2FsY3VsYXRlU2hpcHBpbmdDb3N0KFN0cmluZyBmcm9tLCBTdHJpbmcgdG8pIHsKICAgICAgICBkb3VibGUgZGlzdGFuY2UgPSBkaXN0YW5jZUNhbGN1bGF0b3IuY2FsY3VsYXRlRGlzdGFuY2UoZnJvbSwgdG8pCiAgICAgICAgcmV0dXJuIGRpc3RhbmNlICogMC41IC8vIENvc3RvIHBvciB1bmlkYWQgZGUgZGlzdGFuY2lhCiAgICB9Cn0KCmNsYXNzIERpc3RhbmNlQ2FsY3VsYXRvciB7CiAgICBkb3VibGUgY2FsY3VsYXRlRGlzdGFuY2UoU3RyaW5nIGZyb20sIFN0cmluZyB0bykgewogICAgICAgIC8vIEzDs2dpY2EgcGFyYSBjYWxjdWxhciBsYSBkaXN0YW5jaWEKICAgIH0KfQoKY2xhc3MgU2hpcHBpbmdTZXJ2aWNlU3BlYyBleHRlbmRzIFNwZWNpZmljYXRpb24gewogICAgZGVmICJzaG91bGQgY2FsY3VsYXRlIHNoaXBwaW5nIGNvc3QgYmFzZWQgb24gZGlzdGFuY2UiKCkgewogICAgICAgIGdpdmVuOgogICAgICAgIGRlZiBkaXN0YW5jZUNhbGN1bGF0b3IgPSBTdHViKERpc3RhbmNlQ2FsY3VsYXRvcikKICAgICAgICBkZWYgc2hpcHBpbmdTZXJ2aWNlID0gbmV3IFNoaXBwaW5nU2VydmljZShkaXN0YW5jZUNhbGN1bGF0b3I6IGRpc3RhbmNlQ2FsY3VsYXRvcikKCiAgICAgICAgd2hlbjoKICAgICAgICBkaXN0YW5jZUNhbGN1bGF0b3IuY2FsY3VsYXRlRGlzdGFuY2UoIkEiLCAiQiIpID4+IDEwMC4wCgogICAgICAgIHRoZW46CiAgICAgICAgc2hpcHBpbmdTZXJ2aWNlLmNhbGN1bGF0ZVNoaXBwaW5nQ29zdCgiQSIsICJCIikgPT0gNTAuMAogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class ShippingService {
    DistanceCalculator distanceCalculator

    double calculateShippingCost(String from, String to) {
        double distance = distanceCalculator.calculateDistance(from, to)
        return distance * 0.5 // Costo por unidad de distancia
    }
}

class DistanceCalculator {
    double calculateDistance(String from, String to) {
        // L&oacute;gica para calcular la distancia
    }
}

class ShippingServiceSpec extends Specification {
    def &quot;should calculate shipping cost based on distance&quot;() {
        given:
        def distanceCalculator = Stub(DistanceCalculator)
        def shippingService = new ShippingService(distanceCalculator: distanceCalculator)

        when:
        distanceCalculator.calculateDistance(&quot;A&quot;, &quot;B&quot;) &gt;&gt; 100.0

        then:
        shippingService.calculateShippingCost(&quot;A&quot;, &quot;B&quot;) == 50.0
    }
}</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, hemos aprendido sobre las técnicas de Mocking y Stubbing en Groovy utilizando el framework de pruebas Spock. Estas técnicas son esenciales para escribir pruebas unitarias efectivas y garantizar que nuestro código funcione correctamente en aislamiento. Asegúrate de practicar estos conceptos con los ejercicios proporcionados para reforzar tu comprensión. En el próximo módulo, exploraremos la depuración de código Groovy.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-01-unit-testing' title="Pruebas Unitarias con Groovy">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='06-03-debugging' title="Depuración de Código Groovy">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
