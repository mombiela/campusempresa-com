<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Canales de Plataforma</title>

    <link rel="alternate" href="https://campusempresa.com/mod/flutter/08-03-platform-channels" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/flutter/08-03-platform-channels" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/flutter/08-03-platform-channels" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/flutter/08-03-platform-channels" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/flutter/08-03-platform-channels" class="px-2">CA</a>
<br>
			<cite>Construyendo la sociedad de hoy y del mañana</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Lenguajes de Programación</a>
				 					<a href="/categ/frameworks">Frameworks y Librerías</a>
				 					<a href="/categ/tech-tools">Herramientas Técnicas</a>
				 					<a href="/categ/foundations">Fundamentos Teóricos</a>
				 					<a href="/categ/soft-skills">Habilidades Sociales</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-02-custom-paint-and-canvas' title="Custom Paint y Canvas">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Canales de Plataforma</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-04-isolates-and-concurrency' title="Isolates y Concurrencia">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducción</p>
</h1>
<div class='content'><p>Los canales de plataforma en Flutter permiten la comunicación entre el código Dart y el código nativo (Java/Kotlin para Android y Objective-C/Swift para iOS). Esto es útil cuando necesitas acceder a funcionalidades específicas del sistema operativo que no están disponibles directamente en Flutter.</p>
</div><h1><p>Conceptos Clave</p>
</h1>
<div class='content'><ol>
<li><strong>Canal de Plataforma (Platform Channel)</strong>: Es el medio de comunicación entre Flutter y el código nativo.</li>
<li><strong>Método de Canal (Method Channel)</strong>: Permite invocar métodos nativos desde Dart y viceversa.</li>
<li><strong>Canal de Eventos (Event Channel)</strong>: Permite recibir flujos de datos desde el código nativo hacia Dart.</li>
<li><strong>Canal Básico (Basic Message Channel)</strong>: Permite el intercambio de mensajes arbitrarios entre Dart y el código nativo.</li>
</ol>
</div><h1><p>Estructura de un Canal de Plataforma</p>
</h1>
<div class='content'></div><h2><p>Dart (Flutter)</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvc2VydmljZXMuZGFydCc7CgpjbGFzcyBQbGF0Zm9ybUNoYW5uZWxFeGFtcGxlIHsKICBzdGF0aWMgY29uc3QgcGxhdGZvcm0gPSBNZXRob2RDaGFubmVsKCdjb20uZXhhbXBsZS5wbGF0Zm9ybV9jaGFubmVsJyk7CgogIEZ1dHVyZTxTdHJpbmc+IGdldEJhdHRlcnlMZXZlbCgpIGFzeW5jIHsKICAgIHRyeSB7CiAgICAgIGZpbmFsIGludCByZXN1bHQgPSBhd2FpdCBwbGF0Zm9ybS5pbnZva2VNZXRob2QoJ2dldEJhdHRlcnlMZXZlbCcpOwogICAgICByZXR1cm4gJ0JhdHRlcnkgbGV2ZWwgaXMgJHJlc3VsdCUuJzsKICAgIH0gb24gUGxhdGZvcm1FeGNlcHRpb24gY2F0Y2ggKGUpIHsKICAgICAgcmV0dXJuICJGYWlsZWQgdG8gZ2V0IGJhdHRlcnkgbGV2ZWw6ICcke2UubWVzc2FnZX0nLiI7CiAgICB9CiAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/services.dart';

class PlatformChannelExample {
  static const platform = MethodChannel('com.example.platform_channel');

  Future&lt;String&gt; getBatteryLevel() async {
    try {
      final int result = await platform.invokeMethod('getBatteryLevel');
      return 'Battery level is $result%.';
    } on PlatformException catch (e) {
      return &quot;Failed to get battery level: '${e.message}'.&quot;;
    }
  }
}</pre></div><div class='content'></div><h2><p>Android (Java)</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGlvLmZsdXR0ZXIuZW1iZWRkaW5nLmVuZ2luZS5GbHV0dGVyRW5naW5lOwppbXBvcnQgaW8uZmx1dHRlci5wbHVnaW4uY29tbW9uLk1ldGhvZENoYW5uZWw7CmltcG9ydCBpby5mbHV0dGVyLmVtYmVkZGluZy5hbmRyb2lkLkZsdXR0ZXJBY3Rpdml0eTsKCnB1YmxpYyBjbGFzcyBNYWluQWN0aXZpdHkgZXh0ZW5kcyBGbHV0dGVyQWN0aXZpdHkgewogIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBDSEFOTkVMID0gImNvbS5leGFtcGxlLnBsYXRmb3JtX2NoYW5uZWwiOwoKICBAT3ZlcnJpZGUKICBwdWJsaWMgdm9pZCBjb25maWd1cmVGbHV0dGVyRW5naW5lKEZsdXR0ZXJFbmdpbmUgZmx1dHRlckVuZ2luZSkgewogICAgc3VwZXIuY29uZmlndXJlRmx1dHRlckVuZ2luZShmbHV0dGVyRW5naW5lKTsKICAgIG5ldyBNZXRob2RDaGFubmVsKGZsdXR0ZXJFbmdpbmUuZ2V0RGFydEV4ZWN1dG9yKCkuZ2V0QmluYXJ5TWVzc2VuZ2VyKCksIENIQU5ORUwpCiAgICAgIC5zZXRNZXRob2RDYWxsSGFuZGxlcigKICAgICAgICAoY2FsbCwgcmVzdWx0KSAtPiB7CiAgICAgICAgICBpZiAoY2FsbC5tZXRob2QuZXF1YWxzKCJnZXRCYXR0ZXJ5TGV2ZWwiKSkgewogICAgICAgICAgICBpbnQgYmF0dGVyeUxldmVsID0gZ2V0QmF0dGVyeUxldmVsKCk7CgogICAgICAgICAgICBpZiAoYmF0dGVyeUxldmVsICE9IC0xKSB7CiAgICAgICAgICAgICAgcmVzdWx0LnN1Y2Nlc3MoYmF0dGVyeUxldmVsKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQuZXJyb3IoIlVOQVZBSUxBQkxFIiwgIkJhdHRlcnkgbGV2ZWwgbm90IGF2YWlsYWJsZS4iLCBudWxsKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0Lm5vdEltcGxlbWVudGVkKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICApOwogIH0KCiAgcHJpdmF0ZSBpbnQgZ2V0QmF0dGVyeUxldmVsKCkgewogICAgaW50IGJhdHRlcnlMZXZlbCA9IC0xOwogICAgLy8gQ8OzZGlnbyBwYXJhIG9idGVuZXIgZWwgbml2ZWwgZGUgYmF0ZXLDrWEKICAgIHJldHVybiBiYXR0ZXJ5TGV2ZWw7CiAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import io.flutter.embedding.engine.FlutterEngine;
import io.flutter.plugin.common.MethodChannel;
import io.flutter.embedding.android.FlutterActivity;

public class MainActivity extends FlutterActivity {
  private static final String CHANNEL = &quot;com.example.platform_channel&quot;;

  @Override
  public void configureFlutterEngine(FlutterEngine flutterEngine) {
    super.configureFlutterEngine(flutterEngine);
    new MethodChannel(flutterEngine.getDartExecutor().getBinaryMessenger(), CHANNEL)
      .setMethodCallHandler(
        (call, result) -&gt; {
          if (call.method.equals(&quot;getBatteryLevel&quot;)) {
            int batteryLevel = getBatteryLevel();

            if (batteryLevel != -1) {
              result.success(batteryLevel);
            } else {
              result.error(&quot;UNAVAILABLE&quot;, &quot;Battery level not available.&quot;, null);
            }
          } else {
            result.notImplemented();
          }
        }
      );
  }

  private int getBatteryLevel() {
    int batteryLevel = -1;
    // C&oacute;digo para obtener el nivel de bater&iacute;a
    return batteryLevel;
  }
}</pre></div><div class='content'></div><h2><p>iOS (Swift)</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IEZsdXR0ZXIKaW1wb3J0IFVJS2l0CgpAVUlBcHBsaWNhdGlvbk1haW4KQG9iamMgY2xhc3MgQXBwRGVsZWdhdGU6IEZsdXR0ZXJBcHBEZWxlZ2F0ZSB7CiAgcHJpdmF0ZSBsZXQgQ0hBTk5FTCA9ICJjb20uZXhhbXBsZS5wbGF0Zm9ybV9jaGFubmVsIgoKICBvdmVycmlkZSBmdW5jIGFwcGxpY2F0aW9uKAogICAgXyBhcHBsaWNhdGlvbjogVUlBcHBsaWNhdGlvbiwKICAgIGRpZEZpbmlzaExhdW5jaGluZ1dpdGhPcHRpb25zIGxhdW5jaE9wdGlvbnM6IFtVSUFwcGxpY2F0aW9uLkxhdW5jaE9wdGlvbnNLZXk6IEFueV0/CiAgKSAtPiBCb29sIHsKICAgIGxldCBjb250cm9sbGVyIDogRmx1dHRlclZpZXdDb250cm9sbGVyID0gd2luZG93Py5yb290Vmlld0NvbnRyb2xsZXIgYXMhIEZsdXR0ZXJWaWV3Q29udHJvbGxlcgogICAgbGV0IGJhdHRlcnlDaGFubmVsID0gRmx1dHRlck1ldGhvZENoYW5uZWwobmFtZTogQ0hBTk5FTCwgYmluYXJ5TWVzc2VuZ2VyOiBjb250cm9sbGVyLmJpbmFyeU1lc3NlbmdlcikKCiAgICBiYXR0ZXJ5Q2hhbm5lbC5zZXRNZXRob2RDYWxsSGFuZGxlcih7CiAgICAgIChjYWxsOiBGbHV0dGVyTWV0aG9kQ2FsbCwgcmVzdWx0OiBAZXNjYXBpbmcgRmx1dHRlclJlc3VsdCkgLT4gVm9pZCBpbgogICAgICBpZiBjYWxsLm1ldGhvZCA9PSAiZ2V0QmF0dGVyeUxldmVsIiB7CiAgICAgICAgc2VsZi5yZWNlaXZlQmF0dGVyeUxldmVsKHJlc3VsdDogcmVzdWx0KQogICAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdChGbHV0dGVyTWV0aG9kTm90SW1wbGVtZW50ZWQpCiAgICAgIH0KICAgIH0pCgogICAgcmV0dXJuIHN1cGVyLmFwcGxpY2F0aW9uKGFwcGxpY2F0aW9uLCBkaWRGaW5pc2hMYXVuY2hpbmdXaXRoT3B0aW9uczogbGF1bmNoT3B0aW9ucykKICB9CgogIHByaXZhdGUgZnVuYyByZWNlaXZlQmF0dGVyeUxldmVsKHJlc3VsdDogRmx1dHRlclJlc3VsdCkgewogICAgbGV0IGRldmljZSA9IFVJRGV2aWNlLmN1cnJlbnQKICAgIGRldmljZS5pc0JhdHRlcnlNb25pdG9yaW5nRW5hYmxlZCA9IHRydWUKICAgIGlmIGRldmljZS5iYXR0ZXJ5U3RhdGUgPT0gVUlEZXZpY2UuQmF0dGVyeVN0YXRlLnVua25vd24gewogICAgICByZXN1bHQoRmx1dHRlckVycm9yKGNvZGU6ICJVTkFWQUlMQUJMRSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIkJhdHRlcnkgbGV2ZWwgbm90IGF2YWlsYWJsZS4iLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IG5pbCkpCiAgICB9IGVsc2UgewogICAgICByZXN1bHQoSW50KGRldmljZS5iYXR0ZXJ5TGV2ZWwgKiAxMDApKQogICAgfQogIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import Flutter
import UIKit

@UIApplicationMain
@objc class AppDelegate: FlutterAppDelegate {
  private let CHANNEL = &quot;com.example.platform_channel&quot;

  override func application(
    _ application: UIApplication,
    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
  ) -&gt; Bool {
    let controller : FlutterViewController = window?.rootViewController as! FlutterViewController
    let batteryChannel = FlutterMethodChannel(name: CHANNEL, binaryMessenger: controller.binaryMessenger)

    batteryChannel.setMethodCallHandler({
      (call: FlutterMethodCall, result: @escaping FlutterResult) -&gt; Void in
      if call.method == &quot;getBatteryLevel&quot; {
        self.receiveBatteryLevel(result: result)
      } else {
        result(FlutterMethodNotImplemented)
      }
    })

    return super.application(application, didFinishLaunchingWithOptions: launchOptions)
  }

  private func receiveBatteryLevel(result: FlutterResult) {
    let device = UIDevice.current
    device.isBatteryMonitoringEnabled = true
    if device.batteryState == UIDevice.BatteryState.unknown {
      result(FlutterError(code: &quot;UNAVAILABLE&quot;,
                          message: &quot;Battery level not available.&quot;,
                          details: nil))
    } else {
      result(Int(device.batteryLevel * 100))
    }
  }
}</pre></div><div class='content'></div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Objetivo</p>
</h2>
<div class='content'><p>Crear una aplicación Flutter que obtenga el nivel de batería del dispositivo utilizando canales de plataforma.</p>
</div><h2><p>Pasos</p>
</h2>
<div class='content'><ol>
<li>
<p><strong>Configurar el Proyecto Flutter</strong>:</p>
<ul>
<li>Crear un nuevo proyecto Flutter.</li>
<li>Añadir el código Dart para invocar el método nativo.</li>
</ul>
</li>
<li>
<p><strong>Implementar el Código Nativo</strong>:</p>
<ul>
<li>Para Android, añadir el código Java/Kotlin en <code>MainActivity</code>.</li>
<li>Para iOS, añadir el código Swift/Objective-C en <code>AppDelegate</code>.</li>
</ul>
</li>
<li>
<p><strong>Probar la Aplicación</strong>:</p>
<ul>
<li>Ejecutar la aplicación en un dispositivo físico o emulador.</li>
<li>Verificar que el nivel de batería se muestra correctamente.</li>
</ul>
</li>
</ol>
</div><h2><p>Código Completo</p>
</h2>
<div class='content'><h4>Dart (Flutter)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0ICdwYWNrYWdlOmZsdXR0ZXIvbWF0ZXJpYWwuZGFydCc7CmltcG9ydCAncGFja2FnZTpmbHV0dGVyL3NlcnZpY2VzLmRhcnQnOwoKdm9pZCBtYWluKCkgPT4gcnVuQXBwKE15QXBwKCkpOwoKY2xhc3MgTXlBcHAgZXh0ZW5kcyBTdGF0ZWxlc3NXaWRnZXQgewogIEBvdmVycmlkZQogIFdpZGdldCBidWlsZChCdWlsZENvbnRleHQgY29udGV4dCkgewogICAgcmV0dXJuIE1hdGVyaWFsQXBwKAogICAgICBob21lOiBCYXR0ZXJ5TGV2ZWxTY3JlZW4oKSwKICAgICk7CiAgfQp9CgpjbGFzcyBCYXR0ZXJ5TGV2ZWxTY3JlZW4gZXh0ZW5kcyBTdGF0ZWZ1bFdpZGdldCB7CiAgQG92ZXJyaWRlCiAgX0JhdHRlcnlMZXZlbFNjcmVlblN0YXRlIGNyZWF0ZVN0YXRlKCkgPT4gX0JhdHRlcnlMZXZlbFNjcmVlblN0YXRlKCk7Cn0KCmNsYXNzIF9CYXR0ZXJ5TGV2ZWxTY3JlZW5TdGF0ZSBleHRlbmRzIFN0YXRlPEJhdHRlcnlMZXZlbFNjcmVlbj4gewogIHN0YXRpYyBjb25zdCBwbGF0Zm9ybSA9IE1ldGhvZENoYW5uZWwoJ2NvbS5leGFtcGxlLnBsYXRmb3JtX2NoYW5uZWwnKTsKICBTdHJpbmcgX2JhdHRlcnlMZXZlbCA9ICdVbmtub3duIGJhdHRlcnkgbGV2ZWwuJzsKCiAgRnV0dXJlPHZvaWQ+IF9nZXRCYXR0ZXJ5TGV2ZWwoKSBhc3luYyB7CiAgICBTdHJpbmcgYmF0dGVyeUxldmVsOwogICAgdHJ5IHsKICAgICAgZmluYWwgaW50IHJlc3VsdCA9IGF3YWl0IHBsYXRmb3JtLmludm9rZU1ldGhvZCgnZ2V0QmF0dGVyeUxldmVsJyk7CiAgICAgIGJhdHRlcnlMZXZlbCA9ICdCYXR0ZXJ5IGxldmVsIGlzICRyZXN1bHQlLic7CiAgICB9IG9uIFBsYXRmb3JtRXhjZXB0aW9uIGNhdGNoIChlKSB7CiAgICAgIGJhdHRlcnlMZXZlbCA9ICJGYWlsZWQgdG8gZ2V0IGJhdHRlcnkgbGV2ZWw6ICcke2UubWVzc2FnZX0nLiI7CiAgICB9CgogICAgc2V0U3RhdGUoKCkgewogICAgICBfYmF0dGVyeUxldmVsID0gYmF0dGVyeUxldmVsOwogICAgfSk7CiAgfQoKICBAb3ZlcnJpZGUKICBXaWRnZXQgYnVpbGQoQnVpbGRDb250ZXh0IGNvbnRleHQpIHsKICAgIHJldHVybiBTY2FmZm9sZCgKICAgICAgYXBwQmFyOiBBcHBCYXIoCiAgICAgICAgdGl0bGU6IFRleHQoJ0JhdHRlcnkgTGV2ZWwnKSwKICAgICAgKSwKICAgICAgYm9keTogQ2VudGVyKAogICAgICAgIGNoaWxkOiBDb2x1bW4oCiAgICAgICAgICBtYWluQXhpc0FsaWdubWVudDogTWFpbkF4aXNBbGlnbm1lbnQuY2VudGVyLAogICAgICAgICAgY2hpbGRyZW46IDxXaWRnZXQ+WwogICAgICAgICAgICBUZXh0KF9iYXR0ZXJ5TGV2ZWwpLAogICAgICAgICAgICBTaXplZEJveChoZWlnaHQ6IDIwKSwKICAgICAgICAgICAgRWxldmF0ZWRCdXR0b24oCiAgICAgICAgICAgICAgb25QcmVzc2VkOiBfZ2V0QmF0dGVyeUxldmVsLAogICAgICAgICAgICAgIGNoaWxkOiBUZXh0KCdHZXQgQmF0dGVyeSBMZXZlbCcpLAogICAgICAgICAgICApLAogICAgICAgICAgXSwKICAgICAgICApLAogICAgICApLAogICAgKTsKICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import 'package:flutter/material.dart';
import 'package:flutter/services.dart';

void main() =&gt; runApp(MyApp());

class MyApp extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      home: BatteryLevelScreen(),
    );
  }
}

class BatteryLevelScreen extends StatefulWidget {
  @override
  _BatteryLevelScreenState createState() =&gt; _BatteryLevelScreenState();
}

class _BatteryLevelScreenState extends State&lt;BatteryLevelScreen&gt; {
  static const platform = MethodChannel('com.example.platform_channel');
  String _batteryLevel = 'Unknown battery level.';

  Future&lt;void&gt; _getBatteryLevel() async {
    String batteryLevel;
    try {
      final int result = await platform.invokeMethod('getBatteryLevel');
      batteryLevel = 'Battery level is $result%.';
    } on PlatformException catch (e) {
      batteryLevel = &quot;Failed to get battery level: '${e.message}'.&quot;;
    }

    setState(() {
      _batteryLevel = batteryLevel;
    });
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('Battery Level'),
      ),
      body: Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: &lt;Widget&gt;[
            Text(_batteryLevel),
            SizedBox(height: 20),
            ElevatedButton(
              onPressed: _getBatteryLevel,
              child: Text('Get Battery Level'),
            ),
          ],
        ),
      ),
    );
  }
}</pre></div><div class='content'><h4>Android (Java)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGlvLmZsdXR0ZXIuZW1iZWRkaW5nLmVuZ2luZS5GbHV0dGVyRW5naW5lOwppbXBvcnQgaW8uZmx1dHRlci5wbHVnaW4uY29tbW9uLk1ldGhvZENoYW5uZWw7CmltcG9ydCBpby5mbHV0dGVyLmVtYmVkZGluZy5hbmRyb2lkLkZsdXR0ZXJBY3Rpdml0eTsKCnB1YmxpYyBjbGFzcyBNYWluQWN0aXZpdHkgZXh0ZW5kcyBGbHV0dGVyQWN0aXZpdHkgewogIHByaXZhdGUgc3RhdGljIGZpbmFsIFN0cmluZyBDSEFOTkVMID0gImNvbS5leGFtcGxlLnBsYXRmb3JtX2NoYW5uZWwiOwoKICBAT3ZlcnJpZGUKICBwdWJsaWMgdm9pZCBjb25maWd1cmVGbHV0dGVyRW5naW5lKEZsdXR0ZXJFbmdpbmUgZmx1dHRlckVuZ2luZSkgewogICAgc3VwZXIuY29uZmlndXJlRmx1dHRlckVuZ2luZShmbHV0dGVyRW5naW5lKTsKICAgIG5ldyBNZXRob2RDaGFubmVsKGZsdXR0ZXJFbmdpbmUuZ2V0RGFydEV4ZWN1dG9yKCkuZ2V0QmluYXJ5TWVzc2VuZ2VyKCksIENIQU5ORUwpCiAgICAgIC5zZXRNZXRob2RDYWxsSGFuZGxlcigKICAgICAgICAoY2FsbCwgcmVzdWx0KSAtPiB7CiAgICAgICAgICBpZiAoY2FsbC5tZXRob2QuZXF1YWxzKCJnZXRCYXR0ZXJ5TGV2ZWwiKSkgewogICAgICAgICAgICBpbnQgYmF0dGVyeUxldmVsID0gZ2V0QmF0dGVyeUxldmVsKCk7CgogICAgICAgICAgICBpZiAoYmF0dGVyeUxldmVsICE9IC0xKSB7CiAgICAgICAgICAgICAgcmVzdWx0LnN1Y2Nlc3MoYmF0dGVyeUxldmVsKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICByZXN1bHQuZXJyb3IoIlVOQVZBSUxBQkxFIiwgIkJhdHRlcnkgbGV2ZWwgbm90IGF2YWlsYWJsZS4iLCBudWxsKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcmVzdWx0Lm5vdEltcGxlbWVudGVkKCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICApOwogIH0KCiAgcHJpdmF0ZSBpbnQgZ2V0QmF0dGVyeUxldmVsKCkgewogICAgaW50IGJhdHRlcnlMZXZlbCA9IC0xOwogICAgLy8gQ8OzZGlnbyBwYXJhIG9idGVuZXIgZWwgbml2ZWwgZGUgYmF0ZXLDrWEKICAgIHJldHVybiBiYXR0ZXJ5TGV2ZWw7CiAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import io.flutter.embedding.engine.FlutterEngine;
import io.flutter.plugin.common.MethodChannel;
import io.flutter.embedding.android.FlutterActivity;

public class MainActivity extends FlutterActivity {
  private static final String CHANNEL = &quot;com.example.platform_channel&quot;;

  @Override
  public void configureFlutterEngine(FlutterEngine flutterEngine) {
    super.configureFlutterEngine(flutterEngine);
    new MethodChannel(flutterEngine.getDartExecutor().getBinaryMessenger(), CHANNEL)
      .setMethodCallHandler(
        (call, result) -&gt; {
          if (call.method.equals(&quot;getBatteryLevel&quot;)) {
            int batteryLevel = getBatteryLevel();

            if (batteryLevel != -1) {
              result.success(batteryLevel);
            } else {
              result.error(&quot;UNAVAILABLE&quot;, &quot;Battery level not available.&quot;, null);
            }
          } else {
            result.notImplemented();
          }
        }
      );
  }

  private int getBatteryLevel() {
    int batteryLevel = -1;
    // C&oacute;digo para obtener el nivel de bater&iacute;a
    return batteryLevel;
  }
}</pre></div><div class='content'><h4>iOS (Swift)</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IEZsdXR0ZXIKaW1wb3J0IFVJS2l0CgpAVUlBcHBsaWNhdGlvbk1haW4KQG9iamMgY2xhc3MgQXBwRGVsZWdhdGU6IEZsdXR0ZXJBcHBEZWxlZ2F0ZSB7CiAgcHJpdmF0ZSBsZXQgQ0hBTk5FTCA9ICJjb20uZXhhbXBsZS5wbGF0Zm9ybV9jaGFubmVsIgoKICBvdmVycmlkZSBmdW5jIGFwcGxpY2F0aW9uKAogICAgXyBhcHBsaWNhdGlvbjogVUlBcHBsaWNhdGlvbiwKICAgIGRpZEZpbmlzaExhdW5jaGluZ1dpdGhPcHRpb25zIGxhdW5jaE9wdGlvbnM6IFtVSUFwcGxpY2F0aW9uLkxhdW5jaE9wdGlvbnNLZXk6IEFueV0/CiAgKSAtPiBCb29sIHsKICAgIGxldCBjb250cm9sbGVyIDogRmx1dHRlclZpZXdDb250cm9sbGVyID0gd2luZG93Py5yb290Vmlld0NvbnRyb2xsZXIgYXMhIEZsdXR0ZXJWaWV3Q29udHJvbGxlcgogICAgbGV0IGJhdHRlcnlDaGFubmVsID0gRmx1dHRlck1ldGhvZENoYW5uZWwobmFtZTogQ0hBTk5FTCwgYmluYXJ5TWVzc2VuZ2VyOiBjb250cm9sbGVyLmJpbmFyeU1lc3NlbmdlcikKCiAgICBiYXR0ZXJ5Q2hhbm5lbC5zZXRNZXRob2RDYWxsSGFuZGxlcih7CiAgICAgIChjYWxsOiBGbHV0dGVyTWV0aG9kQ2FsbCwgcmVzdWx0OiBAZXNjYXBpbmcgRmx1dHRlclJlc3VsdCkgLT4gVm9pZCBpbgogICAgICBpZiBjYWxsLm1ldGhvZCA9PSAiZ2V0QmF0dGVyeUxldmVsIiB7CiAgICAgICAgc2VsZi5yZWNlaXZlQmF0dGVyeUxldmVsKHJlc3VsdDogcmVzdWx0KQogICAgICB9IGVsc2UgewogICAgICAgIHJlc3VsdChGbHV0dGVyTWV0aG9kTm90SW1wbGVtZW50ZWQpCiAgICAgIH0KICAgIH0pCgogICAgcmV0dXJuIHN1cGVyLmFwcGxpY2F0aW9uKGFwcGxpY2F0aW9uLCBkaWRGaW5pc2hMYXVuY2hpbmdXaXRoT3B0aW9uczogbGF1bmNoT3B0aW9ucykKICB9CgogIHByaXZhdGUgZnVuYyByZWNlaXZlQmF0dGVyeUxldmVsKHJlc3VsdDogRmx1dHRlclJlc3VsdCkgewogICAgbGV0IGRldmljZSA9IFVJRGV2aWNlLmN1cnJlbnQKICAgIGRldmljZS5pc0JhdHRlcnlNb25pdG9yaW5nRW5hYmxlZCA9IHRydWUKICAgIGlmIGRldmljZS5iYXR0ZXJ5U3RhdGUgPT0gVUlEZXZpY2UuQmF0dGVyeVN0YXRlLnVua25vd24gewogICAgICByZXN1bHQoRmx1dHRlckVycm9yKGNvZGU6ICJVTkFWQUlMQUJMRSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogIkJhdHRlcnkgbGV2ZWwgbm90IGF2YWlsYWJsZS4iLAogICAgICAgICAgICAgICAgICAgICAgICAgIGRldGFpbHM6IG5pbCkpCiAgICB9IGVsc2UgewogICAgICByZXN1bHQoSW50KGRldmljZS5iYXR0ZXJ5TGV2ZWwgKiAxMDApKQogICAgfQogIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import Flutter
import UIKit

@UIApplicationMain
@objc class AppDelegate: FlutterAppDelegate {
  private let CHANNEL = &quot;com.example.platform_channel&quot;

  override func application(
    _ application: UIApplication,
    didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?
  ) -&gt; Bool {
    let controller : FlutterViewController = window?.rootViewController as! FlutterViewController
    let batteryChannel = FlutterMethodChannel(name: CHANNEL, binaryMessenger: controller.binaryMessenger)

    batteryChannel.setMethodCallHandler({
      (call: FlutterMethodCall, result: @escaping FlutterResult) -&gt; Void in
      if call.method == &quot;getBatteryLevel&quot; {
        self.receiveBatteryLevel(result: result)
      } else {
        result(FlutterMethodNotImplemented)
      }
    })

    return super.application(application, didFinishLaunchingWithOptions: launchOptions)
  }

  private func receiveBatteryLevel(result: FlutterResult) {
    let device = UIDevice.current
    device.isBatteryMonitoringEnabled = true
    if device.batteryState == UIDevice.BatteryState.unknown {
      result(FlutterError(code: &quot;UNAVAILABLE&quot;,
                          message: &quot;Battery level not available.&quot;,
                          details: nil))
    } else {
      result(Int(device.batteryLevel * 100))
    }
  }
}</pre></div><div class='content'></div><h1><p>Retroalimentación y Consejos</p>
</h1>
<div class='content'><ul>
<li>
<p><strong>Errores Comunes</strong>:</p>
<ul>
<li>Asegúrate de que el nombre del canal sea el mismo en Dart y en el código nativo.</li>
<li>Verifica que los permisos necesarios estén configurados en el archivo <code>AndroidManifest.xml</code> y <code>Info.plist</code> para acceder a la batería.</li>
<li>Si usas un emulador, ten en cuenta que algunos emuladores pueden no soportar la monitorización de la batería.</li>
</ul>
</li>
<li>
<p><strong>Consejos Adicionales</strong>:</p>
<ul>
<li>Utiliza <code>try-catch</code> en Dart para manejar excepciones y proporcionar retroalimentación al usuario.</li>
<li>Mantén el código nativo lo más simple posible y delega la lógica compleja a Dart cuando sea posible.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, aprendiste cómo utilizar los canales de plataforma para comunicarte entre Flutter y el código nativo. Esto te permite acceder a funcionalidades específicas del sistema operativo y extender las capacidades de tus aplicaciones Flutter. En el siguiente módulo, exploraremos cómo gestionar el estado en Flutter para crear aplicaciones más dinámicas y reactivas.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='08-02-custom-paint-and-canvas' title="Custom Paint y Canvas">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='08-04-isolates-and-concurrency' title="Isolates y Concurrencia">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
