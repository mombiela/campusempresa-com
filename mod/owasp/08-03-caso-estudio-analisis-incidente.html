<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Caso de Estudio 1: Análisis de un Incidente de Seguridad</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/08-03-caso-estudio-analisis-incidente" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/08-03-cas-estudi-analisi-incident" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/08-03-case-study-analyzing-incident" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/owasp/08-03-caso-estudio-analisis-incidente" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/owasp/08-03-caso-estudio-analisis-incidente" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-ejercicio-implementacion-controles' title="Ejercicio 2: Implementación de Controles de Seguridad">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Caso de Estudio 1: Análisis de un Incidente de Seguridad</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-caso-estudio-mejora-seguridad' title="Caso de Estudio 2: Mejora de la Seguridad en una Aplicación Web">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este caso de estudio, analizaremos un incidente de seguridad real para comprender cómo se desarrolló, qué vulnerabilidades fueron explotadas y cómo se podrían haber mitigado. Este ejercicio práctico te ayudará a aplicar los conocimientos adquiridos en los módulos anteriores y a desarrollar habilidades críticas para la identificación y resolución de incidentes de seguridad.</p>
</div><h1>Descripción del Incidente</h1>
<div class='content'></div><h2>Contexto</h2>
<div class='content'><p>Una empresa de comercio electrónico, &quot;E-Shop&quot;, sufrió un ataque que resultó en la exposición de datos sensibles de sus clientes. El ataque se llevó a cabo mediante una vulnerabilidad de inyección SQL en su sistema de gestión de pedidos.</p>
</div><h2>Detalles del Incidente</h2>
<div class='content'><ul>
<li><strong>Fecha del Incidente:</strong> 15 de marzo de 2023</li>
<li><strong>Duración del Incidente:</strong> 3 horas</li>
<li><strong>Impacto:</strong> Exposición de datos personales y financieros de 10,000 clientes</li>
<li><strong>Método de Ataque:</strong> Inyección SQL</li>
<li><strong>Vulnerabilidad Explotada:</strong> Falta de validación y sanitización de entradas en el formulario de búsqueda de pedidos</li>
</ul>
</div><h1>Análisis del Incidente</h1>
<div class='content'></div><h2>Paso 1: Identificación de la Vulnerabilidad</h2>
<div class='content'><h4>Código Vulnerable</h4>
<p>El siguiente fragmento de código muestra la consulta SQL vulnerable utilizada en el formulario de búsqueda de pedidos:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJG9yZGVyX2lkID0gJF9HRVRbJ29yZGVyX2lkJ107CiRxdWVyeSA9ICJTRUxFQ1QgKiBGUk9NIG9yZGVycyBXSEVSRSBvcmRlcl9pZCA9ICckb3JkZXJfaWQnIjsKJHJlc3VsdCA9IG15c3FsaV9xdWVyeSgkY29ubiwgJHF1ZXJ5KTsKPz4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$order_id = $_GET['order_id'];
$query = &quot;SELECT * FROM orders WHERE order_id = '$order_id'&quot;;
$result = mysqli_query($conn, $query);
?&gt;</pre></div><div class='content'><h4>Explicación</h4>
<ul>
<li><strong>Falta de Sanitización:</strong> El valor de <code>order_id</code> se inserta directamente en la consulta SQL sin ninguna validación o sanitización.</li>
<li><strong>Riesgo de Inyección SQL:</strong> Un atacante puede manipular el valor de <code>order_id</code> para ejecutar comandos SQL arbitrarios.</li>
</ul>
</div><h2>Paso 2: Ejecución del Ataque</h2>
<div class='content'><h4>Ejemplo de Inyección SQL</h4>
<p>Un atacante podría enviar el siguiente valor en el parámetro <code>order_id</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JyBPUiAnMSc9JzE="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>' OR '1'='1</pre></div><div class='content'><p>Esto modificaría la consulta SQL a:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUICogRlJPTSBvcmRlcnMgV0hFUkUgb3JkZXJfaWQgPSAnJyBPUiAnMSc9JzEn"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT * FROM orders WHERE order_id = '' OR '1'='1'</pre></div><div class='content'><h4>Resultado</h4>
<p>La consulta devolvería todos los registros de la tabla <code>orders</code>, exponiendo así los datos de todos los pedidos.</p>
</div><h2>Paso 3: Impacto del Incidente</h2>
<div class='content'><h4>Datos Expuestos</h4>
<ul>
<li><strong>Información Personal:</strong> Nombres, direcciones, números de teléfono</li>
<li><strong>Información Financiera:</strong> Números de tarjetas de crédito, fechas de vencimiento</li>
</ul>
<h4>Consecuencias</h4>
<ul>
<li><strong>Pérdida de Confianza:</strong> Los clientes afectados pueden perder la confianza en la empresa.</li>
<li><strong>Repercusiones Legales:</strong> La empresa puede enfrentar multas y sanciones por no proteger adecuadamente los datos de los clientes.</li>
</ul>
</div><h1>Mitigación y Prevención</h1>
<div class='content'></div><h2>Paso 4: Corrección del Código Vulnerable</h2>
<div class='content'><h4>Código Corregido</h4>
<p>El siguiente fragmento de código muestra cómo se puede corregir la vulnerabilidad utilizando consultas preparadas:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJG9yZGVyX2lkID0gJF9HRVRbJ29yZGVyX2lkJ107CiRzdG10ID0gJGNvbm4tPnByZXBhcmUoIlNFTEVDVCAqIEZST00gb3JkZXJzIFdIRVJFIG9yZGVyX2lkID0gPyIpOwokc3RtdC0+YmluZF9wYXJhbSgicyIsICRvcmRlcl9pZCk7CiRzdG10LT5leGVjdXRlKCk7CiRyZXN1bHQgPSAkc3RtdC0+Z2V0X3Jlc3VsdCgpOwo/Pg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$order_id = $_GET['order_id'];
$stmt = $conn-&gt;prepare(&quot;SELECT * FROM orders WHERE order_id = ?&quot;);
$stmt-&gt;bind_param(&quot;s&quot;, $order_id);
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();
?&gt;</pre></div><div class='content'><h4>Explicación</h4>
<ul>
<li><strong>Consultas Preparadas:</strong> Utilizar consultas preparadas con parámetros evita la inyección SQL al tratar los valores de entrada de manera segura.</li>
<li><strong>Validación de Entradas:</strong> Siempre validar y sanitizar las entradas del usuario antes de utilizarlas en consultas SQL.</li>
</ul>
</div><h2>Paso 5: Implementación de Controles Adicionales</h2>
<div class='content'><h4>Controles de Seguridad</h4>
<ul>
<li><strong>Validación del Lado del Servidor:</strong> Implementar validaciones estrictas en el servidor para todas las entradas del usuario.</li>
<li><strong>Escaneo de Vulnerabilidades:</strong> Utilizar herramientas como OWASP ZAP para escanear y detectar vulnerabilidades en la aplicación.</li>
<li><strong>Capacitación en Seguridad:</strong> Capacitar a los desarrolladores en prácticas de codificación segura y concienciación sobre seguridad.</li>
</ul>
</div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><ol>
<li><strong>Identificación de Vulnerabilidades:</strong> Revisa el código de una aplicación web y encuentra posibles vulnerabilidades de inyección SQL.</li>
<li><strong>Corrección de Vulnerabilidades:</strong> Modifica el código para corregir las vulnerabilidades utilizando consultas preparadas y validación de entradas.</li>
<li><strong>Escaneo de Seguridad:</strong> Utiliza OWASP ZAP para escanear la aplicación y verificar que las vulnerabilidades han sido corregidas.</li>
</ol>
</div><h2>Solución</h2>
<div class='content'><h4>Código Vulnerable</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHVzZXJfaWQgPSAkX0dFVFsndXNlcl9pZCddOwokcXVlcnkgPSAiU0VMRUNUICogRlJPTSB1c2VycyBXSEVSRSB1c2VyX2lkID0gJyR1c2VyX2lkJyI7CiRyZXN1bHQgPSBteXNxbGlfcXVlcnkoJGNvbm4sICRxdWVyeSk7Cj8+"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$user_id = $_GET['user_id'];
$query = &quot;SELECT * FROM users WHERE user_id = '$user_id'&quot;;
$result = mysqli_query($conn, $query);
?&gt;</pre></div><div class='content'><h4>Código Corregido</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PD9waHAKJHVzZXJfaWQgPSAkX0dFVFsndXNlcl9pZCddOwokc3RtdCA9ICRjb25uLT5wcmVwYXJlKCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIHVzZXJfaWQgPSA/Iik7CiRzdG10LT5iaW5kX3BhcmFtKCJzIiwgJHVzZXJfaWQpOwokc3RtdC0+ZXhlY3V0ZSgpOwokcmVzdWx0ID0gJHN0bXQtPmdldF9yZXN1bHQoKTsKPz4="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;?php
$user_id = $_GET['user_id'];
$stmt = $conn-&gt;prepare(&quot;SELECT * FROM users WHERE user_id = ?&quot;);
$stmt-&gt;bind_param(&quot;s&quot;, $user_id);
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();
?&gt;</pre></div><div class='content'><h4>Escaneo de Seguridad</h4>
<ol>
<li><strong>Configura OWASP ZAP:</strong> Configura OWASP ZAP para escanear la aplicación.</li>
<li><strong>Ejecuta el Escaneo:</strong> Realiza un escaneo completo de la aplicación.</li>
<li><strong>Analiza los Resultados:</strong> Revisa los resultados del escaneo y asegúrate de que no se detecten vulnerabilidades de inyección SQL.</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>En este caso de estudio, hemos analizado un incidente de seguridad real, identificando la vulnerabilidad explotada y el impacto del ataque. También hemos aprendido cómo corregir la vulnerabilidad y cómo implementar controles adicionales para prevenir futuros incidentes. Este ejercicio práctico refuerza la importancia de la validación y sanitización de entradas, así como el uso de herramientas de escaneo de seguridad para proteger las aplicaciones web.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-02-ejercicio-implementacion-controles' title="Ejercicio 2: Implementación de Controles de Seguridad">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='08-04-caso-estudio-mejora-seguridad' title="Caso de Estudio 2: Mejora de la Seguridad en una Aplicación Web">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
