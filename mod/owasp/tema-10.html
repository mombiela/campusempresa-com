<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A02:2021 - Cryptographic Failures</title>

    <link rel="alternate" href="https://campusempresa.com/mod/owasp/tema-10" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/owasp/tema-10" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/owasp/tema-10" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/owasp/tema-10" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/owasp/tema-10" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-4'>
					<a href='tema-9'>&#x25C4;A01:2021 - Broken Access Control</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">A02:2021 - Cryptographic Failures</a>
	</div>
	<div class='col-4 text-end'>
					<a href='tema-11'>A03:2021 - Injection &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En el contexto de la seguridad de aplicaciones web, los fallos criptográficos son una de las principales vulnerabilidades identificadas por OWASP en su lista de los diez principales riesgos de seguridad. Este tema aborda los errores comunes en la implementación de criptografía y cómo pueden ser explotados por atacantes para comprometer la seguridad de una aplicación.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Criptografía</strong>: Técnica para proteger la información mediante la transformación de datos legibles en datos cifrados.</li>
<li><strong>Cifrado</strong>: Proceso de convertir datos en un formato ilegible para proteger su confidencialidad.</li>
<li><strong>Desencriptación</strong>: Proceso de convertir datos cifrados de vuelta a su formato original.</li>
<li><strong>Algoritmos Criptográficos</strong>: Conjunto de reglas matemáticas utilizadas para cifrar y descifrar datos.</li>
<li><strong>Claves Criptográficas</strong>: Valores secretos utilizados en los algoritmos criptográficos para cifrar y descifrar datos.</li>
</ul>
</div><h1>Errores Comunes en la Criptografía</h1>
<div class='content'><ol>
<li>
<p><strong>Uso de Algoritmos Obsoletos o Inseguros</strong>:</p>
<ul>
<li>Ejemplo: Uso de MD5 o SHA-1 para hashing.</li>
<li>Solución: Utilizar algoritmos modernos como SHA-256 o SHA-3.</li>
</ul>
</li>
<li>
<p><strong>Gestión Inadecuada de Claves</strong>:</p>
<ul>
<li>Ejemplo: Almacenamiento de claves en texto plano.</li>
<li>Solución: Utilizar módulos de seguridad de hardware (HSM) o servicios de gestión de claves.</li>
</ul>
</li>
<li>
<p><strong>Uso Incorrecto de Modos de Operación de Cifrado</strong>:</p>
<ul>
<li>Ejemplo: Uso de ECB (Electronic Codebook) en lugar de CBC (Cipher Block Chaining).</li>
<li>Solución: Utilizar modos de operación seguros como CBC o GCM (Galois/Counter Mode).</li>
</ul>
</li>
<li>
<p><strong>Falta de Entropía en la Generación de Claves</strong>:</p>
<ul>
<li>Ejemplo: Uso de generadores de números pseudoaleatorios inseguros.</li>
<li>Solución: Utilizar generadores de números aleatorios criptográficamente seguros.</li>
</ul>
</li>
</ol>
</div><h1>Ejemplos de Código</h1>
<div class='content'></div><h2>Ejemplo de Uso Incorrecto de Algoritmos Obsoletos</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGhhc2hsaWIKCiMgVXNvIGRlIE1ENSAoaW5zZWd1cm8pCmRhdGEgPSAibWVuc2FqZV9zZWNyZXRvIgpoYXNoX21kNSA9IGhhc2hsaWIubWQ1KGRhdGEuZW5jb2RlKCkpLmhleGRpZ2VzdCgpCnByaW50KGYiTUQ1OiB7aGFzaF9tZDV9Iik="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import hashlib

# Uso de MD5 (inseguro)
data = &quot;mensaje_secreto&quot;
hash_md5 = hashlib.md5(data.encode()).hexdigest()
print(f&quot;MD5: {hash_md5}&quot;)</pre></div><div class='content'></div><h2>Ejemplo de Uso Correcto de Algoritmos Modernos</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGhhc2hsaWIKCiMgVXNvIGRlIFNIQS0yNTYgKHNlZ3VybykKZGF0YSA9ICJtZW5zYWplX3NlY3JldG8iCmhhc2hfc2hhMjU2ID0gaGFzaGxpYi5zaGEyNTYoZGF0YS5lbmNvZGUoKSkuaGV4ZGlnZXN0KCkKcHJpbnQoZiJTSEEtMjU2OiB7aGFzaF9zaGEyNTZ9Iik="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import hashlib

# Uso de SHA-256 (seguro)
data = &quot;mensaje_secreto&quot;
hash_sha256 = hashlib.sha256(data.encode()).hexdigest()
print(f&quot;SHA-256: {hash_sha256}&quot;)</pre></div><div class='content'></div><h2>Ejemplo de Gestión Inadecuada de Claves</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBBbG1hY2VuYW1pZW50byBkZSBjbGF2ZSBlbiB0ZXh0byBwbGFubyAoaW5zZWd1cm8pCmtleSA9ICJjbGF2ZV9zZWNyZXRhIg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Almacenamiento de clave en texto plano (inseguro)
key = &quot;clave_secreta&quot;</pre></div><div class='content'></div><h2>Ejemplo de Gestión Adecuada de Claves</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBjcnlwdG9ncmFwaHkuaGF6bWF0LnByaW1pdGl2ZXMua2RmLnBia2RmMiBpbXBvcnQgUEJLREYySE1BQwpmcm9tIGNyeXB0b2dyYXBoeS5oYXptYXQucHJpbWl0aXZlcyBpbXBvcnQgaGFzaGVzCmZyb20gY3J5cHRvZ3JhcGh5Lmhhem1hdC5iYWNrZW5kcyBpbXBvcnQgZGVmYXVsdF9iYWNrZW5kCmltcG9ydCBvcwoKIyBHZW5lcmFjacOzbiBkZSBjbGF2ZSBzZWd1cmEgdXNhbmRvIFBCS0RGMkhNQUMKcGFzc3dvcmQgPSBiIm1pX2NvbnRyYXNlw7FhIgpzYWx0ID0gb3MudXJhbmRvbSgxNikKa2RmID0gUEJLREYySE1BQygKICAgIGFsZ29yaXRobT1oYXNoZXMuU0hBMjU2KCksCiAgICBsZW5ndGg9MzIsCiAgICBzYWx0PXNhbHQsCiAgICBpdGVyYXRpb25zPTEwMDAwMCwKICAgIGJhY2tlbmQ9ZGVmYXVsdF9iYWNrZW5kKCkKKQprZXkgPSBrZGYuZGVyaXZlKHBhc3N3b3JkKQpwcmludChmIkNsYXZlIHNlZ3VyYToge2tleS5oZXgoKX0iKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.backends import default_backend
import os

# Generaci&oacute;n de clave segura usando PBKDF2HMAC
password = b&quot;mi_contrase&ntilde;a&quot;
salt = os.urandom(16)
kdf = PBKDF2HMAC(
    algorithm=hashes.SHA256(),
    length=32,
    salt=salt,
    iterations=100000,
    backend=default_backend()
)
key = kdf.derive(password)
print(f&quot;Clave segura: {key.hex()}&quot;)</pre></div><div class='content'></div><h1>Comparación de Modos de Operación de Cifrado</h1>
<div class='content'><table>
<thead>
<tr>
<th>Modo de Operación</th>
<th>Seguridad</th>
<th>Uso Recomendado</th>
</tr>
</thead>
<tbody>
<tr>
<td>ECB</td>
<td>Inseguro</td>
<td>No</td>
</tr>
<tr>
<td>CBC</td>
<td>Seguro</td>
<td>Sí</td>
</tr>
<tr>
<td>GCM</td>
<td>Muy Seguro</td>
<td>Sí</td>
</tr>
</tbody>
</table>
</div><h1>Conclusión</h1>
<div class='content'><p>Los fallos criptográficos pueden tener consecuencias graves para la seguridad de una aplicación. Es crucial utilizar algoritmos modernos y seguros, gestionar adecuadamente las claves criptográficas y asegurarse de que los modos de operación de cifrado sean apropiados. Al seguir estas prácticas, se puede mitigar significativamente el riesgo de vulnerabilidades criptográficas en las aplicaciones web.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='tema-9'>&#x25C4;A01:2021 - Broken Access Control</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">A02:2021 - Cryptographic Failures</a>
	</div>
	<div class='col-4 text-end'>
					<a href='tema-11'>A03:2021 - Injection &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
