<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aumento de Datos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/03-03-data-augmentation" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/03-03-data-augmentation" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/03-03-data-augmentation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/tensorflow/03-03-data-augmentation" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/03-03-data-augmentation" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-data-pipelines-with-tf-data' title="Pipelines de Datos con tf.data">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Aumento de Datos</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-working-with-datasets' title="Trabajando con Conjuntos de Datos">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>El aumento de datos (data augmentation) es una técnica utilizada para incrementar la cantidad y diversidad de datos de entrenamiento sin recolectar nuevos datos. Esto se logra aplicando transformaciones aleatorias a los datos existentes, lo que ayuda a mejorar la generalización del modelo y a reducir el sobreajuste (overfitting).</p>
</div><h1><p>Conceptos Clave</p>
</h1>
<div class='content'><ol>
<li><strong>Aumento de Datos</strong>: Proceso de crear nuevas muestras de datos a partir de las existentes mediante transformaciones.</li>
<li><strong>Transformaciones Comunes</strong>: Incluyen rotaciones, traslaciones, escalados, recortes, cambios de brillo y contraste, entre otros.</li>
<li><strong>Beneficios</strong>: Mejora la robustez del modelo, reduce el sobreajuste y puede mejorar la precisión del modelo.</li>
</ol>
</div><h1><p>Transformaciones Comunes</p>
</h1>
<div class='content'><table>
<thead>
<tr>
<th>Transformación</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td>Rotación</td>
<td>Gira la imagen en un ángulo aleatorio.</td>
</tr>
<tr>
<td>Traslación</td>
<td>Desplaza la imagen en una dirección específica.</td>
</tr>
<tr>
<td>Escalado</td>
<td>Cambia el tamaño de la imagen.</td>
</tr>
<tr>
<td>Recorte</td>
<td>Corta una parte de la imagen.</td>
</tr>
<tr>
<td>Cambio de Brillo</td>
<td>Ajusta el brillo de la imagen.</td>
</tr>
<tr>
<td>Cambio de Contraste</td>
<td>Ajusta el contraste de la imagen.</td>
</tr>
</tbody>
</table>
</div><h1><p>Implementación en TensorFlow</p>
</h1>
<div class='content'><p>TensorFlow proporciona varias herramientas para realizar aumento de datos, especialmente a través de la API <code>tf.image</code> y <code>tf.keras.preprocessing.image</code>.</p>
</div><h2><p>Ejemplo Práctico</p>
</h2>
<div class='content'><p>A continuación, se muestra un ejemplo de cómo aplicar aumento de datos utilizando <code>tf.image</code> y <code>tf.keras.preprocessing.image</code>.</p>
<h4>Usando <code>tf.image</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKIyBDYXJnYXIgdW5hIGltYWdlbiBkZSBlamVtcGxvCmltYWdlX3BhdGggPSB0Zi5rZXJhcy51dGlscy5nZXRfZmlsZSgnY2F0LmpwZycsICdodHRwczovL3N0b3JhZ2UuZ29vZ2xlYXBpcy5jb20vZG93bmxvYWQudGVuc29yZmxvdy5vcmcvZXhhbXBsZV9pbWFnZXMvMzIwcHgtRmVsaXNfY2F0dXMtY2F0X29uX3Nub3cuanBnJykKaW1hZ2UgPSB0Zi5pby5yZWFkX2ZpbGUoaW1hZ2VfcGF0aCkKaW1hZ2UgPSB0Zi5pbWFnZS5kZWNvZGVfanBlZyhpbWFnZSkKCiMgQXBsaWNhciB0cmFuc2Zvcm1hY2lvbmVzCnJvdGF0ZWRfaW1hZ2UgPSB0Zi5pbWFnZS5yb3Q5MChpbWFnZSkKZmxpcHBlZF9pbWFnZSA9IHRmLmltYWdlLmZsaXBfbGVmdF9yaWdodChpbWFnZSkKYnJpZ2h0X2ltYWdlID0gdGYuaW1hZ2UuYWRqdXN0X2JyaWdodG5lc3MoaW1hZ2UsIGRlbHRhPTAuMSkKY29udHJhc3RfaW1hZ2UgPSB0Zi5pbWFnZS5hZGp1c3RfY29udHJhc3QoaW1hZ2UsIGNvbnRyYXN0X2ZhY3Rvcj0yKQoKIyBNb3N0cmFyIGltw6FnZW5lcwpwbHQuZmlndXJlKGZpZ3NpemU9KDEwLCAxMCkpCnBsdC5zdWJwbG90KDIsIDIsIDEpCnBsdC50aXRsZSgnUm90YXRlZCBJbWFnZScpCnBsdC5pbXNob3cocm90YXRlZF9pbWFnZSkKcGx0LnN1YnBsb3QoMiwgMiwgMikKcGx0LnRpdGxlKCdGbGlwcGVkIEltYWdlJykKcGx0Lmltc2hvdyhmbGlwcGVkX2ltYWdlKQpwbHQuc3VicGxvdCgyLCAyLCAzKQpwbHQudGl0bGUoJ0JyaWdodCBJbWFnZScpCnBsdC5pbXNob3coYnJpZ2h0X2ltYWdlKQpwbHQuc3VicGxvdCgyLCAyLCA0KQpwbHQudGl0bGUoJ0NvbnRyYXN0IEltYWdlJykKcGx0Lmltc2hvdyhjb250cmFzdF9pbWFnZSkKcGx0LnNob3coKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import matplotlib.pyplot as plt

# Cargar una imagen de ejemplo
image_path = tf.keras.utils.get_file('cat.jpg', 'https://storage.googleapis.com/download.tensorflow.org/example_images/320px-Felis_catus-cat_on_snow.jpg')
image = tf.io.read_file(image_path)
image = tf.image.decode_jpeg(image)

# Aplicar transformaciones
rotated_image = tf.image.rot90(image)
flipped_image = tf.image.flip_left_right(image)
bright_image = tf.image.adjust_brightness(image, delta=0.1)
contrast_image = tf.image.adjust_contrast(image, contrast_factor=2)

# Mostrar im&aacute;genes
plt.figure(figsize=(10, 10))
plt.subplot(2, 2, 1)
plt.title('Rotated Image')
plt.imshow(rotated_image)
plt.subplot(2, 2, 2)
plt.title('Flipped Image')
plt.imshow(flipped_image)
plt.subplot(2, 2, 3)
plt.title('Bright Image')
plt.imshow(bright_image)
plt.subplot(2, 2, 4)
plt.title('Contrast Image')
plt.imshow(contrast_image)
plt.show()</pre></div><div class='content'><h4>Usando <code>tf.keras.preprocessing.image</code></h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLnByZXByb2Nlc3NpbmcuaW1hZ2UgaW1wb3J0IEltYWdlRGF0YUdlbmVyYXRvciwgYXJyYXlfdG9faW1nLCBpbWdfdG9fYXJyYXksIGxvYWRfaW1nCgojIENyZWFyIHVuIGdlbmVyYWRvciBkZSBkYXRvcyBjb24gYXVtZW50bwpkYXRhZ2VuID0gSW1hZ2VEYXRhR2VuZXJhdG9yKAogICAgcm90YXRpb25fcmFuZ2U9NDAsCiAgICB3aWR0aF9zaGlmdF9yYW5nZT0wLjIsCiAgICBoZWlnaHRfc2hpZnRfcmFuZ2U9MC4yLAogICAgc2hlYXJfcmFuZ2U9MC4yLAogICAgem9vbV9yYW5nZT0wLjIsCiAgICBob3Jpem9udGFsX2ZsaXA9VHJ1ZSwKICAgIGZpbGxfbW9kZT0nbmVhcmVzdCcKKQoKIyBDYXJnYXIgdW5hIGltYWdlbiBkZSBlamVtcGxvCmltZyA9IGxvYWRfaW1nKGltYWdlX3BhdGgpICAjIENhcmdhciBpbWFnZW4gY29tbyBQSUwgSW1hZ2UKeCA9IGltZ190b19hcnJheShpbWcpICAjIENvbnZlcnRpciBhIGFycmF5IE51bXB5CnggPSB4LnJlc2hhcGUoKDEsKSArIHguc2hhcGUpICAjIFJlY29uZmlndXJhciBhcnJheQoKIyBHZW5lcmFyIGltw6FnZW5lcyBhdW1lbnRhZGFzCmkgPSAwCmZvciBiYXRjaCBpbiBkYXRhZ2VuLmZsb3coeCwgYmF0Y2hfc2l6ZT0xKToKICAgIHBsdC5maWd1cmUoaSkKICAgIGltZ3Bsb3QgPSBwbHQuaW1zaG93KGFycmF5X3RvX2ltZyhiYXRjaFswXSkpCiAgICBpICs9IDEKICAgIGlmIGkgJSA0ID09IDA6CiAgICAgICAgYnJlYWsKCnBsdC5zaG93KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.preprocessing.image import ImageDataGenerator, array_to_img, img_to_array, load_img

# Crear un generador de datos con aumento
datagen = ImageDataGenerator(
    rotation_range=40,
    width_shift_range=0.2,
    height_shift_range=0.2,
    shear_range=0.2,
    zoom_range=0.2,
    horizontal_flip=True,
    fill_mode='nearest'
)

# Cargar una imagen de ejemplo
img = load_img(image_path)  # Cargar imagen como PIL Image
x = img_to_array(img)  # Convertir a array Numpy
x = x.reshape((1,) + x.shape)  # Reconfigurar array

# Generar im&aacute;genes aumentadas
i = 0
for batch in datagen.flow(x, batch_size=1):
    plt.figure(i)
    imgplot = plt.imshow(array_to_img(batch[0]))
    i += 1
    if i % 4 == 0:
        break

plt.show()</pre></div><div class='content'></div><h2><p>Ejercicio Práctico</p>
</h2>
<div class='content'><p><strong>Ejercicio:</strong></p>
<ol>
<li>Carga una imagen de tu elección.</li>
<li>Aplica al menos tres transformaciones diferentes utilizando <code>tf.image</code>.</li>
<li>Muestra las imágenes originales y transformadas.</li>
</ol>
<p><strong>Solución:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKIyBDYXJnYXIgdW5hIGltYWdlbiBkZSBlamVtcGxvCmltYWdlX3BhdGggPSAncnV0YS9hL3R1L2ltYWdlbi5qcGcnICAjIFJlZW1wbGF6YSBjb24gbGEgcnV0YSBhIHR1IGltYWdlbgppbWFnZSA9IHRmLmlvLnJlYWRfZmlsZShpbWFnZV9wYXRoKQppbWFnZSA9IHRmLmltYWdlLmRlY29kZV9qcGVnKGltYWdlKQoKIyBBcGxpY2FyIHRyYW5zZm9ybWFjaW9uZXMKcm90YXRlZF9pbWFnZSA9IHRmLmltYWdlLnJvdDkwKGltYWdlKQpmbGlwcGVkX2ltYWdlID0gdGYuaW1hZ2UuZmxpcF9sZWZ0X3JpZ2h0KGltYWdlKQpicmlnaHRfaW1hZ2UgPSB0Zi5pbWFnZS5hZGp1c3RfYnJpZ2h0bmVzcyhpbWFnZSwgZGVsdGE9MC4xKQoKIyBNb3N0cmFyIGltw6FnZW5lcwpwbHQuZmlndXJlKGZpZ3NpemU9KDEwLCAxMCkpCnBsdC5zdWJwbG90KDIsIDIsIDEpCnBsdC50aXRsZSgnT3JpZ2luYWwgSW1hZ2UnKQpwbHQuaW1zaG93KGltYWdlKQpwbHQuc3VicGxvdCgyLCAyLCAyKQpwbHQudGl0bGUoJ1JvdGF0ZWQgSW1hZ2UnKQpwbHQuaW1zaG93KHJvdGF0ZWRfaW1hZ2UpCnBsdC5zdWJwbG90KDIsIDIsIDMpCnBsdC50aXRsZSgnRmxpcHBlZCBJbWFnZScpCnBsdC5pbXNob3coZmxpcHBlZF9pbWFnZSkKcGx0LnN1YnBsb3QoMiwgMiwgNCkKcGx0LnRpdGxlKCdCcmlnaHQgSW1hZ2UnKQpwbHQuaW1zaG93KGJyaWdodF9pbWFnZSkKcGx0LnNob3coKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import matplotlib.pyplot as plt

# Cargar una imagen de ejemplo
image_path = 'ruta/a/tu/imagen.jpg'  # Reemplaza con la ruta a tu imagen
image = tf.io.read_file(image_path)
image = tf.image.decode_jpeg(image)

# Aplicar transformaciones
rotated_image = tf.image.rot90(image)
flipped_image = tf.image.flip_left_right(image)
bright_image = tf.image.adjust_brightness(image, delta=0.1)

# Mostrar im&aacute;genes
plt.figure(figsize=(10, 10))
plt.subplot(2, 2, 1)
plt.title('Original Image')
plt.imshow(image)
plt.subplot(2, 2, 2)
plt.title('Rotated Image')
plt.imshow(rotated_image)
plt.subplot(2, 2, 3)
plt.title('Flipped Image')
plt.imshow(flipped_image)
plt.subplot(2, 2, 4)
plt.title('Bright Image')
plt.imshow(bright_image)
plt.show()</pre></div><div class='content'></div><h2><p>Errores Comunes y Consejos</p>
</h2>
<div class='content'><ul>
<li>
<p><strong>Error Común:</strong> Aplicar transformaciones que distorsionen demasiado la imagen, haciendo que los datos aumentados no sean representativos de los datos reales.</p>
<ul>
<li><strong>Consejo:</strong> Mantén las transformaciones dentro de un rango razonable para asegurar que las imágenes aumentadas sean útiles para el entrenamiento.</li>
</ul>
</li>
<li>
<p><strong>Error Común:</strong> No aplicar aumento de datos de manera consistente durante el entrenamiento y la validación.</p>
<ul>
<li><strong>Consejo:</strong> Asegúrate de aplicar las mismas transformaciones de aumento de datos durante el entrenamiento y la validación para mantener la consistencia.</li>
</ul>
</li>
</ul>
</div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>El aumento de datos es una técnica poderosa para mejorar la robustez y la generalización de los modelos de aprendizaje automático. TensorFlow proporciona herramientas flexibles y fáciles de usar para implementar aumento de datos, lo que permite a los desarrolladores mejorar sus modelos sin necesidad de recolectar más datos. En el próximo módulo, exploraremos cómo trabajar con conjuntos de datos en TensorFlow para construir pipelines de datos eficientes.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='03-02-data-pipelines-with-tf-data' title="Pipelines de Datos con tf.data">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-04-working-with-datasets' title="Trabajando con Conjuntos de Datos">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
