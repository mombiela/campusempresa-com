<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorFlow Lite</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/10-01-tensorflow-lite" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/10-01-tensorflow-lite" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/10-01-tensorflow-lite" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/tensorflow/10-01-tensorflow-lite" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/10-01-tensorflow-lite" class="px-2">CA</a>
								</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contenido del curso</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competencias técnicas</a>
				<a href="/all/conocimientos">Conocimientos</a>
				<a href="/all/soft_skills">Competencias sociales</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-04-model-analysis' title="Análisis de Modelos">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">TensorFlow Lite</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'></div><h1><p>Introducción a TensorFlow Lite</p>
</h1>
<div class='content'><p>TensorFlow Lite es una versión ligera de TensorFlow diseñada para dispositivos móviles y embebidos. Permite ejecutar modelos de aprendizaje automático en dispositivos con recursos limitados, como teléfonos inteligentes, microcontroladores y otros dispositivos IoT.</p>
</div><h2><p>Objetivos de Aprendizaje</p>
</h2>
<div class='content'><ul>
<li>Comprender qué es TensorFlow Lite y sus aplicaciones.</li>
<li>Aprender a convertir modelos de TensorFlow a TensorFlow Lite.</li>
<li>Ejecutar modelos de TensorFlow Lite en dispositivos móviles y embebidos.</li>
<li>Optimizar modelos para TensorFlow Lite.</li>
</ul>
</div><h1><p>¿Qué es TensorFlow Lite?</p>
</h1>
<div class='content'><p>TensorFlow Lite es una herramienta que permite ejecutar modelos de aprendizaje automático en dispositivos con recursos limitados. Está optimizado para ofrecer baja latencia y un tamaño reducido de modelo, lo que lo hace ideal para aplicaciones móviles y embebidas.</p>
</div><h2><p>Características Principales</p>
</h2>
<div class='content'><ul>
<li><strong>Optimización de Modelos</strong>: TensorFlow Lite permite optimizar modelos para reducir su tamaño y mejorar la velocidad de inferencia.</li>
<li><strong>Compatibilidad con Dispositivos</strong>: Soporta una amplia gama de dispositivos, incluyendo Android, iOS y microcontroladores.</li>
<li><strong>APIs de Alto Nivel</strong>: Proporciona APIs fáciles de usar para integrar modelos en aplicaciones móviles.</li>
</ul>
</div><h1><p>Configuración de TensorFlow Lite</p>
</h1>
<div class='content'></div><h2><p>Requisitos Previos</p>
</h2>
<div class='content'><ul>
<li>Tener instalado TensorFlow en tu entorno de desarrollo.</li>
<li>Conocimientos básicos de Python y TensorFlow.</li>
</ul>
</div><h2><p>Instalación de TensorFlow Lite</p>
</h2>
<div class='content'><p>Para instalar TensorFlow Lite, puedes usar pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow</pre></div><div class='content'><p>Para dispositivos móviles, necesitarás las bibliotecas específicas para Android o iOS.</p>
</div><h1><p>Conversión de Modelos a TensorFlow Lite</p>
</h1>
<div class='content'></div><h2><p>Paso 1: Crear un Modelo en TensorFlow</p>
</h2>
<div class='content'><p>Primero, necesitas un modelo entrenado en TensorFlow. Aquí hay un ejemplo simple de un modelo de clasificación de dígitos:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmRhdGFzZXRzIGltcG9ydCBtbmlzdApmcm9tIHRlbnNvcmZsb3cua2VyYXMubW9kZWxzIGltcG9ydCBTZXF1ZW50aWFsCmZyb20gdGVuc29yZmxvdy5rZXJhcy5sYXllcnMgaW1wb3J0IERlbnNlLCBGbGF0dGVuCgojIENhcmdhciBkYXRvcwooeF90cmFpbiwgeV90cmFpbiksICh4X3Rlc3QsIHlfdGVzdCkgPSBtbmlzdC5sb2FkX2RhdGEoKQoKIyBOb3JtYWxpemFyIGRhdG9zCnhfdHJhaW4sIHhfdGVzdCA9IHhfdHJhaW4gLyAyNTUuMCwgeF90ZXN0IC8gMjU1LjAKCiMgQ3JlYXIgbW9kZWxvCm1vZGVsID0gU2VxdWVudGlhbChbCiAgICBGbGF0dGVuKGlucHV0X3NoYXBlPSgyOCwgMjgpKSwKICAgIERlbnNlKDEyOCwgYWN0aXZhdGlvbj0ncmVsdScpLAogICAgRGVuc2UoMTAsIGFjdGl2YXRpb249J3NvZnRtYXgnKQpdKQoKIyBDb21waWxhciBtb2RlbG8KbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLAogICAgICAgICAgICAgIGxvc3M9J3NwYXJzZV9jYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLAogICAgICAgICAgICAgIG1ldHJpY3M9WydhY2N1cmFjeSddKQoKIyBFbnRyZW5hciBtb2RlbG8KbW9kZWwuZml0KHhfdHJhaW4sIHlfdHJhaW4sIGVwb2Nocz01KQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.datasets import mnist
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, Flatten

# Cargar datos
(x_train, y_train), (x_test, y_test) = mnist.load_data()

# Normalizar datos
x_train, x_test = x_train / 255.0, x_test / 255.0

# Crear modelo
model = Sequential([
    Flatten(input_shape=(28, 28)),
    Dense(128, activation='relu'),
    Dense(10, activation='softmax')
])

# Compilar modelo
model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

# Entrenar modelo
model.fit(x_train, y_train, epochs=5)</pre></div><div class='content'></div><h2><p>Paso 2: Convertir el Modelo a TensorFlow Lite</p>
</h2>
<div class='content'><p>Usa el convertidor de TensorFlow Lite para convertir el modelo entrenado:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb252ZXJ0aXIgZWwgbW9kZWxvIGEgVGVuc29yRmxvdyBMaXRlCmNvbnZlcnRlciA9IHRmLmxpdGUuVEZMaXRlQ29udmVydGVyLmZyb21fa2VyYXNfbW9kZWwobW9kZWwpCnRmbGl0ZV9tb2RlbCA9IGNvbnZlcnRlci5jb252ZXJ0KCkKCiMgR3VhcmRhciBlbCBtb2RlbG8gY29udmVydGlkbwp3aXRoIG9wZW4oJ21vZGVsLnRmbGl0ZScsICd3YicpIGFzIGY6CiAgICBmLndyaXRlKHRmbGl0ZV9tb2RlbCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Convertir el modelo a TensorFlow Lite
converter = tf.lite.TFLiteConverter.from_keras_model(model)
tflite_model = converter.convert()

# Guardar el modelo convertido
with open('model.tflite', 'wb') as f:
    f.write(tflite_model)</pre></div><div class='content'></div><h2><p>Paso 3: Ejecutar el Modelo en TensorFlow Lite</p>
</h2>
<div class='content'><p>Para ejecutar el modelo en un dispositivo, necesitas usar el intérprete de TensorFlow Lite. Aquí hay un ejemplo de cómo hacerlo en Python:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCgojIENhcmdhciBlbCBtb2RlbG8gVEZMaXRlCmludGVycHJldGVyID0gdGYubGl0ZS5JbnRlcnByZXRlcihtb2RlbF9wYXRoPSJtb2RlbC50ZmxpdGUiKQppbnRlcnByZXRlci5hbGxvY2F0ZV90ZW5zb3JzKCkKCiMgT2J0ZW5lciBkZXRhbGxlcyBkZSBlbnRyYWRhIHkgc2FsaWRhCmlucHV0X2RldGFpbHMgPSBpbnRlcnByZXRlci5nZXRfaW5wdXRfZGV0YWlscygpCm91dHB1dF9kZXRhaWxzID0gaW50ZXJwcmV0ZXIuZ2V0X291dHB1dF9kZXRhaWxzKCkKCiMgUHJlcGFyYXIgZGF0b3MgZGUgZW50cmFkYQppbnB1dF9kYXRhID0gbnAuYXJyYXkoeF90ZXN0WzBdLCBkdHlwZT1ucC5mbG9hdDMyKQppbnB1dF9kYXRhID0gbnAuZXhwYW5kX2RpbXMoaW5wdXRfZGF0YSwgYXhpcz0wKQoKIyBFamVjdXRhciBlbCBtb2RlbG8KaW50ZXJwcmV0ZXIuc2V0X3RlbnNvcihpbnB1dF9kZXRhaWxzWzBdWydpbmRleCddLCBpbnB1dF9kYXRhKQppbnRlcnByZXRlci5pbnZva2UoKQoKIyBPYnRlbmVyIHJlc3VsdGFkb3MKb3V0cHV0X2RhdGEgPSBpbnRlcnByZXRlci5nZXRfdGVuc29yKG91dHB1dF9kZXRhaWxzWzBdWydpbmRleCddKQpwcmludCgiUHJlZGljY2nDs246IiwgbnAuYXJnbWF4KG91dHB1dF9kYXRhKSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf

# Cargar el modelo TFLite
interpreter = tf.lite.Interpreter(model_path=&quot;model.tflite&quot;)
interpreter.allocate_tensors()

# Obtener detalles de entrada y salida
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()

# Preparar datos de entrada
input_data = np.array(x_test[0], dtype=np.float32)
input_data = np.expand_dims(input_data, axis=0)

# Ejecutar el modelo
interpreter.set_tensor(input_details[0]['index'], input_data)
interpreter.invoke()

# Obtener resultados
output_data = interpreter.get_tensor(output_details[0]['index'])
print(&quot;Predicci&oacute;n:&quot;, np.argmax(output_data))</pre></div><div class='content'></div><h1><p>Optimización de Modelos para TensorFlow Lite</p>
</h1>
<div class='content'></div><h2><p>Cuantización</p>
</h2>
<div class='content'><p>La cuantización es una técnica que reduce el tamaño del modelo y mejora la velocidad de inferencia al convertir los pesos del modelo de 32 bits a 8 bits.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDdWFudGl6YWNpw7NuIGRlbCBtb2RlbG8KY29udmVydGVyLm9wdGltaXphdGlvbnMgPSBbdGYubGl0ZS5PcHRpbWl6ZS5ERUZBVUxUXQp0ZmxpdGVfcXVhbnRfbW9kZWwgPSBjb252ZXJ0ZXIuY29udmVydCgpCgojIEd1YXJkYXIgZWwgbW9kZWxvIGN1YW50aXphZG8Kd2l0aCBvcGVuKCdtb2RlbF9xdWFudC50ZmxpdGUnLCAnd2InKSBhcyBmOgogICAgZi53cml0ZSh0ZmxpdGVfcXVhbnRfbW9kZWwp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cuantizaci&oacute;n del modelo
converter.optimizations = [tf.lite.Optimize.DEFAULT]
tflite_quant_model = converter.convert()

# Guardar el modelo cuantizado
with open('model_quant.tflite', 'wb') as f:
    f.write(tflite_quant_model)</pre></div><div class='content'></div><h2><p>Ejercicio Práctico</p>
</h2>
<div class='content'><p><strong>Ejercicio: Convertir y Ejecutar un Modelo en TensorFlow Lite</strong></p>
<ol>
<li>Entrena un modelo simple en TensorFlow (puedes usar el ejemplo de clasificación de dígitos).</li>
<li>Convierte el modelo a TensorFlow Lite.</li>
<li>Ejecuta el modelo convertido en TensorFlow Lite y verifica la salida.</li>
</ol>
<p><strong>Solución:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQYXNvIDE6IEVudHJlbmFyIGVsIG1vZGVsbyAodmVyIGPDs2RpZ28gYW50ZXJpb3IpCgojIFBhc28gMjogQ29udmVydGlyIGVsIG1vZGVsbyBhIFRlbnNvckZsb3cgTGl0ZQpjb252ZXJ0ZXIgPSB0Zi5saXRlLlRGTGl0ZUNvbnZlcnRlci5mcm9tX2tlcmFzX21vZGVsKG1vZGVsKQp0ZmxpdGVfbW9kZWwgPSBjb252ZXJ0ZXIuY29udmVydCgpCndpdGggb3BlbignbW9kZWwudGZsaXRlJywgJ3diJykgYXMgZjoKICAgIGYud3JpdGUodGZsaXRlX21vZGVsKQoKIyBQYXNvIDM6IEVqZWN1dGFyIGVsIG1vZGVsbyBlbiBUZW5zb3JGbG93IExpdGUKaW50ZXJwcmV0ZXIgPSB0Zi5saXRlLkludGVycHJldGVyKG1vZGVsX3BhdGg9Im1vZGVsLnRmbGl0ZSIpCmludGVycHJldGVyLmFsbG9jYXRlX3RlbnNvcnMoKQppbnB1dF9kZXRhaWxzID0gaW50ZXJwcmV0ZXIuZ2V0X2lucHV0X2RldGFpbHMoKQpvdXRwdXRfZGV0YWlscyA9IGludGVycHJldGVyLmdldF9vdXRwdXRfZGV0YWlscygpCmlucHV0X2RhdGEgPSBucC5hcnJheSh4X3Rlc3RbMF0sIGR0eXBlPW5wLmZsb2F0MzIpCmlucHV0X2RhdGEgPSBucC5leHBhbmRfZGltcyhpbnB1dF9kYXRhLCBheGlzPTApCmludGVycHJldGVyLnNldF90ZW5zb3IoaW5wdXRfZGV0YWlsc1swXVsnaW5kZXgnXSwgaW5wdXRfZGF0YSkKaW50ZXJwcmV0ZXIuaW52b2tlKCkKb3V0cHV0X2RhdGEgPSBpbnRlcnByZXRlci5nZXRfdGVuc29yKG91dHB1dF9kZXRhaWxzWzBdWydpbmRleCddKQpwcmludCgiUHJlZGljY2nDs246IiwgbnAuYXJnbWF4KG91dHB1dF9kYXRhKSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Paso 1: Entrenar el modelo (ver c&oacute;digo anterior)

# Paso 2: Convertir el modelo a TensorFlow Lite
converter = tf.lite.TFLiteConverter.from_keras_model(model)
tflite_model = converter.convert()
with open('model.tflite', 'wb') as f:
    f.write(tflite_model)

# Paso 3: Ejecutar el modelo en TensorFlow Lite
interpreter = tf.lite.Interpreter(model_path=&quot;model.tflite&quot;)
interpreter.allocate_tensors()
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()
input_data = np.array(x_test[0], dtype=np.float32)
input_data = np.expand_dims(input_data, axis=0)
interpreter.set_tensor(input_details[0]['index'], input_data)
interpreter.invoke()
output_data = interpreter.get_tensor(output_details[0]['index'])
print(&quot;Predicci&oacute;n:&quot;, np.argmax(output_data))</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, hemos aprendido qué es TensorFlow Lite, cómo convertir modelos de TensorFlow a TensorFlow Lite y cómo ejecutar estos modelos en dispositivos móviles y embebidos. También hemos explorado técnicas de optimización como la cuantización para mejorar el rendimiento de los modelos en dispositivos con recursos limitados. Con estos conocimientos, estás preparado para llevar tus modelos de aprendizaje automático a una amplia gama de dispositivos y aplicaciones del mundo real.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='09-04-model-analysis' title="Análisis de Modelos">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='10-02-tensorflow-js' title="TensorFlow.js">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
