<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargando Datos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/tensorflow/03-01-loading-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/tensorflow/03-01-loading-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/tensorflow/03-01-loading-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/tensorflow/03-01-loading-data" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/tensorflow/03-01-loading-data" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-eager-execution' title="Ejecución Eager">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Cargando Datos</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-data-pipelines-with-tf-data' title="Pipelines de Datos con tf.data">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos cómo cargar datos en TensorFlow, una habilidad fundamental para cualquier proyecto de aprendizaje automático. TensorFlow proporciona varias herramientas y métodos para manejar datos de manera eficiente. Vamos a explorar las formas más comunes de cargar datos y prepararlos para su uso en modelos de aprendizaje automático.</p>
</div><h1>Contenido</h1>
<div class='content'><ol>
<li><a href="#introducción-a-la-carga-de-datos">Introducción a la Carga de Datos</a></li>
<li><a href="#cargando-datos-desde-archivos-csv">Cargando Datos desde Archivos CSV</a></li>
<li><a href="#cargando-datos-desde-archivos-de-imagen">Cargando Datos desde Archivos de Imagen</a></li>
<li><a href="#cargando-datos-desde-tfrecord">Cargando Datos desde TFRecord</a></li>
<li><a href="#ejercicios-prácticos">Ejercicios Prácticos</a></li>
<li><a href="#conclusión">Conclusión</a></li>
</ol>
</div><h1>Introducción a la Carga de Datos</h1>
<div class='content'><p>TensorFlow ofrece varias formas de cargar y preprocesar datos. Las más comunes incluyen:</p>
<ul>
<li>Archivos CSV</li>
<li>Imágenes</li>
<li>TFRecord</li>
</ul>
<p>Cada uno de estos métodos tiene sus propias ventajas y desventajas, y la elección del método adecuado depende del tipo de datos y del problema que se esté resolviendo.</p>
</div><h1>Cargando Datos desde Archivos CSV</h1>
<div class='content'><p>Los archivos CSV (Comma-Separated Values) son una forma común de almacenar datos tabulares. TensorFlow proporciona funciones para leer y procesar estos archivos de manera eficiente.</p>
</div><h2>Ejemplo Práctico</h2>
<div class='content'><p>Supongamos que tenemos un archivo CSV llamado <code>data.csv</code> con el siguiente contenido:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZmVhdHVyZTEsZmVhdHVyZTIsbGFiZWwKMS4wLDIuMCwwCjIuMCwzLjAsMQozLjAsNC4wLDA="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>feature1,feature2,label
1.0,2.0,0
2.0,3.0,1
3.0,4.0,0</pre></div><div class='content'><p>Podemos cargar este archivo en TensorFlow de la siguiente manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pciBsYSBmdW5jacOzbiBwYXJhIHBhcnNlYXIgY2FkYSBsw61uZWEgZGVsIENTVgpkZWYgcGFyc2VfY3N2KGxpbmUpOgogICAgZXhhbXBsZV9kZWZhdWx0cyA9IFtbMC4wXSwgWzAuMF0sIFswXV0gICMgRGVmaW5pciBsb3MgdGlwb3MgZGUgZGF0b3MKICAgIHBhcnNlZF9saW5lID0gdGYuaW8uZGVjb2RlX2NzdihsaW5lLCBleGFtcGxlX2RlZmF1bHRzKQogICAgZmVhdHVyZXMgPSB0Zi5zdGFjayhwYXJzZWRfbGluZVs6LTFdKQogICAgbGFiZWwgPSBwYXJzZWRfbGluZVstMV0KICAgIHJldHVybiBmZWF0dXJlcywgbGFiZWwKCiMgQ2FyZ2FyIGVsIGFyY2hpdm8gQ1NWCmRhdGFzZXQgPSB0Zi5kYXRhLlRleHRMaW5lRGF0YXNldCgiZGF0YS5jc3YiKS5za2lwKDEpICAjIFNhbHRhciBsYSBjYWJlY2VyYQpkYXRhc2V0ID0gZGF0YXNldC5tYXAocGFyc2VfY3N2KQoKIyBJdGVyYXIgc29icmUgZWwgZGF0YXNldApmb3IgZmVhdHVyZXMsIGxhYmVsIGluIGRhdGFzZXQ6CiAgICBwcmludCgiRmVhdHVyZXM6IiwgZmVhdHVyZXMubnVtcHkoKSwgIkxhYmVsOiIsIGxhYmVsLm51bXB5KCkp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definir la funci&oacute;n para parsear cada l&iacute;nea del CSV
def parse_csv(line):
    example_defaults = [[0.0], [0.0], [0]]  # Definir los tipos de datos
    parsed_line = tf.io.decode_csv(line, example_defaults)
    features = tf.stack(parsed_line[:-1])
    label = parsed_line[-1]
    return features, label

# Cargar el archivo CSV
dataset = tf.data.TextLineDataset(&quot;data.csv&quot;).skip(1)  # Saltar la cabecera
dataset = dataset.map(parse_csv)

# Iterar sobre el dataset
for features, label in dataset:
    print(&quot;Features:&quot;, features.numpy(), &quot;Label:&quot;, label.numpy())</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ol>
<li><strong>Definición de la función <code>parse_csv</code></strong>: Esta función define cómo se debe parsear cada línea del archivo CSV. Utiliza <code>tf.io.decode_csv</code> para convertir la línea en un tensor.</li>
<li><strong>Cargar el archivo CSV</strong>: Utilizamos <code>tf.data.TextLineDataset</code> para leer el archivo línea por línea. La función <code>skip(1)</code> se usa para saltar la cabecera del archivo.</li>
<li><strong>Mapeo de la función <code>parse_csv</code></strong>: Aplicamos la función <code>parse_csv</code> a cada línea del dataset.</li>
<li><strong>Iteración sobre el dataset</strong>: Iteramos sobre el dataset para imprimir las características y las etiquetas.</li>
</ol>
</div><h1>Cargando Datos desde Archivos de Imagen</h1>
<div class='content'><p>Para proyectos de visión por computadora, es común trabajar con archivos de imagen. TensorFlow facilita la carga y el preprocesamiento de imágenes.</p>
</div><h2>Ejemplo Práctico</h2>
<div class='content'><p>Supongamos que tenemos un directorio con imágenes de gatos y perros organizadas de la siguiente manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("L2RhdGEKICAgIC9jYXRzCiAgICAgICAgY2F0MS5qcGcKICAgICAgICBjYXQyLmpwZwogICAgICAgIC4uLgogICAgL2RvZ3MKICAgICAgICBkb2cxLmpwZwogICAgICAgIGRvZzIuanBnCiAgICAgICAgLi4u"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/data
    /cats
        cat1.jpg
        cat2.jpg
        ...
    /dogs
        dog1.jpg
        dog2.jpg
        ...</pre></div><div class='content'><p>Podemos cargar estas imágenes en TensorFlow de la siguiente manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pciBlbCBkaXJlY3RvcmlvIGRlIGRhdG9zCmRhdGFfZGlyID0gImRhdGEvIgoKIyBDcmVhciB1biBkYXRhc2V0IGRlIGltw6FnZW5lcwpkYXRhc2V0ID0gdGYua2VyYXMucHJlcHJvY2Vzc2luZy5pbWFnZV9kYXRhc2V0X2Zyb21fZGlyZWN0b3J5KAogICAgZGF0YV9kaXIsCiAgICBpbWFnZV9zaXplPSgxMjgsIDEyOCksCiAgICBiYXRjaF9zaXplPTMyCikKCiMgSXRlcmFyIHNvYnJlIGVsIGRhdGFzZXQKZm9yIGltYWdlcywgbGFiZWxzIGluIGRhdGFzZXQ6CiAgICBwcmludCgiSW1hZ2VzIGJhdGNoIHNoYXBlOiIsIGltYWdlcy5zaGFwZSkKICAgIHByaW50KCJMYWJlbHMgYmF0Y2ggc2hhcGU6IiwgbGFiZWxzLnNoYXBlKQogICAgYnJlYWs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definir el directorio de datos
data_dir = &quot;data/&quot;

# Crear un dataset de im&aacute;genes
dataset = tf.keras.preprocessing.image_dataset_from_directory(
    data_dir,
    image_size=(128, 128),
    batch_size=32
)

# Iterar sobre el dataset
for images, labels in dataset:
    print(&quot;Images batch shape:&quot;, images.shape)
    print(&quot;Labels batch shape:&quot;, labels.shape)
    break</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ol>
<li><strong>Definición del directorio de datos</strong>: Especificamos el directorio donde se encuentran las imágenes.</li>
<li><strong>Creación del dataset de imágenes</strong>: Utilizamos <code>tf.keras.preprocessing.image_dataset_from_directory</code> para cargar las imágenes. Este método organiza automáticamente las imágenes en batches y las redimensiona al tamaño especificado.</li>
<li><strong>Iteración sobre el dataset</strong>: Iteramos sobre el dataset para imprimir las formas de los batches de imágenes y etiquetas.</li>
</ol>
</div><h1>Cargando Datos desde TFRecord</h1>
<div class='content'><p>TFRecord es un formato de archivo optimizado para almacenar grandes cantidades de datos. Es especialmente útil para entrenar modelos en TensorFlow.</p>
</div><h2>Ejemplo Práctico</h2>
<div class='content'><p>Supongamos que tenemos un archivo TFRecord llamado <code>data.tfrecord</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKCiMgRGVmaW5pciBsYSBmdW5jacOzbiBwYXJhIHBhcnNlYXIgY2FkYSBlamVtcGxvIGRlbCBURlJlY29yZApkZWYgcGFyc2VfdGZyZWNvcmQoZXhhbXBsZV9wcm90byk6CiAgICBmZWF0dXJlX2Rlc2NyaXB0aW9uID0gewogICAgICAgICdmZWF0dXJlMSc6IHRmLmlvLkZpeGVkTGVuRmVhdHVyZShbXSwgdGYuZmxvYXQzMiksCiAgICAgICAgJ2ZlYXR1cmUyJzogdGYuaW8uRml4ZWRMZW5GZWF0dXJlKFtdLCB0Zi5mbG9hdDMyKSwKICAgICAgICAnbGFiZWwnOiB0Zi5pby5GaXhlZExlbkZlYXR1cmUoW10sIHRmLmludDY0KSwKICAgIH0KICAgIHJldHVybiB0Zi5pby5wYXJzZV9zaW5nbGVfZXhhbXBsZShleGFtcGxlX3Byb3RvLCBmZWF0dXJlX2Rlc2NyaXB0aW9uKQoKIyBDYXJnYXIgZWwgYXJjaGl2byBURlJlY29yZApkYXRhc2V0ID0gdGYuZGF0YS5URlJlY29yZERhdGFzZXQoImRhdGEudGZyZWNvcmQiKQpkYXRhc2V0ID0gZGF0YXNldC5tYXAocGFyc2VfdGZyZWNvcmQpCgojIEl0ZXJhciBzb2JyZSBlbCBkYXRhc2V0CmZvciByZWNvcmQgaW4gZGF0YXNldDoKICAgIHByaW50KHJlY29yZCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf

# Definir la funci&oacute;n para parsear cada ejemplo del TFRecord
def parse_tfrecord(example_proto):
    feature_description = {
        'feature1': tf.io.FixedLenFeature([], tf.float32),
        'feature2': tf.io.FixedLenFeature([], tf.float32),
        'label': tf.io.FixedLenFeature([], tf.int64),
    }
    return tf.io.parse_single_example(example_proto, feature_description)

# Cargar el archivo TFRecord
dataset = tf.data.TFRecordDataset(&quot;data.tfrecord&quot;)
dataset = dataset.map(parse_tfrecord)

# Iterar sobre el dataset
for record in dataset:
    print(record)</pre></div><div class='content'></div><h2>Explicación del Código</h2>
<div class='content'><ol>
<li><strong>Definición de la función <code>parse_tfrecord</code></strong>: Esta función define cómo se debe parsear cada ejemplo del archivo TFRecord. Utiliza <code>tf.io.parse_single_example</code> para convertir el ejemplo en un diccionario de características.</li>
<li><strong>Cargar el archivo TFRecord</strong>: Utilizamos <code>tf.data.TFRecordDataset</code> para leer el archivo.</li>
<li><strong>Mapeo de la función <code>parse_tfrecord</code></strong>: Aplicamos la función <code>parse_tfrecord</code> a cada ejemplo del dataset.</li>
<li><strong>Iteración sobre el dataset</strong>: Iteramos sobre el dataset para imprimir cada registro.</li>
</ol>
</div><h1>Ejercicios Prácticos</h1>
<div class='content'></div><h2>Ejercicio 1: Cargar un Archivo CSV</h2>
<div class='content'><p>Crea un archivo CSV con datos ficticios y escribe un script en TensorFlow para cargar y procesar estos datos.</p>
</div><h2>Ejercicio 2: Cargar Imágenes</h2>
<div class='content'><p>Organiza un conjunto de imágenes en directorios y escribe un script en TensorFlow para cargar y preprocesar estas imágenes.</p>
</div><h2>Ejercicio 3: Cargar un Archivo TFRecord</h2>
<div class='content'><p>Crea un archivo TFRecord con datos ficticios y escribe un script en TensorFlow para cargar y procesar estos datos.</p>
</div><h1>Conclusión</h1>
<div class='content'><p>En esta sección, hemos aprendido cómo cargar datos en TensorFlow desde diferentes fuentes, incluyendo archivos CSV, imágenes y archivos TFRecord. La capacidad de manejar datos de manera eficiente es crucial para el éxito de cualquier proyecto de aprendizaje automático. En el próximo módulo, exploraremos cómo construir pipelines de datos utilizando <code>tf.data</code> para manejar grandes volúmenes de datos de manera eficiente.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='02-04-eager-execution' title="Ejecución Eager">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='03-02-data-pipelines-with-tf-data' title="Pipelines de Datos con tf.data">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
