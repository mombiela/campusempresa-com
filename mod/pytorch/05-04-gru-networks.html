<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="index, follow, noarchive">
    <title>Unidades Recurrentes con Puerta (GRUs)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/05-04-gru-networks" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/05-04-gru-networks" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/05-04-gru-networks" hreflang="en" />
    
	<!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"> -->
	<link href="/css/bootstrap/bootstrap.css?v=1" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.2b8e6213f8.css" rel="stylesheet">
	 
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script>
  		var LANG = "es";
  		var CATEGORY = "frameworks";
  		var MOD_NAME = "pytorch";
  		var TEMA_NAME = "05-04";
  		var TYPE = "mod";
  		var PATH = "mod/pytorch/05-04-gru-networks";
  		var IS_INDEX = false;
  		var DEVELOP = sessionStorage.getItem("DEVELOP") == "true";
  		  		var ALL_PAGES_MOD = ["01-01-what-is-pytorch","01-02-setting-up-environment","01-03-basic-tensor-operations","01-04-autograd","02-01-introduction-to-neural-networks","02-02-creating-simple-neural-network","02-03-activation-functions","02-04-loss-functions-optimization","03-01-data-loading-preprocessing","03-02-training-loop","03-03-validation-testing","03-04-saving-loading-models","04-01-introduction-to-cnns","04-02-building-cnn-from-scratch","04-03-transfer-learning","04-04-fine-tuning-cnns","05-01-introduction-to-rnns","05-02-building-rnn-from-scratch","05-03-lstm-networks","05-04-gru-networks","06-01-gans","06-02-reinforcement-learning","06-03-deploying-models","06-04-optimizing-performance","07-01-image-classification-project","07-02-nlp-project","07-03-time-series-forecasting-project","07-04-custom-project"];
  		  	</script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<!-- <script type="text/javascript" src="/js/main.js"></script> -->
  	<script type="module" src="/js/app.198aab099d.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
</head>

<body class="d-none">
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-0 text-end">
			<p class="mb-0 p-0">	<a href="https://enterprisecampus.net/mod/pytorch/05-04-gru-networks" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/pytorch/05-04-gru-networks" class="px-2">CA</a>
</p>
			<p class="mb-4 mt-0 mx-2  d-none d-md-block"><cite>Todo el conocimiento a tu alcance</cite></p>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>
		<div class="top-bar container-fluid p-0">
	<div class="container-xxl p-0">
		<div class="row">
			<div class="col">
				<div class="d-flex justify-content-between">
					<div class="left">
						<a href="/" class="nav-link px-3" id="btnHome">
	<i class="bi bi-house-fill"></i>
	HOME
</a>

<a href="/my_modules" class="nav-link px-3 d-none" id="btnMyCourses">
	<i class="bi bi-rocket-takeoff-fill"></i>
	<i><b>Mis cursos</b></i>
</a>
<a href="/end_modules" class="nav-link px-3 d-none" id="trophy_button">
	<i class="bi bi-trophy-fill"></i>
	Finalizados             
</a>

					</div>
                    <div class="ms-auto right">
                        <a id="user_button" href="#" class="nav-link px-3" style="display:none;" data-bs-toggle="modal" data-bs-target="#loginModal">
                            <i id="user_icon" class="bi"></i>                            
                        </a>
                    </div>					
				</div>
			</div>
		</div>
	</div>
</div>

		<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
										<div class="row py-1 m-0" id="buttonsModSection">
	<div class="col-6 p-0" data-mod="pytorch">
		<a  href="#" class="text-secondary d-none" data-read-mod="pytorch" data-read-unit="05-04" style="text-decoration:none;">
			<i class="bi bi-check-circle-fill"></i> 
			Marcar como leído
		</a>
		<a href="#" class="text-secondary d-none" data-unread-mod="pytorch" data-unread-unit="05-04" style="text-decoration:none;">
			<i class="bi bi-x-circle-fill"></i>
			Marcar como no leído
		</a>
	</div>
	<div class="col-6 text-end p-0">
					<a href="./"  class="nav-link">
				<i class="bi bi-journal-text"></i>
				Contenido del curso
			</a>
			</div>
</div>						<div id="inner_content">
				<div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-03-lstm-networks' title="Redes de Memoria a Largo Plazo (LSTM)" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-03-lstm-networks' title="Redes de Memoria a Largo Plazo (LSTM)" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
					<h2 style="text-decoration:underline">Unidades Recurrentes con Puerta (GRUs)</h2>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-01-gans' title="Redes Generativas Antagónicas (GANs)" class="py-2 px-3 btn btn-primary"
				data-read-mod="pytorch" data-read-unit="05-04">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-01-gans' title="Redes Generativas Antagónicas (GANs)" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="05-04">
				 &#x25BA;
			</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Las Unidades Recurrentes con Puerta (GRUs, por sus siglas en inglés) son una variante de las Redes Neuronales Recurrentes (RNNs) diseñadas para abordar el problema del desvanecimiento del gradiente y mejorar la capacidad de las RNNs para capturar dependencias a largo plazo en secuencias de datos. Las GRUs son similares a las Redes de Memoria a Largo Plazo (LSTM), pero con una estructura más simple y menos parámetros.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ol>
<li><strong>Puerta de Actualización</strong>: Controla cuánto de la información pasada debe ser llevada al futuro.</li>
<li><strong>Puerta de Reinicio</strong>: Decide cuánto de la información pasada debe ser olvidada.</li>
<li><strong>Estado Oculto</strong>: Representa la memoria de la red en un momento dado.</li>
</ol>
</div><h1>Estructura de una GRU</h1>
<div class='content'><p>Una GRU tiene dos puertas principales: la puerta de actualización y la puerta de reinicio. A continuación se muestra la estructura matemática de una GRU:</p>
<ol>
<li>
<p><strong>Puerta de Actualización</strong>:
\[
z_t = \sigma(W_z \cdot [h_{t-1}, x_t])
\]
Donde:</p>
<ul>
<li>\( z_t \) es el vector de la puerta de actualización.</li>
<li>\( W_z \) son los pesos de la puerta de actualización.</li>
<li>\( h_{t-1} \) es el estado oculto anterior.</li>
<li>\( x_t \) es la entrada en el tiempo \( t \).</li>
<li>\( \sigma \) es la función sigmoide.</li>
</ul>
</li>
<li>
<p><strong>Puerta de Reinicio</strong>:
\[
r_t = \sigma(W_r \cdot [h_{t-1}, x_t])
\]
Donde:</p>
<ul>
<li>\( r_t \) es el vector de la puerta de reinicio.</li>
<li>\( W_r \) son los pesos de la puerta de reinicio.</li>
</ul>
</li>
<li>
<p><strong>Estado Candidato</strong>:
\[
\tilde{h}<em>t = \tanh(W \cdot [r_t * h</em>{t-1}, x_t])
\]
Donde:</p>
<ul>
<li>\( \tilde{h}_t \) es el estado candidato.</li>
<li>\( W \) son los pesos de la red.</li>
<li>\( * \) denota la multiplicación elemento a elemento.</li>
</ul>
</li>
<li>
<p><strong>Estado Oculto</strong>:
\[
h_t = (1 - z_t) * h_{t-1} + z_t * \tilde{h}_t
\]</p>
</li>
</ol>
</div><h1>Implementación en PyTorch</h1>
<div class='content'></div><h2>Ejemplo Práctico</h2>
<div class='content'><p>Vamos a implementar una GRU simple en PyTorch para predecir una secuencia de números.</p>
</div><h2>Paso 1: Importar Librerías</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KaW1wb3J0IG51bXB5IGFzIG5w"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
import numpy as np</pre></div><div class='content'></div><h2>Paso 2: Definir la Clase de la GRU</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgR1JVTmV0KG5uLk1vZHVsZSk6CiAgICBkZWYgX19pbml0X18oc2VsZiwgaW5wdXRfc2l6ZSwgaGlkZGVuX3NpemUsIG91dHB1dF9zaXplLCBudW1fbGF5ZXJzKToKICAgICAgICBzdXBlcihHUlVOZXQsIHNlbGYpLl9faW5pdF9fKCkKICAgICAgICBzZWxmLmhpZGRlbl9zaXplID0gaGlkZGVuX3NpemUKICAgICAgICBzZWxmLm51bV9sYXllcnMgPSBudW1fbGF5ZXJzCiAgICAgICAgc2VsZi5ncnUgPSBubi5HUlUoaW5wdXRfc2l6ZSwgaGlkZGVuX3NpemUsIG51bV9sYXllcnMsIGJhdGNoX2ZpcnN0PVRydWUpCiAgICAgICAgc2VsZi5mYyA9IG5uLkxpbmVhcihoaWRkZW5fc2l6ZSwgb3V0cHV0X3NpemUpCiAgICAKICAgIGRlZiBmb3J3YXJkKHNlbGYsIHgpOgogICAgICAgIGgwID0gdG9yY2guemVyb3Moc2VsZi5udW1fbGF5ZXJzLCB4LnNpemUoMCksIHNlbGYuaGlkZGVuX3NpemUpLnRvKHguZGV2aWNlKQogICAgICAgIG91dCwgXyA9IHNlbGYuZ3J1KHgsIGgwKQogICAgICAgIG91dCA9IHNlbGYuZmMob3V0WzosIC0xLCA6XSkKICAgICAgICByZXR1cm4gb3V0"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class GRUNet(nn.Module):
    def __init__(self, input_size, hidden_size, output_size, num_layers):
        super(GRUNet, self).__init__()
        self.hidden_size = hidden_size
        self.num_layers = num_layers
        self.gru = nn.GRU(input_size, hidden_size, num_layers, batch_first=True)
        self.fc = nn.Linear(hidden_size, output_size)
    
    def forward(self, x):
        h0 = torch.zeros(self.num_layers, x.size(0), self.hidden_size).to(x.device)
        out, _ = self.gru(x, h0)
        out = self.fc(out[:, -1, :])
        return out</pre></div><div class='content'></div><h2>Paso 3: Preparar los Datos</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHZW5lcmFyIGRhdG9zIGRlIGVqZW1wbG8KZGVmIGNyZWF0ZV9pbm91dF9zZXF1ZW5jZXMoaW5wdXRfZGF0YSwgdHcpOgogICAgaW5vdXRfc2VxID0gW10KICAgIEwgPSBsZW4oaW5wdXRfZGF0YSkKICAgIGZvciBpIGluIHJhbmdlKEwtdHcpOgogICAgICAgIHRyYWluX3NlcSA9IGlucHV0X2RhdGFbaTppK3R3XQogICAgICAgIHRyYWluX2xhYmVsID0gaW5wdXRfZGF0YVtpK3R3OmkrdHcrMV0KICAgICAgICBpbm91dF9zZXEuYXBwZW5kKCh0cmFpbl9zZXEsIHRyYWluX2xhYmVsKSkKICAgIHJldHVybiBpbm91dF9zZXEKCmRhdGEgPSBucC5zaW4obnAubGluc3BhY2UoMCwgMTAwLCAxMDAwKSkKdHJhaW5fd2luZG93ID0gMTAKdHJhaW5faW5vdXRfc2VxID0gY3JlYXRlX2lub3V0X3NlcXVlbmNlcyhkYXRhLCB0cmFpbl93aW5kb3cpCgojIENvbnZlcnRpciBhIHRlbnNvcmVzCnRyYWluX2lub3V0X3NlcSA9IFsodG9yY2gudGVuc29yKHNlcSwgZHR5cGU9dG9yY2guZmxvYXQzMikudW5zcXVlZXplKDApLCB0b3JjaC50ZW5zb3IobGFiZWwsIGR0eXBlPXRvcmNoLmZsb2F0MzIpKSBmb3Igc2VxLCBsYWJlbCBpbiB0cmFpbl9pbm91dF9zZXFd"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Generar datos de ejemplo
def create_inout_sequences(input_data, tw):
    inout_seq = []
    L = len(input_data)
    for i in range(L-tw):
        train_seq = input_data[i:i+tw]
        train_label = input_data[i+tw:i+tw+1]
        inout_seq.append((train_seq, train_label))
    return inout_seq

data = np.sin(np.linspace(0, 100, 1000))
train_window = 10
train_inout_seq = create_inout_sequences(data, train_window)

# Convertir a tensores
train_inout_seq = [(torch.tensor(seq, dtype=torch.float32).unsqueeze(0), torch.tensor(label, dtype=torch.float32)) for seq, label in train_inout_seq]</pre></div><div class='content'></div><h2>Paso 4: Entrenar el Modelo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBIaXBlcnBhcsOhbWV0cm9zCmlucHV0X3NpemUgPSAxCmhpZGRlbl9zaXplID0gNTAKb3V0cHV0X3NpemUgPSAxCm51bV9sYXllcnMgPSAxCm51bV9lcG9jaHMgPSAxMDAKbGVhcm5pbmdfcmF0ZSA9IDAuMDEKCiMgSW5pY2lhbGl6YXIgZWwgbW9kZWxvLCBsYSBmdW5jacOzbiBkZSBww6lyZGlkYSB5IGVsIG9wdGltaXphZG9yCm1vZGVsID0gR1JVTmV0KGlucHV0X3NpemUsIGhpZGRlbl9zaXplLCBvdXRwdXRfc2l6ZSwgbnVtX2xheWVycykKY3JpdGVyaW9uID0gbm4uTVNFTG9zcygpCm9wdGltaXplciA9IG9wdGltLkFkYW0obW9kZWwucGFyYW1ldGVycygpLCBscj1sZWFybmluZ19yYXRlKQoKIyBFbnRyZW5hbWllbnRvCmZvciBlcG9jaCBpbiByYW5nZShudW1fZXBvY2hzKToKICAgIGZvciBzZXEsIGxhYmVscyBpbiB0cmFpbl9pbm91dF9zZXE6CiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpCiAgICAgICAgeV9wcmVkID0gbW9kZWwoc2VxLnVuc3F1ZWV6ZSgtMSkpCiAgICAgICAgbG9zcyA9IGNyaXRlcmlvbih5X3ByZWQsIGxhYmVscykKICAgICAgICBsb3NzLmJhY2t3YXJkKCkKICAgICAgICBvcHRpbWl6ZXIuc3RlcCgpCiAgICAKICAgIGlmIGVwb2NoICUgMTAgPT0gMDoKICAgICAgICBwcmludChmJ0Vwb2NoIHtlcG9jaH0sIExvc3M6IHtsb3NzLml0ZW0oKX0nKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Hiperpar&aacute;metros
input_size = 1
hidden_size = 50
output_size = 1
num_layers = 1
num_epochs = 100
learning_rate = 0.01

# Inicializar el modelo, la funci&oacute;n de p&eacute;rdida y el optimizador
model = GRUNet(input_size, hidden_size, output_size, num_layers)
criterion = nn.MSELoss()
optimizer = optim.Adam(model.parameters(), lr=learning_rate)

# Entrenamiento
for epoch in range(num_epochs):
    for seq, labels in train_inout_seq:
        optimizer.zero_grad()
        y_pred = model(seq.unsqueeze(-1))
        loss = criterion(y_pred, labels)
        loss.backward()
        optimizer.step()
    
    if epoch % 10 == 0:
        print(f'Epoch {epoch}, Loss: {loss.item()}')</pre></div><div class='content'></div><h2>Paso 5: Evaluar el Modelo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFdmFsdWFyIGVsIG1vZGVsbwptb2RlbC5ldmFsKCkKdGVzdF9pbnB1dHMgPSBkYXRhWzp0cmFpbl93aW5kb3ddLnRvbGlzdCgpCmZvciBpIGluIHJhbmdlKDEwMCk6CiAgICBzZXEgPSB0b3JjaC50ZW5zb3IodGVzdF9pbnB1dHNbLXRyYWluX3dpbmRvdzpdLCBkdHlwZT10b3JjaC5mbG9hdDMyKS51bnNxdWVlemUoMCkudW5zcXVlZXplKC0xKQogICAgd2l0aCB0b3JjaC5ub19ncmFkKCk6CiAgICAgICAgdGVzdF9pbnB1dHMuYXBwZW5kKG1vZGVsKHNlcSkuaXRlbSgpKQoKIyBWaXN1YWxpemFyIGxvcyByZXN1bHRhZG9zCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKCnBsdC5wbG90KGRhdGEsIGxhYmVsPSdPcmlnaW5hbCBEYXRhJykKcGx0LnBsb3QocmFuZ2UodHJhaW5fd2luZG93LCB0cmFpbl93aW5kb3crMTAwKSwgdGVzdF9pbnB1dHNbdHJhaW5fd2luZG93Ol0sIGxhYmVsPSdQcmVkaWN0ZWQgRGF0YScpCnBsdC5sZWdlbmQoKQpwbHQuc2hvdygp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Evaluar el modelo
model.eval()
test_inputs = data[:train_window].tolist()
for i in range(100):
    seq = torch.tensor(test_inputs[-train_window:], dtype=torch.float32).unsqueeze(0).unsqueeze(-1)
    with torch.no_grad():
        test_inputs.append(model(seq).item())

# Visualizar los resultados
import matplotlib.pyplot as plt

plt.plot(data, label='Original Data')
plt.plot(range(train_window, train_window+100), test_inputs[train_window:], label='Predicted Data')
plt.legend()
plt.show()</pre></div><div class='content'></div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio</h2>
<div class='content'><p>Implementa una GRU para predecir la serie temporal de la función coseno en lugar de la función seno. Sigue los mismos pasos que en el ejemplo anterior, pero cambia la generación de datos para usar la función coseno.</p>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHZW5lcmFyIGRhdG9zIGRlIGVqZW1wbG8gY29uIGxhIGZ1bmNpw7NuIGNvc2VubwpkYXRhID0gbnAuY29zKG5wLmxpbnNwYWNlKDAsIDEwMCwgMTAwMCkpCnRyYWluX3dpbmRvdyA9IDEwCnRyYWluX2lub3V0X3NlcSA9IGNyZWF0ZV9pbm91dF9zZXF1ZW5jZXMoZGF0YSwgdHJhaW5fd2luZG93KQoKIyBDb252ZXJ0aXIgYSB0ZW5zb3Jlcwp0cmFpbl9pbm91dF9zZXEgPSBbKHRvcmNoLnRlbnNvcihzZXEsIGR0eXBlPXRvcmNoLmZsb2F0MzIpLnVuc3F1ZWV6ZSgwKSwgdG9yY2gudGVuc29yKGxhYmVsLCBkdHlwZT10b3JjaC5mbG9hdDMyKSkgZm9yIHNlcSwgbGFiZWwgaW4gdHJhaW5faW5vdXRfc2VxXQoKIyBJbmljaWFsaXphciBlbCBtb2RlbG8sIGxhIGZ1bmNpw7NuIGRlIHDDqXJkaWRhIHkgZWwgb3B0aW1pemFkb3IKbW9kZWwgPSBHUlVOZXQoaW5wdXRfc2l6ZSwgaGlkZGVuX3NpemUsIG91dHB1dF9zaXplLCBudW1fbGF5ZXJzKQpjcml0ZXJpb24gPSBubi5NU0VMb3NzKCkKb3B0aW1pemVyID0gb3B0aW0uQWRhbShtb2RlbC5wYXJhbWV0ZXJzKCksIGxyPWxlYXJuaW5nX3JhdGUpCgojIEVudHJlbmFtaWVudG8KZm9yIGVwb2NoIGluIHJhbmdlKG51bV9lcG9jaHMpOgogICAgZm9yIHNlcSwgbGFiZWxzIGluIHRyYWluX2lub3V0X3NlcToKICAgICAgICBvcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICB5X3ByZWQgPSBtb2RlbChzZXEudW5zcXVlZXplKC0xKSkKICAgICAgICBsb3NzID0gY3JpdGVyaW9uKHlfcHJlZCwgbGFiZWxzKQogICAgICAgIGxvc3MuYmFja3dhcmQoKQogICAgICAgIG9wdGltaXplci5zdGVwKCkKICAgIAogICAgaWYgZXBvY2ggJSAxMCA9PSAwOgogICAgICAgIHByaW50KGYnRXBvY2gge2Vwb2NofSwgTG9zczoge2xvc3MuaXRlbSgpfScpCgojIEV2YWx1YXIgZWwgbW9kZWxvCm1vZGVsLmV2YWwoKQp0ZXN0X2lucHV0cyA9IGRhdGFbOnRyYWluX3dpbmRvd10udG9saXN0KCkKZm9yIGkgaW4gcmFuZ2UoMTAwKToKICAgIHNlcSA9IHRvcmNoLnRlbnNvcih0ZXN0X2lucHV0c1stdHJhaW5fd2luZG93Ol0sIGR0eXBlPXRvcmNoLmZsb2F0MzIpLnVuc3F1ZWV6ZSgwKS51bnNxdWVlemUoLTEpCiAgICB3aXRoIHRvcmNoLm5vX2dyYWQoKToKICAgICAgICB0ZXN0X2lucHV0cy5hcHBlbmQobW9kZWwoc2VxKS5pdGVtKCkpCgojIFZpc3VhbGl6YXIgbG9zIHJlc3VsdGFkb3MKcGx0LnBsb3QoZGF0YSwgbGFiZWw9J09yaWdpbmFsIERhdGEnKQpwbHQucGxvdChyYW5nZSh0cmFpbl93aW5kb3csIHRyYWluX3dpbmRvdysxMDApLCB0ZXN0X2lucHV0c1t0cmFpbl93aW5kb3c6XSwgbGFiZWw9J1ByZWRpY3RlZCBEYXRhJykKcGx0LmxlZ2VuZCgpCnBsdC5zaG93KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Generar datos de ejemplo con la funci&oacute;n coseno
data = np.cos(np.linspace(0, 100, 1000))
train_window = 10
train_inout_seq = create_inout_sequences(data, train_window)

# Convertir a tensores
train_inout_seq = [(torch.tensor(seq, dtype=torch.float32).unsqueeze(0), torch.tensor(label, dtype=torch.float32)) for seq, label in train_inout_seq]

# Inicializar el modelo, la funci&oacute;n de p&eacute;rdida y el optimizador
model = GRUNet(input_size, hidden_size, output_size, num_layers)
criterion = nn.MSELoss()
optimizer = optim.Adam(model.parameters(), lr=learning_rate)

# Entrenamiento
for epoch in range(num_epochs):
    for seq, labels in train_inout_seq:
        optimizer.zero_grad()
        y_pred = model(seq.unsqueeze(-1))
        loss = criterion(y_pred, labels)
        loss.backward()
        optimizer.step()
    
    if epoch % 10 == 0:
        print(f'Epoch {epoch}, Loss: {loss.item()}')

# Evaluar el modelo
model.eval()
test_inputs = data[:train_window].tolist()
for i in range(100):
    seq = torch.tensor(test_inputs[-train_window:], dtype=torch.float32).unsqueeze(0).unsqueeze(-1)
    with torch.no_grad():
        test_inputs.append(model(seq).item())

# Visualizar los resultados
plt.plot(data, label='Original Data')
plt.plot(range(train_window, train_window+100), test_inputs[train_window:], label='Predicted Data')
plt.legend()
plt.show()</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>En esta sección, hemos aprendido sobre las Unidades Recurrentes con Puerta (GRUs), su estructura y cómo implementarlas en PyTorch. Las GRUs son una herramienta poderosa para trabajar con secuencias de datos y pueden ser utilizadas en una variedad de aplicaciones, desde la predicción de series temporales hasta el procesamiento de lenguaje natural. En el próximo módulo, exploraremos temas avanzados como las Redes Generativas Antagónicas (GANs) y el Aprendizaje por Refuerzo con PyTorch.</p>
</div><div class='row navigation'>
	<div class='col-2 d-none d-md-block'>
					<a href='05-03-lstm-networks' title="Redes de Memoria a Largo Plazo (LSTM)" class="py-2 px-3 btn btn-primary">
				&#x25C4; Anterior 
			</a>
			</div>
	<div class='col-2 d-md-none'>
					<a href='05-03-lstm-networks' title="Redes de Memoria a Largo Plazo (LSTM)" class="py-2 px-3 btn btn-primary">
				&#x25C4;
			</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end d-none d-md-block'>
					<a href='06-01-gans' title="Redes Generativas Antagónicas (GANs)" class="py-2 px-3 btn btn-primary"
				data-read-mod="pytorch" data-read-unit="05-04">
				Siguiente &#x25BA;
			</a>
			</div>
	<div class='col-2 text-end d-md-none '>
					<a href='06-01-gans' title="Redes Generativas Antagónicas (GANs)" class="py-2 px-3 btn btn-primary" 
				data-read-mod="pytorch" data-read-unit="05-04">
				 &#x25BA;
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			
	<div class="container mt-2 d-none d-md-block index">
		<h1>PyTorch: De Principiante a Avanzado</h1>
<h2>Módulo 1: Introducción a PyTorch</h2>
<ul>
<li><a href="01-01-what-is-pytorch">¿Qué es PyTorch?</a></li>
<li><a href="01-02-setting-up-environment">Configuración del Entorno</a></li>
<li><a href="01-03-basic-tensor-operations">Operaciones Básicas con Tensores</a></li>
<li><a href="01-04-autograd">Autograd: Diferenciación Automática</a></li>
</ul>
<h2>Módulo 2: Construcción de Redes Neuronales</h2>
<ul>
<li><a href="02-01-introduction-to-neural-networks">Introducción a las Redes Neuronales</a></li>
<li><a href="02-02-creating-simple-neural-network">Creación de una Red Neuronal Simple</a></li>
<li><a href="02-03-activation-functions">Funciones de Activación</a></li>
<li><a href="02-04-loss-functions-optimization">Funciones de Pérdida y Optimización</a></li>
</ul>
<h2>Módulo 3: Entrenamiento de Redes Neuronales</h2>
<ul>
<li><a href="03-01-data-loading-preprocessing">Carga y Preprocesamiento de Datos</a></li>
<li><a href="03-02-training-loop">Bucle de Entrenamiento</a></li>
<li><a href="03-03-validation-testing">Validación y Pruebas</a></li>
<li><a href="03-04-saving-loading-models">Guardar y Cargar Modelos</a></li>
</ul>
<h2>Módulo 4: Redes Neuronales Convolucionales (CNNs)</h2>
<ul>
<li><a href="04-01-introduction-to-cnns">Introducción a las CNNs</a></li>
<li><a href="04-02-building-cnn-from-scratch">Construcción de una CNN desde Cero</a></li>
<li><a href="04-03-transfer-learning">Aprendizaje por Transferencia con Modelos Preentrenados</a></li>
<li><a href="04-04-fine-tuning-cnns">Ajuste Fino de CNNs</a></li>
</ul>
<h2>Módulo 5: Redes Neuronales Recurrentes (RNNs)</h2>
<ul>
<li><a href="05-01-introduction-to-rnns">Introducción a las RNNs</a></li>
<li><a href="05-02-building-rnn-from-scratch">Construcción de una RNN desde Cero</a></li>
<li><a href="05-03-lstm-networks">Redes de Memoria a Largo Plazo (LSTM)</a></li>
<li><a href="05-04-gru-networks">Unidades Recurrentes con Puerta (GRUs)</a></li>
</ul>
<h2>Módulo 6: Temas Avanzados</h2>
<ul>
<li><a href="06-01-gans">Redes Generativas Antagónicas (GANs)</a></li>
<li><a href="06-02-reinforcement-learning">Aprendizaje por Refuerzo con PyTorch</a></li>
<li><a href="06-03-deploying-models">Despliegue de Modelos PyTorch</a></li>
<li><a href="06-04-optimizing-performance">Optimización del Rendimiento</a></li>
</ul>
<h2>Módulo 7: Estudios de Caso y Proyectos</h2>
<ul>
<li><a href="07-01-image-classification-project">Proyecto de Clasificación de Imágenes</a></li>
<li><a href="07-02-nlp-project">Proyecto de Procesamiento de Lenguaje Natural</a></li>
<li><a href="07-03-time-series-forecasting-project">Proyecto de Pronóstico de Series Temporales</a></li>
<li><a href="07-04-custom-project">Proyecto Personalizado</a></li>
</ul>

	</div>










			<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

		</div>
	</div>
</div>		
<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

		<div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="loginModalLabel">Usuario no autenticado</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
            	<p id="loginModalEmail"></p>
            	<div id="mensaje" class="d-none alert alert-danger"></div>
            	<div id="mensaje_info" class="d-none alert alert-success"></div>
            	
            	<div id="modal-body-main">
					<div class="mt-4 d-none" id="forgotPasswordSection">
						<div class="mb-3">
    <label for="recovery-email" class="form-label">Correo electrónico</label>
    <input type="email" required class="form-control" id="recovery-email" placeholder="Introduce tu correo electrónico">
</div>
<button class="btn btn-primary" id="btnRecover">Enviar enlace de recuperación</button>

					</div>
									
					<div class="mt-4 d-none" id="deleteUserSection">	
						<div class="mb-3 alert alert-danger">
	¡Atención! Estás a punto de eliminar todos los datos de registro y progreso.<br><b>Esta acción no se puede deshacer.</b>
</div>
<div class="mb-3">
    <input type="password" required class="form-control" id="delete-user-pwd" placeholder="Introduce tu contraseña">
</div>
<button class="btn btn-primary" id="btnDeleteUser">Eliminar usuario</button>

					</div>
					
					<div class="mt-4 d-none" id="changePassordSection">
						<div class="mb-3 row">
	<div class="col col-12 my-2">
	    <input type="password" required class="form-control" id="change-pwd-actual" placeholder="Introduce el password actual">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-1" placeholder="Introduce el nuevo password">
	</div>
	<div class="col col-12 my-2">
    	<input type="password" required class="form-control" id="change-pwd-new-2" placeholder="Repite el nuevo password">
	</div>
</div>
<button class="btn btn-primary" id="btnChangePassword">Cambiar el password</button>

					</div>
					
					<div class="mt-4 d-none alert alert-warning" id="verifyPasswordSection">
						<p><b>Falta verificar correu</b></p>
						<a id="btnVerifyEmail" href="#">Enviar enlace de verificación</a>

					</div>
					
					<div class="mt-4 d-none" id="disconnectUserSection">
						<div class="mb-3">
    <button id="btnDisconnect" class="btn btn-primary">Desconectar</button>
</div>

<hr>

<div class="mt-3">
    <button class="btn btn-outline-secondary" id="change-password-link">Cambiar el password</button>
</div>

<div class="mt-3">
    <a href="#" id="delete-user-link">Eliminar usuario</a>
</div>

					</div>
	            
	            	<div class="mt-4 d-none" id="modalTabsSection">
	            		<ul class="nav nav-tabs" id="authTabs" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link active" id="login-tab" data-bs-toggle="tab" data-bs-target="#login" type="button" role="tab" aria-controls="login" aria-selected="true">
        	Iniciar sesión
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link" id="register-tab" data-bs-toggle="tab" data-bs-target="#register" type="button" role="tab" aria-controls="register" aria-selected="false">
        	Registrarse
        </button>
    </li>
</ul>

<div class="tab-content mt-3" id="authTabsContent">
    <div class="tab-pane fade show active" id="login" role="tabpanel" aria-labelledby="login-tab">
    	<div class="mb-3">
    <label for="login-username" class="form-label">Correo electrónico</label>
    <input type="email" required class="form-control" id="login-username" placeholder="Introduce tu correo electrónico">
</div>
<div class="mb-3">
    <label for="login-password" class="form-label">Contraseña</label>
    <input type="password"  required class="form-control" id="login-password" placeholder="Introduce tu contraseña">
</div>
<button class="btn btn-primary" id="btnLogin">Iniciar sesión</button>
<div class="mt-3">
    <a href="#" id="forgot-password-link">¿Has olvidado tu contraseña?</a>
</div>
    </div>

    <div class="tab-pane fade" id="register" role="tabpanel" aria-labelledby="register-tab">
    	<div class="mb-3">
    <label for="register-email" class="form-label">Correo electrónico</label>
    <input type="email" class="form-control" id="register-email" required placeholder="Introduce tu correo electrónico">
</div>

<div class="mb-3">
    <label for="register-password" class="form-label">Contraseña</label>
    <input type="password" class="form-control"  required id="register-password" placeholder="Introduce tu contraseña">
</div>

<div class="mb-3">
    <label for="register-name" class="form-label">Nombre</label>
    <input type="text" class="form-control"  required id="register-name" placeholder="Introduce tu nombre">
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-conditions-reg">
    <label for="accept-conditions-reg" class="form-check-label">
        He leído y acepto la <a href="/privacity" target="blank">Política de Privacidad</a> y los <a href="/licence" target="blank">Términos y Condiciones de Uso</a>.
    </label>
</div>

<div class="form-check mb-3">
    <input type="checkbox" class="form-check-input" id="accept-allow_comunications">
    <label for="accept-allow_comunications" class="form-check-label">
        Deseo recibir noticias y actualizaciones sobre los cursos (opcional).
    </label>
</div>

<button id="btnRegister" class="btn btn-primary">Registrarse</button>
    </div>
</div>
	            	</div>
            	</div>
            </div>
        </div>
    </div>
</div>

	</div>    
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
</body>
</html>
