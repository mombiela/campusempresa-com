<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guardar y Cargar Modelos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/saving-and-loading-models" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/saving-and-loading-models" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/saving-and-loading-models" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body  class="test" >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/pytorch/saving-and-loading-models" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/saving-and-loading-models" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
									<div class="assert">
						<p><b>Atención!</b> Ha habido un error en la generación del curso y puede contener errores de traducción.Estamos trabajando para solucinarlo por lo que se deben usar los contenidos con cuidado.Se puede consultar el contenido correcto en otro idioma en el siguiente enlace:<br>
						<a href="https://enterprisecampus.net/mod/pytorch/saving-and-loading-models">https://enterprisecampus.net/mod/pytorch/saving-and-loading-models</a></p>
					</div>
								<div class='row navigation'>
	<div class='col-4'>
					<a href='evaluating-model-performance'>&#x25C4;Evaluando el Rendimiento del Modelo</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Guardar y Cargar Modelos</a>
	</div>
	<div class='col-4 text-end'>
					<a href='convolutional-neural-networks-cnns'>Redes Neuronales Convolucionales (CNNs) &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En esta sección, cubriremos cómo guardar y cargar modelos en PyTorch. Esta es una habilidad crucial para cualquier practicante de aprendizaje automático, ya que te permite persistir tus modelos y reutilizarlos más tarde sin necesidad de reentrenarlos.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Diccionario de Estado</strong>: Un objeto diccionario de Python que mapea cada capa a su tensor de parámetros.</li>
<li><strong>Guardar un Modelo</strong>: Almacenar el diccionario de estado del modelo en un archivo.</li>
<li><strong>Cargar un Modelo</strong>: Restaurar el diccionario de estado del modelo desde un archivo.</li>
<li><strong>Checkpointing</strong>: Guardar información adicional como el número de época, el estado del optimizador, etc.</li>
</ul>
</div><h1>Guardar un Modelo</h1>
<div class='content'><p>Para guardar un modelo en PyTorch, normalmente guardas el diccionario de estado del modelo. Esto se hace usando la función <code>torch.save</code>.</p>
</div><h2>Ejemplo: Guardar un Modelo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgoKIyBEZWZpbmlyIHVuIG1vZGVsbyBzaW1wbGUKY2xhc3MgU2ltcGxlTW9kZWwobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcihTaW1wbGVNb2RlbCwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuZmMgPSBubi5MaW5lYXIoMTAsIDEpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIHNlbGYuZmMoeCkKCiMgSW5zdGFuY2lhciBlbCBtb2RlbG8KbW9kZWwgPSBTaW1wbGVNb2RlbCgpCgojIEd1YXJkYXIgZWwgZGljY2lvbmFyaW8gZGUgZXN0YWRvIGRlbCBtb2RlbG8KdG9yY2guc2F2ZShtb2RlbC5zdGF0ZV9kaWN0KCksICdtb2RlbC5wdGgnKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn

# Definir un modelo simple
class SimpleModel(nn.Module):
    def __init__(self):
        super(SimpleModel, self).__init__()
        self.fc = nn.Linear(10, 1)

    def forward(self, x):
        return self.fc(x)

# Instanciar el modelo
model = SimpleModel()

# Guardar el diccionario de estado del modelo
torch.save(model.state_dict(), 'model.pth')</pre></div><div class='content'><p>En este ejemplo:</p>
<ul>
<li>Definimos una red neuronal simple con una capa lineal.</li>
<li>Instanciamos el modelo.</li>
<li>Guardamos el diccionario de estado del modelo en un archivo llamado <code>model.pth</code>.</li>
</ul>
</div><h1>Cargar un Modelo</h1>
<div class='content'><p>Para cargar un modelo, necesitas crear una instancia del modelo y luego cargar el diccionario de estado en él usando el método <code>load_state_dict</code>.</p>
</div><h2>Ejemplo: Cargar un Modelo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCgojIERlZmluaXIgbGEgbWlzbWEgYXJxdWl0ZWN0dXJhIGRlbCBtb2RlbG8KY2xhc3MgU2ltcGxlTW9kZWwobm4uTW9kdWxlKToKICAgIGRlZiBfX2luaXRfXyhzZWxmKToKICAgICAgICBzdXBlcihTaW1wbGVNb2RlbCwgc2VsZikuX19pbml0X18oKQogICAgICAgIHNlbGYuZmMgPSBubi5MaW5lYXIoMTAsIDEpCgogICAgZGVmIGZvcndhcmQoc2VsZiwgeCk6CiAgICAgICAgcmV0dXJuIHNlbGYuZmMoeCkKCiMgSW5zdGFuY2lhciBlbCBtb2RlbG8KbW9kZWwgPSBTaW1wbGVNb2RlbCgpCgojIENhcmdhciBlbCBkaWNjaW9uYXJpbyBkZSBlc3RhZG8KbW9kZWwubG9hZF9zdGF0ZV9kaWN0KHRvcmNoLmxvYWQoJ21vZGVsLnB0aCcpKQoKIyBQb25lciBlbCBtb2RlbG8gZW4gbW9kbyBkZSBldmFsdWFjacOzbgptb2RlbC5ldmFsKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch

# Definir la misma arquitectura del modelo
class SimpleModel(nn.Module):
    def __init__(self):
        super(SimpleModel, self).__init__()
        self.fc = nn.Linear(10, 1)

    def forward(self, x):
        return self.fc(x)

# Instanciar el modelo
model = SimpleModel()

# Cargar el diccionario de estado
model.load_state_dict(torch.load('model.pth'))

# Poner el modelo en modo de evaluaci&oacute;n
model.eval()</pre></div><div class='content'><p>En este ejemplo:</p>
<ul>
<li>Definimos la misma arquitectura del modelo que antes.</li>
<li>Instanciamos el modelo.</li>
<li>Cargamos el diccionario de estado desde el archivo <code>model.pth</code>.</li>
<li>Ponemos el modelo en modo de evaluación usando <code>model.eval()</code>. Esto es importante ya que pone el modelo en modo de inferencia, afectando capas como dropout y normalización por lotes.</li>
</ul>
</div><h1>Checkpointing</h1>
<div class='content'><p>Checkpointing implica guardar no solo el diccionario de estado del modelo, sino también otra información como el estado del optimizador, el número de época, etc. Esto es útil para reanudar el entrenamiento desde un punto específico.</p>
</div><h2>Ejemplo: Guardar un Checkpoint</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoLm9wdGltIGFzIG9wdGltCgojIERlZmluaXIgZWwgbW9kZWxvIHkgZWwgb3B0aW1pemFkb3IKbW9kZWwgPSBTaW1wbGVNb2RlbCgpCm9wdGltaXplciA9IG9wdGltLlNHRChtb2RlbC5wYXJhbWV0ZXJzKCksIGxyPTAuMDEpCgojIEd1YXJkYXIgdW4gY2hlY2twb2ludApjaGVja3BvaW50ID0gewogICAgJ2Vwb2NoJzogMTAsCiAgICAnbW9kZWxfc3RhdGVfZGljdCc6IG1vZGVsLnN0YXRlX2RpY3QoKSwKICAgICdvcHRpbWl6ZXJfc3RhdGVfZGljdCc6IG9wdGltaXplci5zdGF0ZV9kaWN0KCksCiAgICAnbG9zcyc6IDAuNCwKfQp0b3JjaC5zYXZlKGNoZWNrcG9pbnQsICdjaGVja3BvaW50LnB0aCcp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch.optim as optim

# Definir el modelo y el optimizador
model = SimpleModel()
optimizer = optim.SGD(model.parameters(), lr=0.01)

# Guardar un checkpoint
checkpoint = {
    'epoch': 10,
    'model_state_dict': model.state_dict(),
    'optimizer_state_dict': optimizer.state_dict(),
    'loss': 0.4,
}
torch.save(checkpoint, 'checkpoint.pth')</pre></div><div class='content'></div><h2>Ejemplo: Cargar un Checkpoint</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBJbnN0YW5jaWFyIGVsIG1vZGVsbyB5IGVsIG9wdGltaXphZG9yCm1vZGVsID0gU2ltcGxlTW9kZWwoKQpvcHRpbWl6ZXIgPSBvcHRpbS5TR0QobW9kZWwucGFyYW1ldGVycygpLCBscj0wLjAxKQoKIyBDYXJnYXIgZWwgY2hlY2twb2ludApjaGVja3BvaW50ID0gdG9yY2gubG9hZCgnY2hlY2twb2ludC5wdGgnKQptb2RlbC5sb2FkX3N0YXRlX2RpY3QoY2hlY2twb2ludFsnbW9kZWxfc3RhdGVfZGljdCddKQpvcHRpbWl6ZXIubG9hZF9zdGF0ZV9kaWN0KGNoZWNrcG9pbnRbJ29wdGltaXplcl9zdGF0ZV9kaWN0J10pCmVwb2NoID0gY2hlY2twb2ludFsnZXBvY2gnXQpsb3NzID0gY2hlY2twb2ludFsnbG9zcyddCgojIFBvbmVyIGVsIG1vZGVsbyBlbiBtb2RvIGRlIGV2YWx1YWNpw7NuCm1vZGVsLmV2YWwoKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Instanciar el modelo y el optimizador
model = SimpleModel()
optimizer = optim.SGD(model.parameters(), lr=0.01)

# Cargar el checkpoint
checkpoint = torch.load('checkpoint.pth')
model.load_state_dict(checkpoint['model_state_dict'])
optimizer.load_state_dict(checkpoint['optimizer_state_dict'])
epoch = checkpoint['epoch']
loss = checkpoint['loss']

# Poner el modelo en modo de evaluaci&oacute;n
model.eval()</pre></div><div class='content'><p>En estos ejemplos:</p>
<ul>
<li>Guardamos un checkpoint que incluye el número de época, el diccionario de estado del modelo, el diccionario de estado del optimizador y la pérdida.</li>
<li>Cargamos el checkpoint y restauramos los estados del modelo y del optimizador, así como el número de época y la pérdida.</li>
</ul>
</div><h1>Resumen</h1>
<div class='content'><ul>
<li><strong>Diccionario de Estado</strong>: El componente clave para guardar y cargar modelos.</li>
<li><strong>Guardar un Modelo</strong>: Usa <code>torch.save(model.state_dict(), 'file.pth')</code>.</li>
<li><strong>Cargar un Modelo</strong>: Usa <code>model.load_state_dict(torch.load('file.pth'))</code> y pon el modelo en modo de evaluación con <code>model.eval()</code>.</li>
<li><strong>Checkpointing</strong>: Guarda información adicional como el número de época y el estado del optimizador para reanudar el entrenamiento más tarde.</li>
</ul>
<p>Al dominar estas técnicas, puedes gestionar eficientemente tus modelos y procesos de entrenamiento, asegurándote de que puedes guardar tu trabajo y continuar justo donde lo dejaste.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='evaluating-model-performance'>&#x25C4;Evaluando el Rendimiento del Modelo</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Guardar y Cargar Modelos</a>
	</div>
	<div class='col-4 text-end'>
					<a href='convolutional-neural-networks-cnns'>Redes Neuronales Convolucionales (CNNs) &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
