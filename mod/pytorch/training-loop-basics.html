<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conceptos Básicos del Bucle de Entrenamiento</title>

    <link rel="alternate" href="https://campusempresa.com/mod/pytorch/training-loop-basics" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/pytorch/training-loop-basics" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/pytorch/training-loop-basics" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/pytorch/training-loop-basics" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/pytorch/training-loop-basics" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='data-loading-and-preprocessing'>&#x25C4;Carga y Preprocesamiento de Datos</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Conceptos Básicos del Bucle de Entrenamiento</a>
	</div>
	<div class='col-4 text-end'>
					<a href='evaluating-model-performance'>Evaluando el Rendimiento del Modelo &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En esta sección, cubriremos los fundamentos de los bucles de entrenamiento en PyTorch. Entender los bucles de entrenamiento es crucial para construir y optimizar redes neuronales. Comenzaremos con los conceptos básicos y gradualmente avanzaremos hacia temas más avanzados.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Época</strong>: Un pase completo a través de todo el conjunto de datos de entrenamiento.</li>
<li><strong>Lote</strong>: Un subconjunto del conjunto de datos de entrenamiento utilizado para actualizar los parámetros del modelo.</li>
<li><strong>Paso Adelante</strong>: Calcular la salida de la red neuronal.</li>
<li><strong>Función de Pérdida</strong>: Una función que mide la diferencia entre la salida predicha y el objetivo real.</li>
<li><strong>Paso Atrás</strong>: Calcular los gradientes de la pérdida con respecto a los parámetros del modelo.</li>
<li><strong>Optimizador</strong>: Un algoritmo que actualiza los parámetros del modelo basado en los gradientes.</li>
</ul>
</div><h1>Estructura Básica del Bucle de Entrenamiento</h1>
<div class='content'><p>Un bucle de entrenamiento típico en PyTorch implica los siguientes pasos:</p>
<ol>
<li><strong>Inicializar el modelo, la función de pérdida y el optimizador</strong>.</li>
<li><strong>Iterar sobre el conjunto de datos</strong> durante un número de épocas.</li>
<li><strong>Para cada lote</strong> en el conjunto de datos:
<ul>
<li>Realizar un paso adelante.</li>
<li>Calcular la pérdida.</li>
<li>Realizar un paso atrás.</li>
<li>Actualizar los parámetros del modelo.</li>
</ul>
</li>
</ol>
</div><h2>Código de Ejemplo</h2>
<div class='content'><p>Aquí hay un ejemplo simple de un bucle de entrenamiento en PyTorch:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRvcmNoCmltcG9ydCB0b3JjaC5ubiBhcyBubgppbXBvcnQgdG9yY2gub3B0aW0gYXMgb3B0aW0KZnJvbSB0b3JjaC51dGlscy5kYXRhIGltcG9ydCBEYXRhTG9hZGVyLCBUZW5zb3JEYXRhc2V0CgojIENvbmp1bnRvIGRlIGRhdG9zIGZpY3RpY2lvCnggPSB0b3JjaC5yYW5kbigxMDAsIDEwKQp5ID0gdG9yY2gucmFuZG4oMTAwLCAxKQoKIyBEYXRhTG9hZGVyCmRhdGFzZXQgPSBUZW5zb3JEYXRhc2V0KHgsIHkpCmRhdGFsb2FkZXIgPSBEYXRhTG9hZGVyKGRhdGFzZXQsIGJhdGNoX3NpemU9MTAsIHNodWZmbGU9VHJ1ZSkKCiMgTW9kZWxvIHNpbXBsZQptb2RlbCA9IG5uLlNlcXVlbnRpYWwoCiAgICBubi5MaW5lYXIoMTAsIDUwKSwKICAgIG5uLlJlTFUoKSwKICAgIG5uLkxpbmVhcig1MCwgMSkKKQoKIyBGdW5jacOzbiBkZSBww6lyZGlkYSB5IG9wdGltaXphZG9yCmNyaXRlcmlvbiA9IG5uLk1TRUxvc3MoKQpvcHRpbWl6ZXIgPSBvcHRpbS5TR0QobW9kZWwucGFyYW1ldGVycygpLCBscj0wLjAxKQoKIyBCdWNsZSBkZSBlbnRyZW5hbWllbnRvCm51bV9lcG9jaHMgPSA1CmZvciBlcG9jaCBpbiByYW5nZShudW1fZXBvY2hzKToKICAgIGZvciBiYXRjaF94LCBiYXRjaF95IGluIGRhdGFsb2FkZXI6CiAgICAgICAgIyBQYXNvIGFkZWxhbnRlCiAgICAgICAgb3V0cHV0cyA9IG1vZGVsKGJhdGNoX3gpCiAgICAgICAgbG9zcyA9IGNyaXRlcmlvbihvdXRwdXRzLCBiYXRjaF95KQogICAgICAgIAogICAgICAgICMgUGFzbyBhdHLDoXMgeSBvcHRpbWl6YWNpw7NuCiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpCiAgICAgICAgbG9zcy5iYWNrd2FyZCgpCiAgICAgICAgb3B0aW1pemVyLnN0ZXAoKQogICAgCiAgICBwcmludChmJ8OJcG9jYSBbe2Vwb2NoKzF9L3tudW1fZXBvY2hzfV0sIFDDqXJkaWRhOiB7bG9zcy5pdGVtKCk6LjRmfScp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import torch
import torch.nn as nn
import torch.optim as optim
from torch.utils.data import DataLoader, TensorDataset

# Conjunto de datos ficticio
x = torch.randn(100, 10)
y = torch.randn(100, 1)

# DataLoader
dataset = TensorDataset(x, y)
dataloader = DataLoader(dataset, batch_size=10, shuffle=True)

# Modelo simple
model = nn.Sequential(
    nn.Linear(10, 50),
    nn.ReLU(),
    nn.Linear(50, 1)
)

# Funci&oacute;n de p&eacute;rdida y optimizador
criterion = nn.MSELoss()
optimizer = optim.SGD(model.parameters(), lr=0.01)

# Bucle de entrenamiento
num_epochs = 5
for epoch in range(num_epochs):
    for batch_x, batch_y in dataloader:
        # Paso adelante
        outputs = model(batch_x)
        loss = criterion(outputs, batch_y)
        
        # Paso atr&aacute;s y optimizaci&oacute;n
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
    
    print(f'&Eacute;poca [{epoch+1}/{num_epochs}], P&eacute;rdida: {loss.item():.4f}')</pre></div><div class='content'></div><h2>Explicación</h2>
<div class='content'><ul>
<li><strong>DataLoader</strong>: Utilizado para cargar el conjunto de datos en lotes.</li>
<li><strong>Modelo</strong>: Una red neuronal simple con una capa oculta.</li>
<li><strong>Criterio</strong>: Función de pérdida de Error Cuadrático Medio (MSE).</li>
<li><strong>Optimizador</strong>: Optimizador de Descenso de Gradiente Estocástico (SGD).</li>
<li><strong>Bucle de Entrenamiento</strong>: Itera sobre el conjunto de datos durante un número especificado de épocas, realizando pasos adelante y atrás, y actualizando los parámetros del modelo.</li>
</ul>
</div><h1>Temas Avanzados</h1>
<div class='content'></div><h2>Programación de la Tasa de Aprendizaje</h2>
<div class='content'><p>Ajustar la tasa de aprendizaje durante el entrenamiento puede ayudar a mejorar el rendimiento del modelo. PyTorch proporciona varios programadores de tasa de aprendizaje.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2NoZWR1bGVyID0gb3B0aW0ubHJfc2NoZWR1bGVyLlN0ZXBMUihvcHRpbWl6ZXIsIHN0ZXBfc2l6ZT0yLCBnYW1tYT0wLjEpCgpmb3IgZXBvY2ggaW4gcmFuZ2UobnVtX2Vwb2Nocyk6CiAgICBmb3IgYmF0Y2hfeCwgYmF0Y2hfeSBpbiBkYXRhbG9hZGVyOgogICAgICAgIG91dHB1dHMgPSBtb2RlbChiYXRjaF94KQogICAgICAgIGxvc3MgPSBjcml0ZXJpb24ob3V0cHV0cywgYmF0Y2hfeSkKICAgICAgICAKICAgICAgICBvcHRpbWl6ZXIuemVyb19ncmFkKCkKICAgICAgICBsb3NzLmJhY2t3YXJkKCkKICAgICAgICBvcHRpbWl6ZXIuc3RlcCgpCiAgICAKICAgIHNjaGVkdWxlci5zdGVwKCkKICAgIHByaW50KGYnw4lwb2NhIFt7ZXBvY2grMX0ve251bV9lcG9jaHN9XSwgUMOpcmRpZGE6IHtsb3NzLml0ZW0oKTouNGZ9LCBMUjoge3NjaGVkdWxlci5nZXRfbGFzdF9scigpfScp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>scheduler = optim.lr_scheduler.StepLR(optimizer, step_size=2, gamma=0.1)

for epoch in range(num_epochs):
    for batch_x, batch_y in dataloader:
        outputs = model(batch_x)
        loss = criterion(outputs, batch_y)
        
        optimizer.zero_grad()
        loss.backward()
        optimizer.step()
    
    scheduler.step()
    print(f'&Eacute;poca [{epoch+1}/{num_epochs}], P&eacute;rdida: {loss.item():.4f}, LR: {scheduler.get_last_lr()}')</pre></div><div class='content'></div><h2>Recorte de Gradientes</h2>
<div class='content'><p>El recorte de gradientes se utiliza para evitar que los gradientes exploten durante el entrenamiento.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm9yIGVwb2NoIGluIHJhbmdlKG51bV9lcG9jaHMpOgogICAgZm9yIGJhdGNoX3gsIGJhdGNoX3kgaW4gZGF0YWxvYWRlcjoKICAgICAgICBvdXRwdXRzID0gbW9kZWwoYmF0Y2hfeCkKICAgICAgICBsb3NzID0gY3JpdGVyaW9uKG91dHB1dHMsIGJhdGNoX3kpCiAgICAgICAgCiAgICAgICAgb3B0aW1pemVyLnplcm9fZ3JhZCgpCiAgICAgICAgbG9zcy5iYWNrd2FyZCgpCiAgICAgICAgCiAgICAgICAgIyBSZWNvcnRlIGRlIGdyYWRpZW50ZXMKICAgICAgICB0b3JjaC5ubi51dGlscy5jbGlwX2dyYWRfbm9ybV8obW9kZWwucGFyYW1ldGVycygpLCBtYXhfbm9ybT0xLjApCiAgICAgICAgCiAgICAgICAgb3B0aW1pemVyLnN0ZXAoKQogICAgCiAgICBwcmludChmJ8OJcG9jYSBbe2Vwb2NoKzF9L3tudW1fZXBvY2hzfV0sIFDDqXJkaWRhOiB7bG9zcy5pdGVtKCk6LjRmfScp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>for epoch in range(num_epochs):
    for batch_x, batch_y in dataloader:
        outputs = model(batch_x)
        loss = criterion(outputs, batch_y)
        
        optimizer.zero_grad()
        loss.backward()
        
        # Recorte de gradientes
        torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)
        
        optimizer.step()
    
    print(f'&Eacute;poca [{epoch+1}/{num_epochs}], P&eacute;rdida: {loss.item():.4f}')</pre></div><div class='content'></div><h1>Resumen</h1>
<div class='content'><p>En esta sección, cubrimos los conceptos básicos de los bucles de entrenamiento en PyTorch, incluyendo conceptos clave, una estructura básica de bucle de entrenamiento, y algunos temas avanzados como la programación de la tasa de aprendizaje y el recorte de gradientes. Entender estos fundamentos es esencial para construir y optimizar redes neuronales de manera efectiva.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='data-loading-and-preprocessing'>&#x25C4;Carga y Preprocesamiento de Datos</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Conceptos Básicos del Bucle de Entrenamiento</a>
	</div>
	<div class='col-4 text-end'>
					<a href='evaluating-model-performance'>Evaluando el Rendimiento del Modelo &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
