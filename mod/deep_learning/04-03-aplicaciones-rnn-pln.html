<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplicaciones de RNN en Procesamiento del Lenguaje Natural</title>

    <link rel="alternate" href="https://campusempresa.com/mod/deep_learning/04-03-aplicaciones-rnn-pln" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/deep_learning/04-03-aplicaciones-rnn-pln" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/deep_learning/04-03-rnn-applications-nlp" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/deep_learning/04-03-rnn-applications-nlp" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/deep_learning/04-03-aplicaciones-rnn-pln" class="px-2">CA</a>
								</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contenido del curso</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competencias técnicas</a>
				<a href="/all/conocimientos">Conocimientos</a>
				<a href="/all/soft_skills">Competencias sociales</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-02-lstm-gru' title="LSTM y GRU">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Aplicaciones de RNN en Procesamiento del Lenguaje Natural</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-04-secuencias-series-temporales' title="Secuencias y series temporales">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>Las Redes Neuronales Recurrentes (RNN) son una clase de redes neuronales especialmente adecuadas para el procesamiento de datos secuenciales, como el lenguaje natural. En esta sección, exploraremos cómo las RNN se aplican en diversas tareas de Procesamiento del Lenguaje Natural (PLN), proporcionando ejemplos prácticos y ejercicios para reforzar los conceptos.</p>
</div><h1><p>Conceptos Clave</p>
</h1>
<div class='content'><ol>
<li><strong>Secuencias y Dependencias Temporales</strong>: Las RNN son capaces de mantener información a lo largo de secuencias, lo que las hace ideales para tareas donde el contexto es importante.</li>
<li><strong>Tipos de RNN</strong>: Incluyen RNN simples, LSTM (Long Short-Term Memory) y GRU (Gated Recurrent Unit), cada una con sus propias ventajas para manejar dependencias a largo plazo.</li>
<li><strong>Tareas Comunes en PLN</strong>:
<ul>
<li><strong>Modelado de Lenguaje</strong>: Predecir la siguiente palabra en una secuencia.</li>
<li><strong>Traducción Automática</strong>: Convertir texto de un idioma a otro.</li>
<li><strong>Análisis de Sentimientos</strong>: Determinar el sentimiento expresado en un texto.</li>
<li><strong>Generación de Texto</strong>: Crear texto coherente y significativo.</li>
</ul>
</li>
</ol>
</div><h1><p>Ejemplo Práctico: Modelado de Lenguaje con RNN</p>
</h1>
<div class='content'><p>Vamos a construir un modelo simple de RNN para predecir la siguiente palabra en una secuencia de texto. Utilizaremos Keras, una biblioteca de alto nivel para redes neuronales en Python.</p>
</div><h2><p>Paso 1: Preparar los Datos</p>
</h2>
<div class='content'><p>Primero, necesitamos un conjunto de datos de texto. Para este ejemplo, utilizaremos un pequeño corpus de texto.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmZyb20ga2VyYXMucHJlcHJvY2Vzc2luZy50ZXh0IGltcG9ydCBUb2tlbml6ZXIKZnJvbSBrZXJhcy51dGlscyBpbXBvcnQgdG9fY2F0ZWdvcmljYWwKZnJvbSBrZXJhcy5tb2RlbHMgaW1wb3J0IFNlcXVlbnRpYWwKZnJvbSBrZXJhcy5sYXllcnMgaW1wb3J0IEVtYmVkZGluZywgU2ltcGxlUk5OLCBEZW5zZQoKIyBDb3JwdXMgZGUgdGV4dG8KdGV4dCA9ICJEZWVwIGxlYXJuaW5nIGlzIGEgc3ViZmllbGQgb2YgbWFjaGluZSBsZWFybmluZyBjb25jZXJuZWQgd2l0aCBhbGdvcml0aG1zIGluc3BpcmVkIGJ5IHRoZSBzdHJ1Y3R1cmUgYW5kIGZ1bmN0aW9uIG9mIHRoZSBicmFpbiBjYWxsZWQgYXJ0aWZpY2lhbCBuZXVyYWwgbmV0d29ya3MuIgoKIyBUb2tlbml6YWNpw7NuIGRlbCB0ZXh0bwp0b2tlbml6ZXIgPSBUb2tlbml6ZXIoKQp0b2tlbml6ZXIuZml0X29uX3RleHRzKFt0ZXh0XSkKc2VxdWVuY2VzID0gdG9rZW5pemVyLnRleHRzX3RvX3NlcXVlbmNlcyhbdGV4dF0pWzBdCgojIENyZWFyIHBhcmVzIGRlIGVudHJhZGEgeSBzYWxpZGEKdm9jYWJfc2l6ZSA9IGxlbih0b2tlbml6ZXIud29yZF9pbmRleCkgKyAxCnNlcXVlbmNlcyA9IG5wLmFycmF5KHNlcXVlbmNlcykKWCA9IFtdCnkgPSBbXQoKZm9yIGkgaW4gcmFuZ2UoMSwgbGVuKHNlcXVlbmNlcykpOgogICAgWC5hcHBlbmQoc2VxdWVuY2VzWzppXSkKICAgIHkuYXBwZW5kKHNlcXVlbmNlc1tpXSkKCiMgUGFkZGluZyBkZSBzZWN1ZW5jaWFzCm1heF9sZW5ndGggPSBtYXgoW2xlbihzZXEpIGZvciBzZXEgaW4gWF0pClggPSBucC5hcnJheShbbnAucGFkKHNlcSwgKDAsIG1heF9sZW5ndGggLSBsZW4oc2VxKSksICdjb25zdGFudCcpIGZvciBzZXEgaW4gWF0pCnkgPSB0b19jYXRlZ29yaWNhbCh5LCBudW1fY2xhc3Nlcz12b2NhYl9zaXplKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
from keras.preprocessing.text import Tokenizer
from keras.utils import to_categorical
from keras.models import Sequential
from keras.layers import Embedding, SimpleRNN, Dense

# Corpus de texto
text = &quot;Deep learning is a subfield of machine learning concerned with algorithms inspired by the structure and function of the brain called artificial neural networks.&quot;

# Tokenizaci&oacute;n del texto
tokenizer = Tokenizer()
tokenizer.fit_on_texts([text])
sequences = tokenizer.texts_to_sequences([text])[0]

# Crear pares de entrada y salida
vocab_size = len(tokenizer.word_index) + 1
sequences = np.array(sequences)
X = []
y = []

for i in range(1, len(sequences)):
    X.append(sequences[:i])
    y.append(sequences[i])

# Padding de secuencias
max_length = max([len(seq) for seq in X])
X = np.array([np.pad(seq, (0, max_length - len(seq)), 'constant') for seq in X])
y = to_categorical(y, num_classes=vocab_size)</pre></div><div class='content'></div><h2><p>Paso 2: Construir el Modelo</p>
</h2>
<div class='content'><p>Ahora, construiremos una RNN simple utilizando Keras.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb25zdHJ1Y2Npw7NuIGRlbCBtb2RlbG8KbW9kZWwgPSBTZXF1ZW50aWFsKCkKbW9kZWwuYWRkKEVtYmVkZGluZyhpbnB1dF9kaW09dm9jYWJfc2l6ZSwgb3V0cHV0X2RpbT0xMCwgaW5wdXRfbGVuZ3RoPW1heF9sZW5ndGgpKQptb2RlbC5hZGQoU2ltcGxlUk5OKHVuaXRzPTUwLCByZXR1cm5fc2VxdWVuY2VzPUZhbHNlKSkKbW9kZWwuYWRkKERlbnNlKHVuaXRzPXZvY2FiX3NpemUsIGFjdGl2YXRpb249J3NvZnRtYXgnKSkKCiMgQ29tcGlsYWNpw7NuIGRlbCBtb2RlbG8KbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLCBsb3NzPSdjYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLCBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCiMgUmVzdW1lbiBkZWwgbW9kZWxvCm1vZGVsLnN1bW1hcnkoKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Construcci&oacute;n del modelo
model = Sequential()
model.add(Embedding(input_dim=vocab_size, output_dim=10, input_length=max_length))
model.add(SimpleRNN(units=50, return_sequences=False))
model.add(Dense(units=vocab_size, activation='softmax'))

# Compilaci&oacute;n del modelo
model.compile(optimizer='adam', loss='categorical_crossentropy', metrics=['accuracy'])

# Resumen del modelo
model.summary()</pre></div><div class='content'></div><h2><p>Paso 3: Entrenar el Modelo</p>
</h2>
<div class='content'><p>Entrenamos el modelo con nuestros datos preparados.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBFbnRyZW5hbWllbnRvIGRlbCBtb2RlbG8KbW9kZWwuZml0KFgsIHksIGVwb2Nocz0xMDAsIHZlcmJvc2U9Mik="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Entrenamiento del modelo
model.fit(X, y, epochs=100, verbose=2)</pre></div><div class='content'></div><h2><p>Paso 4: Generar Texto</p>
</h2>
<div class='content'><p>Finalmente, utilizamos el modelo entrenado para predecir la siguiente palabra en una secuencia.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGdlbmVyYXRlX3RleHQoc2VlZF90ZXh0LCBuZXh0X3dvcmRzLCBtb2RlbCwgbWF4X2xlbmd0aCwgdG9rZW5pemVyKToKICAgIGZvciBfIGluIHJhbmdlKG5leHRfd29yZHMpOgogICAgICAgIHRva2VuX2xpc3QgPSB0b2tlbml6ZXIudGV4dHNfdG9fc2VxdWVuY2VzKFtzZWVkX3RleHRdKVswXQogICAgICAgIHRva2VuX2xpc3QgPSBucC5wYWQodG9rZW5fbGlzdCwgKDAsIG1heF9sZW5ndGggLSBsZW4odG9rZW5fbGlzdCkpLCAnY29uc3RhbnQnKQogICAgICAgIHByZWRpY3RlZCA9IG1vZGVsLnByZWRpY3QobnAuYXJyYXkoW3Rva2VuX2xpc3RdKSwgdmVyYm9zZT0wKQogICAgICAgIHByZWRpY3RlZF93b3JkID0gdG9rZW5pemVyLmluZGV4X3dvcmRbbnAuYXJnbWF4KHByZWRpY3RlZCldCiAgICAgICAgc2VlZF90ZXh0ICs9ICIgIiArIHByZWRpY3RlZF93b3JkCiAgICByZXR1cm4gc2VlZF90ZXh0CgojIEdlbmVyYXIgdGV4dG8Kc2VlZF90ZXh0ID0gIkRlZXAgbGVhcm5pbmciCmdlbmVyYXRlZF90ZXh0ID0gZ2VuZXJhdGVfdGV4dChzZWVkX3RleHQsIDUsIG1vZGVsLCBtYXhfbGVuZ3RoLCB0b2tlbml6ZXIpCnByaW50KGdlbmVyYXRlZF90ZXh0KQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def generate_text(seed_text, next_words, model, max_length, tokenizer):
    for _ in range(next_words):
        token_list = tokenizer.texts_to_sequences([seed_text])[0]
        token_list = np.pad(token_list, (0, max_length - len(token_list)), 'constant')
        predicted = model.predict(np.array([token_list]), verbose=0)
        predicted_word = tokenizer.index_word[np.argmax(predicted)]
        seed_text += &quot; &quot; + predicted_word
    return seed_text

# Generar texto
seed_text = &quot;Deep learning&quot;
generated_text = generate_text(seed_text, 5, model, max_length, tokenizer)
print(generated_text)</pre></div><div class='content'></div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Análisis de Sentimientos</p>
</h2>
<div class='content'><p>Crea un modelo RNN para realizar análisis de sentimientos en un conjunto de datos de reseñas de películas. Utiliza el conjunto de datos IMDB disponible en Keras.</p>
<p><strong>Pasos a seguir</strong>:</p>
<ol>
<li>Cargar y preprocesar el conjunto de datos IMDB.</li>
<li>Construir una RNN utilizando LSTM para clasificar las reseñas como positivas o negativas.</li>
<li>Entrenar y evaluar el modelo.</li>
</ol>
</div><h2><p>Solución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBrZXJhcy5kYXRhc2V0cyBpbXBvcnQgaW1kYgpmcm9tIGtlcmFzLnByZXByb2Nlc3Npbmcuc2VxdWVuY2UgaW1wb3J0IHBhZF9zZXF1ZW5jZXMKZnJvbSBrZXJhcy5sYXllcnMgaW1wb3J0IExTVE0KCiMgQ2FyZ2FyIGVsIGNvbmp1bnRvIGRlIGRhdG9zIElNREIKbWF4X2ZlYXR1cmVzID0gMTAwMDAKbWF4bGVuID0gNTAwCihYX3RyYWluLCB5X3RyYWluKSwgKFhfdGVzdCwgeV90ZXN0KSA9IGltZGIubG9hZF9kYXRhKG51bV93b3Jkcz1tYXhfZmVhdHVyZXMpCgojIFBhZGRpbmcgZGUgc2VjdWVuY2lhcwpYX3RyYWluID0gcGFkX3NlcXVlbmNlcyhYX3RyYWluLCBtYXhsZW49bWF4bGVuKQpYX3Rlc3QgPSBwYWRfc2VxdWVuY2VzKFhfdGVzdCwgbWF4bGVuPW1heGxlbikKCiMgQ29uc3RydWNjacOzbiBkZWwgbW9kZWxvCm1vZGVsID0gU2VxdWVudGlhbCgpCm1vZGVsLmFkZChFbWJlZGRpbmcoaW5wdXRfZGltPW1heF9mZWF0dXJlcywgb3V0cHV0X2RpbT0xMjgsIGlucHV0X2xlbmd0aD1tYXhsZW4pKQptb2RlbC5hZGQoTFNUTSh1bml0cz0xMjgsIHJldHVybl9zZXF1ZW5jZXM9RmFsc2UpKQptb2RlbC5hZGQoRGVuc2UodW5pdHM9MSwgYWN0aXZhdGlvbj0nc2lnbW9pZCcpKQoKIyBDb21waWxhY2nDs24gZGVsIG1vZGVsbwptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9J2JpbmFyeV9jcm9zc2VudHJvcHknLCBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCiMgRW50cmVuYW1pZW50byBkZWwgbW9kZWxvCm1vZGVsLmZpdChYX3RyYWluLCB5X3RyYWluLCBlcG9jaHM9MywgYmF0Y2hfc2l6ZT02NCwgdmFsaWRhdGlvbl9zcGxpdD0wLjIpCgojIEV2YWx1YWNpw7NuIGRlbCBtb2RlbG8KbG9zcywgYWNjdXJhY3kgPSBtb2RlbC5ldmFsdWF0ZShYX3Rlc3QsIHlfdGVzdCkKcHJpbnQoZidBY2N1cmFjeToge2FjY3VyYWN5ICogMTAwOi4yZn0lJyk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from keras.datasets import imdb
from keras.preprocessing.sequence import pad_sequences
from keras.layers import LSTM

# Cargar el conjunto de datos IMDB
max_features = 10000
maxlen = 500
(X_train, y_train), (X_test, y_test) = imdb.load_data(num_words=max_features)

# Padding de secuencias
X_train = pad_sequences(X_train, maxlen=maxlen)
X_test = pad_sequences(X_test, maxlen=maxlen)

# Construcci&oacute;n del modelo
model = Sequential()
model.add(Embedding(input_dim=max_features, output_dim=128, input_length=maxlen))
model.add(LSTM(units=128, return_sequences=False))
model.add(Dense(units=1, activation='sigmoid'))

# Compilaci&oacute;n del modelo
model.compile(optimizer='adam', loss='binary_crossentropy', metrics=['accuracy'])

# Entrenamiento del modelo
model.fit(X_train, y_train, epochs=3, batch_size=64, validation_split=0.2)

# Evaluaci&oacute;n del modelo
loss, accuracy = model.evaluate(X_test, y_test)
print(f'Accuracy: {accuracy * 100:.2f}%')</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En esta sección, hemos explorado cómo las RNN se aplican en diversas tareas de Procesamiento del Lenguaje Natural, como el modelado de lenguaje y el análisis de sentimientos. Hemos construido y entrenado modelos simples utilizando Keras, y hemos proporcionado ejercicios prácticos para reforzar los conceptos aprendidos. En la siguiente sección, profundizaremos en las secuencias y series temporales, explorando cómo las RNN pueden ser utilizadas para predecir datos secuenciales en otros dominios.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='04-02-lstm-gru' title="LSTM y GRU">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='04-04-secuencias-series-temporales' title="Secuencias y series temporales">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
