<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proyecto 4: Detección de fraudes</title>

    <link rel="alternate" href="https://campusempresa.com/mod/machine_learning/09-04-proyecto-deteccion-fraudes" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/machine_learning/09-04-proyecto-deteccion-fraudes" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/machine_learning/09-04-project-fraud-detection" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/machine_learning/09-04-project-fraud-detection" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/machine_learning/09-04-proyecto-deteccion-fraudes" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-proyecto-analisis-sentimientos' title="Proyecto 3: Análisis de sentimientos en redes sociales">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Proyecto 4: Detección de fraudes</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='10-01-libros-recomendados' title="Libros recomendados">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este proyecto, aprenderás a construir un modelo de Machine Learning para detectar fraudes en transacciones financieras. Este es un problema común y crítico en la industria financiera, donde la detección temprana de actividades fraudulentas puede ahorrar millones de dólares y proteger a los consumidores.</p>
</div><h1><p>Objetivos del Proyecto</p>
</h1>
<div class='content'><ol>
<li><strong>Comprender el problema de detección de fraudes</strong>: Familiarizarse con los conceptos y desafíos asociados con la detección de fraudes.</li>
<li><strong>Preprocesar los datos</strong>: Limpiar y preparar los datos para el análisis.</li>
<li><strong>Seleccionar y entrenar modelos de Machine Learning</strong>: Probar diferentes algoritmos y seleccionar el mejor modelo.</li>
<li><strong>Evaluar el rendimiento del modelo</strong>: Utilizar métricas de evaluación para medir la efectividad del modelo.</li>
<li><strong>Implementar el modelo</strong>: Desplegar el modelo en un entorno de producción.</li>
</ol>
</div><h1><p>Paso 1: Comprender el Problema de Detección de Fraudes</p>
</h1>
<div class='content'></div><h2><p>Descripción del Problema</p>
</h2>
<div class='content'><p>La detección de fraudes implica identificar transacciones financieras que son potencialmente fraudulentas. Las características comunes de las transacciones fraudulentas pueden incluir montos inusualmente altos, ubicaciones geográficas inusuales, y patrones de comportamiento atípicos.</p>
</div><h2><p>Desafíos</p>
</h2>
<div class='content'><ul>
<li><strong>Desbalance de clases</strong>: Las transacciones fraudulentas son mucho menos frecuentes que las transacciones legítimas.</li>
<li><strong>Evolución del fraude</strong>: Los métodos de fraude cambian con el tiempo, por lo que los modelos deben ser actualizados regularmente.</li>
<li><strong>Falsos positivos</strong>: Es crucial minimizar los falsos positivos para evitar inconvenientes a los usuarios legítimos.</li>
</ul>
</div><h1><p>Paso 2: Preprocesar los Datos</p>
</h1>
<div class='content'></div><h2><p>Limpieza de Datos</p>
</h2>
<div class='content'><ol>
<li><strong>Eliminar duplicados</strong>: Asegúrate de que no haya transacciones duplicadas en el conjunto de datos.</li>
<li><strong>Manejo de datos faltantes</strong>: Imputa o elimina valores faltantes según sea necesario.</li>
</ol>
</div><h2><p>Transformación de Datos</p>
</h2>
<div class='content'><ol>
<li><strong>Codificación de variables categóricas</strong>: Convierte las variables categóricas en variables numéricas utilizando técnicas como One-Hot Encoding.</li>
<li><strong>Normalización y estandarización</strong>: Escala las características numéricas para que tengan una media de 0 y una desviación estándar de 1.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHBhbmRhcyBhcyBwZApmcm9tIHNrbGVhcm4ucHJlcHJvY2Vzc2luZyBpbXBvcnQgU3RhbmRhcmRTY2FsZXIsIE9uZUhvdEVuY29kZXIKCiMgQ2FyZ2FyIGRhdG9zCmRhdGEgPSBwZC5yZWFkX2NzdigndHJhbnNhY2Npb25lcy5jc3YnKQoKIyBFbGltaW5hciBkdXBsaWNhZG9zCmRhdGEgPSBkYXRhLmRyb3BfZHVwbGljYXRlcygpCgojIE1hbmVqbyBkZSBkYXRvcyBmYWx0YW50ZXMKZGF0YSA9IGRhdGEuZmlsbG5hKG1ldGhvZD0nZmZpbGwnKQoKIyBDb2RpZmljYWNpw7NuIGRlIHZhcmlhYmxlcyBjYXRlZ8OzcmljYXMKZW5jb2RlciA9IE9uZUhvdEVuY29kZXIoKQpjYXRlZ29yaWNhbF9mZWF0dXJlcyA9IFsndGlwb190cmFuc2FjY2lvbicsICd1YmljYWNpb24nXQplbmNvZGVkX2ZlYXR1cmVzID0gZW5jb2Rlci5maXRfdHJhbnNmb3JtKGRhdGFbY2F0ZWdvcmljYWxfZmVhdHVyZXNdKS50b2FycmF5KCkKCiMgTm9ybWFsaXphY2nDs24geSBlc3RhbmRhcml6YWNpw7NuCnNjYWxlciA9IFN0YW5kYXJkU2NhbGVyKCkKbnVtZXJpY2FsX2ZlYXR1cmVzID0gWydtb250bycsICd0aWVtcG8nXQpzY2FsZWRfZmVhdHVyZXMgPSBzY2FsZXIuZml0X3RyYW5zZm9ybShkYXRhW251bWVyaWNhbF9mZWF0dXJlc10pCgojIENvbmNhdGVuYXIgY2FyYWN0ZXLDrXN0aWNhcyB0cmFuc2Zvcm1hZGFzCmltcG9ydCBudW1weSBhcyBucApYID0gbnAuY29uY2F0ZW5hdGUoW3NjYWxlZF9mZWF0dXJlcywgZW5jb2RlZF9mZWF0dXJlc10sIGF4aXM9MSkKeSA9IGRhdGFbJ2ZyYXVkZSdd"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pandas as pd
from sklearn.preprocessing import StandardScaler, OneHotEncoder

# Cargar datos
data = pd.read_csv('transacciones.csv')

# Eliminar duplicados
data = data.drop_duplicates()

# Manejo de datos faltantes
data = data.fillna(method='ffill')

# Codificaci&oacute;n de variables categ&oacute;ricas
encoder = OneHotEncoder()
categorical_features = ['tipo_transaccion', 'ubicacion']
encoded_features = encoder.fit_transform(data[categorical_features]).toarray()

# Normalizaci&oacute;n y estandarizaci&oacute;n
scaler = StandardScaler()
numerical_features = ['monto', 'tiempo']
scaled_features = scaler.fit_transform(data[numerical_features])

# Concatenar caracter&iacute;sticas transformadas
import numpy as np
X = np.concatenate([scaled_features, encoded_features], axis=1)
y = data['fraude']</pre></div><div class='content'></div><h1><p>Paso 3: Seleccionar y Entrenar Modelos de Machine Learning</p>
</h1>
<div class='content'></div><h2><p>Algoritmos a Utilizar</p>
</h2>
<div class='content'><ol>
<li><strong>Regresión Logística</strong></li>
<li><strong>Árboles de Decisión</strong></li>
<li><strong>Máquinas de Soporte Vectorial (SVM)</strong></li>
<li><strong>Random Forest</strong></li>
<li><strong>Gradient Boosting</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgdHJhaW5fdGVzdF9zcGxpdApmcm9tIHNrbGVhcm4ubGluZWFyX21vZGVsIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KZnJvbSBza2xlYXJuLnRyZWUgaW1wb3J0IERlY2lzaW9uVHJlZUNsYXNzaWZpZXIKZnJvbSBza2xlYXJuLmVuc2VtYmxlIGltcG9ydCBSYW5kb21Gb3Jlc3RDbGFzc2lmaWVyLCBHcmFkaWVudEJvb3N0aW5nQ2xhc3NpZmllcgpmcm9tIHNrbGVhcm4uc3ZtIGltcG9ydCBTVkMKCiMgRGl2aWRpciBkYXRvcyBlbiBjb25qdW50b3MgZGUgZW50cmVuYW1pZW50byB5IHBydWViYQpYX3RyYWluLCBYX3Rlc3QsIHlfdHJhaW4sIHlfdGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQoWCwgeSwgdGVzdF9zaXplPTAuMywgcmFuZG9tX3N0YXRlPTQyKQoKIyBFbnRyZW5hciBtb2RlbG9zCm1vZGVscyA9IHsKICAgICdMb2dpc3RpYyBSZWdyZXNzaW9uJzogTG9naXN0aWNSZWdyZXNzaW9uKCksCiAgICAnRGVjaXNpb24gVHJlZSc6IERlY2lzaW9uVHJlZUNsYXNzaWZpZXIoKSwKICAgICdSYW5kb20gRm9yZXN0JzogUmFuZG9tRm9yZXN0Q2xhc3NpZmllcigpLAogICAgJ0dyYWRpZW50IEJvb3N0aW5nJzogR3JhZGllbnRCb29zdGluZ0NsYXNzaWZpZXIoKSwKICAgICdTVk0nOiBTVkMoKQp9Cgpmb3IgbmFtZSwgbW9kZWwgaW4gbW9kZWxzLml0ZW1zKCk6CiAgICBtb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikKICAgIHByaW50KGYne25hbWV9IGVudHJlbmFkby4nKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from sklearn.svm import SVC

# Dividir datos en conjuntos de entrenamiento y prueba
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# Entrenar modelos
models = {
    'Logistic Regression': LogisticRegression(),
    'Decision Tree': DecisionTreeClassifier(),
    'Random Forest': RandomForestClassifier(),
    'Gradient Boosting': GradientBoostingClassifier(),
    'SVM': SVC()
}

for name, model in models.items():
    model.fit(X_train, y_train)
    print(f'{name} entrenado.')</pre></div><div class='content'></div><h1><p>Paso 4: Evaluar el Rendimiento del Modelo</p>
</h1>
<div class='content'></div><h2><p>Métricas de Evaluación</p>
</h2>
<div class='content'><ol>
<li><strong>Precisión</strong></li>
<li><strong>Recall</strong></li>
<li><strong>F1-Score</strong></li>
<li><strong>Matriz de Confusión</strong></li>
<li><strong>Curva ROC y AUC</strong></li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IGNsYXNzaWZpY2F0aW9uX3JlcG9ydCwgY29uZnVzaW9uX21hdHJpeCwgcm9jX2F1Y19zY29yZSwgcm9jX2N1cnZlCmltcG9ydCBtYXRwbG90bGliLnB5cGxvdCBhcyBwbHQKCiMgRXZhbHVhciBtb2RlbG9zCmZvciBuYW1lLCBtb2RlbCBpbiBtb2RlbHMuaXRlbXMoKToKICAgIHlfcHJlZCA9IG1vZGVsLnByZWRpY3QoWF90ZXN0KQogICAgcHJpbnQoZidcbntuYW1lfScpCiAgICBwcmludChjbGFzc2lmaWNhdGlvbl9yZXBvcnQoeV90ZXN0LCB5X3ByZWQpKQogICAgcHJpbnQoJ01hdHJpeiBkZSBDb25mdXNpw7NuOicpCiAgICBwcmludChjb25mdXNpb25fbWF0cml4KHlfdGVzdCwgeV9wcmVkKSkKICAgIAogICAgIyBDdXJ2YSBST0MKICAgIHlfcHJvYiA9IG1vZGVsLnByZWRpY3RfcHJvYmEoWF90ZXN0KVs6LCAxXQogICAgZnByLCB0cHIsIF8gPSByb2NfY3VydmUoeV90ZXN0LCB5X3Byb2IpCiAgICBwbHQucGxvdChmcHIsIHRwciwgbGFiZWw9Zid7bmFtZX0gKEFVQyA9IHtyb2NfYXVjX3Njb3JlKHlfdGVzdCwgeV9wcm9iKTouMmZ9KScpCgpwbHQucGxvdChbMCwgMV0sIFswLCAxXSwgJ2stLScpCnBsdC54bGFiZWwoJ0ZhbHNlIFBvc2l0aXZlIFJhdGUnKQpwbHQueWxhYmVsKCdUcnVlIFBvc2l0aXZlIFJhdGUnKQpwbHQudGl0bGUoJ0N1cnZhIFJPQycpCnBsdC5sZWdlbmQoKQpwbHQuc2hvdygp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.metrics import classification_report, confusion_matrix, roc_auc_score, roc_curve
import matplotlib.pyplot as plt

# Evaluar modelos
for name, model in models.items():
    y_pred = model.predict(X_test)
    print(f'\n{name}')
    print(classification_report(y_test, y_pred))
    print('Matriz de Confusi&oacute;n:')
    print(confusion_matrix(y_test, y_pred))
    
    # Curva ROC
    y_prob = model.predict_proba(X_test)[:, 1]
    fpr, tpr, _ = roc_curve(y_test, y_prob)
    plt.plot(fpr, tpr, label=f'{name} (AUC = {roc_auc_score(y_test, y_prob):.2f})')

plt.plot([0, 1], [0, 1], 'k--')
plt.xlabel('False Positive Rate')
plt.ylabel('True Positive Rate')
plt.title('Curva ROC')
plt.legend()
plt.show()</pre></div><div class='content'></div><h1><p>Paso 5: Implementar el Modelo</p>
</h1>
<div class='content'></div><h2><p>Despliegue en Producción</p>
</h2>
<div class='content'><ol>
<li><strong>Frameworks y Bibliotecas</strong>: Utiliza frameworks como Flask o Django para crear una API que permita a otros sistemas interactuar con el modelo.</li>
<li><strong>Mantenimiento y Monitoreo</strong>: Implementa mecanismos para monitorear el rendimiento del modelo y actualizarlo regularmente.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIGpzb25pZnkKaW1wb3J0IGpvYmxpYgoKIyBHdWFyZGFyIGVsIG1vZGVsbwpqb2JsaWIuZHVtcChtb2RlbHNbJ1JhbmRvbSBGb3Jlc3QnXSwgJ21vZGVsb19mcmF1ZGUucGtsJykKCiMgQ2FyZ2FyIGVsIG1vZGVsbwptb2RlbG8gPSBqb2JsaWIubG9hZCgnbW9kZWxvX2ZyYXVkZS5wa2wnKQoKYXBwID0gRmxhc2soX19uYW1lX18pCgpAYXBwLnJvdXRlKCcvcHJlZGljdCcsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBwcmVkaWN0KCk6CiAgICBkYXRhID0gcmVxdWVzdC5nZXRfanNvbihmb3JjZT1UcnVlKQogICAgcHJlZCA9IG1vZGVsby5wcmVkaWN0KFtkYXRhWydmZWF0dXJlcyddXSkKICAgIHJldHVybiBqc29uaWZ5KHsncHJlZGljdGlvbic6IGludChwcmVkWzBdKX0pCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, jsonify
import joblib

# Guardar el modelo
joblib.dump(models['Random Forest'], 'modelo_fraude.pkl')

# Cargar el modelo
modelo = joblib.load('modelo_fraude.pkl')

app = Flask(__name__)

@app.route('/predict', methods=['POST'])
def predict():
    data = request.get_json(force=True)
    pred = modelo.predict([data['features']])
    return jsonify({'prediction': int(pred[0])})

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En este proyecto, has aprendido a construir un modelo de Machine Learning para detectar fraudes en transacciones financieras. Has pasado por todas las etapas del proceso, desde la comprensión del problema hasta la implementación del modelo en un entorno de producción. Este proyecto te ha proporcionado una visión integral de cómo abordar problemas reales utilizando técnicas de Machine Learning.</p>
</div><h2><p>Resumen de Conceptos Clave</p>
</h2>
<div class='content'><ul>
<li><strong>Preprocesamiento de Datos</strong>: Limpieza, transformación, normalización y estandarización.</li>
<li><strong>Modelos de Machine Learning</strong>: Regresión Logística, Árboles de Decisión, Random Forest, Gradient Boosting, SVM.</li>
<li><strong>Evaluación del Modelo</strong>: Precisión, Recall, F1-Score, Matriz de Confusión, Curva ROC y AUC.</li>
<li><strong>Despliegue del Modelo</strong>: Creación de una API para la predicción y monitoreo del modelo en producción.</li>
</ul>
</div><h2><p>Próximos Pasos</p>
</h2>
<div class='content'><ul>
<li><strong>Experimentar con otros algoritmos y técnicas de preprocesamiento</strong>.</li>
<li><strong>Optimizar hiperparámetros para mejorar el rendimiento del modelo</strong>.</li>
<li><strong>Implementar técnicas de Ensemble Learning para combinar múltiples modelos</strong>.</li>
<li><strong>Explorar técnicas avanzadas como Deep Learning para problemas más complejos</strong>.</li>
</ul>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='09-03-proyecto-analisis-sentimientos' title="Proyecto 3: Análisis de sentimientos en redes sociales">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='10-01-libros-recomendados' title="Libros recomendados">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
