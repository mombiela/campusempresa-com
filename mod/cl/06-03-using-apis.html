<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Usando APIs</title>

    <link rel="alternate" href="https://campusempresa.com/mod/cl/06-03-using-apis" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/cl/06-03-using-apis" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/cl/06-03-using-apis" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/cl/06-03-using-apis" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/cl/06-03-using-apis" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-interfacing-databases' title="Interfaz con Bases de Datos">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Usando APIs</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-network-communication' title="Comunicación de Red">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este módulo, aprenderemos cómo interactuar con APIs (Interfaz de Programación de Aplicaciones) utilizando el Lenguaje de Control (CL). Las APIs permiten que diferentes sistemas y aplicaciones se comuniquen entre sí, lo que es esencial para la integración de sistemas y la automatización de procesos.</p>
</div><h1>Objetivos del Módulo</h1>
<div class='content'><ul>
<li>Entender qué es una API y cómo funciona.</li>
<li>Aprender a realizar llamadas a APIs desde un programa CL.</li>
<li>Manejar las respuestas de las APIs.</li>
<li>Implementar ejemplos prácticos de uso de APIs.</li>
</ul>
</div><h1>¿Qué es una API?</h1>
<div class='content'><p>Una API es un conjunto de definiciones y protocolos que permiten que una aplicación se comunique con otra. Las APIs son utilizadas para:</p>
<ul>
<li>Acceder a servicios web.</li>
<li>Interactuar con bases de datos.</li>
<li>Integrar funcionalidades de terceros en nuestras aplicaciones.</li>
</ul>
</div><h2>Tipos de APIs</h2>
<div class='content'><ul>
<li><strong>REST (Representational State Transfer):</strong> Utiliza HTTP y es el tipo más común de API.</li>
<li><strong>SOAP (Simple Object Access Protocol):</strong> Utiliza XML y es más estricto en su estructura.</li>
<li><strong>GraphQL:</strong> Permite consultas más flexibles y específicas.</li>
</ul>
</div><h1>Realizando Llamadas a APIs desde CL</h1>
<div class='content'><p>Para interactuar con una API desde un programa CL, generalmente utilizamos comandos del sistema operativo que permiten realizar solicitudes HTTP. En sistemas IBM i, podemos usar herramientas como <code>QSH</code> (QShell) o <code>curl</code>.</p>
</div><h2>Ejemplo Práctico: Llamada a una API REST</h2>
<div class='content'><p>Vamos a realizar una llamada a una API REST que devuelve información sobre el clima. Utilizaremos <code>curl</code> para hacer la solicitud HTTP.</p>
<h4>Paso 1: Configuración del Entorno</h4>
<p>Asegúrate de que <code>curl</code> esté disponible en tu sistema IBM i. Puedes verificarlo ejecutando el siguiente comando en QShell:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("JCBjdXJsIC0tdmVyc2lvbg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>$ curl --version</pre></div><div class='content'><h4>Paso 2: Escribiendo el Programa CL</h4>
<p>A continuación, se muestra un ejemplo de un programa CL que realiza una solicitud GET a una API de clima y guarda la respuesta en un archivo.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UEdNCgpEQ0wgVkFSKCZDSVRZKSBUWVBFKCpDSEFSKSBMRU4oNTApIFZBTFVFKCdMb25kb24nKQpEQ0wgVkFSKCZBUElfS0VZKSBUWVBFKCpDSEFSKSBMRU4oNTApIFZBTFVFKCd5b3VyX2FwaV9rZXlfaGVyZScpCkRDTCBWQVIoJlVSTCkgVFlQRSgqQ0hBUikgTEVOKDIwMCkKRENMIFZBUigmQ01EKSBUWVBFKCpDSEFSKSBMRU4oNTAwKQpEQ0wgVkFSKCZSRVNQT05TRV9GSUxFKSBUWVBFKCpDSEFSKSBMRU4oNTApIFZBTFVFKCcvdG1wL3dlYXRoZXJfcmVzcG9uc2UuanNvbicpCgpDSEdWQVIgVkFSKCZVUkwpIFZBTFVFKCdodHRwOi8vYXBpLm9wZW53ZWF0aGVybWFwLm9yZy9kYXRhLzIuNS93ZWF0aGVyP3E9JyAqQ0FUICZDSVRZICpDQVQgJyZhcHBpZD0nICpDQVQgJkFQSV9LRVkpCkNIR1ZBUiBWQVIoJkNNRCkgVkFMVUUoJ2N1cmwgLXMgIicgKkNBVCAmVVJMICpDQVQgJyIgLW8gJyAqQ0FUICZSRVNQT05TRV9GSUxFKQoKUVNIIENNRCgmQ01EKQoKRU5EUEdN"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PGM

DCL VAR(&amp;CITY) TYPE(*CHAR) LEN(50) VALUE('London')
DCL VAR(&amp;API_KEY) TYPE(*CHAR) LEN(50) VALUE('your_api_key_here')
DCL VAR(&amp;URL) TYPE(*CHAR) LEN(200)
DCL VAR(&amp;CMD) TYPE(*CHAR) LEN(500)
DCL VAR(&amp;RESPONSE_FILE) TYPE(*CHAR) LEN(50) VALUE('/tmp/weather_response.json')

CHGVAR VAR(&amp;URL) VALUE('http://api.openweathermap.org/data/2.5/weather?q=' *CAT &amp;CITY *CAT '&amp;appid=' *CAT &amp;API_KEY)
CHGVAR VAR(&amp;CMD) VALUE('curl -s &quot;' *CAT &amp;URL *CAT '&quot; -o ' *CAT &amp;RESPONSE_FILE)

QSH CMD(&amp;CMD)

ENDPGM</pre></div><div class='content'><h4>Explicación del Código</h4>
<ul>
<li><strong>DCL VAR(&amp;CITY):</strong> Declara una variable para la ciudad.</li>
<li><strong>DCL VAR(&amp;API_KEY):</strong> Declara una variable para la clave de la API.</li>
<li><strong>DCL VAR(&amp;URL):</strong> Declara una variable para la URL de la API.</li>
<li><strong>DCL VAR(&amp;CMD):</strong> Declara una variable para el comando <code>curl</code>.</li>
<li><strong>DCL VAR(&amp;RESPONSE_FILE):</strong> Declara una variable para el archivo donde se guardará la respuesta.</li>
<li><strong>CHGVAR VAR(&amp;URL):</strong> Construye la URL de la API con la ciudad y la clave de la API.</li>
<li><strong>CHGVAR VAR(&amp;CMD):</strong> Construye el comando <code>curl</code> para hacer la solicitud y guardar la respuesta.</li>
<li><strong>QSH CMD(&amp;CMD):</strong> Ejecuta el comando <code>curl</code> en QShell.</li>
</ul>
</div><h2>Manejo de Respuestas de la API</h2>
<div class='content'><p>Una vez que la respuesta de la API se guarda en un archivo, podemos procesarla en nuestro programa CL. Generalmente, las respuestas de las APIs están en formato JSON o XML.</p>
<h4>Ejemplo: Procesando una Respuesta JSON</h4>
<p>Para procesar una respuesta JSON, podemos usar herramientas adicionales como <code>jq</code> para filtrar y extraer datos específicos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UEdNCgpEQ0wgVkFSKCZDSVRZKSBUWVBFKCpDSEFSKSBMRU4oNTApIFZBTFVFKCdMb25kb24nKQpEQ0wgVkFSKCZBUElfS0VZKSBUWVBFKCpDSEFSKSBMRU4oNTApIFZBTFVFKCd5b3VyX2FwaV9rZXlfaGVyZScpCkRDTCBWQVIoJlVSTCkgVFlQRSgqQ0hBUikgTEVOKDIwMCkKRENMIFZBUigmQ01EKSBUWVBFKCpDSEFSKSBMRU4oNTAwKQpEQ0wgVkFSKCZSRVNQT05TRV9GSUxFKSBUWVBFKCpDSEFSKSBMRU4oNTApIFZBTFVFKCcvdG1wL3dlYXRoZXJfcmVzcG9uc2UuanNvbicpCkRDTCBWQVIoJlRFTVApIFRZUEUoKkNIQVIpIExFTigxMCkKCkNIR1ZBUiBWQVIoJlVSTCkgVkFMVUUoJ2h0dHA6Ly9hcGkub3BlbndlYXRoZXJtYXAub3JnL2RhdGEvMi41L3dlYXRoZXI/cT0nICpDQVQgJkNJVFkgKkNBVCAnJmFwcGlkPScgKkNBVCAmQVBJX0tFWSkKQ0hHVkFSIFZBUigmQ01EKSBWQUxVRSgnY3VybCAtcyAiJyAqQ0FUICZVUkwgKkNBVCAnIiAtbyAnICpDQVQgJlJFU1BPTlNFX0ZJTEUpCgpRU0ggQ01EKCZDTUQpCgpDSEdWQVIgVkFSKCZDTUQpIFZBTFVFKCdqcSAubWFpbi50ZW1wICcgKkNBVCAmUkVTUE9OU0VfRklMRSkKUVNIIENNRCgmQ01EKSBPVVRQVVQoJlRFTVApCgpTTkRQR01NU0cgTVNHKCdUaGUgdGVtcGVyYXR1cmUgaW4gJyAqQ0FUICZDSVRZICpDQVQgJyBpcyAnICpDQVQgJlRFTVAgKkNBVCAnSycpCgpFTkRQR00="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PGM

DCL VAR(&amp;CITY) TYPE(*CHAR) LEN(50) VALUE('London')
DCL VAR(&amp;API_KEY) TYPE(*CHAR) LEN(50) VALUE('your_api_key_here')
DCL VAR(&amp;URL) TYPE(*CHAR) LEN(200)
DCL VAR(&amp;CMD) TYPE(*CHAR) LEN(500)
DCL VAR(&amp;RESPONSE_FILE) TYPE(*CHAR) LEN(50) VALUE('/tmp/weather_response.json')
DCL VAR(&amp;TEMP) TYPE(*CHAR) LEN(10)

CHGVAR VAR(&amp;URL) VALUE('http://api.openweathermap.org/data/2.5/weather?q=' *CAT &amp;CITY *CAT '&amp;appid=' *CAT &amp;API_KEY)
CHGVAR VAR(&amp;CMD) VALUE('curl -s &quot;' *CAT &amp;URL *CAT '&quot; -o ' *CAT &amp;RESPONSE_FILE)

QSH CMD(&amp;CMD)

CHGVAR VAR(&amp;CMD) VALUE('jq .main.temp ' *CAT &amp;RESPONSE_FILE)
QSH CMD(&amp;CMD) OUTPUT(&amp;TEMP)

SNDPGMMSG MSG('The temperature in ' *CAT &amp;CITY *CAT ' is ' *CAT &amp;TEMP *CAT 'K')

ENDPGM</pre></div><div class='content'><h4>Explicación del Código</h4>
<ul>
<li><strong>QSH CMD(&amp;CMD) OUTPUT(&amp;TEMP):</strong> Ejecuta el comando <code>jq</code> para extraer la temperatura del archivo JSON y guarda el resultado en la variable <code>&amp;TEMP</code>.</li>
<li><strong>SNDPGMMSG:</strong> Envía un mensaje de programa con la temperatura extraída.</li>
</ul>
</div><h1>Ejercicios Prácticos</h1>
<div class='content'></div><h2>Ejercicio 1: Llamada a una API de Cotización de Monedas</h2>
<div class='content'><ol>
<li>Encuentra una API pública que proporcione cotizaciones de monedas.</li>
<li>Escribe un programa CL que realice una solicitud a esta API y guarde la respuesta en un archivo.</li>
<li>Extrae y muestra la cotización de una moneda específica.</li>
</ol>
</div><h2>Ejercicio 2: Integración con una API de Tareas</h2>
<div class='content'><ol>
<li>Encuentra una API pública que permita gestionar tareas (crear, leer, actualizar, eliminar).</li>
<li>Escribe un programa CL que cree una nueva tarea utilizando esta API.</li>
<li>Escribe otro programa CL que lea y muestre todas las tareas.</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>En este módulo, hemos aprendido cómo interactuar con APIs utilizando el Lenguaje de Control (CL). Hemos visto cómo realizar solicitudes HTTP, manejar respuestas y procesar datos. Las APIs son una herramienta poderosa para integrar sistemas y automatizar procesos, y ahora tienes las habilidades básicas para empezar a utilizarlas en tus programas CL.</p>
<p>En el próximo módulo, exploraremos técnicas de depuración y optimización para mejorar el rendimiento y la eficiencia de tus programas CL.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='06-02-interfacing-databases' title="Interfaz con Bases de Datos">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='06-04-network-communication' title="Comunicación de Red">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
