<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow, noarchive">
    <title>Autenticación y Autorización</title>

    <link rel="alternate" href="https://campusempresa.com/mod/rest_api/03-04-autenticacion-autorizacion" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/rest_api/03-04-autenticacion-autorizacion" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/rest_api/03-04-authentication-authorization" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=3" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
			<span>	<a href="https://enterprisecampus.net/mod/rest_api/03-04-authentication-authorization" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/rest_api/03-04-autenticacion-autorizacion" class="px-2">CA</a>
</span>
			<span class="d-none d-md-inline"><br><cite>Construyendo la sociedad de hoy y del mañana</cite></span>
		</div>
	</div>
</div>
<div class="subheader container-xxl d-none d-md-block">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Lenguajes</a>
				 					<a href="/categ/frameworks">Frameworks</a>
				 					<a href="/categ/tech-tools">Herramientas</a>
				 					<a href="/categ/foundations">Fundamentos</a>
				 					<a href="/categ/soft-skills">Competencias</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-03-manejo-peticiones-respuestas' title="Manejo de peticiones y respuestas">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Autenticación y Autorización</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-05-manejo-errores' title="Manejo de errores">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>En este tema, exploraremos los conceptos de autenticación y autorización en el contexto de las APIs RESTful. Aprenderemos cómo implementar estos mecanismos para asegurar nuestras APIs y controlar el acceso a los recursos.</p>
</div><h1><p>Conceptos Clave</p>
</h1>
<div class='content'></div><h2><p>Autenticación</p>
</h2>
<div class='content'><p>La autenticación es el proceso de verificar la identidad de un usuario o una aplicación que intenta acceder a la API. En otras palabras, es el proceso de asegurarse de que el usuario es quien dice ser.</p>
</div><h2><p>Autorización</p>
</h2>
<div class='content'><p>La autorización es el proceso de determinar si un usuario autenticado tiene permiso para acceder a un recurso específico o realizar una acción particular. Es el paso que sigue a la autenticación.</p>
</div><h1><p>Métodos de Autenticación</p>
</h1>
<div class='content'></div><h2><ol>
<li>Autenticación Básica (Basic Authentication)</li>
</ol>
</h2>
<div class='content'><p>La autenticación básica es un método simple en el que el cliente envía el nombre de usuario y la contraseña codificados en Base64 en el encabezado de la solicitud HTTP.</p>
<p><strong>Ejemplo de Encabezado HTTP:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QXV0aG9yaXphdGlvbjogQmFzaWMgZFhObGNtNWhiV1U2Y0dGemMzZHZjbVE9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Authorization: Basic dXNlcm5hbWU6cGFzc3dvcmQ=</pre></div><div class='content'><p><strong>Desventajas:</strong></p>
<ul>
<li>No es seguro enviar credenciales en texto plano.</li>
<li>Requiere HTTPS para proteger las credenciales.</li>
</ul>
</div><h2><ol start="2">
<li>Tokens de Autenticación (Token-based Authentication)</li>
</ol>
</h2>
<div class='content'><p>Los tokens de autenticación son una alternativa más segura. Un token es un string único generado por el servidor después de que el usuario se autentica correctamente. Este token se envía en cada solicitud posterior.</p>
<p><strong>Tipos de Tokens:</strong></p>
<ul>
<li><strong>JWT (JSON Web Tokens):</strong> Un estándar abierto que define una forma compacta y autónoma de transmitir información de manera segura entre las partes como un objeto JSON.</li>
<li><strong>OAuth:</strong> Un protocolo de autorización que permite a las aplicaciones obtener acceso limitado a los recursos de los usuarios en un servidor HTTP.</li>
</ul>
<p><strong>Ejemplo de Encabezado HTTP con JWT:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QXV0aG9yaXphdGlvbjogQmVhcmVyIGV5SmhiR2NpT2lKSVV6STFOaUlzSW5SNWNDSTZJa3BYVkNKOS4uLg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...</pre></div><div class='content'></div><h2><ol start="3">
<li>OAuth 2.0</li>
</ol>
</h2>
<div class='content'><p>OAuth 2.0 es un protocolo de autorización que permite a las aplicaciones obtener acceso limitado a los recursos de los usuarios en un servidor HTTP. Es ampliamente utilizado para la autenticación y autorización en APIs RESTful.</p>
<p><strong>Flujos de OAuth 2.0:</strong></p>
<ul>
<li><strong>Authorization Code Grant:</strong> Utilizado por aplicaciones web y móviles.</li>
<li><strong>Implicit Grant:</strong> Utilizado por aplicaciones de una sola página (SPA).</li>
<li><strong>Resource Owner Password Credentials Grant:</strong> Utilizado en aplicaciones de confianza.</li>
<li><strong>Client Credentials Grant:</strong> Utilizado para la autenticación entre servidores.</li>
</ul>
</div><h1><p>Implementación de Autenticación y Autorización</p>
</h1>
<div class='content'></div><h2><p>Ejemplo Práctico: Implementación de JWT en Node.js</p>
</h2>
<div class='content'><h4>Paso 1: Instalación de Dependencias</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgZXhwcmVzcyBqc29ud2VidG9rZW4gYm9keS1wYXJzZXI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install express jsonwebtoken body-parser</pre></div><div class='content'><h4>Paso 2: Configuración del Servidor</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3Qgand0ID0gcmVxdWlyZSgnanNvbndlYnRva2VuJyk7CmNvbnN0IGJvZHlQYXJzZXIgPSByZXF1aXJlKCdib2R5LXBhcnNlcicpOwoKY29uc3QgYXBwID0gZXhwcmVzcygpOwpjb25zdCBQT1JUID0gMzAwMDsKY29uc3QgU0VDUkVUX0tFWSA9ICd5b3VyX3NlY3JldF9rZXknOwoKYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7CgovLyBSdXRhIGRlIGF1dGVudGljYWNpw7NuCmFwcC5wb3N0KCcvbG9naW4nLCAocmVxLCByZXMpID0+IHsKICAgIGNvbnN0IHsgdXNlcm5hbWUsIHBhc3N3b3JkIH0gPSByZXEuYm9keTsKICAgIC8vIFZhbGlkYXIgY3JlZGVuY2lhbGVzIChlc3RvIGVzIHNvbG8gdW4gZWplbXBsbywgZW4gcHJvZHVjY2nDs24gdXNhciB1bmEgYmFzZSBkZSBkYXRvcykKICAgIGlmICh1c2VybmFtZSA9PT0gJ3VzZXInICYmIHBhc3N3b3JkID09PSAncGFzc3dvcmQnKSB7CiAgICAgICAgY29uc3QgdG9rZW4gPSBqd3Quc2lnbih7IHVzZXJuYW1lIH0sIFNFQ1JFVF9LRVksIHsgZXhwaXJlc0luOiAnMWgnIH0pOwogICAgICAgIHJldHVybiByZXMuanNvbih7IHRva2VuIH0pOwogICAgfQogICAgcmVzLnN0YXR1cyg0MDEpLnNlbmQoJ0NyZWRlbmNpYWxlcyBpbnbDoWxpZGFzJyk7Cn0pOwoKLy8gTWlkZGxld2FyZSBkZSBhdXRlbnRpY2FjacOzbgpjb25zdCBhdXRoZW50aWNhdGVKV1QgPSAocmVxLCByZXMsIG5leHQpID0+IHsKICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcignQXV0aG9yaXphdGlvbicpLnNwbGl0KCcgJylbMV07CiAgICBpZiAodG9rZW4pIHsKICAgICAgICBqd3QudmVyaWZ5KHRva2VuLCBTRUNSRVRfS0VZLCAoZXJyLCB1c2VyKSA9PiB7CiAgICAgICAgICAgIGlmIChlcnIpIHsKICAgICAgICAgICAgICAgIHJldHVybiByZXMuc2VuZFN0YXR1cyg0MDMpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJlcS51c2VyID0gdXNlcjsKICAgICAgICAgICAgbmV4dCgpOwogICAgICAgIH0pOwogICAgfSBlbHNlIHsKICAgICAgICByZXMuc2VuZFN0YXR1cyg0MDEpOwogICAgfQp9OwoKLy8gUnV0YSBwcm90ZWdpZGEKYXBwLmdldCgnL3Byb3RlY3RlZCcsIGF1dGhlbnRpY2F0ZUpXVCwgKHJlcSwgcmVzKSA9PiB7CiAgICByZXMuc2VuZCgnRXN0ZSBlcyB1biByZWN1cnNvIHByb3RlZ2lkbycpOwp9KTsKCmFwcC5saXN0ZW4oUE9SVCwgKCkgPT4gewogICAgY29uc29sZS5sb2coYFNlcnZpZG9yIGNvcnJpZW5kbyBlbiBlbCBwdWVydG8gJHtQT1JUfWApOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const jwt = require('jsonwebtoken');
const bodyParser = require('body-parser');

const app = express();
const PORT = 3000;
const SECRET_KEY = 'your_secret_key';

app.use(bodyParser.json());

// Ruta de autenticaci&oacute;n
app.post('/login', (req, res) =&gt; {
    const { username, password } = req.body;
    // Validar credenciales (esto es solo un ejemplo, en producci&oacute;n usar una base de datos)
    if (username === 'user' &amp;&amp; password === 'password') {
        const token = jwt.sign({ username }, SECRET_KEY, { expiresIn: '1h' });
        return res.json({ token });
    }
    res.status(401).send('Credenciales inv&aacute;lidas');
});

// Middleware de autenticaci&oacute;n
const authenticateJWT = (req, res, next) =&gt; {
    const token = req.header('Authorization').split(' ')[1];
    if (token) {
        jwt.verify(token, SECRET_KEY, (err, user) =&gt; {
            if (err) {
                return res.sendStatus(403);
            }
            req.user = user;
            next();
        });
    } else {
        res.sendStatus(401);
    }
};

// Ruta protegida
app.get('/protected', authenticateJWT, (req, res) =&gt; {
    res.send('Este es un recurso protegido');
});

app.listen(PORT, () =&gt; {
    console.log(`Servidor corriendo en el puerto ${PORT}`);
});</pre></div><div class='content'></div><h2><p>Explicación del Código</p>
</h2>
<div class='content'><ol>
<li><strong>Dependencias:</strong> Instalamos y requerimos <code>express</code>, <code>jsonwebtoken</code> y <code>body-parser</code>.</li>
<li><strong>Configuración del Servidor:</strong> Configuramos el servidor Express y definimos una clave secreta para firmar los tokens.</li>
<li><strong>Ruta de Autenticación:</strong> Creamos una ruta <code>/login</code> que valida las credenciales y genera un token JWT si son correctas.</li>
<li><strong>Middleware de Autenticación:</strong> Definimos un middleware <code>authenticateJWT</code> que verifica el token en el encabezado de la solicitud.</li>
<li><strong>Ruta Protegida:</strong> Creamos una ruta <code>/protected</code> que solo es accesible si el token es válido.</li>
</ol>
</div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Implementar Autenticación Básica</p>
</h2>
<div class='content'><ol>
<li>Crea una API RESTful con una ruta <code>/login</code> que acepte un nombre de usuario y una contraseña.</li>
<li>Valida las credenciales y responde con un mensaje de éxito o error.</li>
<li>Protege una ruta <code>/protected</code> que solo sea accesible si se proporcionan las credenciales correctas en el encabezado HTTP.</li>
</ol>
</div><h2><p>Solución</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgYm9keVBhcnNlciA9IHJlcXVpcmUoJ2JvZHktcGFyc2VyJyk7Cgpjb25zdCBhcHAgPSBleHByZXNzKCk7CmNvbnN0IFBPUlQgPSAzMDAwOwoKYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7Cgpjb25zdCBhdXRoZW50aWNhdGVCYXNpYyA9IChyZXEsIHJlcywgbmV4dCkgPT4gewogICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzWydhdXRob3JpemF0aW9uJ107CiAgICBpZiAoYXV0aEhlYWRlcikgewogICAgICAgIGNvbnN0IGJhc2U2NENyZWRlbnRpYWxzID0gYXV0aEhlYWRlci5zcGxpdCgnICcpWzFdOwogICAgICAgIGNvbnN0IGNyZWRlbnRpYWxzID0gQnVmZmVyLmZyb20oYmFzZTY0Q3JlZGVudGlhbHMsICdiYXNlNjQnKS50b1N0cmluZygnYXNjaWknKTsKICAgICAgICBjb25zdCBbdXNlcm5hbWUsIHBhc3N3b3JkXSA9IGNyZWRlbnRpYWxzLnNwbGl0KCc6Jyk7CiAgICAgICAgaWYgKHVzZXJuYW1lID09PSAndXNlcicgJiYgcGFzc3dvcmQgPT09ICdwYXNzd29yZCcpIHsKICAgICAgICAgICAgcmV0dXJuIG5leHQoKTsKICAgICAgICB9CiAgICB9CiAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnQ3JlZGVuY2lhbGVzIGludsOhbGlkYXMnKTsKfTsKCmFwcC5wb3N0KCcvbG9naW4nLCAocmVxLCByZXMpID0+IHsKICAgIGNvbnN0IHsgdXNlcm5hbWUsIHBhc3N3b3JkIH0gPSByZXEuYm9keTsKICAgIGlmICh1c2VybmFtZSA9PT0gJ3VzZXInICYmIHBhc3N3b3JkID09PSAncGFzc3dvcmQnKSB7CiAgICAgICAgcmV0dXJuIHJlcy5zZW5kKCdJbmljaW8gZGUgc2VzacOzbiBleGl0b3NvJyk7CiAgICB9CiAgICByZXMuc3RhdHVzKDQwMSkuc2VuZCgnQ3JlZGVuY2lhbGVzIGludsOhbGlkYXMnKTsKfSk7CgphcHAuZ2V0KCcvcHJvdGVjdGVkJywgYXV0aGVudGljYXRlQmFzaWMsIChyZXEsIHJlcykgPT4gewogICAgcmVzLnNlbmQoJ0VzdGUgZXMgdW4gcmVjdXJzbyBwcm90ZWdpZG8nKTsKfSk7CgphcHAubGlzdGVuKFBPUlQsICgpID0+IHsKICAgIGNvbnNvbGUubG9nKGBTZXJ2aWRvciBjb3JyaWVuZG8gZW4gZWwgcHVlcnRvICR7UE9SVH1gKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const bodyParser = require('body-parser');

const app = express();
const PORT = 3000;

app.use(bodyParser.json());

const authenticateBasic = (req, res, next) =&gt; {
    const authHeader = req.headers['authorization'];
    if (authHeader) {
        const base64Credentials = authHeader.split(' ')[1];
        const credentials = Buffer.from(base64Credentials, 'base64').toString('ascii');
        const [username, password] = credentials.split(':');
        if (username === 'user' &amp;&amp; password === 'password') {
            return next();
        }
    }
    res.status(401).send('Credenciales inv&aacute;lidas');
};

app.post('/login', (req, res) =&gt; {
    const { username, password } = req.body;
    if (username === 'user' &amp;&amp; password === 'password') {
        return res.send('Inicio de sesi&oacute;n exitoso');
    }
    res.status(401).send('Credenciales inv&aacute;lidas');
});

app.get('/protected', authenticateBasic, (req, res) =&gt; {
    res.send('Este es un recurso protegido');
});

app.listen(PORT, () =&gt; {
    console.log(`Servidor corriendo en el puerto ${PORT}`);
});</pre></div><div class='content'></div><h1><p>Resumen</p>
</h1>
<div class='content'><p>En esta sección, hemos cubierto los conceptos de autenticación y autorización, explorando diferentes métodos de autenticación como la autenticación básica, tokens de autenticación y OAuth 2.0. También hemos implementado un ejemplo práctico de autenticación con JWT en Node.js y proporcionado un ejercicio para reforzar los conceptos aprendidos. Con estos conocimientos, estás preparado para asegurar tus APIs RESTful y controlar el acceso a los recursos de manera efectiva.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='03-03-manejo-peticiones-respuestas' title="Manejo de peticiones y respuestas">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='03-05-manejo-errores' title="Manejo de errores">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicidad</h1>
<p>Este espacio está destinado a publicidad.</p>
<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>¡Gracias por colaborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

<div class="container-xxl d-block d-md-none">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
