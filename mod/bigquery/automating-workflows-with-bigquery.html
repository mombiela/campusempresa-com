<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatización de Flujos de Trabajo con BigQuery</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/automating-workflows-with-bigquery" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/automating-workflows-with-bigquery" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/automating-workflows-with-bigquery" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/bigquery/automating-workflows-with-bigquery" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/automating-workflows-with-bigquery" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='using-bigquery-with-data-studio'>&#x25C4;Usando BigQuery con Data Studio</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Automatización de Flujos de Trabajo con BigQuery</a>
	</div>
	<div class='col-4 text-end'>
					<a href='scheduling-queries'>Programación de consultas &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Automatizar flujos de trabajo en BigQuery puede mejorar significativamente la productividad al reducir la intervención manual y asegurar un procesamiento de datos consistente. Esta sección cubrirá los aspectos esenciales de la automatización de tareas en BigQuery, desde la programación de consultas hasta la integración con otros servicios de Google Cloud.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Consultas Programadas</strong>: Automatiza la ejecución de consultas SQL en intervalos especificados.</li>
<li><strong>Servicio de Transferencia de Datos de BigQuery</strong>: Automatiza el movimiento de datos desde varias fuentes hacia BigQuery.</li>
<li><strong>Funciones en la Nube</strong>: Dispara operaciones de BigQuery basadas en eventos.</li>
<li><strong>Cloud Composer</strong>: Orquesta flujos de trabajo complejos que involucran BigQuery y otros servicios.</li>
<li><strong>APIs y Bibliotecas de Cliente</strong>: Interactúa programáticamente con BigQuery para la automatización.</li>
</ul>
</div><h1>Consultas Programadas</h1>
<div class='content'><p>Las consultas programadas te permiten ejecutar consultas SQL de manera recurrente. Esto es útil para tareas como informes diarios o agregación periódica de datos.</p>
</div><h2>Ejemplo: Creación de una Consulta Programada</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRWplbXBsbyBkZSBjb25zdWx0YSBTUUwgcGFyYSBhZ3JlZ2FyIGRhdG9zIGRlIHZlbnRhcyBkaWFyaWFzClNFTEVDVCAKICBEQVRFKFRJTUVTVEFNUF9UUlVOQyhvcmRlcl90aW1lc3RhbXAsIERBWSkpIEFTIG9yZGVyX2RhdGUsCiAgU1VNKG9yZGVyX2Ftb3VudCkgQVMgdG90YWxfc2FsZXMKRlJPTSAKICBgcHJvamVjdC5kYXRhc2V0Lm9yZGVyc2AKR1JPVVAgQlkgCiAgb3JkZXJfZGF0ZTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Ejemplo de consulta SQL para agregar datos de ventas diarias
SELECT 
  DATE(TIMESTAMP_TRUNC(order_timestamp, DAY)) AS order_date,
  SUM(order_amount) AS total_sales
FROM 
  `project.dataset.orders`
GROUP BY 
  order_date;</pre></div><div class='content'><p>Para programar esta consulta:</p>
<ol>
<li>Ve a la consola de BigQuery.</li>
<li>Navega a la sección &quot;Consultas Programadas&quot;.</li>
<li>Haz clic en &quot;Crear Consulta Programada&quot;.</li>
<li>Ingresa la consulta SQL y establece el horario (por ejemplo, diariamente a medianoche).</li>
</ol>
</div><h1>Servicio de Transferencia de Datos de BigQuery</h1>
<div class='content'><p>El Servicio de Transferencia de Datos de BigQuery automatiza la importación de datos desde varias fuentes, como Google Ads, Google Analytics y bases de datos externas.</p>
</div><h2>Ejemplo: Configuración de una Transferencia de Datos</h2>
<div class='content'><ol>
<li>En la consola de BigQuery, ve a la sección &quot;Transferencias&quot;.</li>
<li>Haz clic en &quot;Crear Transferencia&quot;.</li>
<li>Selecciona la fuente de datos (por ejemplo, Google Analytics).</li>
<li>Configura los ajustes de la transferencia, incluyendo el conjunto de datos de destino y el horario.</li>
</ol>
</div><h1>Funciones en la Nube</h1>
<div class='content'><p>Las Funciones en la Nube pueden usarse para disparar operaciones de BigQuery basadas en eventos, como cargas de archivos a Cloud Storage o cambios en Firestore.</p>
</div><h2>Ejemplo: Disparar una Consulta de BigQuery con Funciones en la Nube</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3Qge0JpZ1F1ZXJ5fSA9IHJlcXVpcmUoJ0Bnb29nbGUtY2xvdWQvYmlncXVlcnknKTsKY29uc3QgYmlncXVlcnkgPSBuZXcgQmlnUXVlcnkoKTsKCmV4cG9ydHMudHJpZ2dlckJpZ1F1ZXJ5ID0gYXN5bmMgKGV2ZW50LCBjb250ZXh0KSA9PiB7CiAgY29uc3QgcXVlcnkgPSBgU0VMRUNUICogRlJPTSBcYHByb2plY3QuZGF0YXNldC50YWJsZVxgIExJTUlUIDEwYDsKICBjb25zdCBvcHRpb25zID0gewogICAgcXVlcnk6IHF1ZXJ5LAogICAgbG9jYXRpb246ICdVUycsCiAgfTsKCiAgY29uc3QgW2pvYl0gPSBhd2FpdCBiaWdxdWVyeS5jcmVhdGVRdWVyeUpvYihvcHRpb25zKTsKICBjb25zb2xlLmxvZyhgSm9iICR7am9iLmlkfSBzdGFydGVkLmApOwp9Ow=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const {BigQuery} = require('@google-cloud/bigquery');
const bigquery = new BigQuery();

exports.triggerBigQuery = async (event, context) =&gt; {
  const query = `SELECT * FROM \`project.dataset.table\` LIMIT 10`;
  const options = {
    query: query,
    location: 'US',
  };

  const [job] = await bigquery.createQueryJob(options);
  console.log(`Job ${job.id} started.`);
};</pre></div><div class='content'><ol>
<li>Despliega esta función en Funciones en la Nube.</li>
<li>Configura un disparador, como un evento de Cloud Storage.</li>
</ol>
</div><h1>Cloud Composer</h1>
<div class='content'><p>Cloud Composer es un servicio de orquestación de flujos de trabajo gestionado, basado en Apache Airflow. Te permite crear, programar y monitorear flujos de trabajo complejos.</p>
</div><h2>Ejemplo: Creación de un Flujo de Trabajo con Cloud Composer</h2>
<div class='content'><ol>
<li>Crea un nuevo entorno en Cloud Composer.</li>
<li>Define un DAG (Grafo Acíclico Dirigido) en Python:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBhaXJmbG93IGltcG9ydCBEQUcKZnJvbSBhaXJmbG93LnByb3ZpZGVycy5nb29nbGUuY2xvdWQub3BlcmF0b3JzLmJpZ3F1ZXJ5IGltcG9ydCBCaWdRdWVyeUV4ZWN1dGVRdWVyeU9wZXJhdG9yCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCgpkZWZhdWx0X2FyZ3MgPSB7CiAgICAnc3RhcnRfZGF0ZSc6IGRhdGV0aW1lKDIwMjMsIDEsIDEpLAp9Cgp3aXRoIERBRygnYmlncXVlcnlfd29ya2Zsb3cnLCBkZWZhdWx0X2FyZ3M9ZGVmYXVsdF9hcmdzLCBzY2hlZHVsZV9pbnRlcnZhbD0nQGRhaWx5JykgYXMgZGFnOgogICAgZXhlY3V0ZV9xdWVyeSA9IEJpZ1F1ZXJ5RXhlY3V0ZVF1ZXJ5T3BlcmF0b3IoCiAgICAgICAgdGFza19pZD0nZXhlY3V0ZV9xdWVyeScsCiAgICAgICAgc3FsPSdTRUxFQ1QgKiBGUk9NIGBwcm9qZWN0LmRhdGFzZXQudGFibGVgIExJTUlUIDEwJywKICAgICAgICB1c2VfbGVnYWN5X3NxbD1GYWxzZSwKICAgICk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from airflow import DAG
from airflow.providers.google.cloud.operators.bigquery import BigQueryExecuteQueryOperator
from datetime import datetime

default_args = {
    'start_date': datetime(2023, 1, 1),
}

with DAG('bigquery_workflow', default_args=default_args, schedule_interval='@daily') as dag:
    execute_query = BigQueryExecuteQueryOperator(
        task_id='execute_query',
        sql='SELECT * FROM `project.dataset.table` LIMIT 10',
        use_legacy_sql=False,
    )</pre></div><div class='content'><ol start="3">
<li>Despliega el DAG en tu entorno de Cloud Composer.</li>
</ol>
</div><h1>APIs y Bibliotecas de Cliente</h1>
<div class='content'><p>BigQuery proporciona APIs y bibliotecas de cliente para varios lenguajes de programación, permitiéndote automatizar tareas programáticamente.</p>
</div><h2>Ejemplo: Uso de la Biblioteca de Cliente de Python</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGJpZ3F1ZXJ5CgpjbGllbnQgPSBiaWdxdWVyeS5DbGllbnQoKQoKcXVlcnkgPSAiIiIKU0VMRUNUIAogIG5hbWUsIAogIFNVTShudW1iZXIpIGFzIHRvdGFsCkZST00gCiAgYGJpZ3F1ZXJ5LXB1YmxpYy1kYXRhLnVzYV9uYW1lcy51c2FfMTkxMF8yMDEzYApHUk9VUCBCWSAKICBuYW1lCk9SREVSIEJZIAogIHRvdGFsIERFU0MKTElNSVQgCiAgMTAKIiIiCgpxdWVyeV9qb2IgPSBjbGllbnQucXVlcnkocXVlcnkpCgpmb3Igcm93IGluIHF1ZXJ5X2pvYjoKICAgIHByaW50KGYie3Jvdy5uYW1lfToge3Jvdy50b3RhbH0iKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import bigquery

client = bigquery.Client()

query = &quot;&quot;&quot;
SELECT 
  name, 
  SUM(number) as total
FROM 
  `bigquery-public-data.usa_names.usa_1910_2013`
GROUP BY 
  name
ORDER BY 
  total DESC
LIMIT 
  10
&quot;&quot;&quot;

query_job = client.query(query)

for row in query_job:
    print(f&quot;{row.name}: {row.total}&quot;)</pre></div><div class='content'><ol>
<li>Instala la biblioteca de cliente de BigQuery: <code>pip install google-cloud-bigquery</code>.</li>
<li>Ejecuta el script para ejecutar la consulta y procesar los resultados.</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>Automatizar flujos de trabajo con BigQuery puede agilizar el procesamiento y análisis de datos, facilitando el manejo de grandes conjuntos de datos y operaciones complejas. Al aprovechar consultas programadas, el Servicio de Transferencia de Datos de BigQuery, Funciones en la Nube, Cloud Composer y APIs, puedes crear flujos de trabajo de datos eficientes y confiables. Comienza identificando tareas repetitivas en tu pipeline de datos y explora cómo estas herramientas pueden ayudarte a automatizarlas.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='using-bigquery-with-data-studio'>&#x25C4;Usando BigQuery con Data Studio</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Automatización de Flujos de Trabajo con BigQuery</a>
	</div>
	<div class='col-4 text-end'>
					<a href='scheduling-queries'>Programación de consultas &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
