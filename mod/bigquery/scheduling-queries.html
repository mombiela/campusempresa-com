<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consultas Programadas</title>

    <link rel="alternate" href="https://campusempresa.com/mod/bigquery/scheduling-queries" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/bigquery/scheduling-queries" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/bigquery/scheduling-queries" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/bigquery/scheduling-queries" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/bigquery/scheduling-queries" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='automating-workflows-with-bigquery'>&#x25C4;Automatizando flujos de trabajo con BigQuery</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consultas Programadas</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-apis-and-client-libraries'>Usando APIs y bibliotecas de cliente &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Programar consultas en BigQuery te permite automatizar la ejecución de consultas SQL a intervalos especificados. Esto es particularmente útil para tareas como generar informes regulares, actualizar conjuntos de datos o realizar análisis de datos rutinarios.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Consultas Programadas</strong>: Consultas que están configuradas para ejecutarse automáticamente a intervalos especificados.</li>
<li><strong>Cloud Scheduler</strong>: Un servicio de trabajos cron completamente gestionado que te permite programar prácticamente cualquier trabajo, incluidas las consultas de BigQuery.</li>
<li><strong>Servicio de Transferencia de Datos de BigQuery</strong>: Un servicio que automatiza el movimiento de datos hacia BigQuery de manera programada y gestionada.</li>
</ul>
</div><h1>Configuración de Consultas Programadas</h1>
<div class='content'></div><h2>Usando la Interfaz de BigQuery</h2>
<div class='content'><ol>
<li><strong>Navegar a la Consola de BigQuery</strong>:
<ul>
<li>Ve a la interfaz web de BigQuery en la Consola de Google Cloud.</li>
</ul>
</li>
<li><strong>Crear una Nueva Consulta Programada</strong>:
<ul>
<li>Haz clic en la pestaña &quot;Consultas Programadas&quot;.</li>
<li>Haz clic en &quot;Crear Consulta Programada&quot;.</li>
</ul>
</li>
<li><strong>Configurar la Consulta</strong>:
<ul>
<li>Ingresa la consulta SQL que deseas programar.</li>
<li>Establece la tabla de destino donde se almacenarán los resultados.</li>
</ul>
</li>
<li><strong>Establecer el Horario</strong>:
<ul>
<li>Define la frecuencia (por ejemplo, diaria, semanal) y la hora específica para que se ejecute la consulta.</li>
</ul>
</li>
<li><strong>Guardar y Activar</strong>:
<ul>
<li>Guarda la consulta programada y asegúrate de que esté activada.</li>
</ul>
</li>
</ol>
</div><h2>Usando Cloud Scheduler</h2>
<div class='content'><ol>
<li><strong>Crear un Trabajo en Cloud Scheduler</strong>:
<ul>
<li>Navega a la página de Cloud Scheduler en la Consola de Google Cloud.</li>
<li>Haz clic en &quot;Crear Trabajo&quot;.</li>
</ul>
</li>
<li><strong>Configurar el Trabajo</strong>:
<ul>
<li>Establece la frecuencia usando la sintaxis cron.</li>
<li>Elige el tipo de destino como &quot;HTTP&quot;.</li>
<li>Establece la URL para activar una Cloud Function o un servicio de Cloud Run que ejecute la consulta de BigQuery.</li>
</ul>
</li>
<li><strong>Escribir la Cloud Function</strong>:
<ul>
<li>Crea una Cloud Function que contenga la lógica de la consulta de BigQuery.</li>
<li>Ejemplo:
<pre><code class="language-python">from google.cloud import bigquery

def run_query(request):
    client = bigquery.Client()
    query = &quot;&quot;&quot;
    SELECT name, COUNT(*) as name_count
    FROM `project.dataset.table`
    GROUP BY name
    &quot;&quot;&quot;
    query_job = client.query(query)
    results = query_job.result()
    return &quot;Query executed successfully&quot;
</code></pre>
</li>
</ul>
</li>
<li><strong>Desplegar la Cloud Function</strong>:
<ul>
<li>Despliega la Cloud Function y toma nota de la URL.</li>
</ul>
</li>
<li><strong>Vincular Cloud Scheduler a la Cloud Function</strong>:
<ul>
<li>Usa la URL de la Cloud Function desplegada en el trabajo de Cloud Scheduler.</li>
</ul>
</li>
</ol>
</div><h2>Usando el Servicio de Transferencia de Datos de BigQuery</h2>
<div class='content'><ol>
<li><strong>Navegar al Servicio de Transferencia de Datos de BigQuery</strong>:
<ul>
<li>Ve a la página del Servicio de Transferencia de Datos de BigQuery en la Consola de Google Cloud.</li>
</ul>
</li>
<li><strong>Crear una Transferencia</strong>:
<ul>
<li>Haz clic en &quot;Crear Transferencia&quot;.</li>
</ul>
</li>
<li><strong>Seleccionar Fuente de Datos</strong>:
<ul>
<li>Elige &quot;Consulta Programada&quot; como la fuente de datos.</li>
</ul>
</li>
<li><strong>Configurar la Consulta</strong>:
<ul>
<li>Ingresa la consulta SQL y establece la tabla de destino.</li>
</ul>
</li>
<li><strong>Establecer el Horario</strong>:
<ul>
<li>Define la frecuencia y la hora de inicio para la consulta.</li>
</ul>
</li>
<li><strong>Guardar y Activar</strong>:
<ul>
<li>Guarda la configuración de la transferencia y asegúrate de que esté activada.</li>
</ul>
</li>
</ol>
</div><h1>Ejemplo: Programar un Informe Diario de Ventas</h1>
<div class='content'></div><h2>Consulta SQL</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUCiAgREFURShvcmRlcl9kYXRlKSBhcyBkYXRlLAogIFNVTSh0b3RhbF9hbW91bnQpIGFzIHRvdGFsX3NhbGVzCkZST00KICBgcHJvamVjdC5kYXRhc2V0Lm9yZGVyc2AKR1JPVVAgQlkKICBkYXRlCk9SREVSIEJZCiAgZGF0ZTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT
  DATE(order_date) as date,
  SUM(total_amount) as total_sales
FROM
  `project.dataset.orders`
GROUP BY
  date
ORDER BY
  date;</pre></div><div class='content'></div><h2>Pasos para Programar</h2>
<div class='content'><ol>
<li>
<p><strong>Usando la Interfaz de BigQuery</strong>:</p>
<ul>
<li>Ingresa la consulta SQL anterior.</li>
<li>Establece la tabla de destino en <code>project.dataset.daily_sales_report</code>.</li>
<li>Programa que se ejecute diariamente a las 2 AM.</li>
</ul>
</li>
<li>
<p><strong>Usando Cloud Scheduler y Cloud Function</strong>:</p>
<ul>
<li>Escribe una Cloud Function con la consulta anterior.</li>
<li>Despliega la Cloud Function.</li>
<li>Crea un trabajo en Cloud Scheduler para activar la Cloud Function diariamente a las 2 AM.</li>
</ul>
</li>
<li>
<p><strong>Usando el Servicio de Transferencia de Datos de BigQuery</strong>:</p>
<ul>
<li>Crea una transferencia con la consulta SQL anterior.</li>
<li>Establece la tabla de destino en <code>project.dataset.daily_sales_report</code>.</li>
<li>Programa que se ejecute diariamente a las 2 AM.</li>
</ul>
</li>
</ol>
</div><h1>Conclusión</h1>
<div class='content'><p>Programar consultas en BigQuery es una característica poderosa que puede ahorrar tiempo y asegurar consistencia en el análisis y reporte de datos. Ya sea usando la interfaz de BigQuery, Cloud Scheduler o el Servicio de Transferencia de Datos de BigQuery, puedes automatizar tus flujos de trabajo de datos de manera eficiente. Entender estos métodos te permite elegir el mejor enfoque para tus necesidades específicas e integrar el procesamiento automatizado de datos en tus proyectos de manera fluida.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='automating-workflows-with-bigquery'>&#x25C4;Automatizando flujos de trabajo con BigQuery</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Consultas Programadas</a>
	</div>
	<div class='col-4 text-end'>
					<a href='using-apis-and-client-libraries'>Usando APIs y bibliotecas de cliente &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
