<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Metaprogramación con F#</title>

    <link rel="alternate" href="https://campusempresa.com/mod/fsharp/09-01-metaprogramming" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/fsharp/09-01-metaprogramming" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/fsharp/09-01-metaprogramming" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/fsharp/09-01-metaprogramming" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/fsharp/09-01-metaprogramming" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='08-04-performance-profiling' title="Perfilado de Rendimiento">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Metaprogramación con F#</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='09-02-type-providers' title="Proveedores de Tipos">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La metaprogramación es una técnica que permite a los programas tratar otros programas como sus datos. En F#, esto se puede lograr mediante el uso de macros, generación de código y otras técnicas avanzadas. Este módulo te guiará a través de los conceptos y herramientas necesarias para realizar metaprogramación en F#.</p>
</div><h1><p>Contenido</p>
</h1>
<div class='content'><ol>
<li><strong>Introducción a la Metaprogramación</strong></li>
<li><strong>Macros en F#</strong></li>
<li><strong>Generación de Código</strong></li>
<li><strong>Reflexión</strong></li>
<li><strong>Ejercicios Prácticos</strong></li>
</ol>
</div><h1><ol>
<li>Introducción a la Metaprogramación</li>
</ol>
</h1>
<div class='content'><p>La metaprogramación permite escribir programas que pueden generar, modificar o analizar otros programas. En F#, esto se puede hacer de varias maneras, incluyendo el uso de macros, generación de código y reflexión.</p>
</div><h2><p>Conceptos Clave</p>
</h2>
<div class='content'><ul>
<li><strong>Macros</strong>: Fragmentos de código que se expanden en tiempo de compilación.</li>
<li><strong>Generación de Código</strong>: Crear código de manera dinámica durante la ejecución del programa.</li>
<li><strong>Reflexión</strong>: Inspeccionar y manipular la estructura de los programas en tiempo de ejecución.</li>
</ul>
</div><h1><ol start="2">
<li>Macros en F#</li>
</ol>
</h1>
<div class='content'><p>En F#, los macros no son tan comunes como en otros lenguajes como Lisp, pero se pueden lograr efectos similares mediante el uso de técnicas como las expresiones de cotización y las plantillas de código.</p>
</div><h2><p>Ejemplo de Expresiones de Cotización</p>
</h2>
<div class='content'><p>Las expresiones de cotización (<code>&lt;@ ... @&gt;</code>) permiten capturar el código como datos que pueden ser manipulados.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlbiBNaWNyb3NvZnQuRlNoYXJwLlF1b3RhdGlvbnMKCmxldCBleHByID0gPEAgMSArIDIgQD4KcHJpbnRmbiAiJUEiIGV4cHI="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>open Microsoft.FSharp.Quotations

let expr = &lt;@ 1 + 2 @&gt;
printfn &quot;%A&quot; expr</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>&lt;@ 1 + 2 @&gt;</code>: Captura la expresión <code>1 + 2</code> como una estructura de datos.</li>
<li><code>printfn &quot;%A&quot; expr</code>: Imprime la estructura de datos de la expresión.</li>
</ul>
</div><h1><ol start="3">
<li>Generación de Código</li>
</ol>
</h1>
<div class='content'><p>La generación de código en F# se puede realizar utilizando técnicas como la generación de código en tiempo de compilación y en tiempo de ejecución.</p>
</div><h2><p>Ejemplo de Generación de Código en Tiempo de Ejecución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlbiBTeXN0ZW0Kb3BlbiBTeXN0ZW0uUmVmbGVjdGlvbi5FbWl0CgpsZXQgY3JlYXRlRHluYW1pY01ldGhvZCgpID0KICAgIGxldCBtZXRob2QgPSBuZXcgRHluYW1pY01ldGhvZCgiQWRkIiwgdHlwZW9mPGludD4sIFt8IHR5cGVvZjxpbnQ+OyB0eXBlb2Y8aW50PiB8XSkKICAgIGxldCBpbCA9IG1ldGhvZC5HZXRJTEdlbmVyYXRvcigpCiAgICBpbC5FbWl0KE9wQ29kZXMuTGRhcmdfMCkKICAgIGlsLkVtaXQoT3BDb2Rlcy5MZGFyZ18xKQogICAgaWwuRW1pdChPcENvZGVzLkFkZCkKICAgIGlsLkVtaXQoT3BDb2Rlcy5SZXQpCiAgICBtZXRob2QKCmxldCBhZGRNZXRob2QgPSBjcmVhdGVEeW5hbWljTWV0aG9kKCkKbGV0IGFkZCA9IGFkZE1ldGhvZC5DcmVhdGVEZWxlZ2F0ZSh0eXBlb2Y8RnVuYzxpbnQsIGludCwgaW50Pj4pIDo/PiBGdW5jPGludCwgaW50LCBpbnQ+CnByaW50Zm4gIlJlc3VsdDogJWQiIChhZGQuSW52b2tlKDIsIDMpKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>open System
open System.Reflection.Emit

let createDynamicMethod() =
    let method = new DynamicMethod(&quot;Add&quot;, typeof&lt;int&gt;, [| typeof&lt;int&gt;; typeof&lt;int&gt; |])
    let il = method.GetILGenerator()
    il.Emit(OpCodes.Ldarg_0)
    il.Emit(OpCodes.Ldarg_1)
    il.Emit(OpCodes.Add)
    il.Emit(OpCodes.Ret)
    method

let addMethod = createDynamicMethod()
let add = addMethod.CreateDelegate(typeof&lt;Func&lt;int, int, int&gt;&gt;) :?&gt; Func&lt;int, int, int&gt;
printfn &quot;Result: %d&quot; (add.Invoke(2, 3))</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>DynamicMethod</code>: Crea un método dinámico.</li>
<li><code>GetILGenerator()</code>: Obtiene un generador de IL (Intermediate Language).</li>
<li><code>Emit</code>: Emite instrucciones IL.</li>
<li><code>CreateDelegate</code>: Crea un delegado para el método dinámico.</li>
</ul>
</div><h1><ol start="4">
<li>Reflexión</li>
</ol>
</h1>
<div class='content'><p>La reflexión permite inspeccionar y manipular la estructura de los programas en tiempo de ejecución.</p>
</div><h2><p>Ejemplo de Reflexión</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("b3BlbiBTeXN0ZW0KCnR5cGUgUGVyc29uKG5hbWU6IHN0cmluZywgYWdlOiBpbnQpID0KICAgIG1lbWJlciB0aGlzLk5hbWUgPSBuYW1lCiAgICBtZW1iZXIgdGhpcy5BZ2UgPSBhZ2UKCmxldCBwZXJzb25UeXBlID0gdHlwZW9mPFBlcnNvbj4KbGV0IHByb3BlcnRpZXMgPSBwZXJzb25UeXBlLkdldFByb3BlcnRpZXMoKQoKZm9yIHByb3AgaW4gcHJvcGVydGllcyBkbwogICAgcHJpbnRmbiAiUHJvcGVydHk6ICVzLCBUeXBlOiAlcyIgcHJvcC5OYW1lIHByb3AuUHJvcGVydHlUeXBlLk5hbWU="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>open System

type Person(name: string, age: int) =
    member this.Name = name
    member this.Age = age

let personType = typeof&lt;Person&gt;
let properties = personType.GetProperties()

for prop in properties do
    printfn &quot;Property: %s, Type: %s&quot; prop.Name prop.PropertyType.Name</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>typeof&lt;Person&gt;</code>: Obtiene el tipo <code>Person</code>.</li>
<li><code>GetProperties()</code>: Obtiene las propiedades del tipo.</li>
<li><code>for prop in properties</code>: Itera sobre las propiedades y las imprime.</li>
</ul>
</div><h1><ol start="5">
<li>Ejercicios Prácticos</li>
</ol>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Crear una Expresión de Cotización</p>
</h2>
<div class='content'><p>Crea una expresión de cotización que capture una función que multiplique dos números y luego imprímela.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVHUgY8OzZGlnbyBhcXXDrQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Tu c&oacute;digo aqu&iacute;</pre></div><div class='content'></div><h2><p>Solución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGV0IGV4cHIgPSA8QCBmdW4geCB5IC0+IHggKiB5IEA+CnByaW50Zm4gIiVBIiBleHBy"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>let expr = &lt;@ fun x y -&gt; x * y @&gt;
printfn &quot;%A&quot; expr</pre></div><div class='content'></div><h2><p>Ejercicio 2: Generar un Método Dinámico</p>
</h2>
<div class='content'><p>Crea un método dinámico que reste dos números y luego invócalo.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVHUgY8OzZGlnbyBhcXXDrQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Tu c&oacute;digo aqu&iacute;</pre></div><div class='content'></div><h2><p>Solución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGV0IGNyZWF0ZUR5bmFtaWNNZXRob2QoKSA9CiAgICBsZXQgbWV0aG9kID0gbmV3IER5bmFtaWNNZXRob2QoIlN1YnRyYWN0IiwgdHlwZW9mPGludD4sIFt8IHR5cGVvZjxpbnQ+OyB0eXBlb2Y8aW50PiB8XSkKICAgIGxldCBpbCA9IG1ldGhvZC5HZXRJTEdlbmVyYXRvcigpCiAgICBpbC5FbWl0KE9wQ29kZXMuTGRhcmdfMCkKICAgIGlsLkVtaXQoT3BDb2Rlcy5MZGFyZ18xKQogICAgaWwuRW1pdChPcENvZGVzLlN1YikKICAgIGlsLkVtaXQoT3BDb2Rlcy5SZXQpCiAgICBtZXRob2QKCmxldCBzdWJ0cmFjdE1ldGhvZCA9IGNyZWF0ZUR5bmFtaWNNZXRob2QoKQpsZXQgc3VidHJhY3QgPSBzdWJ0cmFjdE1ldGhvZC5DcmVhdGVEZWxlZ2F0ZSh0eXBlb2Y8RnVuYzxpbnQsIGludCwgaW50Pj4pIDo/PiBGdW5jPGludCwgaW50LCBpbnQ+CnByaW50Zm4gIlJlc3VsdDogJWQiIChzdWJ0cmFjdC5JbnZva2UoNSwgMykp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>let createDynamicMethod() =
    let method = new DynamicMethod(&quot;Subtract&quot;, typeof&lt;int&gt;, [| typeof&lt;int&gt;; typeof&lt;int&gt; |])
    let il = method.GetILGenerator()
    il.Emit(OpCodes.Ldarg_0)
    il.Emit(OpCodes.Ldarg_1)
    il.Emit(OpCodes.Sub)
    il.Emit(OpCodes.Ret)
    method

let subtractMethod = createDynamicMethod()
let subtract = subtractMethod.CreateDelegate(typeof&lt;Func&lt;int, int, int&gt;&gt;) :?&gt; Func&lt;int, int, int&gt;
printfn &quot;Result: %d&quot; (subtract.Invoke(5, 3))</pre></div><div class='content'></div><h2><p>Ejercicio 3: Usar Reflexión para Obtener Métodos</p>
</h2>
<div class='content'><p>Usa reflexión para obtener y listar todos los métodos de la clase <code>System.String</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gVHUgY8OzZGlnbyBhcXXDrQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Tu c&oacute;digo aqu&iacute;</pre></div><div class='content'></div><h2><p>Solución</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGV0IHN0cmluZ1R5cGUgPSB0eXBlb2Y8c3RyaW5nPgpsZXQgbWV0aG9kcyA9IHN0cmluZ1R5cGUuR2V0TWV0aG9kcygpCgpmb3IgbWV0aG9kIGluIG1ldGhvZHMgZG8KICAgIHByaW50Zm4gIk1ldGhvZDogJXMiIG1ldGhvZC5OYW1l"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>let stringType = typeof&lt;string&gt;
let methods = stringType.GetMethods()

for method in methods do
    printfn &quot;Method: %s&quot; method.Name</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En este módulo, hemos explorado la metaprogramación en F#, incluyendo el uso de macros, generación de código y reflexión. Estas técnicas te permiten escribir programas más flexibles y dinámicos. Asegúrate de practicar los ejercicios para consolidar tu comprensión y estar preparado para los temas avanzados que siguen.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='08-04-performance-profiling' title="Perfilado de Rendimiento">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='09-02-type-providers' title="Proveedores de Tipos">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
