<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulación en Pruebas</title>

    <link rel="alternate" href="https://campusempresa.com/mod/typescript/mocking-tests" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/typescript/mocking-tests" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/typescript/mocking-tests" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/typescript/mocking-tests" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/typescript/mocking-tests" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='integration-testing'>&#x25C4;Pruebas de Integración</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Simulación en Pruebas</a>
	</div>
	<div class='col-4 text-end'>
					<a href='end-to-end-testing'>Pruebas de Extremo a Extremo &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La simulación es un concepto crucial en las pruebas, especialmente cuando se trata de dependencias externas o sistemas complejos. En esta sección, exploraremos cómo usar la simulación en pruebas de TypeScript, desde niveles básicos hasta avanzados.</p>
</div><h1>Introducción a la Simulación</h1>
<div class='content'><p>La simulación te permite simular el comportamiento de objetos complejos o sistemas externos en tus pruebas. Esto es particularmente útil para:</p>
<ul>
<li>Aislar la unidad de código que se está probando.</li>
<li>Simular diferentes escenarios y casos extremos.</li>
<li>Mejorar el rendimiento de las pruebas evitando sistemas externos lentos o poco fiables.</li>
</ul>
</div><h1>Simulación Básica con Jest</h1>
<div class='content'><p>Jest es un marco de pruebas popular que proporciona soporte integrado para la simulación. Comencemos con un ejemplo simple.</p>
</div><h2>Ejemplo: Simulación de una Función</h2>
<div class='content'><p>Supongamos que tenemos una función que obtiene datos de usuario desde una API:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlclNlcnZpY2UudHMKZXhwb3J0IGNvbnN0IGZldGNoVXNlckRhdGEgPSBhc3luYyAodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXI+ID0+IHsKICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5leGFtcGxlLmNvbS91c2Vycy8ke3VzZXJJZH1gKTsKICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwp9Ow=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userService.ts
export const fetchUserData = async (userId: string): Promise&lt;User&gt; =&gt; {
  const response = await fetch(`https://api.example.com/users/${userId}`);
  return response.json();
};</pre></div><div class='content'><p>Queremos probar una función que usa <code>fetchUserData</code> sin hacer llamadas reales a la API:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlckNvbnRyb2xsZXIudHMKaW1wb3J0IHsgZmV0Y2hVc2VyRGF0YSB9IGZyb20gJy4vdXNlclNlcnZpY2UnOwoKZXhwb3J0IGNvbnN0IGdldFVzZXJQcm9maWxlID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyUHJvZmlsZT4gPT4gewogIGNvbnN0IHVzZXIgPSBhd2FpdCBmZXRjaFVzZXJEYXRhKHVzZXJJZCk7CiAgcmV0dXJuIHsKICAgIGlkOiB1c2VyLmlkLAogICAgbmFtZTogdXNlci5uYW1lLAogICAgZW1haWw6IHVzZXIuZW1haWwsCiAgfTsKfTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userController.ts
import { fetchUserData } from './userService';

export const getUserProfile = async (userId: string): Promise&lt;UserProfile&gt; =&gt; {
  const user = await fetchUserData(userId);
  return {
    id: user.id,
    name: user.name,
    email: user.email,
  };
};</pre></div><div class='content'><p>Así es como puedes simular <code>fetchUserData</code> en tu prueba:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlckNvbnRyb2xsZXIudGVzdC50cwppbXBvcnQgeyBnZXRVc2VyUHJvZmlsZSB9IGZyb20gJy4vdXNlckNvbnRyb2xsZXInOwppbXBvcnQgeyBmZXRjaFVzZXJEYXRhIH0gZnJvbSAnLi91c2VyU2VydmljZSc7CgpqZXN0Lm1vY2soJy4vdXNlclNlcnZpY2UnKTsKCnRlc3QoJ3Nob3VsZCByZXR1cm4gdXNlciBwcm9maWxlJywgYXN5bmMgKCkgPT4gewogIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJzEnLCBuYW1lOiAnSm9obiBEb2UnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH07CiAgKGZldGNoVXNlckRhdGEgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7CgogIGNvbnN0IHVzZXJQcm9maWxlID0gYXdhaXQgZ2V0VXNlclByb2ZpbGUoJzEnKTsKCiAgZXhwZWN0KHVzZXJQcm9maWxlKS50b0VxdWFsKG1vY2tVc2VyKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userController.test.ts
import { getUserProfile } from './userController';
import { fetchUserData } from './userService';

jest.mock('./userService');

test('should return user profile', async () =&gt; {
  const mockUser = { id: '1', name: 'John Doe', email: 'john@example.com' };
  (fetchUserData as jest.Mock).mockResolvedValue(mockUser);

  const userProfile = await getUserProfile('1');

  expect(userProfile).toEqual(mockUser);
});</pre></div><div class='content'></div><h1>Técnicas Intermedias de Simulación</h1>
<div class='content'></div><h2>Simulación de Módulos</h2>
<div class='content'><p>A veces, necesitas simular módulos enteros. Jest facilita esto con la función <code>jest.mock</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbWF0aC50cwpleHBvcnQgY29uc3QgYWRkID0gKGE6IG51bWJlciwgYjogbnVtYmVyKTogbnVtYmVyID0+IGEgKyBiOwpleHBvcnQgY29uc3Qgc3VidHJhY3QgPSAoYTogbnVtYmVyLCBiOiBudW1iZXIpOiBudW1iZXIgPT4gYSAtIGI7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// math.ts
export const add = (a: number, b: number): number =&gt; a + b;
export const subtract = (a: number, b: number): number =&gt; a - b;</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbWF0aC50ZXN0LnRzCmltcG9ydCAqIGFzIG1hdGggZnJvbSAnLi9tYXRoJzsKCmplc3QubW9jaygnLi9tYXRoJyk7Cgp0ZXN0KCdzaG91bGQgbW9jayBhZGQgZnVuY3Rpb24nLCAoKSA9PiB7CiAgKG1hdGguYWRkIGFzIGplc3QuTW9jaykubW9ja1JldHVyblZhbHVlKDEwKTsKCiAgZXhwZWN0KG1hdGguYWRkKDEsIDIpKS50b0JlKDEwKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// math.test.ts
import * as math from './math';

jest.mock('./math');

test('should mock add function', () =&gt; {
  (math.add as jest.Mock).mockReturnValue(10);

  expect(math.add(1, 2)).toBe(10);
});</pre></div><div class='content'></div><h2>Simulación de Clases</h2>
<div class='content'><p>También puedes simular clases y sus métodos:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZGF0YWJhc2UudHMKZXhwb3J0IGNsYXNzIERhdGFiYXNlIHsKICBjb25uZWN0KCkgewogICAgLy8gQ29uZWN0YXIgYSBsYSBiYXNlIGRlIGRhdG9zCiAgfQoKICBxdWVyeShzcWw6IHN0cmluZykgewogICAgLy8gRWplY3V0YXIgdW5hIGNvbnN1bHRhCiAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// database.ts
export class Database {
  connect() {
    // Conectar a la base de datos
  }

  query(sql: string) {
    // Ejecutar una consulta
  }
}</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZGF0YWJhc2UudGVzdC50cwppbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gJy4vZGF0YWJhc2UnOwoKamVzdC5tb2NrKCcuL2RhdGFiYXNlJyk7Cgp0ZXN0KCdzaG91bGQgbW9jayBEYXRhYmFzZSBjbGFzcycsICgpID0+IHsKICBjb25zdCBtb2NrQ29ubmVjdCA9IGplc3QuZm4oKTsKICBEYXRhYmFzZS5wcm90b3R5cGUuY29ubmVjdCA9IG1vY2tDb25uZWN0OwoKICBjb25zdCBkYiA9IG5ldyBEYXRhYmFzZSgpOwogIGRiLmNvbm5lY3QoKTsKCiAgZXhwZWN0KG1vY2tDb25uZWN0KS50b0hhdmVCZWVuQ2FsbGVkKCk7Cn0pOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// database.test.ts
import { Database } from './database';

jest.mock('./database');

test('should mock Database class', () =&gt; {
  const mockConnect = jest.fn();
  Database.prototype.connect = mockConnect;

  const db = new Database();
  db.connect();

  expect(mockConnect).toHaveBeenCalled();
});</pre></div><div class='content'></div><h1>Técnicas Avanzadas de Simulación</h1>
<div class='content'></div><h2>Simulación de Funciones Asíncronas</h2>
<div class='content'><p>Cuando se trata de funciones asíncronas, puedes usar <code>mockResolvedValue</code> y <code>mockRejectedValue</code> para simular promesas resueltas y rechazadas.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gYXBpLnRzCmV4cG9ydCBjb25zdCBmZXRjaERhdGEgPSBhc3luYyAoKTogUHJvbWlzZTxzdHJpbmc+ID0+IHsKICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5leGFtcGxlLmNvbS9kYXRhJyk7CiAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKfTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// api.ts
export const fetchData = async (): Promise&lt;string&gt; =&gt; {
  const response = await fetch('https://api.example.com/data');
  return response.json();
};</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gYXBpLnRlc3QudHMKaW1wb3J0IHsgZmV0Y2hEYXRhIH0gZnJvbSAnLi9hcGknOwoKamVzdC5tb2NrKCcuL2FwaScpOwoKdGVzdCgnc2hvdWxkIG1vY2sgZmV0Y2hEYXRhIHdpdGggcmVzb2x2ZWQgdmFsdWUnLCBhc3luYyAoKSA9PiB7CiAgKGZldGNoRGF0YSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKCdtb2NrIGRhdGEnKTsKCiAgY29uc3QgZGF0YSA9IGF3YWl0IGZldGNoRGF0YSgpOwoKICBleHBlY3QoZGF0YSkudG9CZSgnbW9jayBkYXRhJyk7Cn0pOwoKdGVzdCgnc2hvdWxkIG1vY2sgZmV0Y2hEYXRhIHdpdGggcmVqZWN0ZWQgdmFsdWUnLCBhc3luYyAoKSA9PiB7CiAgKGZldGNoRGF0YSBhcyBqZXN0Lk1vY2spLm1vY2tSZWplY3RlZFZhbHVlKG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpKTsKCiAgYXdhaXQgZXhwZWN0KGZldGNoRGF0YSgpKS5yZWplY3RzLnRvVGhyb3coJ05ldHdvcmsgZXJyb3InKTsKfSk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// api.test.ts
import { fetchData } from './api';

jest.mock('./api');

test('should mock fetchData with resolved value', async () =&gt; {
  (fetchData as jest.Mock).mockResolvedValue('mock data');

  const data = await fetchData();

  expect(data).toBe('mock data');
});

test('should mock fetchData with rejected value', async () =&gt; {
  (fetchData as jest.Mock).mockRejectedValue(new Error('Network error'));

  await expect(fetchData()).rejects.toThrow('Network error');
});</pre></div><div class='content'></div><h2>Simulación con Interfaces de TypeScript</h2>
<div class='content'><p>Cuando trabajas con interfaces de TypeScript, puedes usar bibliotecas como <code>ts-mockito</code> para crear simulaciones.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlclNlcnZpY2UudHMKZXhwb3J0IGludGVyZmFjZSBVc2VyU2VydmljZSB7CiAgZ2V0VXNlcihpZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyPjsKfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userService.ts
export interface UserService {
  getUser(id: string): Promise&lt;User&gt;;
}</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlclNlcnZpY2UudGVzdC50cwppbXBvcnQgeyBtb2NrLCBpbnN0YW5jZSwgd2hlbiwgdmVyaWZ5IH0gZnJvbSAndHMtbW9ja2l0byc7CmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnLi91c2VyU2VydmljZSc7Cgp0ZXN0KCdzaG91bGQgbW9jayBVc2VyU2VydmljZSBpbnRlcmZhY2UnLCBhc3luYyAoKSA9PiB7CiAgY29uc3QgdXNlclNlcnZpY2VNb2NrID0gbW9jazxVc2VyU2VydmljZT4oKTsKICB3aGVuKHVzZXJTZXJ2aWNlTW9jay5nZXRVc2VyKCcxJykpLnRoZW5SZXNvbHZlKHsgaWQ6ICcxJywgbmFtZTogJ0pvaG4gRG9lJyB9KTsKCiAgY29uc3QgdXNlclNlcnZpY2UgPSBpbnN0YW5jZSh1c2VyU2VydmljZU1vY2spOwogIGNvbnN0IHVzZXIgPSBhd2FpdCB1c2VyU2VydmljZS5nZXRVc2VyKCcxJyk7CgogIGV4cGVjdCh1c2VyLm5hbWUpLnRvQmUoJ0pvaG4gRG9lJyk7CiAgdmVyaWZ5KHVzZXJTZXJ2aWNlTW9jay5nZXRVc2VyKCcxJykpLmNhbGxlZCgpOwp9KTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userService.test.ts
import { mock, instance, when, verify } from 'ts-mockito';
import { UserService } from './userService';

test('should mock UserService interface', async () =&gt; {
  const userServiceMock = mock&lt;UserService&gt;();
  when(userServiceMock.getUser('1')).thenResolve({ id: '1', name: 'John Doe' });

  const userService = instance(userServiceMock);
  const user = await userService.getUser('1');

  expect(user.name).toBe('John Doe');
  verify(userServiceMock.getUser('1')).called();
});</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>La simulación es una herramienta poderosa en tu arsenal de pruebas. Te permite aislar el código bajo prueba, simular varios escenarios y mejorar el rendimiento de las pruebas. Al dominar técnicas de simulación básicas, intermedias y avanzadas, puedes escribir pruebas más robustas y fiables para tus aplicaciones de TypeScript.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='integration-testing'>&#x25C4;Pruebas de Integración</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Simulación en Pruebas</a>
	</div>
	<div class='col-4 text-end'>
					<a href='end-to-end-testing'>Pruebas de Extremo a Extremo &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
