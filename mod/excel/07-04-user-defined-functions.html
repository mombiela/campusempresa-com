<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Creación de Funciones Definidas por el Usuario</title>

    <link rel="alternate" href="https://campusempresa.com/mod/excel/07-04-user-defined-functions" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/excel/07-04-user-defined-functions" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/excel/07-04-user-defined-functions" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/excel/07-04-user-defined-functions" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/excel/07-04-user-defined-functions" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-editing-macros-vba' title="Editando Macros con VBA">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Creación de Funciones Definidas por el Usuario</h2></a>
			</div>
	<div class='col-2 text-end'>
					<a href='07-05-automating-tasks-vba' title="Automatización de Tareas con VBA">Siguiente &#x25BA;</a>
			</div>
</div>
<div class='content'><p>En este tema, aprenderás a crear tus propias funciones personalizadas en Excel utilizando VBA (Visual Basic for Applications). Las funciones definidas por el usuario (UDF, por sus siglas en inglés) te permiten extender las capacidades de Excel más allá de las funciones integradas.</p>
</div><h1>¿Qué es una Función Definida por el Usuario?</h1>
<div class='content'><p>Una UDF es una función personalizada que puedes crear para realizar cálculos específicos que no están disponibles en las funciones estándar de Excel. Estas funciones se escriben en VBA y se pueden utilizar en las fórmulas de las celdas de la misma manera que las funciones integradas.</p>
</div><h1>Pasos para Crear una UDF</h1>
<div class='content'></div><h2>1. Abrir el Editor de VBA</h2>
<div class='content'><ol>
<li>Abre Excel y presiona <code>Alt + F11</code> para abrir el Editor de VBA.</li>
<li>En el Editor de VBA, inserta un nuevo módulo:
<ul>
<li>Haz clic en <code>Insertar</code> &gt; <code>Módulo</code>.</li>
</ul>
</li>
</ol>
</div><h2>2. Escribir la Función</h2>
<div class='content'><p>En el módulo recién creado, escribe el código de tu función. Aquí tienes un ejemplo de una función simple que suma dos números:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gU3VtYXJEb3NOdW1lcm9zKGEgQXMgRG91YmxlLCBiIEFzIERvdWJsZSkgQXMgRG91YmxlCiAgICBTdW1hckRvc051bWVyb3MgPSBhICsgYgpFbmQgRnVuY3Rpb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function SumarDosNumeros(a As Double, b As Double) As Double
    SumarDosNumeros = a + b
End Function</pre></div><div class='content'></div><h2>3. Guardar y Cerrar el Editor de VBA</h2>
<div class='content'><ol>
<li>Guarda tu trabajo en el Editor de VBA.</li>
<li>Cierra el Editor de VBA y vuelve a Excel.</li>
</ol>
</div><h2>4. Usar la Función en Excel</h2>
<div class='content'><p>Ahora puedes usar tu nueva función <code>SumarDosNumeros</code> en cualquier celda de Excel como lo harías con cualquier otra función:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PVN1bWFyRG9zTnVtZXJvcyg1LCAxMCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>=SumarDosNumeros(5, 10)</pre></div><div class='content'></div><h1>Ejemplo Práctico: Función para Calcular el Área de un Círculo</h1>
<div class='content'><p>Vamos a crear una función que calcule el área de un círculo dado su radio.</p>
</div><h2>1. Escribir la Función</h2>
<div class='content'><p>En el Editor de VBA, escribe el siguiente código:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQXJlYUNpcmN1bG8ocmFkaW8gQXMgRG91YmxlKSBBcyBEb3VibGUKICAgIEFyZWFDaXJjdWxvID0gQXBwbGljYXRpb24uV29ya3NoZWV0RnVuY3Rpb24uUGkoKSAqIHJhZGlvIF4gMgpFbmQgRnVuY3Rpb24="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function AreaCirculo(radio As Double) As Double
    AreaCirculo = Application.WorksheetFunction.Pi() * radio ^ 2
End Function</pre></div><div class='content'></div><h2>2. Usar la Función en Excel</h2>
<div class='content'><p>Puedes usar la función <code>AreaCirculo</code> en una celda de Excel:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PUFyZWFDaXJjdWxvKDUp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>=AreaCirculo(5)</pre></div><div class='content'><p>Esto calculará el área de un círculo con un radio de 5 unidades.</p>
</div><h1>Ejercicio Práctico</h1>
<div class='content'></div><h2>Ejercicio 1: Crear una Función para Convertir Grados Celsius a Fahrenheit</h2>
<div class='content'><ol>
<li>Abre el Editor de VBA (<code>Alt + F11</code>).</li>
<li>Inserta un nuevo módulo.</li>
<li>Escribe una función llamada <code>CelsiusAFahrenheit</code> que convierta una temperatura de grados Celsius a Fahrenheit usando la fórmula: <code>F = C * 9/5 + 32</code>.</li>
<li>Guarda y cierra el Editor de VBA.</li>
<li>Usa la función en una celda de Excel para convertir 25 grados Celsius a Fahrenheit.</li>
</ol>
</div><h2>Solución</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQ2Vsc2l1c0FGYWhyZW5oZWl0KGNlbHNpdXMgQXMgRG91YmxlKSBBcyBEb3VibGUKICAgIENlbHNpdXNBRmFocmVuaGVpdCA9IGNlbHNpdXMgKiA5IC8gNSArIDMyCkVuZCBGdW5jdGlvbg=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function CelsiusAFahrenheit(celsius As Double) As Double
    CelsiusAFahrenheit = celsius * 9 / 5 + 32
End Function</pre></div><div class='content'><p>En Excel, usa la función:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PUNlbHNpdXNBRmFocmVuaGVpdCgyNSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>=CelsiusAFahrenheit(25)</pre></div><div class='content'></div><h1>Errores Comunes y Consejos</h1>
<div class='content'><ul>
<li><strong>Error de Sintaxis:</strong> Asegúrate de que tu código VBA no tenga errores de sintaxis. El Editor de VBA te ayudará a identificar estos errores.</li>
<li><strong>Tipos de Datos Incorrectos:</strong> Asegúrate de que los tipos de datos de los argumentos de tu función sean correctos. Por ejemplo, si esperas un número, usa <code>As Double</code> o <code>As Integer</code>.</li>
<li><strong>Guardar el Archivo:</strong> Si tu archivo de Excel contiene macros o UDFs, guárdalo con la extensión <code>.xlsm</code> (Libro de Excel habilitado para macros).</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Crear funciones definidas por el usuario en Excel te permite personalizar y extender las capacidades de Excel para satisfacer tus necesidades específicas. Con VBA, puedes crear funciones que realicen cálculos complejos y automatizar tareas repetitivas, mejorando así tu eficiencia y productividad en el trabajo con datos.</p>
<p>En el próximo tema, aprenderás a automatizar tareas con VBA, lo que te permitirá llevar tus habilidades de Excel al siguiente nivel.</p>
</div><div class='row navigation'>
	<div class='col-2'>
					<a href='07-03-editing-macros-vba' title="Editando Macros con VBA">&#x25C4;Anterior</a>
			</div>
	<div class='col-8 text-center'>
			</div>
	<div class='col-2 text-end'>
					<a href='07-05-automating-tasks-vba' title="Automatización de Tareas con VBA">Siguiente &#x25BA;</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
