<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DStreams (Flujos Discretizados)</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/dstreams" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/dstreams" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/dstreams" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/apachespark/dstreams" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/dstreams" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-spark-streaming'>&#x25C4;Introducción a Spark Streaming</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">DStreams (Flujos Discretizados)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='window-operations'>Operaciones de Ventana &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción a DStreams</h1>
<div class='content'><p>DStreams, o Flujos Discretizados, son un concepto fundamental en la biblioteca de streaming de Apache Spark, Spark Streaming. Representan un flujo continuo de datos dividido en pequeños lotes discretos.</p>
<ul>
<li><strong>Definición</strong>: Los DStreams son una secuencia de RDDs (Conjuntos de Datos Distribuidos Resilientes) que representan un flujo continuo de datos.</li>
<li><strong>Propósito</strong>: Permiten el procesamiento de datos en tiempo real al descomponer el flujo en partes manejables.</li>
</ul>
</div><h1>Creación de DStreams</h1>
<div class='content'><p>Para crear un DStream, normalmente necesitas un contexto de Spark Streaming y una fuente de datos como Kafka, sockets TCP o archivos.</p>
</div><h2>Ejemplo: Creación de un DStream desde un Socket TCP</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbnRleHQKZnJvbSBweXNwYXJrLnN0cmVhbWluZyBpbXBvcnQgU3RyZWFtaW5nQ29udGV4dAoKIyBDcmVhciB1biBTdHJlYW1pbmdDb250ZXh0IGxvY2FsIGNvbiBkb3MgaGlsb3MgZGUgdHJhYmFqbyB5IHVuIGludGVydmFsbyBkZSBsb3RlIGRlIDEgc2VndW5kbwpzYyA9IFNwYXJrQ29udGV4dCgibG9jYWxbMl0iLCAiTmV0d29ya1dvcmRDb3VudCIpCnNzYyA9IFN0cmVhbWluZ0NvbnRleHQoc2MsIDEpCgojIENyZWFyIHVuIERTdHJlYW0gcXVlIHNlIGNvbmVjdGFyw6EgYSBob3N0bmFtZTpwb3J0LCBjb21vIGxvY2FsaG9zdDo5OTk5CmxpbmVzID0gc3NjLnNvY2tldFRleHRTdHJlYW0oImxvY2FsaG9zdCIsIDk5OTkpCgojIERpdmlkaXIgY2FkYSBsw61uZWEgZW4gcGFsYWJyYXMKd29yZHMgPSBsaW5lcy5mbGF0TWFwKGxhbWJkYSBsaW5lOiBsaW5lLnNwbGl0KCIgIikpCgojIENvbnRhciBjYWRhIHBhbGFicmEgZW4gY2FkYSBsb3RlCnBhaXJzID0gd29yZHMubWFwKGxhbWJkYSB3b3JkOiAod29yZCwgMSkpCndvcmRDb3VudHMgPSBwYWlycy5yZWR1Y2VCeUtleShsYW1iZGEgeCwgeTogeCArIHkpCgojIEltcHJpbWlyIGxvcyBwcmltZXJvcyBkaWV6IGVsZW1lbnRvcyBkZSBjYWRhIFJERCBnZW5lcmFkbyBlbiBlc3RlIERTdHJlYW0gZW4gbGEgY29uc29sYQp3b3JkQ291bnRzLnBwcmludCgpCgojIEluaWNpYXIgZWwgY8OhbGN1bG8Kc3NjLnN0YXJ0KCkKCiMgRXNwZXJhciBhIHF1ZSBlbCBjw6FsY3VsbyB0ZXJtaW5lCnNzYy5hd2FpdFRlcm1pbmF0aW9uKCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkContext
from pyspark.streaming import StreamingContext

# Crear un StreamingContext local con dos hilos de trabajo y un intervalo de lote de 1 segundo
sc = SparkContext(&quot;local[2]&quot;, &quot;NetworkWordCount&quot;)
ssc = StreamingContext(sc, 1)

# Crear un DStream que se conectar&aacute; a hostname:port, como localhost:9999
lines = ssc.socketTextStream(&quot;localhost&quot;, 9999)

# Dividir cada l&iacute;nea en palabras
words = lines.flatMap(lambda line: line.split(&quot; &quot;))

# Contar cada palabra en cada lote
pairs = words.map(lambda word: (word, 1))
wordCounts = pairs.reduceByKey(lambda x, y: x + y)

# Imprimir los primeros diez elementos de cada RDD generado en este DStream en la consola
wordCounts.pprint()

# Iniciar el c&aacute;lculo
ssc.start()

# Esperar a que el c&aacute;lculo termine
ssc.awaitTermination()</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li>Se inicializan <code>SparkContext</code> y <code>StreamingContext</code>.</li>
<li>Se crea un DStream desde un socket TCP.</li>
<li>El flujo se procesa para contar palabras en cada lote.</li>
<li>Los resultados se imprimen en la consola.</li>
</ul>
</li>
</ul>
</div><h1>Transformaciones en DStreams</h1>
<div class='content'><p>Los DStreams soportan varias transformaciones similares a los RDDs, como <code>map</code>, <code>flatMap</code>, <code>filter</code>, <code>reduceByKey</code> y <code>window</code>.</p>
</div><h2>Ejemplo: Aplicación de Transformaciones</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBGaWx0cmFyIGzDrW5lYXMgcXVlIGNvbnRpZW5lbiBsYSBwYWxhYnJhICJlcnJvciIKZXJyb3JzID0gbGluZXMuZmlsdGVyKGxhbWJkYSBsaW5lOiAiZXJyb3IiIGluIGxpbmUpCgojIENvbnRhciBlbCBuw7ptZXJvIGRlIGVycm9yZXMgZW4gY2FkYSBsb3RlCmVycm9yQ291bnRzID0gZXJyb3JzLmNvdW50KCkKCiMgSW1wcmltaXIgZWwgY29udGVvIGRlIGVycm9yZXMKZXJyb3JDb3VudHMucHByaW50KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Filtrar l&iacute;neas que contienen la palabra &quot;error&quot;
errors = lines.filter(lambda line: &quot;error&quot; in line)

# Contar el n&uacute;mero de errores en cada lote
errorCounts = errors.count()

# Imprimir el conteo de errores
errorCounts.pprint()</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li>La transformación <code>filter</code> filtra líneas que contienen la palabra &quot;error&quot;.</li>
<li>La transformación <code>count</code> cuenta el número de dichas líneas en cada lote.</li>
</ul>
</li>
</ul>
</div><h1>Operaciones de Ventana</h1>
<div class='content'><p>Las operaciones de ventana te permiten aplicar transformaciones sobre una ventana deslizante de datos.</p>
</div><h2>Ejemplo: Conteo de Palabras en Ventana</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb250YXIgcGFsYWJyYXMgZW4gdW5hIHZlbnRhbmEgZGUgMzAgc2VndW5kb3MgZGVzbGl6w6FuZG9zZSBjYWRhIDEwIHNlZ3VuZG9zCndpbmRvd2VkV29yZENvdW50cyA9IHBhaXJzLnJlZHVjZUJ5S2V5QW5kV2luZG93KGxhbWJkYSB4LCB5OiB4ICsgeSwgMzAsIDEwKQoKIyBJbXByaW1pciBsb3MgY29udGVvcyBkZSBwYWxhYnJhcwp3aW5kb3dlZFdvcmRDb3VudHMucHByaW50KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Contar palabras en una ventana de 30 segundos desliz&aacute;ndose cada 10 segundos
windowedWordCounts = pairs.reduceByKeyAndWindow(lambda x, y: x + y, 30, 10)

# Imprimir los conteos de palabras
windowedWordCounts.pprint()</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>reduceByKeyAndWindow</code> aplica el conteo de palabras sobre una ventana de 30 segundos, deslizándose cada 10 segundos.</li>
</ul>
</li>
</ul>
</div><h1>Operaciones de Salida</h1>
<div class='content'><p>Las operaciones de salida te permiten enviar los datos procesados a sistemas externos como bases de datos, paneles de control o archivos.</p>
</div><h2>Ejemplo: Guardar la Salida de DStream en Archivos de Texto</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHdWFyZGFyIGNhZGEgUkREIGVuIGVsIERTdHJlYW0gZW4gdW4gYXJjaGl2byBkZSB0ZXh0bwp3b3JkQ291bnRzLnNhdmVBc1RleHRGaWxlcygib3V0cHV0L3dvcmRDb3VudHMiKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Guardar cada RDD en el DStream en un archivo de texto
wordCounts.saveAsTextFiles(&quot;output/wordCounts&quot;)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>saveAsTextFiles</code> guarda cada RDD en el DStream en archivos de texto en el directorio especificado.</li>
</ul>
</li>
</ul>
</div><h1>Conceptos Avanzados</h1>
<h2>Checkpointing</h2>
<div class='content'><p>El checkpointing es crucial para la tolerancia a fallos en aplicaciones de streaming. Guarda el estado del DStream en un almacenamiento confiable.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3NjLmNoZWNrcG9pbnQoImNoZWNrcG9pbnQtZGlyZWN0b3J5Iik="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ssc.checkpoint(&quot;checkpoint-directory&quot;)</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>checkpoint</code> establece el directorio donde se guardará el estado.</li>
</ul>
</li>
</ul>
</div><h2>Transformaciones con Estado</h2>
<div class='content'><p>Las transformaciones con estado te permiten mantener el estado a través de lotes.</p>
</div><h2>Ejemplo: Conteo de Palabras con Estado</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIHVwZGF0ZUZ1bmN0aW9uKG5ld1ZhbHVlcywgcnVubmluZ0NvdW50KToKICAgIHJldHVybiBzdW0obmV3VmFsdWVzKSArIChydW5uaW5nQ291bnQgb3IgMCkKCnJ1bm5pbmdDb3VudHMgPSBwYWlycy51cGRhdGVTdGF0ZUJ5S2V5KHVwZGF0ZUZ1bmN0aW9uKQoKIyBJbXByaW1pciBsb3MgY29udGVvcyBhY3VtdWxhZG9zCnJ1bm5pbmdDb3VudHMucHByaW50KCk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def updateFunction(newValues, runningCount):
    return sum(newValues) + (runningCount or 0)

runningCounts = pairs.updateStateByKey(updateFunction)

# Imprimir los conteos acumulados
runningCounts.pprint()</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>updateStateByKey</code> mantiene un conteo acumulado de palabras a través de lotes usando la función de actualización proporcionada.</li>
</ul>
</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Los DStreams son una poderosa abstracción en Spark Streaming para el procesamiento de datos en tiempo real. Al entender cómo crear, transformar y emitir DStreams, puedes construir aplicaciones de streaming robustas. Las características avanzadas como las operaciones de ventana, el checkpointing y las transformaciones con estado mejoran aún más las capacidades de los DStreams, haciéndolos adecuados para una amplia gama de tareas de análisis en tiempo real.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-spark-streaming'>&#x25C4;Introducción a Spark Streaming</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">DStreams (Flujos Discretizados)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='window-operations'>Operaciones de Ventana &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
