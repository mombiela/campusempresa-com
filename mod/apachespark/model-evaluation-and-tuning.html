<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evaluación y Ajuste de Modelos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/apachespark/model-evaluation-and-tuning" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/apachespark/model-evaluation-and-tuning" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/apachespark/model-evaluation-and-tuning" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/apachespark/model-evaluation-and-tuning" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/apachespark/model-evaluation-and-tuning" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='collaborative-filtering'>&#x25C4;Filtrado Colaborativo</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Evaluación y Ajuste de Modelos</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-graphx'>Introducción a GraphX &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>La evaluación y el ajuste de modelos son pasos críticos en el pipeline de aprendizaje automático. Aseguran que los modelos que construyes no solo sean precisos, sino que también se generalicen bien a datos no vistos. En esta sección, exploraremos cómo evaluar y ajustar modelos de aprendizaje automático utilizando MLlib de Apache Spark.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Evaluación de Modelos</strong>: El proceso de evaluar qué tan bien funciona un modelo.</li>
<li><strong>Ajuste de Modelos</strong>: El proceso de optimizar los parámetros del modelo para mejorar el rendimiento.</li>
<li><strong>Validación Cruzada</strong>: Una técnica para evaluar el rendimiento del modelo dividiendo los datos en conjuntos de entrenamiento y prueba múltiples veces.</li>
<li><strong>Hiperparámetros</strong>: Parámetros que se establecen antes de que comience el proceso de aprendizaje y controlan el proceso de aprendizaje.</li>
</ul>
</div><h1>Evaluación de Modelos</h1>
<div class='content'></div><h2>Métricas</h2>
<div class='content'><p>Spark MLlib proporciona varias métricas para evaluar el rendimiento de los modelos de aprendizaje automático:</p>
<ul>
<li><strong>Métricas de Clasificación</strong>: Precisión, Exactitud, Recuperación, Puntuación F1, etc.</li>
<li><strong>Métricas de Regresión</strong>: Error Cuadrático Medio (MSE), Raíz del Error Cuadrático Medio (RMSE), Error Absoluto Medio (MAE), R-cuadrado, etc.</li>
</ul>
</div><h2>Ejemplo: Evaluación de un Modelo de Clasificación</h2>
<div class='content'><p>Evaluemos un modelo de regresión logística utilizando la precisión como métrica.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IE11bHRpY2xhc3NDbGFzc2lmaWNhdGlvbkV2YWx1YXRvcgpmcm9tIHB5c3Bhcmsuc3FsIGltcG9ydCBTcGFya1Nlc3Npb24KCiMgSW5pY2lhbGl6YXIgc2VzacOzbiBkZSBTcGFyawpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIk1vZGVsRXZhbHVhdGlvbiIpLmdldE9yQ3JlYXRlKCkKCiMgQ2FyZ2FyIGRhdG9zCmRhdGEgPSBzcGFyay5yZWFkLmZvcm1hdCgibGlic3ZtIikubG9hZCgiZGF0YS9tbGxpYi9zYW1wbGVfbGlic3ZtX2RhdGEudHh0IikKCiMgRGl2aWRpciBkYXRvcyBlbiBjb25qdW50b3MgZGUgZW50cmVuYW1pZW50byB5IHBydWViYQp0cmFpbl9kYXRhLCB0ZXN0X2RhdGEgPSBkYXRhLnJhbmRvbVNwbGl0KFswLjcsIDAuM10pCgojIEVudHJlbmFyIHVuIG1vZGVsbyBkZSByZWdyZXNpw7NuIGxvZ8Otc3RpY2EKbHIgPSBMb2dpc3RpY1JlZ3Jlc3Npb24oKQptb2RlbCA9IGxyLmZpdCh0cmFpbl9kYXRhKQoKIyBIYWNlciBwcmVkaWNjaW9uZXMKcHJlZGljdGlvbnMgPSBtb2RlbC50cmFuc2Zvcm0odGVzdF9kYXRhKQoKIyBFdmFsdWFyIGVsIG1vZGVsbwpldmFsdWF0b3IgPSBNdWx0aWNsYXNzQ2xhc3NpZmljYXRpb25FdmFsdWF0b3IobWV0cmljTmFtZT0iYWNjdXJhY3kiKQphY2N1cmFjeSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKcHJpbnQoZiJQcmVjaXNpw7NuIGRlIFBydWViYToge2FjY3VyYWN5fSIp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegression
from pyspark.ml.evaluation import MulticlassClassificationEvaluator
from pyspark.sql import SparkSession

# Inicializar sesi&oacute;n de Spark
spark = SparkSession.builder.appName(&quot;ModelEvaluation&quot;).getOrCreate()

# Cargar datos
data = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_libsvm_data.txt&quot;)

# Dividir datos en conjuntos de entrenamiento y prueba
train_data, test_data = data.randomSplit([0.7, 0.3])

# Entrenar un modelo de regresi&oacute;n log&iacute;stica
lr = LogisticRegression()
model = lr.fit(train_data)

# Hacer predicciones
predictions = model.transform(test_data)

# Evaluar el modelo
evaluator = MulticlassClassificationEvaluator(metricName=&quot;accuracy&quot;)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Precisi&oacute;n de Prueba: {accuracy}&quot;)</pre></div><div class='content'></div><h2>Ejemplo: Evaluación de un Modelo de Regresión</h2>
<div class='content'><p>Evaluemos un modelo de regresión lineal utilizando RMSE como métrica.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IExpbmVhclJlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKCiMgQ2FyZ2FyIGRhdG9zCmRhdGEgPSBzcGFyay5yZWFkLmZvcm1hdCgibGlic3ZtIikubG9hZCgiZGF0YS9tbGxpYi9zYW1wbGVfbGluZWFyX3JlZ3Jlc3Npb25fZGF0YS50eHQiKQoKIyBEaXZpZGlyIGRhdG9zIGVuIGNvbmp1bnRvcyBkZSBlbnRyZW5hbWllbnRvIHkgcHJ1ZWJhCnRyYWluX2RhdGEsIHRlc3RfZGF0YSA9IGRhdGEucmFuZG9tU3BsaXQoWzAuNywgMC4zXSkKCiMgRW50cmVuYXIgdW4gbW9kZWxvIGRlIHJlZ3Jlc2nDs24gbGluZWFsCmxyID0gTGluZWFyUmVncmVzc2lvbigpCm1vZGVsID0gbHIuZml0KHRyYWluX2RhdGEpCgojIEhhY2VyIHByZWRpY2Npb25lcwpwcmVkaWN0aW9ucyA9IG1vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIEV2YWx1YXIgZWwgbW9kZWxvCmV2YWx1YXRvciA9IFJlZ3Jlc3Npb25FdmFsdWF0b3IobWV0cmljTmFtZT0icm1zZSIpCnJtc2UgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiUk1TRSBkZSBQcnVlYmE6IHtybXNlfSIp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.regression import LinearRegression
from pyspark.ml.evaluation import RegressionEvaluator

# Cargar datos
data = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_linear_regression_data.txt&quot;)

# Dividir datos en conjuntos de entrenamiento y prueba
train_data, test_data = data.randomSplit([0.7, 0.3])

# Entrenar un modelo de regresi&oacute;n lineal
lr = LinearRegression()
model = lr.fit(train_data)

# Hacer predicciones
predictions = model.transform(test_data)

# Evaluar el modelo
evaluator = RegressionEvaluator(metricName=&quot;rmse&quot;)
rmse = evaluator.evaluate(predictions)
print(f&quot;RMSE de Prueba: {rmse}&quot;)</pre></div><div class='content'></div><h1>Ajuste de Modelos</h1>
<div class='content'></div><h2>Ajuste de Hiperparámetros</h2>
<div class='content'><p>El ajuste de hiperparámetros implica encontrar el mejor conjunto de hiperparámetros para un modelo. Spark MLlib proporciona herramientas como <code>ParamGridBuilder</code> y <code>CrossValidator</code> para facilitar este proceso.</p>
</div><h2>Ejemplo: Ajuste de Hiperparámetros con Validación Cruzada</h2>
<div class='content'><p>Ajustemos los hiperparámetros de un modelo de regresión logística utilizando validación cruzada.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnR1bmluZyBpbXBvcnQgUGFyYW1HcmlkQnVpbGRlciwgQ3Jvc3NWYWxpZGF0b3IKCiMgRGVmaW5pciBsYSBjdWFkcsOtY3VsYSBkZSBwYXLDoW1ldHJvcwpwYXJhbUdyaWQgPSBQYXJhbUdyaWRCdWlsZGVyKCkgXAogICAgLmFkZEdyaWQobHIucmVnUGFyYW0sIFswLjEsIDAuMDFdKSBcCiAgICAuYWRkR3JpZChsci5lbGFzdGljTmV0UGFyYW0sIFswLjAsIDAuNSwgMS4wXSkgXAogICAgLmJ1aWxkKCkKCiMgRGVmaW5pciBlbCB2YWxpZGFkb3IgY3J1emFkbwpjcm9zc3ZhbCA9IENyb3NzVmFsaWRhdG9yKGVzdGltYXRvcj1sciwKICAgICAgICAgICAgICAgICAgICAgICAgICBlc3RpbWF0b3JQYXJhbU1hcHM9cGFyYW1HcmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgIGV2YWx1YXRvcj1ldmFsdWF0b3IsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbnVtRm9sZHM9MykKCiMgRWplY3V0YXIgdmFsaWRhY2nDs24gY3J1emFkYSB5IGVsZWdpciBlbCBtZWpvciBjb25qdW50byBkZSBwYXLDoW1ldHJvcwpjdk1vZGVsID0gY3Jvc3N2YWwuZml0KHRyYWluX2RhdGEpCgojIEhhY2VyIHByZWRpY2Npb25lcyBlbiBsb3MgZGF0b3MgZGUgcHJ1ZWJhCnByZWRpY3Rpb25zID0gY3ZNb2RlbC50cmFuc2Zvcm0odGVzdF9kYXRhKQoKIyBFdmFsdWFyIGVsIG1vZGVsbyBhanVzdGFkbwphY2N1cmFjeSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKcHJpbnQoZiJQcmVjaXNpw7NuIGRlIFBydWViYSBBanVzdGFkYToge2FjY3VyYWN5fSIp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.tuning import ParamGridBuilder, CrossValidator

# Definir la cuadr&iacute;cula de par&aacute;metros
paramGrid = ParamGridBuilder() \
    .addGrid(lr.regParam, [0.1, 0.01]) \
    .addGrid(lr.elasticNetParam, [0.0, 0.5, 1.0]) \
    .build()

# Definir el validador cruzado
crossval = CrossValidator(estimator=lr,
                          estimatorParamMaps=paramGrid,
                          evaluator=evaluator,
                          numFolds=3)

# Ejecutar validaci&oacute;n cruzada y elegir el mejor conjunto de par&aacute;metros
cvModel = crossval.fit(train_data)

# Hacer predicciones en los datos de prueba
predictions = cvModel.transform(test_data)

# Evaluar el modelo ajustado
accuracy = evaluator.evaluate(predictions)
print(f&quot;Precisi&oacute;n de Prueba Ajustada: {accuracy}&quot;)</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>La evaluación y el ajuste de modelos son esenciales para construir modelos de aprendizaje automático robustos. Apache Spark MLlib proporciona un conjunto completo de herramientas para evaluar y ajustar modelos de manera eficiente. Al comprender y aplicar estas técnicas, puedes mejorar significativamente el rendimiento y la fiabilidad de tus aplicaciones de aprendizaje automático.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='collaborative-filtering'>&#x25C4;Filtrado Colaborativo</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Evaluación y Ajuste de Modelos</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-graphx'>Introducción a GraphX &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
