<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL para análisis de datos</title>

    <link rel="alternate" href="https://campusempresa.com/mod/sql/11-03-sql-data-analysis" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/sql/11-03-sql-data-analysis" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/sql/11-03-sql-data-analysis" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css?v=2" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725" crossorigin="anonymous"></script>  	
	</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-6 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-6 p-2 p-md-0 text-end">
				<a href="https://enterprisecampus.net/mod/sql/11-03-sql-data-analysis" class="px-2">EN</a></b>
	|
	<b class="px-2">ES</b>
	|
	<a href="https://campusempresa.cat/mod/sql/11-03-sql-data-analysis" class="px-2">CA</a>
<br>
			<cite>Construyendo la sociedad de hoy y del mañana</cite>
		</div>
	</div>
</div>
<div id="subheader" class="container-xxl">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
			<a href="/objective">El Proyecto</a> | 
<a href="/about">Sobre nosotros</a> | 
<a href="/contribute">Contribuir</a> | 
<a href="/donate">Donaciones</a> | 
<a href="/licence">Licencia</a>
		</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				 					<a href="/categ/languages">Lenguajes de Programación</a>
				 					<a href="/categ/frameworks">Frameworks y Librerías</a>
				 					<a href="/categ/tech-tools">Herramientas Técnicas</a>
				 					<a href="/categ/foundations">Fundamentos Teóricos</a>
				 					<a href="/categ/soft-skills">Habilidades Sociales</a>
							</div>
		</div>
	</div>
</div>
		
<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
				<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='11-02-best-practices' title="Mejores prácticas">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">SQL para análisis de datos</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='11-04-sql-web-development' title="SQL en desarrollo web">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>El análisis de datos es una de las aplicaciones más poderosas de SQL. En este módulo, aprenderás cómo utilizar SQL para extraer, transformar y analizar datos de manera efectiva. Este conocimiento es fundamental para roles como analistas de datos, científicos de datos y desarrolladores de BI (Business Intelligence).</p>
</div><h1><p>Objetivos del Módulo</p>
</h1>
<div class='content'><ul>
<li>Comprender cómo utilizar SQL para realizar análisis de datos.</li>
<li>Aprender a utilizar funciones agregadas y de ventana para análisis avanzados.</li>
<li>Conocer técnicas para limpiar y preparar datos.</li>
<li>Realizar análisis exploratorio de datos (EDA) utilizando SQL.</li>
</ul>
</div><h1><p>Contenido del Módulo</p>
</h1>
<div class='content'><ol>
<li><a href="#funciones-agregadas">Funciones agregadas</a></li>
<li><a href="#funciones-de-ventana">Funciones de ventana</a></li>
<li><a href="#limpieza-y-preparación-de-datos">Limpieza y preparación de datos</a></li>
<li><a href="#análisis-exploratorio-de-datos-eda">Análisis exploratorio de datos (EDA)</a></li>
<li><a href="#ejercicios-prácticos">Ejercicios prácticos</a></li>
</ol>
</div><h1><p>Funciones agregadas</p>
</h1>
<div class='content'><p>Las funciones agregadas son esenciales para resumir y analizar grandes conjuntos de datos. Las funciones más comunes incluyen <code>SUM</code>, <code>AVG</code>, <code>COUNT</code>, <code>MIN</code> y <code>MAX</code>.</p>
</div><h2><p>Ejemplo práctico</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gU3Vwb25nYW1vcyBxdWUgdGVuZW1vcyB1bmEgdGFibGEgZGUgdmVudGFzIGxsYW1hZGEgJ3NhbGVzJyBjb24gbGFzIHNpZ3VpZW50ZXMgY29sdW1uYXM6Ci0tIGlkLCBwcm9kdWN0X2lkLCBxdWFudGl0eSwgcHJpY2UsIHNhbGVfZGF0ZQoKLS0gUXVlcmVtb3MgY2FsY3VsYXIgZWwgdG90YWwgZGUgdmVudGFzIHkgZWwgcHJvbWVkaW8gZGUgdmVudGFzIHBvciBwcm9kdWN0by4KU0VMRUNUIAogICAgcHJvZHVjdF9pZCwKICAgIFNVTShxdWFudGl0eSAqIHByaWNlKSBBUyB0b3RhbF9zYWxlcywKICAgIEFWRyhxdWFudGl0eSAqIHByaWNlKSBBUyBhdmVyYWdlX3NhbGVzCkZST00gCiAgICBzYWxlcwpHUk9VUCBCWSAKICAgIHByb2R1Y3RfaWQ7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Supongamos que tenemos una tabla de ventas llamada 'sales' con las siguientes columnas:
-- id, product_id, quantity, price, sale_date

-- Queremos calcular el total de ventas y el promedio de ventas por producto.
SELECT 
    product_id,
    SUM(quantity * price) AS total_sales,
    AVG(quantity * price) AS average_sales
FROM 
    sales
GROUP BY 
    product_id;</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>SUM(quantity * price)</code>: Calcula el total de ventas por producto.</li>
<li><code>AVG(quantity * price)</code>: Calcula el promedio de ventas por producto.</li>
<li><code>GROUP BY product_id</code>: Agrupa los resultados por <code>product_id</code>.</li>
</ul>
</div><h1><p>Funciones de ventana</p>
</h1>
<div class='content'><p>Las funciones de ventana permiten realizar cálculos sobre un conjunto de filas relacionadas sin agrupar los resultados en una sola fila. Esto es útil para cálculos como promedios móviles, sumas acumulativas, etc.</p>
</div><h2><p>Ejemplo práctico</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gUXVlcmVtb3MgY2FsY3VsYXIgbGEgc3VtYSBhY3VtdWxhdGl2YSBkZSB2ZW50YXMgcG9yIHByb2R1Y3RvLgpTRUxFQ1QgCiAgICBwcm9kdWN0X2lkLAogICAgc2FsZV9kYXRlLAogICAgcXVhbnRpdHkgKiBwcmljZSBBUyBzYWxlX2Ftb3VudCwKICAgIFNVTShxdWFudGl0eSAqIHByaWNlKSBPVkVSIChQQVJUSVRJT04gQlkgcHJvZHVjdF9pZCBPUkRFUiBCWSBzYWxlX2RhdGUpIEFTIGN1bXVsYXRpdmVfc2FsZXMKRlJPTSAKICAgIHNhbGVzOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Queremos calcular la suma acumulativa de ventas por producto.
SELECT 
    product_id,
    sale_date,
    quantity * price AS sale_amount,
    SUM(quantity * price) OVER (PARTITION BY product_id ORDER BY sale_date) AS cumulative_sales
FROM 
    sales;</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>SUM(quantity * price) OVER (PARTITION BY product_id ORDER BY sale_date)</code>: Calcula la suma acumulativa de ventas por producto, ordenada por fecha de venta.</li>
</ul>
</div><h1><p>Limpieza y preparación de datos</p>
</h1>
<div class='content'><p>Antes de realizar cualquier análisis, es crucial limpiar y preparar los datos. Esto puede incluir la eliminación de duplicados, el manejo de valores nulos y la normalización de datos.</p>
</div><h2><p>Ejemplo práctico</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gUXVlcmVtb3MgZWxpbWluYXIgbGFzIGZpbGFzIGR1cGxpY2FkYXMgZW4gbGEgdGFibGEgJ3NhbGVzJy4KREVMRVRFIEZST00gCiAgICBzYWxlcwpXSEVSRSAKICAgIGlkIE5PVCBJTiAoCiAgICAgICAgU0VMRUNUIAogICAgICAgICAgICBNSU4oaWQpCiAgICAgICAgRlJPTSAKICAgICAgICAgICAgc2FsZXMKICAgICAgICBHUk9VUCBCWSAKICAgICAgICAgICAgcHJvZHVjdF9pZCwgc2FsZV9kYXRlLCBxdWFudGl0eSwgcHJpY2UKICAgICk7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Queremos eliminar las filas duplicadas en la tabla 'sales'.
DELETE FROM 
    sales
WHERE 
    id NOT IN (
        SELECT 
            MIN(id)
        FROM 
            sales
        GROUP BY 
            product_id, sale_date, quantity, price
    );</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>MIN(id)</code>: Selecciona la fila con el ID más bajo para cada grupo de duplicados.</li>
<li><code>DELETE FROM sales WHERE id NOT IN (...)</code>: Elimina las filas que no son la primera ocurrencia de cada grupo de duplicados.</li>
</ul>
</div><h1><p>Análisis exploratorio de datos (EDA)</p>
</h1>
<div class='content'><p>El EDA es el proceso de analizar conjuntos de datos para resumir sus características principales, a menudo utilizando métodos visuales. En SQL, esto puede incluir la generación de estadísticas descriptivas y la identificación de patrones.</p>
</div><h2><p>Ejemplo práctico</p>
</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gUXVlcmVtb3Mgb2J0ZW5lciBlc3RhZMOtc3RpY2FzIGRlc2NyaXB0aXZhcyBkZSBsYXMgdmVudGFzLgpTRUxFQ1QgCiAgICBwcm9kdWN0X2lkLAogICAgQ09VTlQoKikgQVMgbnVtX3NhbGVzLAogICAgU1VNKHF1YW50aXR5ICogcHJpY2UpIEFTIHRvdGFsX3NhbGVzLAogICAgQVZHKHF1YW50aXR5ICogcHJpY2UpIEFTIGF2ZXJhZ2Vfc2FsZXMsCiAgICBNSU4ocXVhbnRpdHkgKiBwcmljZSkgQVMgbWluX3NhbGUsCiAgICBNQVgocXVhbnRpdHkgKiBwcmljZSkgQVMgbWF4X3NhbGUKRlJPTSAKICAgIHNhbGVzCkdST1VQIEJZIAogICAgcHJvZHVjdF9pZDs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Queremos obtener estad&iacute;sticas descriptivas de las ventas.
SELECT 
    product_id,
    COUNT(*) AS num_sales,
    SUM(quantity * price) AS total_sales,
    AVG(quantity * price) AS average_sales,
    MIN(quantity * price) AS min_sale,
    MAX(quantity * price) AS max_sale
FROM 
    sales
GROUP BY 
    product_id;</pre></div><div class='content'></div><h2><p>Explicación</p>
</h2>
<div class='content'><ul>
<li><code>COUNT(*)</code>: Cuenta el número de ventas por producto.</li>
<li><code>SUM(quantity * price)</code>: Calcula el total de ventas por producto.</li>
<li><code>AVG(quantity * price)</code>: Calcula el promedio de ventas por producto.</li>
<li><code>MIN(quantity * price)</code>: Encuentra la venta mínima por producto.</li>
<li><code>MAX(quantity * price)</code>: Encuentra la venta máxima por producto.</li>
</ul>
</div><h1><p>Ejercicios prácticos</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Análisis de ventas por región</p>
</h2>
<div class='content'><p><strong>Descripción:</strong> Utiliza la tabla <code>sales</code> y una tabla adicional <code>regions</code> que contiene las columnas <code>product_id</code>, <code>region</code> para calcular el total de ventas por región.</p>
<p><strong>Instrucción:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXNjcmliZSB1bmEgY29uc3VsdGEgcGFyYSBjYWxjdWxhciBlbCB0b3RhbCBkZSB2ZW50YXMgcG9yIHJlZ2nDs24uClNFTEVDVCAKICAgIHIucmVnaW9uLAogICAgU1VNKHMucXVhbnRpdHkgKiBzLnByaWNlKSBBUyB0b3RhbF9zYWxlcwpGUk9NIAogICAgc2FsZXMgcwpKT0lOIAogICAgcmVnaW9ucyByIE9OIHMucHJvZHVjdF9pZCA9IHIucHJvZHVjdF9pZApHUk9VUCBCWSAKICAgIHIucmVnaW9uOw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Escribe una consulta para calcular el total de ventas por regi&oacute;n.
SELECT 
    r.region,
    SUM(s.quantity * s.price) AS total_sales
FROM 
    sales s
JOIN 
    regions r ON s.product_id = r.product_id
GROUP BY 
    r.region;</pre></div><div class='content'></div><h2><p>Ejercicio 2: Identificación de productos más vendidos</p>
</h2>
<div class='content'><p><strong>Descripción:</strong> Encuentra los 5 productos más vendidos en términos de cantidad.</p>
<p><strong>Instrucción:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXNjcmliZSB1bmEgY29uc3VsdGEgcGFyYSBlbmNvbnRyYXIgbG9zIDUgcHJvZHVjdG9zIG3DoXMgdmVuZGlkb3MuClNFTEVDVCAKICAgIHByb2R1Y3RfaWQsCiAgICBTVU0ocXVhbnRpdHkpIEFTIHRvdGFsX3F1YW50aXR5CkZST00gCiAgICBzYWxlcwpHUk9VUCBCWSAKICAgIHByb2R1Y3RfaWQKT1JERVIgQlkgCiAgICB0b3RhbF9xdWFudGl0eSBERVNDCkxJTUlUIDU7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Escribe una consulta para encontrar los 5 productos m&aacute;s vendidos.
SELECT 
    product_id,
    SUM(quantity) AS total_quantity
FROM 
    sales
GROUP BY 
    product_id
ORDER BY 
    total_quantity DESC
LIMIT 5;</pre></div><div class='content'></div><h2><p>Ejercicio 3: Análisis de ventas mensuales</p>
</h2>
<div class='content'><p><strong>Descripción:</strong> Calcula el total de ventas por mes.</p>
<p><strong>Instrucción:</strong></p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXNjcmliZSB1bmEgY29uc3VsdGEgcGFyYSBjYWxjdWxhciBlbCB0b3RhbCBkZSB2ZW50YXMgcG9yIG1lcy4KU0VMRUNUIAogICAgREFURV9UUlVOQygnbW9udGgnLCBzYWxlX2RhdGUpIEFTIHNhbGVfbW9udGgsCiAgICBTVU0ocXVhbnRpdHkgKiBwcmljZSkgQVMgdG90YWxfc2FsZXMKRlJPTSAKICAgIHNhbGVzCkdST1VQIEJZIAogICAgc2FsZV9tb250aApPUkRFUiBCWSAKICAgIHNhbGVfbW9udGg7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Escribe una consulta para calcular el total de ventas por mes.
SELECT 
    DATE_TRUNC('month', sale_date) AS sale_month,
    SUM(quantity * price) AS total_sales
FROM 
    sales
GROUP BY 
    sale_month
ORDER BY 
    sale_month;</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>En este módulo, hemos explorado cómo utilizar SQL para el análisis de datos, incluyendo el uso de funciones agregadas y de ventana, técnicas de limpieza y preparación de datos, y métodos para realizar análisis exploratorio de datos. Estos conocimientos te permitirán extraer información valiosa de tus datos y tomar decisiones informadas basadas en ellos.</p>
<p>En el próximo módulo, profundizaremos en la creación y gestión de índices para optimizar el rendimiento de tus consultas SQL.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='11-02-best-practices' title="Mejores prácticas">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='11-04-sql-web-development' title="SQL en desarrollo web">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<!-- 
<h1>Publicidad</h1>
<p>Este espacio está destinado a publicidad.</p>
<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
<p>¡Gracias por colaborar!</p>
-->

<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-0611338592562725"
     crossorigin="anonymous"></script>
<!-- enterprise_campus -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-0611338592562725"
     data-ad-slot="6914733106"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
