<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Automatización de Reportes</title>

    <link rel="alternate" href="https://campusempresa.com/mod/analitica_digital/06-03-automatizacion-reportes" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/analitica_digital/06-03-automatizacion-reportes" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/analitica_digital/06-03-report-automation" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="/js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body >
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-12 col-md-8 p-2 p-md-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png"></a>
			</h1>
		</div>
		<div class="col-12 col-md-4 p-2 p-md-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-2 p-md-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/analitica_digital/06-03-report-automation" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/analitica_digital/06-03-automatizacion-reportes" class="px-2">CA</a>
								</div>
	</div>
</div>

<div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<!-- <a href="/">Home</a>  -->
									<a href="./">Contenido del curso</a>
					<span class="sep">|</span>
								<a href="/all/competencias">Competencias técnicas</a>
				<a href="/all/conocimientos">Conocimientos</a>
				<a href="/all/soft_skills">Competencias sociales</a>
			</div>
		</div>
	</div>
</div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content">
								<div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-02-google-data-studio' title="Uso de Dashboards en Google Data Studio">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
					<a href="./"><h2 style="text-decoration:underline">Automatización de Reportes</h2></a>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-caso-practico-ecommerce' title="Caso Práctico: E-commerce">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>
<div class='content'><p>La automatización de reportes en analítica digital es una práctica esencial para ahorrar tiempo, reducir errores y asegurar que los datos se presenten de manera consistente y oportuna. En esta sección, aprenderás cómo automatizar la creación y distribución de reportes utilizando diversas herramientas y técnicas.</p>
</div><h1><p>Objetivos de la Sección</p>
</h1>
<div class='content'><ul>
<li>Comprender la importancia de la automatización de reportes.</li>
<li>Conocer las herramientas disponibles para la automatización.</li>
<li>Aprender a configurar reportes automatizados en Google Analytics y Google Data Studio.</li>
<li>Implementar scripts y APIs para la automatización avanzada.</li>
</ul>
</div><h1><p>Importancia de la Automatización de Reportes</p>
</h1>
<div class='content'><p>Automatizar los reportes tiene múltiples beneficios:</p>
<ul>
<li><strong>Eficiencia:</strong> Reduce el tiempo dedicado a la creación manual de reportes.</li>
<li><strong>Consistencia:</strong> Asegura que los reportes se generen con el mismo formato y estructura cada vez.</li>
<li><strong>Puntualidad:</strong> Permite la entrega de reportes en intervalos regulares sin retrasos.</li>
<li><strong>Reducción de Errores:</strong> Minimiza los errores humanos en la recopilación y presentación de datos.</li>
</ul>
</div><h1><p>Herramientas para la Automatización de Reportes</p>
</h1>
<div class='content'><p>Existen varias herramientas que facilitan la automatización de reportes en analítica digital:</p>
<ul>
<li><strong>Google Analytics:</strong> Permite programar reportes y enviarlos automáticamente por correo electrónico.</li>
<li><strong>Google Data Studio:</strong> Ofrece la capacidad de crear dashboards interactivos que se actualizan automáticamente.</li>
<li><strong>APIs de Google Analytics:</strong> Permiten la extracción de datos programática para su uso en scripts personalizados.</li>
<li><strong>Zapier:</strong> Conecta diferentes aplicaciones para automatizar flujos de trabajo, incluyendo la generación de reportes.</li>
</ul>
</div><h1><p>Configuración de Reportes Automatizados en Google Analytics</p>
</h1>
<div class='content'></div><h2><p>Paso 1: Crear un Reporte Personalizado</p>
</h2>
<div class='content'><ol>
<li><strong>Accede a Google Analytics</strong> y navega a la vista deseada.</li>
<li>Ve a <strong>Personalización &gt; Informes personalizados</strong>.</li>
<li>Haz clic en <strong>+ Nuevo informe personalizado</strong>.</li>
<li>Configura el informe con las métricas y dimensiones que necesitas.</li>
<li>Guarda el informe.</li>
</ol>
</div><h2><p>Paso 2: Programar la Entrega del Reporte</p>
</h2>
<div class='content'><ol>
<li>Abre el informe personalizado que has creado.</li>
<li>Haz clic en el botón <strong>Compartir</strong> en la parte superior derecha.</li>
<li>Selecciona <strong>Programar</strong>.</li>
<li>Configura la frecuencia de envío (diaria, semanal, mensual, etc.).</li>
<li>Introduce las direcciones de correo electrónico de los destinatarios.</li>
<li>Haz clic en <strong>Programar</strong>.</li>
</ol>
</div><h2><p>Ejemplo de Configuración de Reporte Automatizado</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Tm9tYnJlIGRlbCBSZXBvcnRlOiBUcsOhZmljbyBNZW5zdWFsIGRlbCBTaXRpbyBXZWIKTcOpdHJpY2FzOiBTZXNpb25lcywgVXN1YXJpb3MsIFRhc2EgZGUgUmVib3RlCkRpbWVuc2lvbmVzOiBGdWVudGUvTWVkaW8KRnJlY3VlbmNpYSBkZSBFbnbDrW86IE1lbnN1YWwKRGVzdGluYXRhcmlvczogbWFya2V0aW5nQGVtcHJlc2EuY29tLCBhbmFsaXRpY2FAZW1wcmVzYS5jb20="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Nombre del Reporte: Tr&aacute;fico Mensual del Sitio Web
M&eacute;tricas: Sesiones, Usuarios, Tasa de Rebote
Dimensiones: Fuente/Medio
Frecuencia de Env&iacute;o: Mensual
Destinatarios: marketing@empresa.com, analitica@empresa.com</pre></div><div class='content'></div><h1><p>Uso de Google Data Studio para la Automatización</p>
</h1>
<div class='content'></div><h2><p>Paso 1: Crear un Dashboard en Google Data Studio</p>
</h2>
<div class='content'><ol>
<li><strong>Accede a Google Data Studio</strong> y crea un nuevo informe.</li>
<li>Conecta tu fuente de datos (por ejemplo, Google Analytics).</li>
<li>Diseña el dashboard con los gráficos y tablas necesarios.</li>
<li>Guarda el informe.</li>
</ol>
</div><h2><p>Paso 2: Compartir y Programar la Actualización del Dashboard</p>
</h2>
<div class='content'><ol>
<li>Haz clic en el botón <strong>Compartir</strong> en la parte superior derecha.</li>
<li>Introduce las direcciones de correo electrónico de los destinatarios y configura los permisos.</li>
<li>Google Data Studio actualiza automáticamente los datos en tiempo real, por lo que no es necesario programar actualizaciones manuales.</li>
</ol>
</div><h2><p>Ejemplo de Dashboard Automatizado</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Tm9tYnJlIGRlbCBEYXNoYm9hcmQ6IFJlbmRpbWllbnRvIGRlIGxhIENhbXBhw7FhIGRlIE1hcmtldGluZwpHcsOhZmljb3M6IEdyw6FmaWNvIGRlIGzDrW5lYXMgZGUgc2VzaW9uZXMgcG9yIGTDrWEsIFRhYmxhIGRlIGNvbnZlcnNpb25lcyBwb3IgZnVlbnRlL21lZGlvLCBHcsOhZmljbyBkZSBiYXJyYXMgZGUgaW5ncmVzb3MgcG9yIHByb2R1Y3RvCkRlc3RpbmF0YXJpb3M6IGVxdWlwb19tYXJrZXRpbmdAZW1wcmVzYS5jb20="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Nombre del Dashboard: Rendimiento de la Campa&ntilde;a de Marketing
Gr&aacute;ficos: Gr&aacute;fico de l&iacute;neas de sesiones por d&iacute;a, Tabla de conversiones por fuente/medio, Gr&aacute;fico de barras de ingresos por producto
Destinatarios: equipo_marketing@empresa.com</pre></div><div class='content'></div><h1><p>Automatización Avanzada con Scripts y APIs</p>
</h1>
<div class='content'></div><h2><p>Uso de la API de Google Analytics</p>
</h2>
<div class='content'><p>La API de Google Analytics permite extraer datos de manera programática y automatizar la creación de reportes personalizados.</p>
<h4>Ejemplo de Script en Python</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGVhcGljbGllbnQuZGlzY292ZXJ5IGltcG9ydCBidWlsZApmcm9tIG9hdXRoMmNsaWVudC5zZXJ2aWNlX2FjY291bnQgaW1wb3J0IFNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHMKaW1wb3J0IHBhbmRhcyBhcyBwZAoKIyBDb25maWd1cmFjacOzbiBkZSBsYSBBUEkKU0NPUEVTID0gWydodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2FuYWx5dGljcy5yZWFkb25seSddCktFWV9GSUxFX0xPQ0FUSU9OID0gJ3BhdGgvdG8veW91ci1zZXJ2aWNlLWFjY291bnQta2V5Lmpzb24nClZJRVdfSUQgPSAneW91cl92aWV3X2lkJwoKZGVmIGluaXRpYWxpemVfYW5hbHl0aWNzcmVwb3J0aW5nKCk6CiAgICBjcmVkZW50aWFscyA9IFNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHMuZnJvbV9qc29uX2tleWZpbGVfbmFtZShLRVlfRklMRV9MT0NBVElPTiwgU0NPUEVTKQogICAgYW5hbHl0aWNzID0gYnVpbGQoJ2FuYWx5dGljc3JlcG9ydGluZycsICd2NCcsIGNyZWRlbnRpYWxzPWNyZWRlbnRpYWxzKQogICAgcmV0dXJuIGFuYWx5dGljcwoKZGVmIGdldF9yZXBvcnQoYW5hbHl0aWNzKToKICAgIHJldHVybiBhbmFseXRpY3MucmVwb3J0cygpLmJhdGNoR2V0KAogICAgICAgIGJvZHk9ewogICAgICAgICAgICAncmVwb3J0UmVxdWVzdHMnOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJ3ZpZXdJZCc6IFZJRVdfSUQsCiAgICAgICAgICAgICAgICAgICAgJ2RhdGVSYW5nZXMnOiBbeydzdGFydERhdGUnOiAnMzBkYXlzQWdvJywgJ2VuZERhdGUnOiAndG9kYXknfV0sCiAgICAgICAgICAgICAgICAgICAgJ21ldHJpY3MnOiBbeydleHByZXNzaW9uJzogJ2dhOnNlc3Npb25zJ30sIHsnZXhwcmVzc2lvbic6ICdnYTp1c2Vycyd9XSwKICAgICAgICAgICAgICAgICAgICAnZGltZW5zaW9ucyc6IFt7J25hbWUnOiAnZ2E6c291cmNlTWVkaXVtJ31dCiAgICAgICAgICAgICAgICB9XQogICAgICAgIH0KICAgICkuZXhlY3V0ZSgpCgpkZWYgcHJpbnRfcmVzcG9uc2UocmVzcG9uc2UpOgogICAgZm9yIHJlcG9ydCBpbiByZXNwb25zZS5nZXQoJ3JlcG9ydHMnLCBbXSk6CiAgICAgICAgY29sdW1uSGVhZGVyID0gcmVwb3J0LmdldCgnY29sdW1uSGVhZGVyJywge30pCiAgICAgICAgZGltZW5zaW9uSGVhZGVycyA9IGNvbHVtbkhlYWRlci5nZXQoJ2RpbWVuc2lvbnMnLCBbXSkKICAgICAgICBtZXRyaWNIZWFkZXJzID0gY29sdW1uSGVhZGVyLmdldCgnbWV0cmljSGVhZGVyJywge30pLmdldCgnbWV0cmljSGVhZGVyRW50cmllcycsIFtdKQoKICAgICAgICBmb3Igcm93IGluIHJlcG9ydC5nZXQoJ2RhdGEnLCB7fSkuZ2V0KCdyb3dzJywgW10pOgogICAgICAgICAgICBkaW1lbnNpb25zID0gcm93LmdldCgnZGltZW5zaW9ucycsIFtdKQogICAgICAgICAgICBkYXRlUmFuZ2VWYWx1ZXMgPSByb3cuZ2V0KCdtZXRyaWNzJywgW10pCgogICAgICAgICAgICBmb3IgaGVhZGVyLCBkaW1lbnNpb24gaW4gemlwKGRpbWVuc2lvbkhlYWRlcnMsIGRpbWVuc2lvbnMpOgogICAgICAgICAgICAgICAgcHJpbnQoaGVhZGVyICsgJzogJyArIGRpbWVuc2lvbikKCiAgICAgICAgICAgIGZvciBpLCB2YWx1ZXMgaW4gZW51bWVyYXRlKGRhdGVSYW5nZVZhbHVlcyk6CiAgICAgICAgICAgICAgICBwcmludCgnRGF0ZSByYW5nZSAoJyArIHN0cihpKSArICcpJykKICAgICAgICAgICAgICAgIGZvciBtZXRyaWNIZWFkZXIsIHZhbHVlIGluIHppcChtZXRyaWNIZWFkZXJzLCB2YWx1ZXMuZ2V0KCd2YWx1ZXMnKSk6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQobWV0cmljSGVhZGVyLmdldCgnbmFtZScpICsgJzogJyArIHZhbHVlKQoKYW5hbHl0aWNzID0gaW5pdGlhbGl6ZV9hbmFseXRpY3NyZXBvcnRpbmcoKQpyZXNwb25zZSA9IGdldF9yZXBvcnQoYW5hbHl0aWNzKQpwcmludF9yZXNwb25zZShyZXNwb25zZSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from googleapiclient.discovery import build
from oauth2client.service_account import ServiceAccountCredentials
import pandas as pd

# Configuraci&oacute;n de la API
SCOPES = ['https://www.googleapis.com/auth/analytics.readonly']
KEY_FILE_LOCATION = 'path/to/your-service-account-key.json'
VIEW_ID = 'your_view_id'

def initialize_analyticsreporting():
    credentials = ServiceAccountCredentials.from_json_keyfile_name(KEY_FILE_LOCATION, SCOPES)
    analytics = build('analyticsreporting', 'v4', credentials=credentials)
    return analytics

def get_report(analytics):
    return analytics.reports().batchGet(
        body={
            'reportRequests': [
                {
                    'viewId': VIEW_ID,
                    'dateRanges': [{'startDate': '30daysAgo', 'endDate': 'today'}],
                    'metrics': [{'expression': 'ga:sessions'}, {'expression': 'ga:users'}],
                    'dimensions': [{'name': 'ga:sourceMedium'}]
                }]
        }
    ).execute()

def print_response(response):
    for report in response.get('reports', []):
        columnHeader = report.get('columnHeader', {})
        dimensionHeaders = columnHeader.get('dimensions', [])
        metricHeaders = columnHeader.get('metricHeader', {}).get('metricHeaderEntries', [])

        for row in report.get('data', {}).get('rows', []):
            dimensions = row.get('dimensions', [])
            dateRangeValues = row.get('metrics', [])

            for header, dimension in zip(dimensionHeaders, dimensions):
                print(header + ': ' + dimension)

            for i, values in enumerate(dateRangeValues):
                print('Date range (' + str(i) + ')')
                for metricHeader, value in zip(metricHeaders, values.get('values')):
                    print(metricHeader.get('name') + ': ' + value)

analytics = initialize_analyticsreporting()
response = get_report(analytics)
print_response(response)</pre></div><div class='content'></div><h2><p>Explicación del Script</p>
</h2>
<div class='content'><ol>
<li><strong>Inicialización de la API:</strong> Configura las credenciales y crea un objeto de servicio para interactuar con la API de Google Analytics.</li>
<li><strong>Solicitud de Reporte:</strong> Define los parámetros del reporte, incluyendo el ID de la vista, el rango de fechas, las métricas y las dimensiones.</li>
<li><strong>Impresión de la Respuesta:</strong> Extrae y muestra los datos del reporte.</li>
</ol>
</div><h1><p>Ejercicio Práctico</p>
</h1>
<div class='content'></div><h2><p>Ejercicio 1: Automatización de Reporte en Google Analytics</p>
</h2>
<div class='content'><ol>
<li>Crea un reporte personalizado en Google Analytics que incluya las siguientes métricas: Sesiones, Usuarios, Tasa de Rebote.</li>
<li>Programa el envío del reporte a tu correo electrónico con una frecuencia semanal.</li>
</ol>
</div><h2><p>Ejercicio 2: Dashboard en Google Data Studio</p>
</h2>
<div class='content'><ol>
<li>Diseña un dashboard en Google Data Studio que muestre el rendimiento de una campaña de marketing.</li>
<li>Incluye gráficos de líneas para sesiones diarias, una tabla de conversiones por fuente/medio y un gráfico de barras de ingresos por producto.</li>
<li>Comparte el dashboard con tu equipo de marketing.</li>
</ol>
</div><h2><p>Ejercicio 3: Script de Automatización con la API de Google Analytics</p>
</h2>
<div class='content'><ol>
<li>Modifica el script de ejemplo para incluir una nueva métrica: Tasa de Conversión de Objetivos.</li>
<li>Ejecuta el script y verifica que los datos se extraen correctamente.</li>
</ol>
</div><h1><p>Soluciones</p>
</h1>
<div class='content'></div><h2><p>Solución al Ejercicio 1</p>
</h2>
<div class='content'><ol>
<li>Accede a Google Analytics y crea un reporte personalizado con las métricas especificadas.</li>
<li>Programa el envío del reporte a tu correo electrónico.</li>
</ol>
</div><h2><p>Solución al Ejercicio 2</p>
</h2>
<div class='content'><ol>
<li>Accede a Google Data Studio y diseña el dashboard con los gráficos y tablas especificados.</li>
<li>Comparte el dashboard con tu equipo de marketing.</li>
</ol>
</div><h2><p>Solución al Ejercicio 3</p>
</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGVhcGljbGllbnQuZGlzY292ZXJ5IGltcG9ydCBidWlsZApmcm9tIG9hdXRoMmNsaWVudC5zZXJ2aWNlX2FjY291bnQgaW1wb3J0IFNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHMKaW1wb3J0IHBhbmRhcyBhcyBwZAoKIyBDb25maWd1cmFjacOzbiBkZSBsYSBBUEkKU0NPUEVTID0gWydodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9hdXRoL2FuYWx5dGljcy5yZWFkb25seSddCktFWV9GSUxFX0xPQ0FUSU9OID0gJ3BhdGgvdG8veW91ci1zZXJ2aWNlLWFjY291bnQta2V5Lmpzb24nClZJRVdfSUQgPSAneW91cl92aWV3X2lkJwoKZGVmIGluaXRpYWxpemVfYW5hbHl0aWNzcmVwb3J0aW5nKCk6CiAgICBjcmVkZW50aWFscyA9IFNlcnZpY2VBY2NvdW50Q3JlZGVudGlhbHMuZnJvbV9qc29uX2tleWZpbGVfbmFtZShLRVlfRklMRV9MT0NBVElPTiwgU0NPUEVTKQogICAgYW5hbHl0aWNzID0gYnVpbGQoJ2FuYWx5dGljc3JlcG9ydGluZycsICd2NCcsIGNyZWRlbnRpYWxzPWNyZWRlbnRpYWxzKQogICAgcmV0dXJuIGFuYWx5dGljcwoKZGVmIGdldF9yZXBvcnQoYW5hbHl0aWNzKToKICAgIHJldHVybiBhbmFseXRpY3MucmVwb3J0cygpLmJhdGNoR2V0KAogICAgICAgIGJvZHk9ewogICAgICAgICAgICAncmVwb3J0UmVxdWVzdHMnOiBbCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgJ3ZpZXdJZCc6IFZJRVdfSUQsCiAgICAgICAgICAgICAgICAgICAgJ2RhdGVSYW5nZXMnOiBbeydzdGFydERhdGUnOiAnMzBkYXlzQWdvJywgJ2VuZERhdGUnOiAndG9kYXknfV0sCiAgICAgICAgICAgICAgICAgICAgJ21ldHJpY3MnOiBbeydleHByZXNzaW9uJzogJ2dhOnNlc3Npb25zJ30sIHsnZXhwcmVzc2lvbic6ICdnYTp1c2Vycyd9LCB7J2V4cHJlc3Npb24nOiAnZ2E6Z29hbENvbnZlcnNpb25SYXRlQWxsJ31dLAogICAgICAgICAgICAgICAgICAgICdkaW1lbnNpb25zJzogW3snbmFtZSc6ICdnYTpzb3VyY2VNZWRpdW0nfV0KICAgICAgICAgICAgICAgIH1dCiAgICAgICAgfQogICAgKS5leGVjdXRlKCkKCmRlZiBwcmludF9yZXNwb25zZShyZXNwb25zZSk6CiAgICBmb3IgcmVwb3J0IGluIHJlc3BvbnNlLmdldCgncmVwb3J0cycsIFtdKToKICAgICAgICBjb2x1bW5IZWFkZXIgPSByZXBvcnQuZ2V0KCdjb2x1bW5IZWFkZXInLCB7fSkKICAgICAgICBkaW1lbnNpb25IZWFkZXJzID0gY29sdW1uSGVhZGVyLmdldCgnZGltZW5zaW9ucycsIFtdKQogICAgICAgIG1ldHJpY0hlYWRlcnMgPSBjb2x1bW5IZWFkZXIuZ2V0KCdtZXRyaWNIZWFkZXInLCB7fSkuZ2V0KCdtZXRyaWNIZWFkZXJFbnRyaWVzJywgW10pCgogICAgICAgIGZvciByb3cgaW4gcmVwb3J0LmdldCgnZGF0YScsIHt9KS5nZXQoJ3Jvd3MnLCBbXSk6CiAgICAgICAgICAgIGRpbWVuc2lvbnMgPSByb3cuZ2V0KCdkaW1lbnNpb25zJywgW10pCiAgICAgICAgICAgIGRhdGVSYW5nZVZhbHVlcyA9IHJvdy5nZXQoJ21ldHJpY3MnLCBbXSkKCiAgICAgICAgICAgIGZvciBoZWFkZXIsIGRpbWVuc2lvbiBpbiB6aXAoZGltZW5zaW9uSGVhZGVycywgZGltZW5zaW9ucyk6CiAgICAgICAgICAgICAgICBwcmludChoZWFkZXIgKyAnOiAnICsgZGltZW5zaW9uKQoKICAgICAgICAgICAgZm9yIGksIHZhbHVlcyBpbiBlbnVtZXJhdGUoZGF0ZVJhbmdlVmFsdWVzKToKICAgICAgICAgICAgICAgIHByaW50KCdEYXRlIHJhbmdlICgnICsgc3RyKGkpICsgJyknKQogICAgICAgICAgICAgICAgZm9yIG1ldHJpY0hlYWRlciwgdmFsdWUgaW4gemlwKG1ldHJpY0hlYWRlcnMsIHZhbHVlcy5nZXQoJ3ZhbHVlcycpKToKICAgICAgICAgICAgICAgICAgICBwcmludChtZXRyaWNIZWFkZXIuZ2V0KCduYW1lJykgKyAnOiAnICsgdmFsdWUpCgphbmFseXRpY3MgPSBpbml0aWFsaXplX2FuYWx5dGljc3JlcG9ydGluZygpCnJlc3BvbnNlID0gZ2V0X3JlcG9ydChhbmFseXRpY3MpCnByaW50X3Jlc3BvbnNlKHJlc3BvbnNlKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from googleapiclient.discovery import build
from oauth2client.service_account import ServiceAccountCredentials
import pandas as pd

# Configuraci&oacute;n de la API
SCOPES = ['https://www.googleapis.com/auth/analytics.readonly']
KEY_FILE_LOCATION = 'path/to/your-service-account-key.json'
VIEW_ID = 'your_view_id'

def initialize_analyticsreporting():
    credentials = ServiceAccountCredentials.from_json_keyfile_name(KEY_FILE_LOCATION, SCOPES)
    analytics = build('analyticsreporting', 'v4', credentials=credentials)
    return analytics

def get_report(analytics):
    return analytics.reports().batchGet(
        body={
            'reportRequests': [
                {
                    'viewId': VIEW_ID,
                    'dateRanges': [{'startDate': '30daysAgo', 'endDate': 'today'}],
                    'metrics': [{'expression': 'ga:sessions'}, {'expression': 'ga:users'}, {'expression': 'ga:goalConversionRateAll'}],
                    'dimensions': [{'name': 'ga:sourceMedium'}]
                }]
        }
    ).execute()

def print_response(response):
    for report in response.get('reports', []):
        columnHeader = report.get('columnHeader', {})
        dimensionHeaders = columnHeader.get('dimensions', [])
        metricHeaders = columnHeader.get('metricHeader', {}).get('metricHeaderEntries', [])

        for row in report.get('data', {}).get('rows', []):
            dimensions = row.get('dimensions', [])
            dateRangeValues = row.get('metrics', [])

            for header, dimension in zip(dimensionHeaders, dimensions):
                print(header + ': ' + dimension)

            for i, values in enumerate(dateRangeValues):
                print('Date range (' + str(i) + ')')
                for metricHeader, value in zip(metricHeaders, values.get('values')):
                    print(metricHeader.get('name') + ': ' + value)

analytics = initialize_analyticsreporting()
response = get_report(analytics)
print_response(response)</pre></div><div class='content'></div><h1><p>Conclusión</p>
</h1>
<div class='content'><p>La automatización de reportes es una herramienta poderosa en la analítica digital que permite a los profesionales ahorrar tiempo, reducir errores y asegurar la consistencia en la presentación de datos. Al dominar las herramientas y técnicas para la automatización, podrás optimizar tus procesos de reporte y enfocarte en el análisis y la toma de decisiones estratégicas. En la próxima sección, exploraremos casos prácticos y ejercicios para aplicar los conocimientos adquiridos en situaciones del mundo real.</p>
</div><div class='row navigation'>
	<div class='col-1 col-md-2'>
					<a href='06-02-google-data-studio' title="Uso de Dashboards en Google Data Studio">
				<span class="d-none d-md-inline">&#x25C4; Anterior</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-left-square-fill"></i></span>
			</a>
			</div>
	<div class='col-10 col-md-8 text-center'>
			</div>
	<div class='col-1 col-md-2 text-end'>
					<a href='07-01-caso-practico-ecommerce' title="Caso Práctico: E-commerce">
				<span class="d-none d-md-inline">Siguiente &#x25BA;</span>
				<span class="d-inline d-md-none"><i class="bi bi-caret-right-square-fill"></i></span>
			</a>
			</div>
</div>

			</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Usamos cookies para mejorar tu experiencia de uso y ofrecer contenidos adaptados a tus intereses.
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
