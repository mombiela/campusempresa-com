<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pruebas de Servicios Web RESTful</title>

    <link rel="alternate" href="https://campusempresa.com/mod/springboot/testing-restful-web-services" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/mod/springboot/testing-restful-web-services" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/mod/springboot/testing-restful-web-services" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/mod/springboot/testing-restful-web-services" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/mod/springboot/testing-restful-web-services" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='integration-testing'>&#x25C4;Pruebas de Integración</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Pruebas de Servicios Web RESTful</a>
	</div>
	<div class='col-4 text-end'>
					<a href='test-containers'>Contenedores de Prueba &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>Las pruebas son un aspecto crucial del desarrollo de software, asegurando que tu aplicación se comporte como se espera. En esta sección, cubriremos cómo probar servicios web RESTful en una aplicación Spring Boot, desde pruebas unitarias básicas hasta pruebas de integración más avanzadas.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Pruebas Unitarias</strong>: Pruebas de componentes individuales en aislamiento.</li>
<li><strong>Pruebas de Integración</strong>: Pruebas de la interacción entre múltiples componentes.</li>
<li><strong>Mocking</strong>: Simulación del comportamiento de objetos complejos.</li>
<li><strong>Test RestTemplate</strong>: Una utilidad de Spring para probar servicios RESTful.</li>
<li><strong>JUnit</strong>: Un popular marco de pruebas en Java.</li>
<li><strong>Mockito</strong>: Un marco de mocking para pruebas unitarias.</li>
</ul>
</div><h1>Configuración del Entorno de Pruebas</h1>
<div class='content'><p>Antes de sumergirnos en la escritura de pruebas, configuremos nuestro entorno de pruebas.</p>
<ol>
<li>
<p><strong>Agregar Dependencias</strong>: Asegúrate de tener las dependencias necesarias en tu archivo <code>pom.xml</code>.</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mockito&lt;/groupId&gt;
    &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Anotaciones</strong>: Familiarízate con las anotaciones clave.</p>
<ul>
<li><code>@SpringBootTest</code>: Usado para pruebas de integración.</li>
<li><code>@WebMvcTest</code>: Usado para probar controladores Spring MVC.</li>
<li><code>@MockBean</code>: Usado para agregar mocks al ApplicationContext de Spring.</li>
</ul>
</li>
</ol>
</div><h1>Pruebas Unitarias de Controladores REST</h1>
<div class='content'><p>Las pruebas unitarias se centran en componentes individuales. Para los controladores REST, podemos usar <code>@WebMvcTest</code>.</p>
</div><h2>Ejemplo: Probar un Controlador REST</h2>
<div class='content'><p>Supongamos que tenemos un simple <code>UserController</code> con un endpoint <code>GET</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJlc3RDb250cm9sbGVyCkBSZXF1ZXN0TWFwcGluZygiL3VzZXJzIikKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyIHsKICAgIEBHZXRNYXBwaW5nKCIve2lkfSIpCiAgICBwdWJsaWMgUmVzcG9uc2VFbnRpdHk8VXNlcj4gZ2V0VXNlckJ5SWQoQFBhdGhWYXJpYWJsZSBMb25nIGlkKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoaWQsICJKb2huIERvZSIpOwogICAgICAgIHJldHVybiBSZXNwb25zZUVudGl0eS5vayh1c2VyKTsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RestController
@RequestMapping(&quot;/users&quot;)
public class UserController {
    @GetMapping(&quot;/{id}&quot;)
    public ResponseEntity&lt;User&gt; getUserById(@PathVariable Long id) {
        User user = new User(id, &quot;John Doe&quot;);
        return ResponseEntity.ok(user);
    }
}</pre></div><div class='content'></div><h2>Escribiendo la Prueba Unitaria</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAV2ViTXZjVGVzdChVc2VyQ29udHJvbGxlci5jbGFzcykKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyVGVzdCB7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBNb2NrTXZjIG1vY2tNdmM7CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RHZXRVc2VyQnlJZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIG1vY2tNdmMucGVyZm9ybShnZXQoIi91c2Vycy8xIikpCiAgICAgICAgICAgICAgICAuYW5kRXhwZWN0KHN0YXR1cygpLmlzT2soKSkKICAgICAgICAgICAgICAgIC5hbmRFeHBlY3QoanNvblBhdGgoIiQubmFtZSIpLnZhbHVlKCJKb2huIERvZSIpKTsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@WebMvcTest(UserController.class)
public class UserControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    public void testGetUserById() throws Exception {
        mockMvc.perform(get(&quot;/users/1&quot;))
                .andExpect(status().isOk())
                .andExpect(jsonPath(&quot;$.name&quot;).value(&quot;John Doe&quot;));
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>@RunWith(SpringRunner.class)</code>: Integra el Spring TestContext Framework con JUnit.</li>
<li><code>@WebMvcTest(UserController.class)</code>: Configura la infraestructura de Spring MVC para probar el <code>UserController</code>.</li>
<li><code>MockMvc</code>: Una clase para realizar solicitudes y verificar respuestas.</li>
<li><code>mockMvc.perform(get(&quot;/users/1&quot;))</code>: Simula una solicitud GET a <code>/users/1</code>.</li>
<li><code>andExpect(status().isOk())</code>: Asegura que el estado de la respuesta sea 200 OK.</li>
<li><code>andExpect(jsonPath(&quot;$.name&quot;).value(&quot;John Doe&quot;))</code>: Asegura que la respuesta JSON contenga el nombre esperado.</li>
</ul>
</li>
</ul>
</div><h1>Pruebas de Integración de Servicios RESTful</h1>
<div class='content'><p>Las pruebas de integración verifican la interacción entre múltiples componentes. Para esto, usamos <code>@SpringBootTest</code>.</p>
</div><h2>Ejemplo: Prueba de Integración</h2>
<div class='content'><p>Supongamos que tenemos un <code>UserService</code> que interactúa con una base de datos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFNlcnZpY2UKcHVibGljIGNsYXNzIFVzZXJTZXJ2aWNlIHsKICAgIHB1YmxpYyBVc2VyIGdldFVzZXJCeUlkKExvbmcgaWQpIHsKICAgICAgICByZXR1cm4gbmV3IFVzZXIoaWQsICJKb2huIERvZSIpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Service
public class UserService {
    public User getUserById(Long id) {
        return new User(id, &quot;John Doe&quot;);
    }
}</pre></div><div class='content'></div><h2>Escribiendo la Prueba de Integración</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAU3ByaW5nQm9vdFRlc3QKcHVibGljIGNsYXNzIFVzZXJTZXJ2aWNlSW50ZWdyYXRpb25UZXN0IHsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJTZXJ2aWNlIHVzZXJTZXJ2aWNlOwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0VXNlckJ5SWQoKSB7CiAgICAgICAgVXNlciB1c2VyID0gdXNlclNlcnZpY2UuZ2V0VXNlckJ5SWQoMUwpOwogICAgICAgIGFzc2VydE5vdE51bGwodXNlcik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJKb2huIERvZSIsIHVzZXIuZ2V0TmFtZSgpKTsKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@SpringBootTest
public class UserServiceIntegrationTest {

    @Autowired
    private UserService userService;

    @Test
    public void testGetUserById() {
        User user = userService.getUserById(1L);
        assertNotNull(user);
        assertEquals(&quot;John Doe&quot;, user.getName());
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>@SpringBootTest</code>: Carga el contexto completo de la aplicación.</li>
<li><code>@Autowired</code>: Inyecta el bean <code>UserService</code>.</li>
<li><code>assertNotNull(user)</code>: Asegura que el objeto usuario no sea nulo.</li>
<li><code>assertEquals(&quot;John Doe&quot;, user.getName())</code>: Asegura que el nombre del usuario sea &quot;John Doe&quot;.</li>
</ul>
</li>
</ul>
</div><h1>Mocking de Dependencias</h1>
<div class='content'><p>Cuando se realizan pruebas unitarias, a menudo es necesario simular dependencias para aislar el componente bajo prueba.</p>
</div><h2>Ejemplo: Mocking de un Servicio</h2>
<div class='content'><p>Supongamos que <code>UserController</code> depende de <code>UserService</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJlc3RDb250cm9sbGVyCkBSZXF1ZXN0TWFwcGluZygiL3VzZXJzIikKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyIHsKICAgIEBBdXRvd2lyZWQKICAgIHByaXZhdGUgVXNlclNlcnZpY2UgdXNlclNlcnZpY2U7CgogICAgQEdldE1hcHBpbmcoIi97aWR9IikKICAgIHB1YmxpYyBSZXNwb25zZUVudGl0eTxVc2VyPiBnZXRVc2VyQnlJZChAUGF0aFZhcmlhYmxlIExvbmcgaWQpIHsKICAgICAgICBVc2VyIHVzZXIgPSB1c2VyU2VydmljZS5nZXRVc2VyQnlJZChpZCk7CiAgICAgICAgcmV0dXJuIFJlc3BvbnNlRW50aXR5Lm9rKHVzZXIpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RestController
@RequestMapping(&quot;/users&quot;)
public class UserController {
    @Autowired
    private UserService userService;

    @GetMapping(&quot;/{id}&quot;)
    public ResponseEntity&lt;User&gt; getUserById(@PathVariable Long id) {
        User user = userService.getUserById(id);
        return ResponseEntity.ok(user);
    }
}</pre></div><div class='content'></div><h2>Escribiendo la Prueba con Mocking</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAV2ViTXZjVGVzdChVc2VyQ29udHJvbGxlci5jbGFzcykKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyVGVzdCB7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBNb2NrTXZjIG1vY2tNdmM7CgogICAgQE1vY2tCZWFuCiAgICBwcml2YXRlIFVzZXJTZXJ2aWNlIHVzZXJTZXJ2aWNlOwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0VXNlckJ5SWQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBVc2VyIG1vY2tVc2VyID0gbmV3IFVzZXIoMUwsICJKb2huIERvZSIpOwogICAgICAgIHdoZW4odXNlclNlcnZpY2UuZ2V0VXNlckJ5SWQoMUwpKS50aGVuUmV0dXJuKG1vY2tVc2VyKTsKCiAgICAgICAgbW9ja012Yy5wZXJmb3JtKGdldCgiL3VzZXJzLzEiKSkKICAgICAgICAgICAgICAgIC5hbmRFeHBlY3Qoc3RhdHVzKCkuaXNPaygpKQogICAgICAgICAgICAgICAgLmFuZEV4cGVjdChqc29uUGF0aCgiJC5uYW1lIikudmFsdWUoIkpvaG4gRG9lIikpOwogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@WebMvcTest(UserController.class)
public class UserControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @MockBean
    private UserService userService;

    @Test
    public void testGetUserById() throws Exception {
        User mockUser = new User(1L, &quot;John Doe&quot;);
        when(userService.getUserById(1L)).thenReturn(mockUser);

        mockMvc.perform(get(&quot;/users/1&quot;))
                .andExpect(status().isOk())
                .andExpect(jsonPath(&quot;$.name&quot;).value(&quot;John Doe&quot;));
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicación</strong>:
<ul>
<li><code>@MockBean</code>: Crea un mock de <code>UserService</code> y lo inyecta en el contexto de la aplicación.</li>
<li><code>when(userService.getUserById(1L)).thenReturn(mockUser)</code>: Configura el mock para que devuelva <code>mockUser</code> cuando se llame a <code>getUserById</code>.</li>
</ul>
</li>
</ul>
</div><h1>Conclusión</h1>
<div class='content'><p>Probar servicios web RESTful en Spring Boot implica tanto pruebas unitarias como de integración. Las pruebas unitarias se centran en componentes individuales, a menudo utilizando mocking para aislar dependencias, mientras que las pruebas de integración verifican la interacción entre múltiples componentes. Al usar herramientas como <code>MockMvc</code>, <code>JUnit</code> y <code>Mockito</code>, puedes asegurarte de que tus servicios RESTful se comporten como se espera, lo que lleva a aplicaciones más robustas y confiables.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='integration-testing'>&#x25C4;Pruebas de Integración</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Pruebas de Servicios Web RESTful</a>
	</div>
	<div class='col-4 text-end'>
					<a href='test-containers'>Contenedores de Prueba &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
