<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Construyendo una CNN con TensorFlow</title>

    <link rel="alternate" href="https://campusempresa.com/tensorflow/building-a-cnn" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/tensorflow/building-a-cnn" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/tensorflow/building-a-cnn" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/tensorflow/building-a-cnn" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/tensorflow/building-a-cnn" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-cnns'>&#x25C4;Introducción a las CNNs</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Construyendo una CNN con TensorFlow</a>
	</div>
	<div class='col-4 text-end'>
					<a href='pooling-layers'>Capas de Pooling &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En esta sección, exploraremos cómo construir una Red Neuronal Convolucional (CNN) usando TensorFlow. Las CNNs son particularmente efectivas para tareas de reconocimiento y clasificación de imágenes. Comenzaremos desde lo básico y gradualmente avanzaremos hacia conceptos más avanzados.</p>
</div><h1>Conceptos Clave</h1>
<div class='content'><ul>
<li><strong>Capa Convolucional</strong>: Aplica operaciones de convolución a los datos de entrada.</li>
<li><strong>Capa de Pooling</strong>: Reduce la dimensionalidad de los mapas de características.</li>
<li><strong>Capa Completamente Conectada</strong>: Conecta cada neurona en una capa con cada neurona en otra capa.</li>
<li><strong>Función de Activación</strong>: Introduce no linealidad en el modelo.</li>
<li><strong>Función de Pérdida</strong>: Mide qué tan bien las predicciones del modelo coinciden con los datos reales.</li>
<li><strong>Optimizador</strong>: Ajusta los pesos de la red para minimizar la función de pérdida.</li>
</ul>
</div><h1>Configuración del Entorno</h1>
<div class='content'><p>Antes de comenzar a construir nuestra CNN, asegúrate de tener TensorFlow instalado. Puedes instalarlo usando pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow</pre></div><div class='content'></div><h1>Construyendo una CNN Simple</h1>
<div class='content'></div><h2>Importando Bibliotecas</h2>
<div class='content'><p>Primero, necesitamos importar las bibliotecas necesarias.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzIGltcG9ydCBsYXllcnMsIG1vZGVscw=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras import layers, models</pre></div><div class='content'></div><h2>Cargando y Preprocesando Datos</h2>
<div class='content'><p>Para este ejemplo, usaremos el conjunto de datos CIFAR-10, que contiene 60,000 imágenes en color de 32x32 en 10 clases.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJnYXIgZWwgY29uanVudG8gZGUgZGF0b3MgQ0lGQVItMTAKKHRyYWluX2ltYWdlcywgdHJhaW5fbGFiZWxzKSwgKHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscykgPSB0Zi5rZXJhcy5kYXRhc2V0cy5jaWZhcjEwLmxvYWRfZGF0YSgpCgojIE5vcm1hbGl6YXIgbG9zIHZhbG9yZXMgZGUgbG9zIHDDrXhlbGVzIHBhcmEgcXVlIGVzdMOpbiBlbnRyZSAwIHkgMQp0cmFpbl9pbWFnZXMsIHRlc3RfaW1hZ2VzID0gdHJhaW5faW1hZ2VzIC8gMjU1LjAsIHRlc3RfaW1hZ2VzIC8gMjU1LjA="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Cargar el conjunto de datos CIFAR-10
(train_images, train_labels), (test_images, test_labels) = tf.keras.datasets.cifar10.load_data()

# Normalizar los valores de los p&iacute;xeles para que est&eacute;n entre 0 y 1
train_images, test_images = train_images / 255.0, test_images / 255.0</pre></div><div class='content'></div><h2>Definiendo la Arquitectura de la CNN</h2>
<div class='content'><p>Crearemos una CNN simple con la siguiente arquitectura:</p>
<ul>
<li><strong>Capa Convolucional</strong>: 32 filtros, tamaño de kernel 3x3, activación ReLU</li>
<li><strong>Capa de Pooling</strong>: MaxPooling con tamaño de pool 2x2</li>
<li><strong>Capa Convolucional</strong>: 64 filtros, tamaño de kernel 3x3, activación ReLU</li>
<li><strong>Capa de Pooling</strong>: MaxPooling con tamaño de pool 2x2</li>
<li><strong>Capa Completamente Conectada</strong>: 64 unidades, activación ReLU</li>
<li><strong>Capa de Salida</strong>: 10 unidades (una para cada clase), activación softmax</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwgPSBtb2RlbHMuU2VxdWVudGlhbCgpCm1vZGVsLmFkZChsYXllcnMuQ29udjJEKDMyLCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnLCBpbnB1dF9zaGFwZT0oMzIsIDMyLCAzKSkpCm1vZGVsLmFkZChsYXllcnMuTWF4UG9vbGluZzJEKCgyLCAyKSkpCm1vZGVsLmFkZChsYXllcnMuQ29udjJEKDY0LCAoMywgMyksIGFjdGl2YXRpb249J3JlbHUnKSkKbW9kZWwuYWRkKGxheWVycy5NYXhQb29saW5nMkQoKDIsIDIpKSkKbW9kZWwuYWRkKGxheWVycy5GbGF0dGVuKCkpCm1vZGVsLmFkZChsYXllcnMuRGVuc2UoNjQsIGFjdGl2YXRpb249J3JlbHUnKSkKbW9kZWwuYWRkKGxheWVycy5EZW5zZSgxMCwgYWN0aXZhdGlvbj0nc29mdG1heCcpKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model = models.Sequential()
model.add(layers.Conv2D(32, (3, 3), activation='relu', input_shape=(32, 32, 3)))
model.add(layers.MaxPooling2D((2, 2)))
model.add(layers.Conv2D(64, (3, 3), activation='relu'))
model.add(layers.MaxPooling2D((2, 2)))
model.add(layers.Flatten())
model.add(layers.Dense(64, activation='relu'))
model.add(layers.Dense(10, activation='softmax'))</pre></div><div class='content'></div><h2>Compilando el Modelo</h2>
<div class='content'><p>A continuación, necesitamos compilar el modelo especificando el optimizador, la función de pérdida y las métricas.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLAogICAgICAgICAgICAgIGxvc3M9J3NwYXJzZV9jYXRlZ29yaWNhbF9jcm9zc2VudHJvcHknLAogICAgICAgICAgICAgIG1ldHJpY3M9WydhY2N1cmFjeSddKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])</pre></div><div class='content'></div><h2>Entrenando el Modelo</h2>
<div class='content'><p>Ahora podemos entrenar el modelo usando los datos de entrenamiento.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGlzdG9yeSA9IG1vZGVsLmZpdCh0cmFpbl9pbWFnZXMsIHRyYWluX2xhYmVscywgZXBvY2hzPTEwLCAKICAgICAgICAgICAgICAgICAgICB2YWxpZGF0aW9uX2RhdGE9KHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscykp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>history = model.fit(train_images, train_labels, epochs=10, 
                    validation_data=(test_images, test_labels))</pre></div><div class='content'></div><h2>Evaluando el Modelo</h2>
<div class='content'><p>Finalmente, evaluamos el rendimiento del modelo en los datos de prueba.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGVzdF9sb3NzLCB0ZXN0X2FjYyA9IG1vZGVsLmV2YWx1YXRlKHRlc3RfaW1hZ2VzLCB0ZXN0X2xhYmVscywgdmVyYm9zZT0yKQpwcmludChmJ1ByZWNpc2nDs24gZW4gZWwgdGVzdDoge3Rlc3RfYWNjfScp"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>test_loss, test_acc = model.evaluate(test_images, test_labels, verbose=2)
print(f'Precisi&oacute;n en el test: {test_acc}')</pre></div><div class='content'></div><h1>Conceptos Avanzados</h1>
<div class='content'></div><h2>Aumento de Datos</h2>
<div class='content'><p>Para mejorar el rendimiento del modelo, podemos usar aumento de datos para incrementar artificialmente el tamaño del conjunto de datos de entrenamiento.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLnByZXByb2Nlc3NpbmcuaW1hZ2UgaW1wb3J0IEltYWdlRGF0YUdlbmVyYXRvcgoKZGF0YWdlbiA9IEltYWdlRGF0YUdlbmVyYXRvcigKICAgIHJvdGF0aW9uX3JhbmdlPTIwLAogICAgd2lkdGhfc2hpZnRfcmFuZ2U9MC4yLAogICAgaGVpZ2h0X3NoaWZ0X3JhbmdlPTAuMiwKICAgIGhvcml6b250YWxfZmxpcD1UcnVlKQoKZGF0YWdlbi5maXQodHJhaW5faW1hZ2VzKQoKIyBVc2FyIGVsIGdlbmVyYWRvciBkZSBkYXRvcyBwYXJhIGVudHJlbmFyIGVsIG1vZGVsbwpoaXN0b3J5ID0gbW9kZWwuZml0KGRhdGFnZW4uZmxvdyh0cmFpbl9pbWFnZXMsIHRyYWluX2xhYmVscywgYmF0Y2hfc2l6ZT0zMiksCiAgICAgICAgICAgICAgICAgICAgZXBvY2hzPTEwLAogICAgICAgICAgICAgICAgICAgIHZhbGlkYXRpb25fZGF0YT0odGVzdF9pbWFnZXMsIHRlc3RfbGFiZWxzKSk="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.preprocessing.image import ImageDataGenerator

datagen = ImageDataGenerator(
    rotation_range=20,
    width_shift_range=0.2,
    height_shift_range=0.2,
    horizontal_flip=True)

datagen.fit(train_images)

# Usar el generador de datos para entrenar el modelo
history = model.fit(datagen.flow(train_images, train_labels, batch_size=32),
                    epochs=10,
                    validation_data=(test_images, test_labels))</pre></div><div class='content'></div><h2>Aprendizaje por Transferencia</h2>
<div class='content'><p>El aprendizaje por transferencia implica usar un modelo preentrenado y ajustarlo para una tarea específica. TensorFlow proporciona varios modelos preentrenados a través del módulo <code>tf.keras.applications</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmFwcGxpY2F0aW9ucyBpbXBvcnQgVkdHMTYKCiMgQ2FyZ2FyIGVsIG1vZGVsbyBWR0cxNiwgZXhjbHV5ZW5kbyBsYXMgY2FwYXMgc3VwZXJpb3JlcwpiYXNlX21vZGVsID0gVkdHMTYod2VpZ2h0cz0naW1hZ2VuZXQnLCBpbmNsdWRlX3RvcD1GYWxzZSwgaW5wdXRfc2hhcGU9KDMyLCAzMiwgMykpCgojIENvbmdlbGFyIGVsIG1vZGVsbyBiYXNlCmJhc2VfbW9kZWwudHJhaW5hYmxlID0gRmFsc2UKCiMgQWdyZWdhciBjYXBhcyBwZXJzb25hbGl6YWRhcyBlbiBsYSBwYXJ0ZSBzdXBlcmlvcgptb2RlbCA9IG1vZGVscy5TZXF1ZW50aWFsKFsKICAgIGJhc2VfbW9kZWwsCiAgICBsYXllcnMuRmxhdHRlbigpLAogICAgbGF5ZXJzLkRlbnNlKDY0LCBhY3RpdmF0aW9uPSdyZWx1JyksCiAgICBsYXllcnMuRGVuc2UoMTAsIGFjdGl2YXRpb249J3NvZnRtYXgnKQpdKQoKIyBDb21waWxhciB5IGVudHJlbmFyIGVsIG1vZGVsbyBjb21vIGFudGVzCm1vZGVsLmNvbXBpbGUob3B0aW1pemVyPSdhZGFtJywKICAgICAgICAgICAgICBsb3NzPSdzcGFyc2VfY2F0ZWdvcmljYWxfY3Jvc3NlbnRyb3B5JywKICAgICAgICAgICAgICBtZXRyaWNzPVsnYWNjdXJhY3knXSkKCmhpc3RvcnkgPSBtb2RlbC5maXQodHJhaW5faW1hZ2VzLCB0cmFpbl9sYWJlbHMsIGVwb2Nocz0xMCwgCiAgICAgICAgICAgICAgICAgICAgdmFsaWRhdGlvbl9kYXRhPSh0ZXN0X2ltYWdlcywgdGVzdF9sYWJlbHMpKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from tensorflow.keras.applications import VGG16

# Cargar el modelo VGG16, excluyendo las capas superiores
base_model = VGG16(weights='imagenet', include_top=False, input_shape=(32, 32, 3))

# Congelar el modelo base
base_model.trainable = False

# Agregar capas personalizadas en la parte superior
model = models.Sequential([
    base_model,
    layers.Flatten(),
    layers.Dense(64, activation='relu'),
    layers.Dense(10, activation='softmax')
])

# Compilar y entrenar el modelo como antes
model.compile(optimizer='adam',
              loss='sparse_categorical_crossentropy',
              metrics=['accuracy'])

history = model.fit(train_images, train_labels, epochs=10, 
                    validation_data=(test_images, test_labels))</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>En esta sección, cubrimos los conceptos básicos de la construcción de una Red Neuronal Convolucional usando TensorFlow. Comenzamos con una arquitectura simple de CNN, pasamos al aumento de datos y finalmente exploramos el aprendizaje por transferencia. Al comprender estos conceptos, puedes construir y optimizar tus propias CNNs para diversas tareas de reconocimiento de imágenes.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='introduction-to-cnns'>&#x25C4;Introducción a las CNNs</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Construyendo una CNN con TensorFlow</a>
	</div>
	<div class='col-4 text-end'>
					<a href='pooling-layers'>Capas de Pooling &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Aceptar</a>
    <a href="/cookies">Mas información</a>
</div>	

	</div>    
</body>
</html>
