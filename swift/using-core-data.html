<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uso de Core Data</title>

    <link rel="alternate" href="https://campusempresa.com/swift/using-core-data" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/swift/using-core-data" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/swift/using-core-data" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/swift/using-core-data" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/swift/using-core-data" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='concurrency-and-multithreading'>&#x25C4;Concurrencia y Multithreading</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Uso de Core Data</a>
	</div>
	<div class='col-4 text-end'>
					<a href='testing-and-debugging'>Pruebas y Depuración &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Core Data es un potente framework proporcionado por Apple para gestionar la capa de modelo de tu aplicación. Te permite trabajar con gráficos de objetos y persistir datos de manera eficiente. Este tema te guiará desde los conceptos básicos hasta el uso avanzado de Core Data en Swift.</p>
</div><h1>Introducción a Core Data</h1>
<div class='content'><p>Core Data es un framework de gráficos de objetos y persistencia proporcionado por Apple. Permite a los desarrolladores gestionar los objetos de la capa de modelo en sus aplicaciones. Core Data se puede utilizar para almacenar datos en una base de datos SQLite, archivos binarios o en memoria.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Modelo de Objeto Gestionado</strong>: Define la estructura de tus datos.</li>
<li><strong>Contexto de Objeto Gestionado</strong>: Actúa como un bloc de notas para los objetos gestionados.</li>
<li><strong>Coordinador de Almacenamiento Persistente</strong>: Coordina entre el contexto de objeto gestionado y el almacenamiento persistente.</li>
<li><strong>Objeto Gestionado</strong>: Instancias de las entidades de tu modelo de datos.</li>
</ul>
</div><h1>Configuración de Core Data en un Proyecto Swift</h1>
<div class='content'><p>Para usar Core Data en tu proyecto, necesitas configurarlo adecuadamente. Esto implica crear un modelo de datos y configurar la pila de Core Data.</p>
</div><h2>Creación de un Modelo de Datos</h2>
<div class='content'><ol>
<li>
<p><strong>Agregar un Archivo de Modelo de Datos</strong>:</p>
<ul>
<li>Ve a Archivo &gt; Nuevo &gt; Archivo.</li>
<li>Elige Modelo de Datos y nómbralo (por ejemplo, <code>Model.xcdatamodeld</code>).</li>
</ul>
</li>
<li>
<p><strong>Definir Entidades y Atributos</strong>:</p>
<ul>
<li>Abre el archivo <code>.xcdatamodeld</code>.</li>
<li>Agrega entidades (por ejemplo, <code>Person</code>) y atributos (por ejemplo, <code>name</code>, <code>age</code>).</li>
</ul>
</li>
</ol>
</div><h2>Configuración de la Pila de Core Data</h2>
<div class='content'><p>La pila de Core Data es el corazón de Core Data. Consiste en el modelo de objeto gestionado, el coordinador de almacenamiento persistente y el contexto de objeto gestionado.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IENvcmVEYXRhCgpjbGFzcyBDb3JlRGF0YVN0YWNrIHsKICAgIHN0YXRpYyBsZXQgc2hhcmVkID0gQ29yZURhdGFTdGFjaygpCgogICAgcHJpdmF0ZSBpbml0KCkge30KCiAgICBsYXp5IHZhciBwZXJzaXN0ZW50Q29udGFpbmVyOiBOU1BlcnNpc3RlbnRDb250YWluZXIgPSB7CiAgICAgICAgbGV0IGNvbnRhaW5lciA9IE5TUGVyc2lzdGVudENvbnRhaW5lcihuYW1lOiAiTW9kZWwiKQogICAgICAgIGNvbnRhaW5lci5sb2FkUGVyc2lzdGVudFN0b3JlcyB7IHN0b3JlRGVzY3JpcHRpb24sIGVycm9yIGluCiAgICAgICAgICAgIGlmIGxldCBlcnJvciA9IGVycm9yIGFzIE5TRXJyb3I/IHsKICAgICAgICAgICAgICAgIGZhdGFsRXJyb3IoIlVucmVzb2x2ZWQgZXJyb3IgXChlcnJvciksIFwoZXJyb3IudXNlckluZm8pIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gY29udGFpbmVyCiAgICB9KCkKCiAgICB2YXIgY29udGV4dDogTlNNYW5hZ2VkT2JqZWN0Q29udGV4dCB7CiAgICAgICAgcmV0dXJuIHBlcnNpc3RlbnRDb250YWluZXIudmlld0NvbnRleHQKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import CoreData

class CoreDataStack {
    static let shared = CoreDataStack()

    private init() {}

    lazy var persistentContainer: NSPersistentContainer = {
        let container = NSPersistentContainer(name: &quot;Model&quot;)
        container.loadPersistentStores { storeDescription, error in
            if let error = error as NSError? {
                fatalError(&quot;Unresolved error \(error), \(error.userInfo)&quot;)
            }
        }
        return container
    }()

    var context: NSManagedObjectContext {
        return persistentContainer.viewContext
    }
}</pre></div><div class='content'></div><h1>Operaciones Básicas con Core Data</h1>
<div class='content'><p>Una vez configurada la pila de Core Data, puedes realizar operaciones básicas como crear, leer, actualizar y eliminar (CRUD) datos.</p>
</div><h2>Creación de Datos</h2>
<div class='content'><p>Para crear un nuevo objeto gestionado, necesitas insertarlo en el contexto de objeto gestionado.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBjcmVhdGVQZXJzb24obmFtZTogU3RyaW5nLCBhZ2U6IEludDE2KSB7CiAgICBsZXQgY29udGV4dCA9IENvcmVEYXRhU3RhY2suc2hhcmVkLmNvbnRleHQKICAgIGxldCBwZXJzb24gPSBQZXJzb24oY29udGV4dDogY29udGV4dCkKICAgIHBlcnNvbi5uYW1lID0gbmFtZQogICAgcGVyc29uLmFnZSA9IGFnZQoKICAgIGRvIHsKICAgICAgICB0cnkgY29udGV4dC5zYXZlKCkKICAgIH0gY2F0Y2ggewogICAgICAgIHByaW50KCJGYWlsZWQgdG8gc2F2ZSBwZXJzb246IFwoZXJyb3IpIikKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func createPerson(name: String, age: Int16) {
    let context = CoreDataStack.shared.context
    let person = Person(context: context)
    person.name = name
    person.age = age

    do {
        try context.save()
    } catch {
        print(&quot;Failed to save person: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h2>Lectura de Datos</h2>
<div class='content'><p>Para obtener datos, utilizas <code>NSFetchRequest</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBmZXRjaFBlb3BsZSgpIC0+IFtQZXJzb25dPyB7CiAgICBsZXQgY29udGV4dCA9IENvcmVEYXRhU3RhY2suc2hhcmVkLmNvbnRleHQKICAgIGxldCBmZXRjaFJlcXVlc3Q6IE5TRmV0Y2hSZXF1ZXN0PFBlcnNvbj4gPSBQZXJzb24uZmV0Y2hSZXF1ZXN0KCkKCiAgICBkbyB7CiAgICAgICAgbGV0IHBlb3BsZSA9IHRyeSBjb250ZXh0LmZldGNoKGZldGNoUmVxdWVzdCkKICAgICAgICByZXR1cm4gcGVvcGxlCiAgICB9IGNhdGNoIHsKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIHBlb3BsZTogXChlcnJvcikiKQogICAgICAgIHJldHVybiBuaWwKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func fetchPeople() -&gt; [Person]? {
    let context = CoreDataStack.shared.context
    let fetchRequest: NSFetchRequest&lt;Person&gt; = Person.fetchRequest()

    do {
        let people = try context.fetch(fetchRequest)
        return people
    } catch {
        print(&quot;Failed to fetch people: \(error)&quot;)
        return nil
    }
}</pre></div><div class='content'></div><h2>Actualización de Datos</h2>
<div class='content'><p>Para actualizar un objeto gestionado, primero obténlo, luego modifica sus propiedades y guarda el contexto.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyB1cGRhdGVQZXJzb24ocGVyc29uOiBQZXJzb24sIG5ld05hbWU6IFN0cmluZykgewogICAgbGV0IGNvbnRleHQgPSBDb3JlRGF0YVN0YWNrLnNoYXJlZC5jb250ZXh0CiAgICBwZXJzb24ubmFtZSA9IG5ld05hbWUKCiAgICBkbyB7CiAgICAgICAgdHJ5IGNvbnRleHQuc2F2ZSgpCiAgICB9IGNhdGNoIHsKICAgICAgICBwcmludCgiRmFpbGVkIHRvIHVwZGF0ZSBwZXJzb246IFwoZXJyb3IpIikKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func updatePerson(person: Person, newName: String) {
    let context = CoreDataStack.shared.context
    person.name = newName

    do {
        try context.save()
    } catch {
        print(&quot;Failed to update person: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h2>Eliminación de Datos</h2>
<div class='content'><p>Para eliminar un objeto gestionado, primero obténlo, luego elimínalo del contexto y guarda.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBkZWxldGVQZXJzb24ocGVyc29uOiBQZXJzb24pIHsKICAgIGxldCBjb250ZXh0ID0gQ29yZURhdGFTdGFjay5zaGFyZWQuY29udGV4dAogICAgY29udGV4dC5kZWxldGUocGVyc29uKQoKICAgIGRvIHsKICAgICAgICB0cnkgY29udGV4dC5zYXZlKCkKICAgIH0gY2F0Y2ggewogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZGVsZXRlIHBlcnNvbjogXChlcnJvcikiKQogICAgfQp9"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func deletePerson(person: Person) {
    let context = CoreDataStack.shared.context
    context.delete(person)

    do {
        try context.save()
    } catch {
        print(&quot;Failed to delete person: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h1>Características Avanzadas de Core Data</h1>
<div class='content'><p>Core Data ofrece características avanzadas como relaciones, operaciones en lote y versionado.</p>
</div><h2>Relaciones</h2>
<div class='content'><p>Las entidades pueden tener relaciones con otras entidades. Por ejemplo, una entidad <code>Person</code> podría tener una relación con una entidad <code>Car</code>.</p>
<ul>
<li><strong>Uno a Uno</strong>: Una persona tiene un coche.</li>
<li><strong>Uno a Muchos</strong>: Una persona tiene muchos coches.</li>
<li><strong>Muchos a Muchos</strong>: Muchas personas pueden poseer muchos coches.</li>
</ul>
</div><h2>Operaciones en Lote</h2>
<div class='content'><p>Las operaciones en lote te permiten realizar acciones en múltiples registros de manera eficiente.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBiYXRjaFVwZGF0ZVBlcnNvbkFnZSgpIHsKICAgIGxldCBjb250ZXh0ID0gQ29yZURhdGFTdGFjay5zaGFyZWQuY29udGV4dAogICAgbGV0IGJhdGNoVXBkYXRlUmVxdWVzdCA9IE5TQmF0Y2hVcGRhdGVSZXF1ZXN0KGVudGl0eU5hbWU6ICJQZXJzb24iKQogICAgYmF0Y2hVcGRhdGVSZXF1ZXN0LnByb3BlcnRpZXNUb1VwZGF0ZSA9IFsiYWdlIjogMzBdCiAgICBiYXRjaFVwZGF0ZVJlcXVlc3QucmVzdWx0VHlwZSA9IC51cGRhdGVkT2JqZWN0SURzUmVzdWx0VHlwZQoKICAgIGRvIHsKICAgICAgICBsZXQgcmVzdWx0ID0gdHJ5IGNvbnRleHQuZXhlY3V0ZShiYXRjaFVwZGF0ZVJlcXVlc3QpIGFzPyBOU0JhdGNoVXBkYXRlUmVzdWx0CiAgICAgICAgaWYgbGV0IG9iamVjdElEcyA9IHJlc3VsdD8ucmVzdWx0IGFzPyBbTlNNYW5hZ2VkT2JqZWN0SURdIHsKICAgICAgICAgICAgZm9yIG9iamVjdElEIGluIG9iamVjdElEcyB7CiAgICAgICAgICAgICAgICBsZXQgbWFuYWdlZE9iamVjdCA9IGNvbnRleHQub2JqZWN0KHdpdGg6IG9iamVjdElEKQogICAgICAgICAgICAgICAgY29udGV4dC5yZWZyZXNoKG1hbmFnZWRPYmplY3QsIG1lcmdlQ2hhbmdlczogZmFsc2UpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGNhdGNoIHsKICAgICAgICBwcmludCgiRmFpbGVkIHRvIHBlcmZvcm0gYmF0Y2ggdXBkYXRlOiBcKGVycm9yKSIpCiAgICB9Cn0="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func batchUpdatePersonAge() {
    let context = CoreDataStack.shared.context
    let batchUpdateRequest = NSBatchUpdateRequest(entityName: &quot;Person&quot;)
    batchUpdateRequest.propertiesToUpdate = [&quot;age&quot;: 30]
    batchUpdateRequest.resultType = .updatedObjectIDsResultType

    do {
        let result = try context.execute(batchUpdateRequest) as? NSBatchUpdateResult
        if let objectIDs = result?.result as? [NSManagedObjectID] {
            for objectID in objectIDs {
                let managedObject = context.object(with: objectID)
                context.refresh(managedObject, mergeChanges: false)
            }
        }
    } catch {
        print(&quot;Failed to perform batch update: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h2>Versionado y Migración</h2>
<div class='content'><p>Cuando cambias tu modelo de datos, necesitas migrar los datos existentes al nuevo modelo. Core Data proporciona migración ligera para manejar cambios simples.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGV0IGNvbnRhaW5lciA9IE5TUGVyc2lzdGVudENvbnRhaW5lcihuYW1lOiAiTW9kZWwiKQpsZXQgZGVzY3JpcHRpb24gPSBjb250YWluZXIucGVyc2lzdGVudFN0b3JlRGVzY3JpcHRpb25zLmZpcnN0CmRlc2NyaXB0aW9uPy5zaG91bGRNaWdyYXRlU3RvcmVBdXRvbWF0aWNhbGx5ID0gdHJ1ZQpkZXNjcmlwdGlvbj8uc2hvdWxkSW5mZXJNYXBwaW5nTW9kZWxBdXRvbWF0aWNhbGx5ID0gdHJ1ZQpjb250YWluZXIubG9hZFBlcnNpc3RlbnRTdG9yZXMgeyBzdG9yZURlc2NyaXB0aW9uLCBlcnJvciBpbgogICAgaWYgbGV0IGVycm9yID0gZXJyb3IgYXMgTlNFcnJvcj8gewogICAgICAgIGZhdGFsRXJyb3IoIlVucmVzb2x2ZWQgZXJyb3IgXChlcnJvciksIFwoZXJyb3IudXNlckluZm8pIikKICAgIH0KfQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>let container = NSPersistentContainer(name: &quot;Model&quot;)
let description = container.persistentStoreDescriptions.first
description?.shouldMigrateStoreAutomatically = true
description?.shouldInferMappingModelAutomatically = true
container.loadPersistentStores { storeDescription, error in
    if let error = error as NSError? {
        fatalError(&quot;Unresolved error \(error), \(error.userInfo)&quot;)
    }
}</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Core Data es un robusto framework para gestionar y persistir datos en aplicaciones iOS. Al entender sus conceptos clave y aprender a realizar operaciones básicas y avanzadas, puedes gestionar eficientemente la capa de datos de tu aplicación. Recuerda siempre manejar los errores de manera adecuada y considerar las implicaciones de rendimiento de tus operaciones de datos. Con práctica, podrás aprovechar Core Data para construir aplicaciones potentes y eficientes.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='concurrency-and-multithreading'>&#x25C4;Concurrencia y Multithreading</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Uso de Core Data</a>
	</div>
	<div class='col-4 text-end'>
					<a href='testing-and-debugging'>Pruebas y Depuración &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
