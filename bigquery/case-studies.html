<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudios de Caso</title>

    <link rel="alternate" href="https://campusempresa.com/bigquery/case-studies" hreflang="es" />
	<link rel="alternate" href="https://campusempresa.cat/bigquery/case-studies" hreflang="ca" />
	<link rel="alternate" href="https://enterprisecampus.net/bigquery/case-studies" hreflang="en" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construyendo la sociedad de hoy y del mañana</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
										<a href="https://enterprisecampus.net/bigquery/case-studies" class="px-2">EN</a></b>
				|
				<b class="px-2">ES</b>
				|
				<a href="https://campusempresa.cat/bigquery/case-studies" class="px-2">CA</a>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/objective">El Proyecto</a>
				<a href="/about">Sobre nosotros</a>
				<a href="/contribute">Contribuir</a>
				<a href="/donate">Donaciones</a>
				<a href="/licence">Licencia</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='real-time-analytics'>&#x25C4;Analítica en tiempo real</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Estudios de Caso</a>
	</div>
	<div class='col-4 text-end'>
					<a href='capstone-project'>Proyecto final &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducción</h1>
<div class='content'><p>En esta sección, exploraremos estudios de caso del mundo real para entender cómo se puede aplicar BigQuery para resolver varios desafíos de datos. Al examinar estos estudios de caso, obtendrás información sobre aplicaciones prácticas, mejores prácticas y técnicas avanzadas.</p>
</div><h1>Estudio de Caso 1: Análisis de Datos de Comercio Electrónico</h1>
<div class='content'></div><h2>Descripción General</h2>
<div class='content'><p>Una empresa de comercio electrónico quiere analizar sus datos de ventas para entender el comportamiento del cliente, optimizar el inventario y mejorar las estrategias de marketing.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Ingesta de Datos</strong>: Cargar datos de ventas en BigQuery.</li>
<li><strong>Transformación de Datos</strong>: Limpiar y transformar datos para el análisis.</li>
<li><strong>Optimización de Consultas</strong>: Escribir consultas eficientes para manejar grandes conjuntos de datos.</li>
<li><strong>Visualización</strong>: Usar herramientas como Google Data Studio para visualizar los resultados.</li>
</ul>
</div><h2>Pasos y Ejemplos de Código</h2>
<div class='content'><h4>Ingesta de Datos</h4>
<p>Primero, carga los datos de ventas en BigQuery. Supongamos que los datos están en un archivo CSV almacenado en Google Cloud Storage.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FyZ2FyIGRhdG9zIGRlc2RlIEdvb2dsZSBDbG91ZCBTdG9yYWdlIGVuIEJpZ1F1ZXJ5CkxPQUQgREFUQSBJTlRPIGBwcm9qZWN0LmRhdGFzZXQuc2FsZXNgCkZST00gJ2dzOi8vYnVja2V0X25hbWUvc2FsZXNfZGF0YS5jc3YnCldJVEgKICBGT1JNQVQgPSBDU1YsCiAgRklFTERfREVMSU1JVEVSID0gJywnLAogIFNLSVBfTEVBRElOR19ST1dTID0gMTs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Cargar datos desde Google Cloud Storage en BigQuery
LOAD DATA INTO `project.dataset.sales`
FROM 'gs://bucket_name/sales_data.csv'
WITH
  FORMAT = CSV,
  FIELD_DELIMITER = ',',
  SKIP_LEADING_ROWS = 1;</pre></div><div class='content'><h4>Transformación de Datos</h4>
<p>Limpia y transforma los datos para hacerlos adecuados para el análisis.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXIgdW5hIG51ZXZhIHRhYmxhIGNvbiBkYXRvcyBsaW1waW9zCkNSRUFURSBUQUJMRSBgcHJvamVjdC5kYXRhc2V0LmNsZWFuZWRfc2FsZXNgIEFTClNFTEVDVAogIG9yZGVyX2lkLAogIGN1c3RvbWVyX2lkLAogIHByb2R1Y3RfaWQsCiAgQ0FTVChvcmRlcl9kYXRlIEFTIERBVEUpIEFTIG9yZGVyX2RhdGUsCiAgQ0FTVChxdWFudGl0eSBBUyBJTlQ2NCkgQVMgcXVhbnRpdHksCiAgQ0FTVChwcmljZSBBUyBGTE9BVDY0KSBBUyBwcmljZSwKICBxdWFudGl0eSAqIHByaWNlIEFTIHRvdGFsX2Ftb3VudApGUk9NCiAgYHByb2plY3QuZGF0YXNldC5zYWxlc2AKV0hFUkUKICBvcmRlcl9kYXRlIElTIE5PVCBOVUxMCiAgQU5EIHF1YW50aXR5ID4gMAogIEFORCBwcmljZSA+IDA7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Crear una nueva tabla con datos limpios
CREATE TABLE `project.dataset.cleaned_sales` AS
SELECT
  order_id,
  customer_id,
  product_id,
  CAST(order_date AS DATE) AS order_date,
  CAST(quantity AS INT64) AS quantity,
  CAST(price AS FLOAT64) AS price,
  quantity * price AS total_amount
FROM
  `project.dataset.sales`
WHERE
  order_date IS NOT NULL
  AND quantity &gt; 0
  AND price &gt; 0;</pre></div><div class='content'><h4>Optimización de Consultas</h4>
<p>Escribe consultas optimizadas para analizar los datos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FsY3VsYXIgdmVudGFzIHRvdGFsZXMgcG9yIHByb2R1Y3RvClNFTEVDVAogIHByb2R1Y3RfaWQsCiAgU1VNKHRvdGFsX2Ftb3VudCkgQVMgdG90YWxfc2FsZXMKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuY2xlYW5lZF9zYWxlc2AKR1JPVVAgQlkKICBwcm9kdWN0X2lkCk9SREVSIEJZCiAgdG90YWxfc2FsZXMgREVTQzs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Calcular ventas totales por producto
SELECT
  product_id,
  SUM(total_amount) AS total_sales
FROM
  `project.dataset.cleaned_sales`
GROUP BY
  product_id
ORDER BY
  total_sales DESC;</pre></div><div class='content'><h4>Visualización</h4>
<p>Usa Google Data Studio para crear visualizaciones basadas en los resultados de la consulta.</p>
</div><h1>Estudio de Caso 2: Análisis en Tiempo Real para Dispositivos IoT</h1>
<div class='content'></div><h2>Descripción General</h2>
<div class='content'><p>Una empresa quiere realizar análisis en tiempo real sobre los datos generados por dispositivos IoT para monitorear el rendimiento y detectar anomalías.</p>
</div><h2>Conceptos Clave</h2>
<div class='content'><ul>
<li><strong>Datos en Streaming</strong>: Ingesta de datos en tiempo real en BigQuery.</li>
<li><strong>Funciones de Ventana</strong>: Uso de funciones de ventana para analizar datos de series temporales.</li>
<li><strong>Detección de Anomalías</strong>: Identificación de anomalías en los datos.</li>
</ul>
</div><h2>Pasos y Ejemplos de Código</h2>
<div class='content'><h4>Datos en Streaming</h4>
<p>Ingesta de datos en tiempo real desde dispositivos IoT usando la API de streaming de BigQuery.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGJpZ3F1ZXJ5CgpjbGllbnQgPSBiaWdxdWVyeS5DbGllbnQoKQp0YWJsZV9pZCA9ICJwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGEiCgpyb3dzX3RvX2luc2VydCA9IFsKICAgIHsiZGV2aWNlX2lkIjogImRldmljZV8xIiwgInRpbWVzdGFtcCI6ICIyMDIzLTEwLTAxVDEyOjAwOjAwWiIsICJ0ZW1wZXJhdHVyZSI6IDIyLjV9LAogICAgeyJkZXZpY2VfaWQiOiAiZGV2aWNlXzIiLCAidGltZXN0YW1wIjogIjIwMjMtMTAtMDFUMTI6MDE6MDBaIiwgInRlbXBlcmF0dXJlIjogMjMuMH0sCl0KCmVycm9ycyA9IGNsaWVudC5pbnNlcnRfcm93c19qc29uKHRhYmxlX2lkLCByb3dzX3RvX2luc2VydCkKaWYgZXJyb3JzID09IFtdOgogICAgcHJpbnQoIk5ldyByb3dzIGhhdmUgYmVlbiBhZGRlZC4iKQplbHNlOgogICAgcHJpbnQoIkVuY291bnRlcmVkIGVycm9ycyB3aGlsZSBpbnNlcnRpbmcgcm93czoge30iLmZvcm1hdChlcnJvcnMpKQ=="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import bigquery

client = bigquery.Client()
table_id = &quot;project.dataset.iot_data&quot;

rows_to_insert = [
    {&quot;device_id&quot;: &quot;device_1&quot;, &quot;timestamp&quot;: &quot;2023-10-01T12:00:00Z&quot;, &quot;temperature&quot;: 22.5},
    {&quot;device_id&quot;: &quot;device_2&quot;, &quot;timestamp&quot;: &quot;2023-10-01T12:01:00Z&quot;, &quot;temperature&quot;: 23.0},
]

errors = client.insert_rows_json(table_id, rows_to_insert)
if errors == []:
    print(&quot;New rows have been added.&quot;)
else:
    print(&quot;Encountered errors while inserting rows: {}&quot;.format(errors))</pre></div><div class='content'><h4>Funciones de Ventana</h4>
<p>Usa funciones de ventana para analizar los datos de series temporales.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FsY3VsYXIgbGEgdGVtcGVyYXR1cmEgcHJvbWVkaW8gbcOzdmlsIHBhcmEgY2FkYSBkaXNwb3NpdGl2bwpTRUxFQ1QKICBkZXZpY2VfaWQsCiAgdGltZXN0YW1wLAogIHRlbXBlcmF0dXJlLAogIEFWRyh0ZW1wZXJhdHVyZSkgT1ZFUiAoUEFSVElUSU9OIEJZIGRldmljZV9pZCBPUkRFUiBCWSB0aW1lc3RhbXAgUk9XUyBCRVRXRUVOIDIgUFJFQ0VESU5HIEFORCBDVVJSRU5UIFJPVykgQVMgbW92aW5nX2F2Z190ZW1wCkZST00KICBgcHJvamVjdC5kYXRhc2V0LmlvdF9kYXRhYDs="))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Calcular la temperatura promedio m&oacute;vil para cada dispositivo
SELECT
  device_id,
  timestamp,
  temperature,
  AVG(temperature) OVER (PARTITION BY device_id ORDER BY timestamp ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg_temp
FROM
  `project.dataset.iot_data`;</pre></div><div class='content'><h4>Detección de Anomalías</h4>
<p>Identifica anomalías en los datos de temperatura.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRGV0ZWN0YXIgYW5vbWFsw61hcyBkZSB0ZW1wZXJhdHVyYQpXSVRIIHRlbXBfc3RhdHMgQVMgKAogIFNFTEVDVAogICAgZGV2aWNlX2lkLAogICAgQVZHKHRlbXBlcmF0dXJlKSBBUyBhdmdfdGVtcCwKICAgIFNURERFVih0ZW1wZXJhdHVyZSkgQVMgc3RkZGV2X3RlbXAKICBGUk9NCiAgICBgcHJvamVjdC5kYXRhc2V0LmlvdF9kYXRhYAogIEdST1VQIEJZCiAgICBkZXZpY2VfaWQKKQpTRUxFQ1QKICBpb3QuZGV2aWNlX2lkLAogIGlvdC50aW1lc3RhbXAsCiAgaW90LnRlbXBlcmF0dXJlLAogIENBU0UKICAgIFdIRU4gQUJTKGlvdC50ZW1wZXJhdHVyZSAtIHRzLmF2Z190ZW1wKSA+IDMgKiB0cy5zdGRkZXZfdGVtcCBUSEVOICdBbm9tYWx5JwogICAgRUxTRSAnTm9ybWFsJwogIEVORCBBUyBzdGF0dXMKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGFgIEFTIGlvdApKT0lOCiAgdGVtcF9zdGF0cyBBUyB0cwpPTgogIGlvdC5kZXZpY2VfaWQgPSB0cy5kZXZpY2VfaWQ7"))));alert("¡Copiado!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Detectar anomal&iacute;as de temperatura
WITH temp_stats AS (
  SELECT
    device_id,
    AVG(temperature) AS avg_temp,
    STDDEV(temperature) AS stddev_temp
  FROM
    `project.dataset.iot_data`
  GROUP BY
    device_id
)
SELECT
  iot.device_id,
  iot.timestamp,
  iot.temperature,
  CASE
    WHEN ABS(iot.temperature - ts.avg_temp) &gt; 3 * ts.stddev_temp THEN 'Anomaly'
    ELSE 'Normal'
  END AS status
FROM
  `project.dataset.iot_data` AS iot
JOIN
  temp_stats AS ts
ON
  iot.device_id = ts.device_id;</pre></div><div class='content'></div><h1>Conclusión</h1>
<div class='content'><p>Al examinar estos estudios de caso, has aprendido cómo aplicar BigQuery a escenarios del mundo real. Has visto cómo ingerir, transformar y analizar datos, así como cómo optimizar consultas y visualizar resultados. Estos ejemplos deberían proporcionar una base sólida para abordar tus propios desafíos de datos usando BigQuery.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='real-time-analytics'>&#x25C4;Analítica en tiempo real</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Estudios de Caso</a>
	</div>
	<div class='col-4 text-end'>
					<a href='capstone-project'>Proyecto final &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicidad</h1>
			<p>Este espacio está destinado a publicidad.</p>
			<p>Si quieres ser patrocinador, contáctanos para incluir enlaces en esta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>¡Gracias por colaborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Todos los derechos reservados</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
