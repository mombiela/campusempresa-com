<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulació en Proves</title>

    <link rel="alternate" href="https://campusempresa.com/es/typescript/mocking-tests" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/typescript/mocking-tests" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/typescript/mocking-tests" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/typescript/mocking-tests" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='integration-testing'>&#x25C4;Proves d'integració</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Simulació en Proves</a>
	</div>
	<div class='col-4 text-end'>
					<a href='end-to-end-testing'>Proves de punta a punta &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La simulació és un concepte crucial en les proves, especialment quan es tracta de dependències externes o sistemes complexos. En aquesta secció, explorarem com utilitzar la simulació en proves de TypeScript, des de nivells bàsics fins a avançats.</p>
</div><h1>Introducció a la Simulació</h1>
<div class='content'><p>La simulació et permet simular el comportament d'objectes complexos o sistemes externs en les teves proves. Això és particularment útil per a:</p>
<ul>
<li>Aïllar la unitat de codi que s'està provant.</li>
<li>Simular diferents escenaris i casos límit.</li>
<li>Millorar el rendiment de les proves evitant sistemes externs lents o poc fiables.</li>
</ul>
</div><h1>Simulació Bàsica amb Jest</h1>
<div class='content'><p>Jest és un marc de proves popular que proporciona suport integrat per a la simulació. Comencem amb un exemple senzill.</p>
</div><h2>Exemple: Simulació d'una Funció</h2>
<div class='content'><p>Suposem que tenim una funció que obté dades d'usuari d'una API:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlclNlcnZpY2UudHMKZXhwb3J0IGNvbnN0IGZldGNoVXNlckRhdGEgPSBhc3luYyAodXNlcklkOiBzdHJpbmcpOiBQcm9taXNlPFVzZXI+ID0+IHsKICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGBodHRwczovL2FwaS5leGFtcGxlLmNvbS91c2Vycy8ke3VzZXJJZH1gKTsKICByZXR1cm4gcmVzcG9uc2UuanNvbigpOwp9Ow=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userService.ts
export const fetchUserData = async (userId: string): Promise&lt;User&gt; =&gt; {
  const response = await fetch(`https://api.example.com/users/${userId}`);
  return response.json();
};</pre></div><div class='content'><p>Volem provar una funció que utilitza <code>fetchUserData</code> sense fer crides reals a l'API:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlckNvbnRyb2xsZXIudHMKaW1wb3J0IHsgZmV0Y2hVc2VyRGF0YSB9IGZyb20gJy4vdXNlclNlcnZpY2UnOwoKZXhwb3J0IGNvbnN0IGdldFVzZXJQcm9maWxlID0gYXN5bmMgKHVzZXJJZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyUHJvZmlsZT4gPT4gewogIGNvbnN0IHVzZXIgPSBhd2FpdCBmZXRjaFVzZXJEYXRhKHVzZXJJZCk7CiAgcmV0dXJuIHsKICAgIGlkOiB1c2VyLmlkLAogICAgbmFtZTogdXNlci5uYW1lLAogICAgZW1haWw6IHVzZXIuZW1haWwsCiAgfTsKfTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userController.ts
import { fetchUserData } from './userService';

export const getUserProfile = async (userId: string): Promise&lt;UserProfile&gt; =&gt; {
  const user = await fetchUserData(userId);
  return {
    id: user.id,
    name: user.name,
    email: user.email,
  };
};</pre></div><div class='content'><p>Aquí tens com pots simular <code>fetchUserData</code> en la teva prova:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlckNvbnRyb2xsZXIudGVzdC50cwppbXBvcnQgeyBnZXRVc2VyUHJvZmlsZSB9IGZyb20gJy4vdXNlckNvbnRyb2xsZXInOwppbXBvcnQgeyBmZXRjaFVzZXJEYXRhIH0gZnJvbSAnLi91c2VyU2VydmljZSc7CgpqZXN0Lm1vY2soJy4vdXNlclNlcnZpY2UnKTsKCnRlc3QoJ2hhdXJpYSBkZSByZXRvcm5hciBlbCBwZXJmaWwgZGUgbFwndXN1YXJpJywgYXN5bmMgKCkgPT4gewogIGNvbnN0IG1vY2tVc2VyID0geyBpZDogJzEnLCBuYW1lOiAnSm9obiBEb2UnLCBlbWFpbDogJ2pvaG5AZXhhbXBsZS5jb20nIH07CiAgKGZldGNoVXNlckRhdGEgYXMgamVzdC5Nb2NrKS5tb2NrUmVzb2x2ZWRWYWx1ZShtb2NrVXNlcik7CgogIGNvbnN0IHVzZXJQcm9maWxlID0gYXdhaXQgZ2V0VXNlclByb2ZpbGUoJzEnKTsKCiAgZXhwZWN0KHVzZXJQcm9maWxlKS50b0VxdWFsKG1vY2tVc2VyKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userController.test.ts
import { getUserProfile } from './userController';
import { fetchUserData } from './userService';

jest.mock('./userService');

test('hauria de retornar el perfil de l\'usuari', async () =&gt; {
  const mockUser = { id: '1', name: 'John Doe', email: 'john@example.com' };
  (fetchUserData as jest.Mock).mockResolvedValue(mockUser);

  const userProfile = await getUserProfile('1');

  expect(userProfile).toEqual(mockUser);
});</pre></div><div class='content'></div><h1>Tècniques de Simulació Intermèdies</h1>
<div class='content'></div><h2>Simulació de Mòduls</h2>
<div class='content'><p>De vegades, necessites simular mòduls sencers. Jest fa això fàcil amb la funció <code>jest.mock</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbWF0aC50cwpleHBvcnQgY29uc3QgYWRkID0gKGE6IG51bWJlciwgYjogbnVtYmVyKTogbnVtYmVyID0+IGEgKyBiOwpleHBvcnQgY29uc3Qgc3VidHJhY3QgPSAoYTogbnVtYmVyLCBiOiBudW1iZXIpOiBudW1iZXIgPT4gYSAtIGI7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// math.ts
export const add = (a: number, b: number): number =&gt; a + b;
export const subtract = (a: number, b: number): number =&gt; a - b;</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbWF0aC50ZXN0LnRzCmltcG9ydCAqIGFzIG1hdGggZnJvbSAnLi9tYXRoJzsKCmplc3QubW9jaygnLi9tYXRoJyk7Cgp0ZXN0KCdoYXVyaWEgZGUgc2ltdWxhciBsYSBmdW5jacOzIGFkZCcsICgpID0+IHsKICAobWF0aC5hZGQgYXMgamVzdC5Nb2NrKS5tb2NrUmV0dXJuVmFsdWUoMTApOwoKICBleHBlY3QobWF0aC5hZGQoMSwgMikpLnRvQmUoMTApOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// math.test.ts
import * as math from './math';

jest.mock('./math');

test('hauria de simular la funci&oacute; add', () =&gt; {
  (math.add as jest.Mock).mockReturnValue(10);

  expect(math.add(1, 2)).toBe(10);
});</pre></div><div class='content'></div><h2>Simulació de Classes</h2>
<div class='content'><p>També pots simular classes i els seus mètodes:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZGF0YWJhc2UudHMKZXhwb3J0IGNsYXNzIERhdGFiYXNlIHsKICBjb25uZWN0KCkgewogICAgLy8gQ29ubmVjdGFyIGEgbGEgYmFzZSBkZSBkYWRlcwogIH0KCiAgcXVlcnkoc3FsOiBzdHJpbmcpIHsKICAgIC8vIEV4ZWN1dGFyIHVuYSBjb25zdWx0YQogIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// database.ts
export class Database {
  connect() {
    // Connectar a la base de dades
  }

  query(sql: string) {
    // Executar una consulta
  }
}</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZGF0YWJhc2UudGVzdC50cwppbXBvcnQgeyBEYXRhYmFzZSB9IGZyb20gJy4vZGF0YWJhc2UnOwoKamVzdC5tb2NrKCcuL2RhdGFiYXNlJyk7Cgp0ZXN0KCdoYXVyaWEgZGUgc2ltdWxhciBsYSBjbGFzc2UgRGF0YWJhc2UnLCAoKSA9PiB7CiAgY29uc3QgbW9ja0Nvbm5lY3QgPSBqZXN0LmZuKCk7CiAgRGF0YWJhc2UucHJvdG90eXBlLmNvbm5lY3QgPSBtb2NrQ29ubmVjdDsKCiAgY29uc3QgZGIgPSBuZXcgRGF0YWJhc2UoKTsKICBkYi5jb25uZWN0KCk7CgogIGV4cGVjdChtb2NrQ29ubmVjdCkudG9IYXZlQmVlbkNhbGxlZCgpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// database.test.ts
import { Database } from './database';

jest.mock('./database');

test('hauria de simular la classe Database', () =&gt; {
  const mockConnect = jest.fn();
  Database.prototype.connect = mockConnect;

  const db = new Database();
  db.connect();

  expect(mockConnect).toHaveBeenCalled();
});</pre></div><div class='content'></div><h1>Tècniques de Simulació Avançades</h1>
<div class='content'></div><h2>Simulació de Funcions Asíncrones</h2>
<div class='content'><p>Quan es tracta de funcions asíncrones, pots utilitzar <code>mockResolvedValue</code> i <code>mockRejectedValue</code> per simular promeses resoltes i rebutjades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gYXBpLnRzCmV4cG9ydCBjb25zdCBmZXRjaERhdGEgPSBhc3luYyAoKTogUHJvbWlzZTxzdHJpbmc+ID0+IHsKICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5leGFtcGxlLmNvbS9kYXRhJyk7CiAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTsKfTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// api.ts
export const fetchData = async (): Promise&lt;string&gt; =&gt; {
  const response = await fetch('https://api.example.com/data');
  return response.json();
};</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gYXBpLnRlc3QudHMKaW1wb3J0IHsgZmV0Y2hEYXRhIH0gZnJvbSAnLi9hcGknOwoKamVzdC5tb2NrKCcuL2FwaScpOwoKdGVzdCgnaGF1cmlhIGRlIHNpbXVsYXIgZmV0Y2hEYXRhIGFtYiB2YWxvciByZXNvbHQnLCBhc3luYyAoKSA9PiB7CiAgKGZldGNoRGF0YSBhcyBqZXN0Lk1vY2spLm1vY2tSZXNvbHZlZFZhbHVlKCdtb2NrIGRhdGEnKTsKCiAgY29uc3QgZGF0YSA9IGF3YWl0IGZldGNoRGF0YSgpOwoKICBleHBlY3QoZGF0YSkudG9CZSgnbW9jayBkYXRhJyk7Cn0pOwoKdGVzdCgnaGF1cmlhIGRlIHNpbXVsYXIgZmV0Y2hEYXRhIGFtYiB2YWxvciByZWJ1dGphdCcsIGFzeW5jICgpID0+IHsKICAoZmV0Y2hEYXRhIGFzIGplc3QuTW9jaykubW9ja1JlamVjdGVkVmFsdWUobmV3IEVycm9yKCdFcnJvciBkZSB4YXJ4YScpKTsKCiAgYXdhaXQgZXhwZWN0KGZldGNoRGF0YSgpKS5yZWplY3RzLnRvVGhyb3coJ0Vycm9yIGRlIHhhcnhhJyk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// api.test.ts
import { fetchData } from './api';

jest.mock('./api');

test('hauria de simular fetchData amb valor resolt', async () =&gt; {
  (fetchData as jest.Mock).mockResolvedValue('mock data');

  const data = await fetchData();

  expect(data).toBe('mock data');
});

test('hauria de simular fetchData amb valor rebutjat', async () =&gt; {
  (fetchData as jest.Mock).mockRejectedValue(new Error('Error de xarxa'));

  await expect(fetchData()).rejects.toThrow('Error de xarxa');
});</pre></div><div class='content'></div><h2>Simulació amb Interfícies de TypeScript</h2>
<div class='content'><p>Quan treballes amb interfícies de TypeScript, pots utilitzar biblioteques com <code>ts-mockito</code> per crear simulacions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlclNlcnZpY2UudHMKZXhwb3J0IGludGVyZmFjZSBVc2VyU2VydmljZSB7CiAgZ2V0VXNlcihpZDogc3RyaW5nKTogUHJvbWlzZTxVc2VyPjsKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userService.ts
export interface UserService {
  getUser(id: string): Promise&lt;User&gt;;
}</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gdXNlclNlcnZpY2UudGVzdC50cwppbXBvcnQgeyBtb2NrLCBpbnN0YW5jZSwgd2hlbiwgdmVyaWZ5IH0gZnJvbSAndHMtbW9ja2l0byc7CmltcG9ydCB7IFVzZXJTZXJ2aWNlIH0gZnJvbSAnLi91c2VyU2VydmljZSc7Cgp0ZXN0KCdoYXVyaWEgZGUgc2ltdWxhciBsYSBpbnRlcmbDrWNpZSBVc2VyU2VydmljZScsIGFzeW5jICgpID0+IHsKICBjb25zdCB1c2VyU2VydmljZU1vY2sgPSBtb2NrPFVzZXJTZXJ2aWNlPigpOwogIHdoZW4odXNlclNlcnZpY2VNb2NrLmdldFVzZXIoJzEnKSkudGhlblJlc29sdmUoeyBpZDogJzEnLCBuYW1lOiAnSm9obiBEb2UnIH0pOwoKICBjb25zdCB1c2VyU2VydmljZSA9IGluc3RhbmNlKHVzZXJTZXJ2aWNlTW9jayk7CiAgY29uc3QgdXNlciA9IGF3YWl0IHVzZXJTZXJ2aWNlLmdldFVzZXIoJzEnKTsKCiAgZXhwZWN0KHVzZXIubmFtZSkudG9CZSgnSm9obiBEb2UnKTsKICB2ZXJpZnkodXNlclNlcnZpY2VNb2NrLmdldFVzZXIoJzEnKSkuY2FsbGVkKCk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// userService.test.ts
import { mock, instance, when, verify } from 'ts-mockito';
import { UserService } from './userService';

test('hauria de simular la interf&iacute;cie UserService', async () =&gt; {
  const userServiceMock = mock&lt;UserService&gt;();
  when(userServiceMock.getUser('1')).thenResolve({ id: '1', name: 'John Doe' });

  const userService = instance(userServiceMock);
  const user = await userService.getUser('1');

  expect(user.name).toBe('John Doe');
  verify(userServiceMock.getUser('1')).called();
});</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>La simulació és una eina poderosa en el teu arsenal de proves. Et permet aïllar el codi que es prova, simular diversos escenaris i millorar el rendiment de les proves. Dominant tècniques bàsiques, intermèdies i avançades de simulació, pots escriure proves més robustes i fiables per a les teves aplicacions de TypeScript.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='integration-testing'>&#x25C4;Proves d'integració</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Simulació en Proves</a>
	</div>
	<div class='col-4 text-end'>
					<a href='end-to-end-testing'>Proves de punta a punta &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
