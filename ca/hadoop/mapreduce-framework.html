<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marc de treball MapReduce</title>

    <link rel="alternate" href="https://campusempresa.com/es/hadoop/mapreduce-framework" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/hadoop/mapreduce-framework" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/hadoop/mapreduce-framework" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/hadoop/mapreduce-framework" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='hdfs'>&#x25C4;HDFS (Sistema de Fitxers Distribuït de Hadoop)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Marc de treball MapReduce</a>
	</div>
	<div class='col-4 text-end'>
					<a href='yarn'>YARN (Yet Another Resource Negotiator) &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a MapReduce</h1>
<div class='content'><p>MapReduce és un model de programació i una implementació associada per processar i generar grans conjunts de dades amb un algorisme paral·lel i distribuït en un clúster. Va ser desenvolupat originalment per Google i ara s'utilitza àmpliament en diversos marcs de processament de grans dades, incloent Hadoop.</p>
</div><h2>Conceptes clau</h2>
<div class='content'><ul>
<li><strong>Funció Map</strong>: Processa parells clau/valor d'entrada per generar un conjunt de parells clau/valor intermedis.</li>
<li><strong>Funció Reduce</strong>: Fusiona tots els valors intermedis associats amb la mateixa clau intermèdia.</li>
<li><strong>Treball</strong>: Un càlcul complet de MapReduce, que consisteix en una fase de map, una fase de shuffle i sort, i una fase de reduce.</li>
<li><strong>Tasca</strong>: Una unitat individual de treball; un treball es divideix en múltiples tasques.</li>
</ul>
</div><h1>Com funciona MapReduce</h1>
<div class='content'><p>El marc de treball MapReduce opera en tres etapes principals: Map, Shuffle i Sort, i Reduce.</p>
</div><h2>Etapa Map</h2>
<div class='content'><p>Les dades d'entrada es divideixen en fragments independents, que són processats per les tasques de map de manera completament paral·lela. El marc de treball ordena les sortides dels maps, que després són l'entrada per a les tasques de reduce.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFRva2VuaXplck1hcHBlciBleHRlbmRzIE1hcHBlcjxPYmplY3QsIFRleHQsIFRleHQsIEludFdyaXRhYmxlPiB7CiAgICBwcml2YXRlIGZpbmFsIHN0YXRpYyBJbnRXcml0YWJsZSBvbmUgPSBuZXcgSW50V3JpdGFibGUoMSk7CiAgICBwcml2YXRlIFRleHQgd29yZCA9IG5ldyBUZXh0KCk7CgogICAgcHVibGljIHZvaWQgbWFwKE9iamVjdCBrZXksIFRleHQgdmFsdWUsIENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgU3RyaW5nVG9rZW5pemVyIGl0ciA9IG5ldyBTdHJpbmdUb2tlbml6ZXIodmFsdWUudG9TdHJpbmcoKSk7CiAgICAgICAgd2hpbGUgKGl0ci5oYXNNb3JlVG9rZW5zKCkpIHsKICAgICAgICAgICAgd29yZC5zZXQoaXRyLm5leHRUb2tlbigpKTsKICAgICAgICAgICAgY29udGV4dC53cml0ZSh3b3JkLCBvbmUpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class TokenizerMapper extends Mapper&lt;Object, Text, Text, IntWritable&gt; {
    private final static IntWritable one = new IntWritable(1);
    private Text word = new Text();

    public void map(Object key, Text value, Context context) throws IOException, InterruptedException {
        StringTokenizer itr = new StringTokenizer(value.toString());
        while (itr.hasMoreTokens()) {
            word.set(itr.nextToken());
            context.write(word, one);
        }
    }
}</pre></div><div class='content'><p><em>Explicació</em>: Aquest exemple mostra una classe Mapper senzilla que tokenitza l'entrada de text i emet cada paraula amb un recompte d'un.</p>
</div><h2>Etapa Shuffle i Sort</h2>
<div class='content'><p>Aquesta etapa és gestionada pel marc de treball Hadoop. Ordena les sortides dels maps i les transfereix als reducers.</p>
</div><h2>Etapa Reduce</h2>
<div class='content'><p>Les tasques de reduce prenen els parells clau/valor intermedis produïts per les tasques de map i els processen per produir la sortida final.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEludFN1bVJlZHVjZXIgZXh0ZW5kcyBSZWR1Y2VyPFRleHQsIEludFdyaXRhYmxlLCBUZXh0LCBJbnRXcml0YWJsZT4gewogICAgcHJpdmF0ZSBJbnRXcml0YWJsZSByZXN1bHQgPSBuZXcgSW50V3JpdGFibGUoKTsKCiAgICBwdWJsaWMgdm9pZCByZWR1Y2UoVGV4dCBrZXksIEl0ZXJhYmxlPEludFdyaXRhYmxlPiB2YWx1ZXMsIENvbnRleHQgY29udGV4dCkgdGhyb3dzIElPRXhjZXB0aW9uLCBJbnRlcnJ1cHRlZEV4Y2VwdGlvbiB7CiAgICAgICAgaW50IHN1bSA9IDA7CiAgICAgICAgZm9yIChJbnRXcml0YWJsZSB2YWwgOiB2YWx1ZXMpIHsKICAgICAgICAgICAgc3VtICs9IHZhbC5nZXQoKTsKICAgICAgICB9CiAgICAgICAgcmVzdWx0LnNldChzdW0pOwogICAgICAgIGNvbnRleHQud3JpdGUoa2V5LCByZXN1bHQpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class IntSumReducer extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    private IntWritable result = new IntWritable();

    public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        result.set(sum);
        context.write(key, result);
    }
}</pre></div><div class='content'><p><em>Explicació</em>: Aquest exemple mostra una classe Reducer que suma els recomptes per a cada paraula i escriu el recompte final a la sortida.</p>
</div><h1>Conceptes avançats de MapReduce</h1>
<div class='content'></div><h2>Combiner</h2>
<div class='content'><p>Un combiner és un mini-reducer que realitza una tasca de reducció local sobre la sortida del map. Ajuda a reduir la quantitat de dades transferides entre les tasques de map i reduce.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIFRva2VuaXplckNvbWJpbmVyIGV4dGVuZHMgUmVkdWNlcjxUZXh0LCBJbnRXcml0YWJsZSwgVGV4dCwgSW50V3JpdGFibGU+IHsKICAgIHByaXZhdGUgSW50V3JpdGFibGUgcmVzdWx0ID0gbmV3IEludFdyaXRhYmxlKCk7CgogICAgcHVibGljIHZvaWQgcmVkdWNlKFRleHQga2V5LCBJdGVyYWJsZTxJbnRXcml0YWJsZT4gdmFsdWVzLCBDb250ZXh0IGNvbnRleHQpIHRocm93cyBJT0V4Y2VwdGlvbiwgSW50ZXJydXB0ZWRFeGNlcHRpb24gewogICAgICAgIGludCBzdW0gPSAwOwogICAgICAgIGZvciAoSW50V3JpdGFibGUgdmFsIDogdmFsdWVzKSB7CiAgICAgICAgICAgIHN1bSArPSB2YWwuZ2V0KCk7CiAgICAgICAgfQogICAgICAgIHJlc3VsdC5zZXQoc3VtKTsKICAgICAgICBjb250ZXh0LndyaXRlKGtleSwgcmVzdWx0KTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class TokenizerCombiner extends Reducer&lt;Text, IntWritable, Text, IntWritable&gt; {
    private IntWritable result = new IntWritable();

    public void reduce(Text key, Iterable&lt;IntWritable&gt; values, Context context) throws IOException, InterruptedException {
        int sum = 0;
        for (IntWritable val : values) {
            sum += val.get();
        }
        result.set(sum);
        context.write(key, result);
    }
}</pre></div><div class='content'><p><em>Explicació</em>: Aquesta classe combiner realitza una agregació local dels recomptes de paraules abans d'enviar-los al reducer.</p>
</div><h2>Particionadors</h2>
<div class='content'><p>Els particionadors controlen la partició de les claus de sortida intermèdies del map. La clau (o un subconjunt de la clau) s'utilitza per derivar la partició, típicament per una funció de hash.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIEN1c3RvbVBhcnRpdGlvbmVyIGV4dGVuZHMgUGFydGl0aW9uZXI8VGV4dCwgSW50V3JpdGFibGU+IHsKICAgIEBPdmVycmlkZQogICAgcHVibGljIGludCBnZXRQYXJ0aXRpb24oVGV4dCBrZXksIEludFdyaXRhYmxlIHZhbHVlLCBpbnQgbnVtUGFydGl0aW9ucykgewogICAgICAgIHJldHVybiAoa2V5Lmhhc2hDb2RlKCkgJiBJbnRlZ2VyLk1BWF9WQUxVRSkgJSBudW1QYXJ0aXRpb25zOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class CustomPartitioner extends Partitioner&lt;Text, IntWritable&gt; {
    @Override
    public int getPartition(Text key, IntWritable value, int numPartitions) {
        return (key.hashCode() &amp; Integer.MAX_VALUE) % numPartitions;
    }
}</pre></div><div class='content'><p><em>Explicació</em>: Aquest particionador personalitzat assegura que les claus es distribueixin uniformement entre els reducers.</p>
</div><h1>Optimització de treballs MapReduce</h1>
<div class='content'><ul>
<li><strong>Localitat de dades</strong>: Assegureu-vos que les dades es processen on estan emmagatzemades per minimitzar l'I/O de xarxa.</li>
<li><strong>Execució especulativa</strong>: Activeu l'execució especulativa per gestionar tasques que s'executen lentament.</li>
<li><strong>Combiner</strong>: Utilitzeu combiners per reduir la quantitat de dades barrejades entre les tasques de map i reduce.</li>
<li><strong>Configuració adequada</strong>: Ajusteu el nombre de tasques de map i reduce en funció dels recursos del clúster i els requisits del treball.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>El marc de treball MapReduce és una eina poderosa per processar grans conjunts de dades de manera distribuïda i paral·lela. Entendre els seus conceptes bàsics i característiques avançades us permetrà escriure treballs de processament de dades eficients i escalables. Aprofitant els combiners, particionadors i una configuració adequada del treball, podeu optimitzar els vostres treballs MapReduce per obtenir un millor rendiment.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='hdfs'>&#x25C4;HDFS (Sistema de Fitxers Distribuït de Hadoop)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Marc de treball MapReduce</a>
	</div>
	<div class='col-4 text-end'>
					<a href='yarn'>YARN (Yet Another Resource Negotiator) &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
