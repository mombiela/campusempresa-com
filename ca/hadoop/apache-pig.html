<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Apache Pig</title>

    <link rel="alternate" href="https://campusempresa.com/es/hadoop/apache-pig" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/hadoop/apache-pig" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/hadoop/apache-pig" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/hadoop/apache-pig" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='yarn-schedulers'>&#x25C4; Planificadors de YARN</a></div><div class='col-6 text-end'><a href='apache-hive'>Apache Hive &#x25BA;</a></div></div><div class='content'></div><h1>Introducció a Apache Pig</h1>
<div class='content'><p>Apache Pig és una plataforma d'alt nivell per crear programes que s'executen a Apache Hadoop. El llenguatge per a aquesta plataforma es diu Pig Latin, que abstrau la complexitat d'escriure programes MapReduce.</p>
<ul>
<li><strong>Propòsit</strong>: Simplifica el procés d'escriure transformacions de dades complexes.</li>
<li><strong>Components</strong>: Pig Latin (llenguatge de script) i Pig Runtime (entorn d'execució).</li>
</ul>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Pig Latin</strong>: Un llenguatge de script d'alt nivell utilitzat amb Apache Pig.</li>
<li><strong>Pig Engine</strong>: Executa scripts Pig Latin i els tradueix en treballs MapReduce.</li>
<li><strong>Model de Dades</strong>: Pig utilitza un model de dades niat, que inclou:
<ul>
<li><strong>Atom</strong>: Un valor atòmic simple.</li>
<li><strong>Tuple</strong>: Una seqüència de camps.</li>
<li><strong>Bag</strong>: Una col·lecció de tuples.</li>
<li><strong>Map</strong>: Una col·lecció de parelles clau-valor.</li>
</ul>
</li>
</ul>
</div><h1>Instal·lació i Configuració d'Apache Pig</h1>
<div class='content'><ol>
<li><strong>Prerequisits</strong>: Assegura't que Hadoop està instal·lat i en funcionament.</li>
<li><strong>Descarregar Pig</strong>: Obteniu l'última versió des del lloc web d'Apache Pig.</li>
<li><strong>Extreure i Configurar</strong>:
<pre><code class="language-bash">tar -xzvf pig-x.y.z.tar.gz
export PIG_HOME=/path/to/pig
export PATH=$PATH:$PIG_HOME/bin
</code></pre>
</li>
<li><strong>Verificar la Instal·lació</strong>:
<pre><code class="language-bash">pig -version
</code></pre>
</li>
</ol>
</div><h1>Sintaxi Bàsica de Pig Latin</h1>
<h2>Carregar Dades</h2>
<div class='content'><ul>
<li><strong>Comanda</strong>: <code>LOAD</code></li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">data = LOAD 'input_data.txt' USING PigStorage(',') AS (field1:chararray, field2:int);
</code></pre>
</li>
</ul>
</div><h2>Emmagatzemar Dades</h2>
<div class='content'><ul>
<li><strong>Comanda</strong>: <code>STORE</code></li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">STORE data INTO 'output_data' USING PigStorage(',');
</code></pre>
</li>
</ul>
</div><h2>Filtrar Dades</h2>
<div class='content'><ul>
<li><strong>Comanda</strong>: <code>FILTER</code></li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">filtered_data = FILTER data BY field2 &gt; 10;
</code></pre>
</li>
</ul>
</div><h2>Agrupar i Agregar Dades</h2>
<div class='content'><ul>
<li><strong>Comanda</strong>: <code>GROUP</code>, <code>FOREACH</code>, <code>GENERATE</code></li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">grouped_data = GROUP data BY field1;
aggregated_data = FOREACH grouped_data GENERATE group, COUNT(data);
</code></pre>
</li>
</ul>
</div><h2>Unir Dades</h2>
<div class='content'><ul>
<li><strong>Comanda</strong>: <code>JOIN</code></li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">joined_data = JOIN data1 BY field1, data2 BY field2;
</code></pre>
</li>
</ul>
</div><h1>Funcions Avançades de Pig Latin</h1>
<h2>Funcions Definides per l'Usuari (UDFs)</h2>
<div class='content'><ul>
<li><strong>Propòsit</strong>: Estendre Pig Latin amb lògica de processament personalitzada.</li>
<li><strong>Exemple</strong>:
<pre><code class="language-java">public class MyUDF extends EvalFunc&lt;String&gt; {
    public String exec(Tuple input) throws IOException {
        // Lògica personalitzada aquí
    }
}
</code></pre>
<pre><code class="language-pig">REGISTER 'myudf.jar';
DEFINE MyUDF my.package.MyUDF();
result = FOREACH data GENERATE MyUDF(field1);
</code></pre>
</li>
</ul>
</div><h2>Substitució de Paràmetres</h2>
<div class='content'><ul>
<li><strong>Propòsit</strong>: Fer els scripts més flexibles i reutilitzables.</li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">%declare input 'input_data.txt'
data = LOAD '$input' USING PigStorage(',') AS (field1:chararray, field2:int);
</code></pre>
</li>
</ul>
</div><h2>Macros</h2>
<div class='content'><ul>
<li><strong>Propòsit</strong>: Reutilitzar blocs de codi dins dels scripts Pig.</li>
<li><strong>Exemple</strong>:
<pre><code class="language-pig">DEFINE process_data() RETURNS processed_data {
    filtered_data = FILTER data BY field2 &gt; 10;
    grouped_data = GROUP filtered_data BY field1;
    processed_data = FOREACH grouped_data GENERATE group, COUNT(filtered_data);
}
data = LOAD 'input_data.txt' USING PigStorage(',') AS (field1:chararray, field2:int);
processed_data = process_data();
</code></pre>
</li>
</ul>
</div><h1>Optimització del Rendiment</h1>
<div class='content'><ul>
<li><strong>Combinació d'Operacions</strong>: Minimitzar el nombre de treballs MapReduce.</li>
<li><strong>Ús de <code>LIMIT</code></strong>: Reduir la quantitat de dades processades.</li>
<li><strong>Paral·lelisme</strong>: Augmentar el nombre de reducers.
<pre><code class="language-pig">data = LOAD 'input_data.txt' USING PigStorage(',') AS (field1:chararray, field2:int);
grouped_data = GROUP data BY field1 PARALLEL 10;
</code></pre>
</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Apache Pig proporciona una plataforma potent i flexible per processar grans conjunts de dades a Hadoop. Utilitzant Pig Latin, els desenvolupadors poden escriure transformacions de dades complexes més fàcilment en comparació amb els programes tradicionals de MapReduce. Entendre els conceptes bàsics de Pig Latin, les funcions avançades i les tècniques d'optimització del rendiment pot millorar significativament la teva capacitat per treballar amb big data de manera eficient.</p>
</div><div class='row navigation'><div class='col-6'><a href='yarn-schedulers'>&#x25C4; Planificadors de YARN</a></div><div class='col-6 text-end'><a href='apache-hive'>Apache Hive &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
