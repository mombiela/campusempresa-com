<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async i Await en C#</title>

    <link rel="alternate" href="https://campusempresa.com/es/csharp/async-await" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/csharp/async-await" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/csharp/async-await" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/csharp/async-await" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>La programació asíncrona és una forma de programació paral·lela que permet que una unitat de treball s'executi separadament del fil principal de l'aplicació. Quan el treball es completa, notifica el fil principal. En C#, les paraules clau <code>async</code> i <code>await</code> s'utilitzen per facilitar la programació asíncrona.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Programació Asíncrona</strong>: Permet que les tasques s'executin en segon pla, millorant la capacitat de resposta de les aplicacions.</li>
<li><strong>Paraula clau <code>async</code></strong>: Marca un mètode com a asíncron.</li>
<li><strong>Paraula clau <code>await</code></strong>: Pausa l'execució d'un mètode asíncron fins que la tasca esperada es completi.</li>
<li><strong>Task</strong>: Representa una operació asíncrona.</li>
</ul>
</div><h1>Ús Bàsic</h1>
<div class='content'></div><h2>Definició d'un Mètode Asíncron</h2>
<div class='content'><p>Per definir un mètode asíncron, utilitza la paraula clau <code>async</code> a la signatura del mètode.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8aW50PiBDYWxjdWxhdGVTdW1Bc3luYyhpbnQgYSwgaW50IGIpCnsKICAgIHJldHVybiBhd2FpdCBUYXNrLlJ1bigoKSA9PiBhICsgYik7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;int&gt; CalculateSumAsync(int a, int b)
{
    return await Task.Run(() =&gt; a + b);
}</pre></div><div class='content'></div><h2>Crida a un Mètode Asíncron</h2>
<div class='content'><p>Quan cridis un mètode asíncron, utilitza la paraula clau <code>await</code> per esperar que la tasca es completi.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgTWFpbkFzeW5jKCkKewogICAgaW50IHJlc3VsdCA9IGF3YWl0IENhbGN1bGF0ZVN1bUFzeW5jKDUsIDEwKTsKICAgIENvbnNvbGUuV3JpdGVMaW5lKHJlc3VsdCk7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task MainAsync()
{
    int result = await CalculateSumAsync(5, 10);
    Console.WriteLine(result);
}</pre></div><div class='content'></div><h2>Exemple: Obtenir Dades d'una API Web</h2>
<div class='content'><p>Aquí tens un exemple senzill d'obtenir dades d'una API web utilitzant <code>HttpClient</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8c3RyaW5nPiBGZXRjaERhdGFBc3luYyhzdHJpbmcgdXJsKQp7CiAgICB1c2luZyAoSHR0cENsaWVudCBjbGllbnQgPSBuZXcgSHR0cENsaWVudCgpKQogICAgewogICAgICAgIEh0dHBSZXNwb25zZU1lc3NhZ2UgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuR2V0QXN5bmModXJsKTsKICAgICAgICByZXNwb25zZS5FbnN1cmVTdWNjZXNzU3RhdHVzQ29kZSgpOwogICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5Db250ZW50LlJlYWRBc1N0cmluZ0FzeW5jKCk7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;string&gt; FetchDataAsync(string url)
{
    using (HttpClient client = new HttpClient())
    {
        HttpResponseMessage response = await client.GetAsync(url);
        response.EnsureSuccessStatusCode();
        return await response.Content.ReadAsStringAsync();
    }
}</pre></div><div class='content'></div><h1>Ús Avançat</h1>
<div class='content'></div><h2>Gestió de Múltiples Operacions Asíncrones</h2>
<div class='content'><p>Pots executar múltiples operacions asíncrones simultàniament utilitzant <code>Task.WhenAll</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2sgRmV0Y2hNdWx0aXBsZURhdGFBc3luYygpCnsKICAgIHZhciB0YXNrMSA9IEZldGNoRGF0YUFzeW5jKCJodHRwczovL2FwaS5leGFtcGxlLmNvbS9kYXRhMSIpOwogICAgdmFyIHRhc2syID0gRmV0Y2hEYXRhQXN5bmMoImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEyIik7CgogICAgYXdhaXQgVGFzay5XaGVuQWxsKHRhc2sxLCB0YXNrMik7CgogICAgQ29uc29sZS5Xcml0ZUxpbmUoYXdhaXQgdGFzazEpOwogICAgQ29uc29sZS5Xcml0ZUxpbmUoYXdhaXQgdGFzazIpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task FetchMultipleDataAsync()
{
    var task1 = FetchDataAsync(&quot;https://api.example.com/data1&quot;);
    var task2 = FetchDataAsync(&quot;https://api.example.com/data2&quot;);

    await Task.WhenAll(task1, task2);

    Console.WriteLine(await task1);
    Console.WriteLine(await task2);
}</pre></div><div class='content'></div><h2>Gestió d'Errors en Mètodes Asíncrons</h2>
<div class='content'><p>Utilitza blocs try-catch per gestionar excepcions en mètodes asíncrons.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8c3RyaW5nPiBGZXRjaERhdGFXaXRoRXJyb3JIYW5kbGluZ0FzeW5jKHN0cmluZyB1cmwpCnsKICAgIHRyeQogICAgewogICAgICAgIHVzaW5nIChIdHRwQ2xpZW50IGNsaWVudCA9IG5ldyBIdHRwQ2xpZW50KCkpCiAgICAgICAgewogICAgICAgICAgICBIdHRwUmVzcG9uc2VNZXNzYWdlIHJlc3BvbnNlID0gYXdhaXQgY2xpZW50LkdldEFzeW5jKHVybCk7CiAgICAgICAgICAgIHJlc3BvbnNlLkVuc3VyZVN1Y2Nlc3NTdGF0dXNDb2RlKCk7CiAgICAgICAgICAgIHJldHVybiBhd2FpdCByZXNwb25zZS5Db250ZW50LlJlYWRBc1N0cmluZ0FzeW5jKCk7CiAgICAgICAgfQogICAgfQogICAgY2F0Y2ggKEh0dHBSZXF1ZXN0RXhjZXB0aW9uIGUpCiAgICB7CiAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoJCJFcnJvciBlbiBsYSBzb2zCt2xpY2l0dWQ6IHtlLk1lc3NhZ2V9Iik7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;string&gt; FetchDataWithErrorHandlingAsync(string url)
{
    try
    {
        using (HttpClient client = new HttpClient())
        {
            HttpResponseMessage response = await client.GetAsync(url);
            response.EnsureSuccessStatusCode();
            return await response.Content.ReadAsStringAsync();
        }
    }
    catch (HttpRequestException e)
    {
        Console.WriteLine($&quot;Error en la sol&middot;licitud: {e.Message}&quot;);
        return null;
    }
}</pre></div><div class='content'></div><h2>Retorn de Valors des de Mètodes Asíncrons</h2>
<div class='content'><p>Els mètodes asíncrons poden retornar <code>Task</code>, <code>Task&lt;T&gt;</code>, o <code>void</code>. Utilitza <code>Task&lt;T&gt;</code> quan necessitis retornar un valor.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8aW50PiBHZXREYXRhTGVuZ3RoQXN5bmMoc3RyaW5nIHVybCkKewogICAgc3RyaW5nIGRhdGEgPSBhd2FpdCBGZXRjaERhdGFBc3luYyh1cmwpOwogICAgcmV0dXJuIGRhdGEuTGVuZ3RoOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;int&gt; GetDataLengthAsync(string url)
{
    string data = await FetchDataAsync(url);
    return data.Length;
}</pre></div><div class='content'></div><h1>Millors Pràctiques</h1>
<div class='content'><ul>
<li><strong>Evita Crides Bloquejants</strong>: No utilitzis <code>.Result</code> o <code>.Wait()</code> en mètodes asíncrons ja que bloqueja el fil que crida.</li>
<li><strong>Utilitza ConfigureAwait</strong>: Utilitza <code>ConfigureAwait(false)</code> per evitar bloquejos en certs contextos de sincronització, especialment en aplicacions d'interfície d'usuari.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGFzeW5jIFRhc2s8c3RyaW5nPiBGZXRjaERhdGFXaXRoQ29uZmlndXJlQXdhaXRBc3luYyhzdHJpbmcgdXJsKQp7CiAgICB1c2luZyAoSHR0cENsaWVudCBjbGllbnQgPSBuZXcgSHR0cENsaWVudCgpKQogICAgewogICAgICAgIEh0dHBSZXNwb25zZU1lc3NhZ2UgcmVzcG9uc2UgPSBhd2FpdCBjbGllbnQuR2V0QXN5bmModXJsKS5Db25maWd1cmVBd2FpdChmYWxzZSk7CiAgICAgICAgcmVzcG9uc2UuRW5zdXJlU3VjY2Vzc1N0YXR1c0NvZGUoKTsKICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuQ29udGVudC5SZWFkQXNTdHJpbmdBc3luYygpLkNvbmZpZ3VyZUF3YWl0KGZhbHNlKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public async Task&lt;string&gt; FetchDataWithConfigureAwaitAsync(string url)
{
    using (HttpClient client = new HttpClient())
    {
        HttpResponseMessage response = await client.GetAsync(url).ConfigureAwait(false);
        response.EnsureSuccessStatusCode();
        return await response.Content.ReadAsStringAsync().ConfigureAwait(false);
    }
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>La programació asíncrona en C# utilitzant <code>async</code> i <code>await</code> ajuda a crear aplicacions responsives permetent que les tasques s'executin simultàniament sense bloquejar el fil principal. Comprenent i aplicant aquests conceptes, pots millorar significativament el rendiment i la capacitat de resposta de les teves aplicacions. Recorda gestionar les excepcions correctament i seguir les millors pràctiques per evitar errors comuns.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
