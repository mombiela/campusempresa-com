<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LINQ to SQL</title>

    <link rel="alternate" href="https://campusempresa.com/es/csharp/linq-sql" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/csharp/linq-sql" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/csharp/linq-sql" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/csharp/linq-sql" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='linq-xml'>&#x25C4; LINQ a XML</a></div><div class='col-6 text-end'><a href='introduction-async'>Introducció a la Programació Asíncrona &#x25BA;</a></div></div><div class='content'></div><h1>Introducció a LINQ to SQL</h1>
<div class='content'><p>LINQ to SQL és un component del .NET Framework que proporciona una infraestructura d'execució per gestionar dades relacionals com a objectes. Et permet consultar bases de dades utilitzant la sintaxi LINQ (Language Integrated Query), que és més intuïtiva i llegible en comparació amb les consultes SQL tradicionals.</p>
<ul>
<li><strong>LINQ (Language Integrated Query)</strong>: Un conjunt de tecnologies basades en la integració de capacitats de consulta directament en el llenguatge C#.</li>
<li><strong>SQL (Structured Query Language)</strong>: Un llenguatge estàndard per accedir i manipular bases de dades.</li>
</ul>
</div><h1>Configuració de LINQ to SQL</h1>
<div class='content'><p>Abans d'endinsar-te en LINQ to SQL, has de configurar el teu entorn.</p>
<ol>
<li><strong>Instal·la Visual Studio</strong>: Assegura't de tenir Visual Studio instal·lat.</li>
<li><strong>Crea una Base de Dades</strong>: Utilitza SQL Server o qualsevol altra base de dades compatible.</li>
<li><strong>Afegeix Classes LINQ to SQL</strong>: A Visual Studio, afegeix un nou element de Classes LINQ to SQL al teu projecte.</li>
</ol>
</div><h1>Operacions bàsiques de LINQ to SQL</h1>
<h2>Connexió a una Base de Dades</h2>
<div class='content'><p>Per connectar-te a una base de dades, has de crear un objecte DataContext.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uTGlucTsKdXNpbmcgU3lzdGVtLkRhdGEuTGlucTsKCnB1YmxpYyBjbGFzcyBQcm9ncmFtCnsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBNYWluKCkKICAgIHsKICAgICAgICBzdHJpbmcgY29ubmVjdGlvblN0cmluZyA9IEAieW91cl9jb25uZWN0aW9uX3N0cmluZ19oZXJlIjsKICAgICAgICBEYXRhQ29udGV4dCBkYiA9IG5ldyBEYXRhQ29udGV4dChjb25uZWN0aW9uU3RyaW5nKTsKICAgICAgICAKICAgICAgICAvLyBFbCB0ZXUgY29kaSBhcXXDrQogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using System;
using System.Linq;
using System.Data.Linq;

public class Program
{
    public static void Main()
    {
        string connectionString = @&quot;your_connection_string_here&quot;;
        DataContext db = new DataContext(connectionString);
        
        // El teu codi aqu&iacute;
    }
}</pre></div><div class='content'></div><h2>Consultar Dades</h2>
<div class='content'><p>Pots consultar dades utilitzant la sintaxi LINQ.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIHF1ZXJ5ID0gZnJvbSBjdXN0b21lciBpbiBkYi5HZXRUYWJsZTxDdXN0b21lcj4oKQogICAgICAgICAgICB3aGVyZSBjdXN0b21lci5DaXR5ID09ICJTZWF0dGxlIgogICAgICAgICAgICBzZWxlY3QgY3VzdG9tZXI7Cgpmb3JlYWNoICh2YXIgY3VzdG9tZXIgaW4gcXVlcnkpCnsKICAgIENvbnNvbGUuV3JpdGVMaW5lKGN1c3RvbWVyLk5hbWUpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var query = from customer in db.GetTable&lt;Customer&gt;()
            where customer.City == &quot;Seattle&quot;
            select customer;

foreach (var customer in query)
{
    Console.WriteLine(customer.Name);
}</pre></div><div class='content'></div><h2>Inserir Dades</h2>
<div class='content'><p>Per inserir dades a la base de dades, crea un objecte de l'entitat i insereix-lo utilitzant el mètode <code>InsertOnSubmit</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q3VzdG9tZXIgbmV3Q3VzdG9tZXIgPSBuZXcgQ3VzdG9tZXIKewogICAgTmFtZSA9ICJKb2huIERvZSIsCiAgICBDaXR5ID0gIk5ldyBZb3JrIgp9OwoKZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuSW5zZXJ0T25TdWJtaXQobmV3Q3VzdG9tZXIpOwpkYi5TdWJtaXRDaGFuZ2VzKCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Customer newCustomer = new Customer
{
    Name = &quot;John Doe&quot;,
    City = &quot;New York&quot;
};

db.GetTable&lt;Customer&gt;().InsertOnSubmit(newCustomer);
db.SubmitChanges();</pre></div><div class='content'></div><h2>Actualitzar Dades</h2>
<div class='content'><p>Per actualitzar dades, recupera l'objecte, modifica'l i crida <code>SubmitChanges</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIGN1c3RvbWVyID0gZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuRmlyc3QoYyA9PiBjLk5hbWUgPT0gIkpvaG4gRG9lIik7CmN1c3RvbWVyLkNpdHkgPSAiTG9zIEFuZ2VsZXMiOwpkYi5TdWJtaXRDaGFuZ2VzKCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var customer = db.GetTable&lt;Customer&gt;().First(c =&gt; c.Name == &quot;John Doe&quot;);
customer.City = &quot;Los Angeles&quot;;
db.SubmitChanges();</pre></div><div class='content'></div><h2>Esborrar Dades</h2>
<div class='content'><p>Per esborrar dades, recupera l'objecte i utilitza el mètode <code>DeleteOnSubmit</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIGN1c3RvbWVyID0gZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuRmlyc3QoYyA9PiBjLk5hbWUgPT0gIkpvaG4gRG9lIik7CmRiLkdldFRhYmxlPEN1c3RvbWVyPigpLkRlbGV0ZU9uU3VibWl0KGN1c3RvbWVyKTsKZGIuU3VibWl0Q2hhbmdlcygpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var customer = db.GetTable&lt;Customer&gt;().First(c =&gt; c.Name == &quot;John Doe&quot;);
db.GetTable&lt;Customer&gt;().DeleteOnSubmit(customer);
db.SubmitChanges();</pre></div><div class='content'></div><h1>Funcionalitats avançades de LINQ to SQL</h1>
<h2>Procediments emmagatzemats</h2>
<div class='content'><p>Pots cridar procediments emmagatzemats utilitzant LINQ to SQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFyIHJlc3VsdCA9IGRiLkV4ZWN1dGVRdWVyeTxDdXN0b21lcj4oIkVYRUMgR2V0Q3VzdG9tZXJzQnlDaXR5IEBDaXR5PXswfSIsICJTZWF0dGxlIik7Cgpmb3JlYWNoICh2YXIgY3VzdG9tZXIgaW4gcmVzdWx0KQp7CiAgICBDb25zb2xlLldyaXRlTGluZShjdXN0b21lci5OYW1lKTsKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>var result = db.ExecuteQuery&lt;Customer&gt;(&quot;EXEC GetCustomersByCity @City={0}&quot;, &quot;Seattle&quot;);

foreach (var customer in result)
{
    Console.WriteLine(customer.Name);
}</pre></div><div class='content'></div><h2>Transaccions</h2>
<div class='content'><p>LINQ to SQL suporta transaccions per assegurar la integritat de les dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNpbmcgKHZhciB0cmFuc2FjdGlvbiA9IGRiLkNvbm5lY3Rpb24uQmVnaW5UcmFuc2FjdGlvbigpKQp7CiAgICB0cnkKICAgIHsKICAgICAgICBkYi5UcmFuc2FjdGlvbiA9IHRyYW5zYWN0aW9uOwoKICAgICAgICAvLyBSZWFsaXR6YSBtw7psdGlwbGVzIG9wZXJhY2lvbnMKICAgICAgICBkYi5TdWJtaXRDaGFuZ2VzKCk7CgogICAgICAgIHRyYW5zYWN0aW9uLkNvbW1pdCgpOwogICAgfQogICAgY2F0Y2gKICAgIHsKICAgICAgICB0cmFuc2FjdGlvbi5Sb2xsYmFjaygpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>using (var transaction = db.Connection.BeginTransaction())
{
    try
    {
        db.Transaction = transaction;

        // Realitza m&uacute;ltiples operacions
        db.SubmitChanges();

        transaction.Commit();
    }
    catch
    {
        transaction.Rollback();
    }
}</pre></div><div class='content'></div><h2>Càrrega diferida</h2>
<div class='content'><p>La càrrega diferida et permet carregar dades relacionades només quan s'accedeixen.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGF0YUxvYWRPcHRpb25zIG9wdGlvbnMgPSBuZXcgRGF0YUxvYWRPcHRpb25zKCk7Cm9wdGlvbnMuTG9hZFdpdGg8Q3VzdG9tZXI+KGMgPT4gYy5PcmRlcnMpOwpkYi5Mb2FkT3B0aW9ucyA9IG9wdGlvbnM7Cgp2YXIgY3VzdG9tZXJzID0gZGIuR2V0VGFibGU8Q3VzdG9tZXI+KCkuVG9MaXN0KCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DataLoadOptions options = new DataLoadOptions();
options.LoadWith&lt;Customer&gt;(c =&gt; c.Orders);
db.LoadOptions = options;

var customers = db.GetTable&lt;Customer&gt;().ToList();</pre></div><div class='content'></div><h1>Consideracions de rendiment</h1>
<div class='content'><ul>
<li><strong>Optimitza les Consultes</strong>: Utilitza projeccions per seleccionar només els camps necessaris.</li>
<li><strong>Operacions en Bloc</strong>: Agrupa múltiples operacions per reduir els viatges a la base de dades.</li>
<li><strong>Indexació</strong>: Assegura una indexació adequada a les taules de la base de dades per accelerar les consultes.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>LINQ to SQL simplifica les operacions de base de dades permetent-te utilitzar la sintaxi C# per interactuar amb la teva base de dades. Proporciona una manera més llegible i mantenible de realitzar operacions CRUD i suporta funcionalitats avançades com procediments emmagatzemats i transaccions. Entenent i utilitzant LINQ to SQL, pots escriure codi d'accés a dades eficient i efectiu en les teves aplicacions C#.</p>
</div><div class='row navigation'><div class='col-6'><a href='linq-xml'>&#x25C4; LINQ a XML</a></div><div class='col-6 text-end'><a href='introduction-async'>Introducció a la Programació Asíncrona &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
