<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projecte 2: Generació de Text amb RNN</title>

    <link rel="alternate" href="https://campusempresa.com/es/deep_learning/proyecto-generacion-texto-rnn" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/deep_learning/proyecto-generacion-texto-rnn" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/deep_learning/proyecto-generacion-texto-rnn" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/deep_learning/proyecto-generacion-texto-rnn" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='proyecto-clasificacion-imagenes-cnn'>&#x25C4; Projecte 1: Classificació d'Imatges amb CNN</a></div><div class='col-6 text-end'><a href='proyecto-deteccion-anomalias-autoencoders'>Projecte 3: Detecció d'Anomalies amb Autoencoders &#x25BA;</a></div></div><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquest projecte, explorarem com les Xarxes Neuronals Recurrentes (RNN) poden ser utilitzades per a la generació de text. Les RNN són especialment adequades per a tasques seqüencials, com el processament de text, a causa de la seva capacitat per mantenir informació sobre estats anteriors en la seqüència.</p>
</div><h1>Objectius del Projecte</h1>
<div class='content'><ul>
<li>Comprendre el funcionament bàsic de les RNN.</li>
<li>Implementar una RNN per a la generació de text.</li>
<li>Avaluar el rendiment de la RNN en la tasca de generació de text.</li>
</ul>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Xarxes Neuronals Recurrentes (RNN)</strong>: Un tipus de xarxa neuronal que és capaç de manejar dades seqüencials.</li>
<li><strong>Estats Ocults</strong>: Els estats interns de la RNN que permeten mantenir informació sobre entrades anteriors.</li>
<li><strong>Generació de Text</strong>: El procés de produir text nou basat en patrons apresos d'un corpus de text existent.</li>
</ul>
</div><h1>Implementació d'una RNN per a Generació de Text</h1>
<div class='content'></div><h2>Preparació de l'Entorn</h2>
<div class='content'><p>Primer, assegura't de tenir instal·lades les biblioteques necessàries. Utilitzarem TensorFlow i Keras per implementar la nostra RNN.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IXBpcCBpbnN0YWxsIHRlbnNvcmZsb3c="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>!pip install tensorflow</pre></div><div class='content'></div><h2>Importació de Biblioteques</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmltcG9ydCB0ZW5zb3JmbG93IGFzIHRmCmZyb20gdGVuc29yZmxvdy5rZXJhcy5tb2RlbHMgaW1wb3J0IFNlcXVlbnRpYWwKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLmxheWVycyBpbXBvcnQgRGVuc2UsIExTVE0sIEVtYmVkZGluZwpmcm9tIHRlbnNvcmZsb3cua2VyYXMub3B0aW1pemVycyBpbXBvcnQgQWRhbQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, LSTM, Embedding
from tensorflow.keras.optimizers import Adam</pre></div><div class='content'></div><h2>Càrrega i Preprocessament de Dades</h2>
<div class='content'><p>Per a aquest projecte, utilitzarem un corpus de text. Pots triar qualsevol text llarg, com un llibre o una col·lecció d'articles.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDYXJyZWdhciBlbCB0ZXh0CnBhdGhfdG9fZmlsZSA9ICdwYXRoL3RvL3lvdXIvdGV4dGZpbGUudHh0Jwp0ZXh0ID0gb3BlbihwYXRoX3RvX2ZpbGUsICdyJykucmVhZCgpCgojIFByZXByb2Nlc3NhbWVudAp2b2NhYiA9IHNvcnRlZChzZXQodGV4dCkpCmNoYXIyaWR4ID0ge3U6aSBmb3IgaSwgdSBpbiBlbnVtZXJhdGUodm9jYWIpfQppZHgyY2hhciA9IG5wLmFycmF5KHZvY2FiKQp0ZXh0X2FzX2ludCA9IG5wLmFycmF5KFtjaGFyMmlkeFtjXSBmb3IgYyBpbiB0ZXh0XSkKCiMgQ3JlYXIgc2Vxw7zDqG5jaWVzIGQnZW50cmFkYSBpIHNvcnRpZGEKc2VxX2xlbmd0aCA9IDEwMApleGFtcGxlc19wZXJfZXBvY2ggPSBsZW4odGV4dCkvLyhzZXFfbGVuZ3RoKzEpCgpjaGFyX2RhdGFzZXQgPSB0Zi5kYXRhLkRhdGFzZXQuZnJvbV90ZW5zb3Jfc2xpY2VzKHRleHRfYXNfaW50KQpzZXF1ZW5jZXMgPSBjaGFyX2RhdGFzZXQuYmF0Y2goc2VxX2xlbmd0aCsxLCBkcm9wX3JlbWFpbmRlcj1UcnVlKQoKZGVmIHNwbGl0X2lucHV0X3RhcmdldChjaHVuayk6CiAgICBpbnB1dF90ZXh0ID0gY2h1bmtbOi0xXQogICAgdGFyZ2V0X3RleHQgPSBjaHVua1sxOl0KICAgIHJldHVybiBpbnB1dF90ZXh0LCB0YXJnZXRfdGV4dAoKZGF0YXNldCA9IHNlcXVlbmNlcy5tYXAoc3BsaXRfaW5wdXRfdGFyZ2V0KQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Carregar el text
path_to_file = 'path/to/your/textfile.txt'
text = open(path_to_file, 'r').read()

# Preprocessament
vocab = sorted(set(text))
char2idx = {u:i for i, u in enumerate(vocab)}
idx2char = np.array(vocab)
text_as_int = np.array([char2idx[c] for c in text])

# Crear seq&uuml;&egrave;ncies d'entrada i sortida
seq_length = 100
examples_per_epoch = len(text)//(seq_length+1)

char_dataset = tf.data.Dataset.from_tensor_slices(text_as_int)
sequences = char_dataset.batch(seq_length+1, drop_remainder=True)

def split_input_target(chunk):
    input_text = chunk[:-1]
    target_text = chunk[1:]
    return input_text, target_text

dataset = sequences.map(split_input_target)</pre></div><div class='content'></div><h2>Construcció del Model</h2>
<div class='content'><p>Utilitzarem una arquitectura simple de LSTM per a la nostra RNN.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBQYXLDoG1ldHJlcyBkZWwgbW9kZWwKdm9jYWJfc2l6ZSA9IGxlbih2b2NhYikKZW1iZWRkaW5nX2RpbSA9IDI1Ngpybm5fdW5pdHMgPSAxMDI0CgojIENvbnN0cnVjY2nDsyBkZWwgbW9kZWwKbW9kZWwgPSBTZXF1ZW50aWFsKFsKICAgIEVtYmVkZGluZyh2b2NhYl9zaXplLCBlbWJlZGRpbmdfZGltLCBiYXRjaF9pbnB1dF9zaGFwZT1bTm9uZSwgTm9uZV0pLAogICAgTFNUTShybm5fdW5pdHMsIHJldHVybl9zZXF1ZW5jZXM9VHJ1ZSwgc3RhdGVmdWw9RmFsc2UsIHJlY3VycmVudF9pbml0aWFsaXplcj0nZ2xvcm90X3VuaWZvcm0nKSwKICAgIERlbnNlKHZvY2FiX3NpemUpCl0pCgojIENvbXBpbGFjacOzIGRlbCBtb2RlbAptb2RlbC5jb21waWxlKG9wdGltaXplcj0nYWRhbScsIGxvc3M9dGYubG9zc2VzLlNwYXJzZUNhdGVnb3JpY2FsQ3Jvc3NlbnRyb3B5KGZyb21fbG9naXRzPVRydWUpKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Par&agrave;metres del model
vocab_size = len(vocab)
embedding_dim = 256
rnn_units = 1024

# Construcci&oacute; del model
model = Sequential([
    Embedding(vocab_size, embedding_dim, batch_input_shape=[None, None]),
    LSTM(rnn_units, return_sequences=True, stateful=False, recurrent_initializer='glorot_uniform'),
    Dense(vocab_size)
])

# Compilaci&oacute; del model
model.compile(optimizer='adam', loss=tf.losses.SparseCategoricalCrossentropy(from_logits=True))</pre></div><div class='content'></div><h2>Entrenament del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBDb25maWd1cmFjacOzIGRlIGwnZW50cmVuYW1lbnQKQkFUQ0hfU0laRSA9IDY0CkJVRkZFUl9TSVpFID0gMTAwMDAKCmRhdGFzZXQgPSBkYXRhc2V0LnNodWZmbGUoQlVGRkVSX1NJWkUpLmJhdGNoKEJBVENIX1NJWkUsIGRyb3BfcmVtYWluZGVyPVRydWUpCgojIEVudHJlbmFtZW50CkVQT0NIUyA9IDEwCmhpc3RvcnkgPSBtb2RlbC5maXQoZGF0YXNldCwgZXBvY2hzPUVQT0NIUyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Configuraci&oacute; de l'entrenament
BATCH_SIZE = 64
BUFFER_SIZE = 10000

dataset = dataset.shuffle(BUFFER_SIZE).batch(BATCH_SIZE, drop_remainder=True)

# Entrenament
EPOCHS = 10
history = model.fit(dataset, epochs=EPOCHS)</pre></div><div class='content'></div><h2>Generació de Text</h2>
<div class='content'><p>Un cop entrenat el model, podem generar text nou.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVmIGdlbmVyYXRlX3RleHQobW9kZWwsIHN0YXJ0X3N0cmluZyk6CiAgICBudW1fZ2VuZXJhdGUgPSAxMDAwCiAgICBpbnB1dF9ldmFsID0gW2NoYXIyaWR4W3NdIGZvciBzIGluIHN0YXJ0X3N0cmluZ10KICAgIGlucHV0X2V2YWwgPSB0Zi5leHBhbmRfZGltcyhpbnB1dF9ldmFsLCAwKQogICAgdGV4dF9nZW5lcmF0ZWQgPSBbXQogICAgdGVtcGVyYXR1cmUgPSAxLjAKCiAgICBtb2RlbC5yZXNldF9zdGF0ZXMoKQogICAgZm9yIGkgaW4gcmFuZ2UobnVtX2dlbmVyYXRlKToKICAgICAgICBwcmVkaWN0aW9ucyA9IG1vZGVsKGlucHV0X2V2YWwpCiAgICAgICAgcHJlZGljdGlvbnMgPSB0Zi5zcXVlZXplKHByZWRpY3Rpb25zLCAwKQogICAgICAgIHByZWRpY3Rpb25zID0gcHJlZGljdGlvbnMgLyB0ZW1wZXJhdHVyZQogICAgICAgIHByZWRpY3RlZF9pZCA9IHRmLnJhbmRvbS5jYXRlZ29yaWNhbChwcmVkaWN0aW9ucywgbnVtX3NhbXBsZXM9MSlbLTEsMF0ubnVtcHkoKQogICAgICAgIGlucHV0X2V2YWwgPSB0Zi5leHBhbmRfZGltcyhbcHJlZGljdGVkX2lkXSwgMCkKICAgICAgICB0ZXh0X2dlbmVyYXRlZC5hcHBlbmQoaWR4MmNoYXJbcHJlZGljdGVkX2lkXSkKCiAgICByZXR1cm4gKHN0YXJ0X3N0cmluZyArICcnLmpvaW4odGV4dF9nZW5lcmF0ZWQpKQoKcHJpbnQoZ2VuZXJhdGVfdGV4dChtb2RlbCwgc3RhcnRfc3RyaW5nPSJPbmNlIHVwb24gYSB0aW1lIikp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>def generate_text(model, start_string):
    num_generate = 1000
    input_eval = [char2idx[s] for s in start_string]
    input_eval = tf.expand_dims(input_eval, 0)
    text_generated = []
    temperature = 1.0

    model.reset_states()
    for i in range(num_generate):
        predictions = model(input_eval)
        predictions = tf.squeeze(predictions, 0)
        predictions = predictions / temperature
        predicted_id = tf.random.categorical(predictions, num_samples=1)[-1,0].numpy()
        input_eval = tf.expand_dims([predicted_id], 0)
        text_generated.append(idx2char[predicted_id])

    return (start_string + ''.join(text_generated))

print(generate_text(model, start_string=&quot;Once upon a time&quot;))</pre></div><div class='content'></div><h1>Avaluació i Ajustos</h1>
<div class='content'><ul>
<li><strong>Avaluació</strong>: Revisa el text generat per avaluar la coherència i fluïdesa.</li>
<li><strong>Ajustos</strong>: Si el text generat no és satisfactori, considera ajustar els hiperparàmetres, com la mida de la xarxa, la longitud de les seqüències d'entrada, o el nombre d'èpoques d'entrenament.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquest projecte, hem après a implementar una RNN per a la generació de text. Hem cobert des de la preparació de dades fins a la construcció, entrenament i avaluació del model. La generació de text amb RNN és una poderosa tècnica que pot ser aplicada en diverses àrees, com la creació de contingut, xatbots i més.</p>
</div><div class='row navigation'><div class='col-6'><a href='proyecto-clasificacion-imagenes-cnn'>&#x25C4; Projecte 1: Classificació d'Imatges amb CNN</a></div><div class='col-6 text-end'><a href='proyecto-deteccion-anomalias-autoencoders'>Projecte 3: Detecció d'Anomalies amb Autoencoders &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
