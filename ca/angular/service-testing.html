<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proves de serveis a Angular</title>

    <link rel="alternate" href="https://campusempresa.com/es/angular/service-testing" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/angular/service-testing" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/angular/service-testing" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/angular/service-testing" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='component-testing'>&#x25C4; Proves de components</a></div><div class='col-6 text-end'><a href='end-to-end-testing'>Proves de cap a cap &#x25BA;</a></div></div><div class='content'></div><h1>Introducció a les proves de serveis</h1>
<div class='content'><p>Les proves de serveis són una part crucial del desenvolupament d'aplicacions Angular. Asseguren que els serveis, que sovint contenen la lògica de negoci i el codi d'accés a dades, funcionin correctament. Aquesta secció et guiarà a través dels conceptes bàsics de les proves de serveis, des de la configuració del teu entorn de proves fins a l'escriptura i execució de proves.</p>
</div><h1>Configuració de l'entorn de proves</h1>
<div class='content'><p>Abans de començar a escriure proves, necessitem configurar el nostre entorn de proves.</p>
<ul>
<li><strong>Instal·lar Angular CLI</strong>: Assegura't que tens Angular CLI instal·lat.
<pre><code class="language-bash">npm install -g @angular/cli
</code></pre>
</li>
<li><strong>Crear un nou projecte Angular</strong>: Si no tens un projecte existent, crea'n un.
<pre><code class="language-bash">ng new my-angular-app
cd my-angular-app
</code></pre>
</li>
<li><strong>Instal·lar les biblioteques de proves necessàries</strong>: Angular ve amb Jasmine i Karma per defecte, però pots instal·lar biblioteques addicionals si cal.
<pre><code class="language-bash">npm install --save-dev @angular/core @angular/common @angular/compiler @angular/platform-browser @angular/platform-browser-dynamic @angular/router @angular/forms
</code></pre>
</li>
</ul>
</div><h1>Escriure la teva primera prova de servei</h1>
<div class='content'><p>Comencem escrivint una prova simple per a un servei Angular.</p>
</div><h2>Crear un servei</h2>
<div class='content'><p>Primer, crea un servei utilitzant Angular CLI.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bmcgZ2VuZXJhdGUgc2VydmljZSBteS1zZXJ2aWNl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ng generate service my-service</pre></div><div class='content'><p>Aquesta comanda generarà un fitxer de servei <code>my-service.service.ts</code> i un fitxer de prova corresponent <code>my-service.service.spec.ts</code>.</p>
</div><h2>Entendre el codi del servei</h2>
<div class='content'><p>Aquí tens un exemple simple d'un servei que proporciona un missatge de salutació:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbXktc2VydmljZS5zZXJ2aWNlLnRzCmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJzsKCkBJbmplY3RhYmxlKHsKICBwcm92aWRlZEluOiAncm9vdCcKfSkKZXhwb3J0IGNsYXNzIE15U2VydmljZSB7CiAgY29uc3RydWN0b3IoKSB7IH0KCiAgZ2V0R3JlZXRpbmcoKTogc3RyaW5nIHsKICAgIHJldHVybiAnSGVsbG8sIFdvcmxkISc7CiAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// my-service.service.ts
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root'
})
export class MyService {
  constructor() { }

  getGreeting(): string {
    return 'Hello, World!';
  }
}</pre></div><div class='content'></div><h2>Escriure la prova</h2>
<div class='content'><p>Ara, escrivim una prova per al mètode <code>getGreeting</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gbXktc2VydmljZS5zZXJ2aWNlLnNwZWMudHMKaW1wb3J0IHsgVGVzdEJlZCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUvdGVzdGluZyc7CmltcG9ydCB7IE15U2VydmljZSB9IGZyb20gJy4vbXktc2VydmljZS5zZXJ2aWNlJzsKCmRlc2NyaWJlKCdNeVNlcnZpY2UnLCAoKSA9PiB7CiAgbGV0IHNlcnZpY2U6IE15U2VydmljZTsKCiAgYmVmb3JlRWFjaCgoKSA9PiB7CiAgICBUZXN0QmVkLmNvbmZpZ3VyZVRlc3RpbmdNb2R1bGUoe30pOwogICAgc2VydmljZSA9IFRlc3RCZWQuaW5qZWN0KE15U2VydmljZSk7CiAgfSk7CgogIGl0KCdzaG91bGQgYmUgY3JlYXRlZCcsICgpID0+IHsKICAgIGV4cGVjdChzZXJ2aWNlKS50b0JlVHJ1dGh5KCk7CiAgfSk7CgogIGl0KCdzaG91bGQgcmV0dXJuIGdyZWV0aW5nIG1lc3NhZ2UnLCAoKSA9PiB7CiAgICBleHBlY3Qoc2VydmljZS5nZXRHcmVldGluZygpKS50b0JlKCdIZWxsbywgV29ybGQhJyk7CiAgfSk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// my-service.service.spec.ts
import { TestBed } from '@angular/core/testing';
import { MyService } from './my-service.service';

describe('MyService', () =&gt; {
  let service: MyService;

  beforeEach(() =&gt; {
    TestBed.configureTestingModule({});
    service = TestBed.inject(MyService);
  });

  it('should be created', () =&gt; {
    expect(service).toBeTruthy();
  });

  it('should return greeting message', () =&gt; {
    expect(service.getGreeting()).toBe('Hello, World!');
  });
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>TestBed</strong>: L'API principal d'Angular per configurar i inicialitzar l'entorn per a proves unitàries.</li>
<li><strong>beforeEach</strong>: Una funció de Jasmine que s'executa abans de cada prova. Configura el mòdul de proves i injecta el servei.</li>
<li><strong>it</strong>: Defineix un únic cas de prova. La primera prova comprova si el servei es crea, i la segona prova comprova si el mètode <code>getGreeting</code> retorna el missatge correcte.</li>
</ul>
</div><h1>Proves avançades de serveis</h1>
<div class='content'><p>A mesura que avancis, potser necessitaràs provar serveis que depenen d'altres serveis o recursos externs.</p>
</div><h2>Simulació de dependències</h2>
<div class='content'><p>Quan un servei depèn d'un altre servei, pots simular les dependències per aïllar la unitat sota prova.</p>
<h4>Exemple de servei amb dependència</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZGF0YS5zZXJ2aWNlLnRzCmltcG9ydCB7IEluamVjdGFibGUgfSBmcm9tICdAYW5ndWxhci9jb3JlJzsKCkBJbmplY3RhYmxlKHsKICBwcm92aWRlZEluOiAncm9vdCcKfSkKZXhwb3J0IGNsYXNzIERhdGFTZXJ2aWNlIHsKICBnZXREYXRhKCk6IHN0cmluZyB7CiAgICByZXR1cm4gJ1JlYWwgRGF0YSc7CiAgfQp9CgovLyBkZXBlbmRlbnQuc2VydmljZS50cwppbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7CmltcG9ydCB7IERhdGFTZXJ2aWNlIH0gZnJvbSAnLi9kYXRhLnNlcnZpY2UnOwoKQEluamVjdGFibGUoewogIHByb3ZpZGVkSW46ICdyb290Jwp9KQpleHBvcnQgY2xhc3MgRGVwZW5kZW50U2VydmljZSB7CiAgY29uc3RydWN0b3IocHJpdmF0ZSBkYXRhU2VydmljZTogRGF0YVNlcnZpY2UpIHsgfQoKICBnZXRQcm9jZXNzZWREYXRhKCk6IHN0cmluZyB7CiAgICByZXR1cm4gdGhpcy5kYXRhU2VydmljZS5nZXREYXRhKCkgKyAnIFByb2Nlc3NlZCc7CiAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// data.service.ts
import { Injectable } from '@angular/core';

@Injectable({
  providedIn: 'root'
})
export class DataService {
  getData(): string {
    return 'Real Data';
  }
}

// dependent.service.ts
import { Injectable } from '@angular/core';
import { DataService } from './data.service';

@Injectable({
  providedIn: 'root'
})
export class DependentService {
  constructor(private dataService: DataService) { }

  getProcessedData(): string {
    return this.dataService.getData() + ' Processed';
  }
}</pre></div><div class='content'><h4>Escriure proves amb simulacions</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZGVwZW5kZW50LnNlcnZpY2Uuc3BlYy50cwppbXBvcnQgeyBUZXN0QmVkIH0gZnJvbSAnQGFuZ3VsYXIvY29yZS90ZXN0aW5nJzsKaW1wb3J0IHsgRGVwZW5kZW50U2VydmljZSB9IGZyb20gJy4vZGVwZW5kZW50LnNlcnZpY2UnOwppbXBvcnQgeyBEYXRhU2VydmljZSB9IGZyb20gJy4vZGF0YS5zZXJ2aWNlJzsKCmNsYXNzIE1vY2tEYXRhU2VydmljZSB7CiAgZ2V0RGF0YSgpIHsKICAgIHJldHVybiAnTW9jayBEYXRhJzsKICB9Cn0KCmRlc2NyaWJlKCdEZXBlbmRlbnRTZXJ2aWNlJywgKCkgPT4gewogIGxldCBzZXJ2aWNlOiBEZXBlbmRlbnRTZXJ2aWNlOwogIGxldCBkYXRhU2VydmljZTogRGF0YVNlcnZpY2U7CgogIGJlZm9yZUVhY2goKCkgPT4gewogICAgVGVzdEJlZC5jb25maWd1cmVUZXN0aW5nTW9kdWxlKHsKICAgICAgcHJvdmlkZXJzOiBbCiAgICAgICAgRGVwZW5kZW50U2VydmljZSwKICAgICAgICB7IHByb3ZpZGU6IERhdGFTZXJ2aWNlLCB1c2VDbGFzczogTW9ja0RhdGFTZXJ2aWNlIH0KICAgICAgXQogICAgfSk7CiAgICBzZXJ2aWNlID0gVGVzdEJlZC5pbmplY3QoRGVwZW5kZW50U2VydmljZSk7CiAgICBkYXRhU2VydmljZSA9IFRlc3RCZWQuaW5qZWN0KERhdGFTZXJ2aWNlKTsKICB9KTsKCiAgaXQoJ3Nob3VsZCBiZSBjcmVhdGVkJywgKCkgPT4gewogICAgZXhwZWN0KHNlcnZpY2UpLnRvQmVUcnV0aHkoKTsKICB9KTsKCiAgaXQoJ3Nob3VsZCByZXR1cm4gcHJvY2Vzc2VkIGRhdGEnLCAoKSA9PiB7CiAgICBleHBlY3Qoc2VydmljZS5nZXRQcm9jZXNzZWREYXRhKCkpLnRvQmUoJ01vY2sgRGF0YSBQcm9jZXNzZWQnKTsKICB9KTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// dependent.service.spec.ts
import { TestBed } from '@angular/core/testing';
import { DependentService } from './dependent.service';
import { DataService } from './data.service';

class MockDataService {
  getData() {
    return 'Mock Data';
  }
}

describe('DependentService', () =&gt; {
  let service: DependentService;
  let dataService: DataService;

  beforeEach(() =&gt; {
    TestBed.configureTestingModule({
      providers: [
        DependentService,
        { provide: DataService, useClass: MockDataService }
      ]
    });
    service = TestBed.inject(DependentService);
    dataService = TestBed.inject(DataService);
  });

  it('should be created', () =&gt; {
    expect(service).toBeTruthy();
  });

  it('should return processed data', () =&gt; {
    expect(service.getProcessedData()).toBe('Mock Data Processed');
  });
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>MockDataService</strong>: Una classe simulada que simula el comportament de <code>DataService</code>.</li>
<li><strong>providers</strong>: Configura el mòdul de proves per utilitzar <code>MockDataService</code> en lloc del <code>DataService</code> real.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Les proves de serveis a Angular són essencials per assegurar la fiabilitat i correcció de la lògica de negoci de la teva aplicació. Configurant un entorn de proves adequat, escrivint proves bàsiques i utilitzant tècniques avançades com la simulació de dependències, pots crear proves robustes i mantenibles per als teus serveis Angular. Recorda executar les teves proves freqüentment i integrar-les en el teu flux de treball de desenvolupament per detectar problemes aviat i millorar la qualitat del codi.</p>
</div><div class='row navigation'><div class='col-6'><a href='component-testing'>&#x25C4; Proves de components</a></div><div class='col-6 text-end'><a href='end-to-end-testing'>Proves de cap a cap &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
