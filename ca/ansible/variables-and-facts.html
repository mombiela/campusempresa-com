<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Variables i Fets en Ansible</title>

    <link rel="alternate" href="https://campusempresa.com/es/ansible/variables-and-facts" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/ansible/variables-and-facts" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/ansible/variables-and-facts" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/ansible/variables-and-facts" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='running-ad-hoc-commands'>&#x25C4;Executant Comandes Ad-Hoc</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Variables i Fets en Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='conditionals-and-loops'>Condicionals i Bucles &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En Ansible, les variables i els fets són components essencials que et permeten gestionar i manipular dades de manera dinàmica. Entendre com utilitzar-los efectivament pot millorar significativament els teus scripts d'automatització.</p>
</div><h1>Variables en Ansible</h1>
<div class='content'><p>Les variables en Ansible s'utilitzen per emmagatzemar valors que es poden reutilitzar al llarg dels teus playbooks. Ajuden a fer que els teus playbooks siguin més flexibles i fàcils de mantenir.</p>
</div><h2>Definició de Variables</h2>
<div class='content'><p>Les variables es poden definir en diversos llocs:</p>
<ul>
<li><strong>Playbooks</strong></li>
<li><strong>Fitxers d'inventari</strong></li>
<li><strong>Rols</strong></li>
<li><strong>Variables de grup i host</strong></li>
</ul>
<h4>Exemple: Definició de Variables en un Playbook</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0tCi0gbmFtZTogRXhlbXBsZSBkZSBQbGF5Ym9vawogIGhvc3RzOiBhbGwKICB2YXJzOgogICAgaHR0cF9wb3J0OiA4MAogICAgbWF4X2NsaWVudHM6IDIwMAogIHRhc2tzOgogICAgLSBuYW1lOiBJbXByaW1pciBlbCBwb3J0IEhUVFAKICAgICAgZGVidWc6CiAgICAgICAgbXNnOiAiRWwgcG9ydCBIVFRQIMOpcyB7eyBodHRwX3BvcnQgfX0iCiAgICAtIG5hbWU6IEltcHJpbWlyIGVsIG3DoHhpbSBkZSBjbGllbnRzCiAgICAgIGRlYnVnOgogICAgICAgIG1zZzogIkVsIG3DoHhpbSBkZSBjbGllbnRzIMOpcyB7eyBtYXhfY2xpZW50cyB9fSI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>---
- name: Exemple de Playbook
  hosts: all
  vars:
    http_port: 80
    max_clients: 200
  tasks:
    - name: Imprimir el port HTTP
      debug:
        msg: &quot;El port HTTP &eacute;s {{ http_port }}&quot;
    - name: Imprimir el m&agrave;xim de clients
      debug:
        msg: &quot;El m&agrave;xim de clients &eacute;s {{ max_clients }}&quot;</pre></div><div class='content'></div><h2>Ús de Variables</h2>
<div class='content'><p>Les variables es referencien utilitzant doble claudàtor <code>{{ }}</code>.</p>
<h4>Exemple: Ús de Variables en una Tasca</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbnN0YWzCt2xhciBBcGFjaGUKICBhcHQ6CiAgICBuYW1lOiBhcGFjaGUyCiAgICBzdGF0ZTogcHJlc2VudAoKLSBuYW1lOiBDb25maWd1cmFyIEFwYWNoZQogIHRlbXBsYXRlOgogICAgc3JjOiB0ZW1wbGF0ZXMvYXBhY2hlMi5jb25mLmoyCiAgICBkZXN0OiAvZXRjL2FwYWNoZTIvYXBhY2hlMi5jb25mCiAgdmFyczoKICAgIHNlcnZlcl9wb3J0OiA4MDgw"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Instal&middot;lar Apache
  apt:
    name: apache2
    state: present

- name: Configurar Apache
  template:
    src: templates/apache2.conf.j2
    dest: /etc/apache2/apache2.conf
  vars:
    server_port: 8080</pre></div><div class='content'></div><h2>Precedència de Variables</h2>
<div class='content'><p>Les variables d'Ansible tenen un ordre específic de precedència, que determina quin valor de variable s'utilitza quan hi ha múltiples definicions.</p>
<p>| Nivell de Precedència | Font |
|-----------------------|------|
| 1 (Més Alt)           | Extra vars (<code>-e</code> en la línia de comandes) |
| 2                     | Task vars (només per a la tasca) |
| 3                     | Block vars (només per a tasques en el bloc) |
| 4                     | Role i include vars (amb <code>include_vars</code>) |
| 5                     | Play vars_files |
| 6                     | Play vars_prompt |
| 7                     | Play vars |
| 8                     | Host facts / cached facts |
| 9                     | Host vars |
| 10                    | Group vars |
| 11                    | Inventory vars |
| 12 (Més Baix)         | Default vars (definides en rols) |</p>
</div><h1>Fets en Ansible</h1>
<div class='content'><p>Els fets són peces d'informació sobre els nodes gestionats, com ara adreces IP, detalls del sistema operatiu i informació del maquinari. Ansible recull automàticament els fets al començament de l'execució d'un playbook.</p>
</div><h2>Recollida de Fets</h2>
<div class='content'><p>Per defecte, Ansible recull fets utilitzant el mòdul <code>setup</code>.</p>
<h4>Exemple: Recollida de Fets</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBSZWNvbGxpciBmZXRzCiAgaG9zdHM6IGFsbAogIHRhc2tzOgogICAgLSBuYW1lOiBNb3N0cmFyIHRvdHMgZWxzIGZldHMKICAgICAgZGVidWc6CiAgICAgICAgdmFyOiBhbnNpYmxlX2ZhY3Rz"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Recollir fets
  hosts: all
  tasks:
    - name: Mostrar tots els fets
      debug:
        var: ansible_facts</pre></div><div class='content'></div><h2>Ús de Fets</h2>
<div class='content'><p>Els fets es poden utilitzar igual que les variables en els teus playbooks.</p>
<h4>Exemple: Ús de Fets en una Tasca</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbXByaW1pciBlbCBzaXN0ZW1hIG9wZXJhdGl1CiAgZGVidWc6CiAgICBtc2c6ICJFbCBzaXN0ZW1hIG9wZXJhdGl1IMOpcyB7eyBhbnNpYmxlX2ZhY3RzWydvc19mYW1pbHknXSB9fSI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Imprimir el sistema operatiu
  debug:
    msg: &quot;El sistema operatiu &eacute;s {{ ansible_facts['os_family'] }}&quot;</pre></div><div class='content'></div><h2>Fets Personalitzats</h2>
<div class='content'><p>També pots definir fets personalitzats col·locant scripts al directori <code>/etc/ansible/facts.d</code> en els nodes gestionats.</p>
<h4>Exemple: Script de Fet Personalitzat</h4>
<p>Crea un script anomenat <code>custom_fact.sh</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyEvYmluL2Jhc2gKZWNobyAneyJjdXN0b21fZmFjdCI6ICJjdXN0b21fdmFsdWUifSc="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#!/bin/bash
echo '{&quot;custom_fact&quot;: &quot;custom_value&quot;}'</pre></div><div class='content'><p>Col·loca l'script a <code>/etc/ansible/facts.d/custom_fact.sh</code> i fes-lo executable.</p>
<h4>Exemple: Ús de Fets Personalitzats</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LSBuYW1lOiBJbXByaW1pciBmZXQgcGVyc29uYWxpdHphdAogIGRlYnVnOgogICAgbXNnOiAiRWwgZmV0IHBlcnNvbmFsaXR6YXQgw6lzIHt7IGFuc2libGVfZmFjdHNbJ2N1c3RvbV9mYWN0J10gfX0i"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>- name: Imprimir fet personalitzat
  debug:
    msg: &quot;El fet personalitzat &eacute;s {{ ansible_facts['custom_fact'] }}&quot;</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Entendre i utilitzar efectivament les variables i els fets en Ansible és crucial per crear playbooks dinàmics i flexibles. Les variables et permeten emmagatzemar i reutilitzar valors, mentre que els fets proporcionen informació detallada sobre els teus nodes gestionats. Dominant aquests conceptes, podràs escriure scripts d'automatització més eficients i fàcils de mantenir.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='running-ad-hoc-commands'>&#x25C4;Executant Comandes Ad-Hoc</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Variables i Fets en Ansible</a>
	</div>
	<div class='col-4 text-end'>
					<a href='conditionals-and-loops'>Condicionals i Bucles &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
