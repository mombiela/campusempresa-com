<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Provar el codi d'Ansible</title>

    <link rel="alternate" href="https://campusempresa.com/es/ansible/testing-ansible-code" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/ansible/testing-ansible-code" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/ansible/testing-ansible-code" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/ansible/testing-ansible-code" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>Provar el teu codi d'Ansible és crucial per assegurar-te que els teus scripts d'automatització funcionen com s'espera i no introdueixen errors a la teva infraestructura. Aquesta secció cobrirà diverses metodologies i eines per provar el codi d'Ansible, des de comprovacions bàsiques de sintaxi fins a proves d'integració més avançades.</p>
</div><h1>Conceptes clau</h1>
<div class='content'><ul>
<li><strong>Comprovació de sintaxi</strong>: Assegurar que els teus playbooks i rols estan lliures d'errors de sintaxi.</li>
<li><strong>Linting</strong>: Utilitzar eines per fer complir els estàndards de codificació i les millors pràctiques.</li>
<li><strong>Proves unitàries</strong>: Provar tasques o rols individuals de manera aïllada.</li>
<li><strong>Proves d'integració</strong>: Provar el playbook complet en un entorn controlat.</li>
<li><strong>Integració contínua (CI)</strong>: Automatitzar el procés de prova utilitzant eines de CI.</li>
</ul>
</div><h1>Comprovació de sintaxi</h1>
<div class='content'><p>Abans d'executar els teus playbooks d'Ansible, és essencial comprovar si hi ha errors de sintaxi. Ansible proporciona una comanda integrada per a aquest propòsit.</p>
</div><h2>Exemple</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1wbGF5Ym9vayAtLXN5bnRheC1jaGVjayB5b3VyX3BsYXlib29rLnltbA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-playbook --syntax-check your_playbook.yml</pre></div><div class='content'><p>Aquesta comanda analitzarà el playbook i informarà de qualsevol error de sintaxi sense executar-lo.</p>
</div><h1>Linting</h1>
<div class='content'><p>Les eines de linting t'ajuden a adherir-te als estàndards de codificació i les millors pràctiques. <code>ansible-lint</code> és una eina popular per a aquest propòsit.</p>
</div><h2>Exemple</h2>
<div class='content'><p>Primer, instal·la <code>ansible-lint</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgYW5zaWJsZS1saW50"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install ansible-lint</pre></div><div class='content'><p>Després, executa'l contra el teu playbook:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YW5zaWJsZS1saW50IHlvdXJfcGxheWJvb2sueW1s"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ansible-lint your_playbook.yml</pre></div><div class='content'><p>Això mostrarà qualsevol problema trobat en el teu playbook, com ara mòduls obsolets o formatació incorrecta.</p>
</div><h1>Proves unitàries</h1>
<div class='content'><p>Les proves unitàries en Ansible impliquen provar rols o tasques individuals. <code>molecule</code> és una eina àmpliament utilitzada per a aquest propòsit.</p>
</div><h2>Exemple</h2>
<div class='content'><p>Primer, instal·la <code>molecule</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgbW9sZWN1bGU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install molecule</pre></div><div class='content'><p>Inicialitza un nou rol amb <code>molecule</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9sZWN1bGUgaW5pdCByb2xlIG15X3JvbGU="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>molecule init role my_role</pre></div><div class='content'><p>Això crearà una estructura de directoris per al teu rol, incloent-hi un directori <code>molecule</code> per a les proves. Pots escriure les proves al directori <code>molecule/default/tests</code>.</p>
<p>Executa les proves amb:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9sZWN1bGUgdGVzdA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>molecule test</pre></div><div class='content'></div><h1>Proves d'integració</h1>
<div class='content'><p>Les proves d'integració impliquen executar el teu playbook complet en un entorn controlat per assegurar-te que tots els components funcionen junts com s'espera. També pots utilitzar <code>molecule</code> per a les proves d'integració.</p>
</div><h2>Exemple</h2>
<div class='content'><p>Crea un escenari de <code>molecule</code> per al teu playbook:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9sZWN1bGUgaW5pdCBzY2VuYXJpbyAtLWRyaXZlci1uYW1lIGRvY2tlcg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>molecule init scenario --driver-name docker</pre></div><div class='content'><p>Això configurarà un entorn basat en Docker per provar el teu playbook. Pots escriure les proves del teu playbook al directori <code>molecule/default/tests</code> i executar-les amb:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9sZWN1bGUgdGVzdA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>molecule test</pre></div><div class='content'></div><h1>Integració contínua (CI)</h1>
<div class='content'><p>Automatitzar el teu procés de prova utilitzant eines de CI com Jenkins, Travis CI o GitHub Actions assegura que el teu codi d'Ansible es prova cada vegada que fas canvis.</p>
</div><h2>Exemple: GitHub Actions</h2>
<div class='content'><p>Crea un fitxer <code>.github/workflows/ci.yml</code> al teu repositori:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bmFtZTogQ0kKCm9uOiBbcHVzaCwgcHVsbF9yZXF1ZXN0XQoKam9iczoKICB0ZXN0OgogICAgcnVucy1vbjogdWJ1bnR1LWxhdGVzdAogICAgc3RlcHM6CiAgICAgIC0gdXNlczogYWN0aW9ucy9jaGVja291dEB2MgogICAgICAtIG5hbWU6IFNldCB1cCBQeXRob24KICAgICAgICB1c2VzOiBhY3Rpb25zL3NldHVwLXB5dGhvbkB2MgogICAgICAgIHdpdGg6CiAgICAgICAgICBweXRob24tdmVyc2lvbjogJzMueCcKICAgICAgLSBuYW1lOiBJbnN0YWxsIGRlcGVuZGVuY2llcwogICAgICAgIHJ1bjogfAogICAgICAgICAgcHl0aG9uIC1tIHBpcCBpbnN0YWxsIC0tdXBncmFkZSBwaXAKICAgICAgICAgIHBpcCBpbnN0YWxsIGFuc2libGUgYW5zaWJsZS1saW50IG1vbGVjdWxlIGRvY2tlcgogICAgICAtIG5hbWU6IFJ1biBBbnNpYmxlIExpbnQKICAgICAgICBydW46IGFuc2libGUtbGludCB5b3VyX3BsYXlib29rLnltbAogICAgICAtIG5hbWU6IFJ1biBNb2xlY3VsZSBUZXN0cwogICAgICAgIHJ1bjogbW9sZWN1bGUgdGVzdA=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>name: CI

on: [push, pull_request]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: '3.x'
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install ansible ansible-lint molecule docker
      - name: Run Ansible Lint
        run: ansible-lint your_playbook.yml
      - name: Run Molecule Tests
        run: molecule test</pre></div><div class='content'><p>Aquesta configuració executarà <code>ansible-lint</code> i les proves de <code>molecule</code> cada vegada que enviïs canvis al teu repositori o creïs una sol·licitud d'extracció.</p>
</div><h1>Conclusió</h1>
<div class='content'><p>Provar el teu codi d'Ansible és un procés en múltiples passos que inclou la comprovació de sintaxi, linting, proves unitàries, proves d'integració i integració contínua. Incorporant aquestes pràctiques al teu flux de treball, pots assegurar-te que els teus scripts d'automatització són fiables, mantenibles i lliures d'errors.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
