<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Async/Await a Node.js</title>

    <link rel="alternate" href="https://campusempresa.com/es/nodejs/async-await" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nodejs/async-await" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nodejs/async-await" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/nodejs/async-await" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció a Async/Await</h1>
<div class='content'><p>Async/Await és una manera moderna de gestionar operacions asíncrones en JavaScript, fent que el codi sigui més fàcil de llegir i escriure en comparació amb mètodes tradicionals com callbacks i promeses.</p>
<ul>
<li><strong>Async</strong>: Declara una funció com a asíncrona, permetent l'ús de <code>await</code> dins d'ella.</li>
<li><strong>Await</strong>: Pausa l'execució d'una funció asíncrona fins que una promesa es resol o es rebutja.</li>
</ul>
</div><h1>Per què utilitzar Async/Await?</h1>
<div class='content'><ul>
<li><strong>Llegibilitat</strong>: El codi sembla síncron, fent-lo més fàcil d'entendre.</li>
<li><strong>Gestió d'errors</strong>: Simplifica la gestió d'errors amb blocs <code>try/catch</code>.</li>
<li><strong>Enllaçament</strong>: Evita la complexitat d'enllaçar múltiples crides <code>.then()</code>.</li>
</ul>
</div><h1>Sintaxi bàsica</h1>
<h2>Funció Async</h2>
<div class='content'><p>Per definir una funció asíncrona, utilitza la paraula clau <code>async</code> abans de la declaració de la funció.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXN5bmMgZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogIC8vIGNvcyBkZSBsYSBmdW5jacOzCn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>async function fetchData() {
  // cos de la funci&oacute;
}</pre></div><div class='content'></div><h2>Paraula clau Await</h2>
<div class='content'><p>Utilitza la paraula clau <code>await</code> per pausar l'execució de la funció asíncrona fins que la promesa es resol.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXN5bmMgZnVuY3Rpb24gZmV0Y2hEYXRhKCkgewogIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEnKTsKICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpOwogIHJldHVybiBkYXRhOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>async function fetchData() {
  const response = await fetch('https://api.example.com/data');
  const data = await response.json();
  return data;
}</pre></div><div class='content'></div><h1>Exemple: Obtenint dades d'una API</h1>
<div class='content'><p>Vegem un exemple senzill d'obtenció de dades d'una API utilitzant async/await.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZmV0Y2ggPSByZXF1aXJlKCdub2RlLWZldGNoJyk7Cgphc3luYyBmdW5jdGlvbiBnZXRVc2VyRGF0YSh1c2VySWQpIHsKICB0cnkgewogICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3VzZXJzLyR7dXNlcklkfWApOwogICAgY29uc3QgdXNlciA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTsKICAgIGNvbnNvbGUubG9nKHVzZXIpOwogIH0gY2F0Y2ggKGVycm9yKSB7CiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBvYnRlbmludCBkYWRlcyBkZSBsJ3VzdWFyaTonLCBlcnJvcik7CiAgfQp9CgpnZXRVc2VyRGF0YSgxKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fetch = require('node-fetch');

async function getUserData(userId) {
  try {
    const response = await fetch(`https://jsonplaceholder.typicode.com/users/${userId}`);
    const user = await response.json();
    console.log(user);
  } catch (error) {
    console.error('Error obtenint dades de l'usuari:', error);
  }
}

getUserData(1);</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>fetch</strong>: Utilitzat per fer sol·licituds HTTP.</li>
<li><strong>await fetch</strong>: Espera que la crida fetch es completi.</li>
<li><strong>await response.json()</strong>: Espera que la resposta es converteixi a JSON.</li>
<li><strong>try/catch</strong>: Gestiona qualsevol error que es produeixi durant les operacions asíncrones.</li>
</ul>
</div><h1>Gestionant múltiples promeses</h1>
<div class='content'><p>Pots utilitzar <code>await</code> amb múltiples promeses utilitzant <code>Promise.all</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXN5bmMgZnVuY3Rpb24gZ2V0TXVsdGlwbGVVc2Vycyh1c2VySWRzKSB7CiAgdHJ5IHsKICAgIGNvbnN0IHVzZXJQcm9taXNlcyA9IHVzZXJJZHMubWFwKGlkID0+IGZldGNoKGBodHRwczovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vdXNlcnMvJHtpZH1gKSk7CiAgICBjb25zdCByZXNwb25zZXMgPSBhd2FpdCBQcm9taXNlLmFsbCh1c2VyUHJvbWlzZXMpOwogICAgY29uc3QgdXNlcnMgPSBhd2FpdCBQcm9taXNlLmFsbChyZXNwb25zZXMubWFwKHJlcyA9PiByZXMuanNvbigpKSk7CiAgICBjb25zb2xlLmxvZyh1c2Vycyk7CiAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIG9idGVuaW50IG3Dumx0aXBsZXMgdXN1YXJpczonLCBlcnJvcik7CiAgfQp9CgpnZXRNdWx0aXBsZVVzZXJzKFsxLCAyLCAzXSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>async function getMultipleUsers(userIds) {
  try {
    const userPromises = userIds.map(id =&gt; fetch(`https://jsonplaceholder.typicode.com/users/${id}`));
    const responses = await Promise.all(userPromises);
    const users = await Promise.all(responses.map(res =&gt; res.json()));
    console.log(users);
  } catch (error) {
    console.error('Error obtenint m&uacute;ltiples usuaris:', error);
  }
}

getMultipleUsers([1, 2, 3]);</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>userPromises</strong>: Array de promeses per obtenir dades d'usuaris.</li>
<li><strong>Promise.all(userPromises)</strong>: Espera que totes les promeses fetch es resolguin.</li>
<li><strong>responses.map(res =&gt; res.json())</strong>: Converteix cada resposta a JSON.</li>
<li><strong>Promise.all</strong>: Espera que totes les promeses de conversió a JSON es resolguin.</li>
</ul>
</div><h1>Conceptes avançats</h1>
<h2>Execució seqüencial vs paral·lela</h2>
<div class='content'><ul>
<li><strong>Seqüencial</strong>: Cada operació espera que l'anterior es completi.</li>
<li><strong>Paral·lela</strong>: Múltiples operacions s'executen simultàniament.</li>
</ul>
<h4>Exemple seqüencial</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXN5bmMgZnVuY3Rpb24gZmV0Y2hTZXF1ZW50aWFsKCkgewogIGNvbnN0IHVzZXIxID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS91c2Vycy8xJykudGhlbihyZXMgPT4gcmVzLmpzb24oKSk7CiAgY29uc3QgdXNlcjIgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9qc29ucGxhY2Vob2xkZXIudHlwaWNvZGUuY29tL3VzZXJzLzInKS50aGVuKHJlcyA9PiByZXMuanNvbigpKTsKICBjb25zb2xlLmxvZyh1c2VyMSwgdXNlcjIpOwp9CgpmZXRjaFNlcXVlbnRpYWwoKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>async function fetchSequential() {
  const user1 = await fetch('https://jsonplaceholder.typicode.com/users/1').then(res =&gt; res.json());
  const user2 = await fetch('https://jsonplaceholder.typicode.com/users/2').then(res =&gt; res.json());
  console.log(user1, user2);
}

fetchSequential();</pre></div><div class='content'><h4>Exemple paral·lel</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXN5bmMgZnVuY3Rpb24gZmV0Y2hQYXJhbGxlbCgpIHsKICBjb25zdCBbdXNlcjEsIHVzZXIyXSA9IGF3YWl0IFByb21pc2UuYWxsKFsKICAgIGZldGNoKCdodHRwczovL2pzb25wbGFjZWhvbGRlci50eXBpY29kZS5jb20vdXNlcnMvMScpLnRoZW4ocmVzID0+IHJlcy5qc29uKCkpLAogICAgZmV0Y2goJ2h0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS91c2Vycy8yJykudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICBdKTsKICBjb25zb2xlLmxvZyh1c2VyMSwgdXNlcjIpOwp9CgpmZXRjaFBhcmFsbGVsKCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>async function fetchParallel() {
  const [user1, user2] = await Promise.all([
    fetch('https://jsonplaceholder.typicode.com/users/1').then(res =&gt; res.json()),
    fetch('https://jsonplaceholder.typicode.com/users/2').then(res =&gt; res.json())
  ]);
  console.log(user1, user2);
}

fetchParallel();</pre></div><div class='content'></div><h2>Gestió d'errors amb múltiples promeses</h2>
<div class='content'><p>Quan utilitzes <code>Promise.all</code>, si una promesa falla, tota l'operació falla. Pots gestionar això embolicant cada promesa en un bloc try/catch o utilitzant <code>Promise.allSettled</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXN5bmMgZnVuY3Rpb24gZmV0Y2hXaXRoRXJyb3JIYW5kbGluZygpIHsKICBjb25zdCB1c2VyUHJvbWlzZXMgPSBbMSwgMiwgM10ubWFwKGlkID0+IAogICAgZmV0Y2goYGh0dHBzOi8vanNvbnBsYWNlaG9sZGVyLnR5cGljb2RlLmNvbS91c2Vycy8ke2lkfWApCiAgICAgIC50aGVuKHJlcyA9PiByZXMuanNvbigpKQogICAgICAuY2F0Y2goZXJyb3IgPT4gKHsgZXJyb3IgfSkpCiAgKTsKICBjb25zdCB1c2VycyA9IGF3YWl0IFByb21pc2UuYWxsKHVzZXJQcm9taXNlcyk7CiAgY29uc29sZS5sb2codXNlcnMpOwp9CgpmZXRjaFdpdGhFcnJvckhhbmRsaW5nKCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>async function fetchWithErrorHandling() {
  const userPromises = [1, 2, 3].map(id =&gt; 
    fetch(`https://jsonplaceholder.typicode.com/users/${id}`)
      .then(res =&gt; res.json())
      .catch(error =&gt; ({ error }))
  );
  const users = await Promise.all(userPromises);
  console.log(users);
}

fetchWithErrorHandling();</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Async/Await simplifica la programació asíncrona a Node.js fent que el codi sigui més llegible i fàcil de gestionar. Permet una gestió d'errors directa i pot gestionar múltiples operacions asíncrones de manera eficient. Entenent i utilitzant async/await, pots escriure codi més net i més fàcil de mantenir.</p>
<ul>
<li><strong>Punts clau</strong>:
<ul>
<li>Utilitza <code>async</code> per declarar una funció asíncrona.</li>
<li>Utilitza <code>await</code> per pausar l'execució fins que una promesa es resolgui.</li>
<li>Gestiona errors utilitzant blocs <code>try/catch</code>.</li>
<li>Utilitza <code>Promise.all</code> per a l'execució paral·lela de múltiples promeses.</li>
<li>Considera estratègies de gestió d'errors per a múltiples promeses.</li>
</ul>
</li>
</ul>
<p>Dominant async/await, estaràs ben preparat per gestionar operacions asíncrones complexes en les teves aplicacions Node.js.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
