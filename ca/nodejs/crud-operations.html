<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realització d'operacions CRUD</title>

    <link rel="alternate" href="https://campusempresa.com/es/nodejs/crud-operations" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nodejs/crud-operations" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nodejs/crud-operations" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/nodejs/crud-operations" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>Les operacions CRUD (Crear, Llegir, Actualitzar, Eliminar) són fonamentals per interactuar amb bases de dades en qualsevol aplicació. Aquesta secció et guiarà a través de la realització d'operacions CRUD utilitzant Node.js, des de nivells bàsics fins a avançats.</p>
</div><h1>Introducció a les operacions CRUD</h1>
<div class='content'><ul>
<li><strong>Crear</strong>: Afegir noves dades a la base de dades.</li>
<li><strong>Llegir</strong>: Recuperar dades de la base de dades.</li>
<li><strong>Actualitzar</strong>: Modificar dades existents a la base de dades.</li>
<li><strong>Eliminar</strong>: Eliminar dades de la base de dades.</li>
</ul>
</div><h1>Configuració de l'entorn</h1>
<div class='content'><p>Abans d'endinsar-nos en les operacions CRUD, assegura't de tenir instal·lat el següent:</p>
<ul>
<li>Node.js</li>
<li>npm (Node Package Manager)</li>
<li>MongoDB (per a operacions de base de dades)</li>
</ul>
</div><h2>Instal·lació de paquets necessaris</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluaXQgLXkKbnBtIGluc3RhbGwgZXhwcmVzcyBtb25nb29zZSBib2R5LXBhcnNlcg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm init -y
npm install express mongoose body-parser</pre></div><div class='content'><ul>
<li><strong>express</strong>: Un framework web per a Node.js.</li>
<li><strong>mongoose</strong>: Una biblioteca ODM (Object Data Modeling) per a MongoDB i Node.js.</li>
<li><strong>body-parser</strong>: Middleware per analitzar els cossos de les sol·licituds entrants.</li>
</ul>
</div><h1>Connexió a MongoDB</h1>
<div class='content'><p>Crea un fitxer anomenat <code>app.js</code> i configura la connexió a MongoDB.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZXhwcmVzcyA9IHJlcXVpcmUoJ2V4cHJlc3MnKTsKY29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwpjb25zdCBib2R5UGFyc2VyID0gcmVxdWlyZSgnYm9keS1wYXJzZXInKTsKCmNvbnN0IGFwcCA9IGV4cHJlc3MoKTsKYXBwLnVzZShib2R5UGFyc2VyLmpzb24oKSk7Cgptb25nb29zZS5jb25uZWN0KCdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2NydWREQicsIHsgdXNlTmV3VXJsUGFyc2VyOiB0cnVlLCB1c2VVbmlmaWVkVG9wb2xvZ3k6IHRydWUgfSkKICAudGhlbigoKSA9PiBjb25zb2xlLmxvZygnTW9uZ29EQiBjb25uZWN0ZWQnKSkKICAuY2F0Y2goZXJyID0+IGNvbnNvbGUubG9nKGVycikpOwoKY29uc3QgcG9ydCA9IDMwMDA7CmFwcC5saXN0ZW4ocG9ydCwgKCkgPT4gewogIGNvbnNvbGUubG9nKGBTZXJ2ZXIgcnVubmluZyBvbiBwb3J0ICR7cG9ydH1gKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const express = require('express');
const mongoose = require('mongoose');
const bodyParser = require('body-parser');

const app = express();
app.use(bodyParser.json());

mongoose.connect('mongodb://localhost:27017/crudDB', { useNewUrlParser: true, useUnifiedTopology: true })
  .then(() =&gt; console.log('MongoDB connected'))
  .catch(err =&gt; console.log(err));

const port = 3000;
app.listen(port, () =&gt; {
  console.log(`Server running on port ${port}`);
});</pre></div><div class='content'></div><h1>Definició d'un esquema i model de Mongoose</h1>
<div class='content'><p>Crea un directori <code>models</code> i dins d'ell, crea un fitxer anomenat <code>Item.js</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgbW9uZ29vc2UgPSByZXF1aXJlKCdtb25nb29zZScpOwoKY29uc3QgaXRlbVNjaGVtYSA9IG5ldyBtb25nb29zZS5TY2hlbWEoewogIG5hbWU6IHsKICAgIHR5cGU6IFN0cmluZywKICAgIHJlcXVpcmVkOiB0cnVlCiAgfSwKICBxdWFudGl0eTogewogICAgdHlwZTogTnVtYmVyLAogICAgcmVxdWlyZWQ6IHRydWUKICB9Cn0pOwoKbW9kdWxlLmV4cG9ydHMgPSBtb25nb29zZS5tb2RlbCgnSXRlbScsIGl0ZW1TY2hlbWEpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const mongoose = require('mongoose');

const itemSchema = new mongoose.Schema({
  name: {
    type: String,
    required: true
  },
  quantity: {
    type: Number,
    required: true
  }
});

module.exports = mongoose.model('Item', itemSchema);</pre></div><div class='content'></div><h1>Operació de Creació</h1>
<div class='content'></div><h2>Afegir un nou element</h2>
<div class='content'><p>A <code>app.js</code>, afegeix una ruta per gestionar la creació d'un nou element.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgSXRlbSA9IHJlcXVpcmUoJy4vbW9kZWxzL0l0ZW0nKTsKCmFwcC5wb3N0KCcvaXRlbXMnLCBhc3luYyAocmVxLCByZXMpID0+IHsKICBjb25zdCB7IG5hbWUsIHF1YW50aXR5IH0gPSByZXEuYm9keTsKICB0cnkgewogICAgY29uc3QgbmV3SXRlbSA9IG5ldyBJdGVtKHsgbmFtZSwgcXVhbnRpdHkgfSk7CiAgICBhd2FpdCBuZXdJdGVtLnNhdmUoKTsKICAgIHJlcy5zdGF0dXMoMjAxKS5qc29uKG5ld0l0ZW0pOwogIH0gY2F0Y2ggKGVycikgewogICAgcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7CiAgfQp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Item = require('./models/Item');

app.post('/items', async (req, res) =&gt; {
  const { name, quantity } = req.body;
  try {
    const newItem = new Item({ name, quantity });
    await newItem.save();
    res.status(201).json(newItem);
  } catch (err) {
    res.status(400).json({ error: err.message });
  }
});</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquesta ruta escolta les sol·licituds POST a <code>/items</code>, crea un nou element utilitzant les dades del cos de la sol·licitud i el desa a la base de dades.</li>
</ul>
</div><h1>Operació de Lectura</h1>
<div class='content'></div><h2>Recuperar tots els elements</h2>
<div class='content'><p>Afegeix una ruta per obtenir tots els elements.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLmdldCgnL2l0ZW1zJywgYXN5bmMgKHJlcSwgcmVzKSA9PiB7CiAgdHJ5IHsKICAgIGNvbnN0IGl0ZW1zID0gYXdhaXQgSXRlbS5maW5kKCk7CiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihpdGVtcyk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnIubWVzc2FnZSB9KTsKICB9Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.get('/items', async (req, res) =&gt; {
  try {
    const items = await Item.find();
    res.status(200).json(items);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquesta ruta escolta les sol·licituds GET a <code>/items</code> i recupera tots els elements de la base de dades.</li>
</ul>
</div><h2>Recuperar un sol element per ID</h2>
<div class='content'><p>Afegeix una ruta per obtenir un sol element pel seu ID.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLmdldCgnL2l0ZW1zLzppZCcsIGFzeW5jIChyZXEsIHJlcykgPT4gewogIHRyeSB7CiAgICBjb25zdCBpdGVtID0gYXdhaXQgSXRlbS5maW5kQnlJZChyZXEucGFyYW1zLmlkKTsKICAgIGlmICghaXRlbSkgcmV0dXJuIHJlcy5zdGF0dXMoNDA0KS5qc29uKHsgZXJyb3I6ICdJdGVtIG5vdCBmb3VuZCcgfSk7CiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihpdGVtKTsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6IGVyci5tZXNzYWdlIH0pOwogIH0KfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.get('/items/:id', async (req, res) =&gt; {
  try {
    const item = await Item.findById(req.params.id);
    if (!item) return res.status(404).json({ error: 'Item not found' });
    res.status(200).json(item);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquesta ruta escolta les sol·licituds GET a <code>/items/:id</code> i recupera un element específic pel seu ID.</li>
</ul>
</div><h1>Operació d'Actualització</h1>
<div class='content'></div><h2>Actualitzar un element per ID</h2>
<div class='content'><p>Afegeix una ruta per actualitzar un element.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLnB1dCgnL2l0ZW1zLzppZCcsIGFzeW5jIChyZXEsIHJlcykgPT4gewogIGNvbnN0IHsgbmFtZSwgcXVhbnRpdHkgfSA9IHJlcS5ib2R5OwogIHRyeSB7CiAgICBjb25zdCB1cGRhdGVkSXRlbSA9IGF3YWl0IEl0ZW0uZmluZEJ5SWRBbmRVcGRhdGUocmVxLnBhcmFtcy5pZCwgeyBuYW1lLCBxdWFudGl0eSB9LCB7IG5ldzogdHJ1ZSB9KTsKICAgIGlmICghdXBkYXRlZEl0ZW0pIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnSXRlbSBub3QgZm91bmQnIH0pOwogICAgcmVzLnN0YXR1cygyMDApLmpzb24odXBkYXRlZEl0ZW0pOwogIH0gY2F0Y2ggKGVycikgewogICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7CiAgfQp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.put('/items/:id', async (req, res) =&gt; {
  const { name, quantity } = req.body;
  try {
    const updatedItem = await Item.findByIdAndUpdate(req.params.id, { name, quantity }, { new: true });
    if (!updatedItem) return res.status(404).json({ error: 'Item not found' });
    res.status(200).json(updatedItem);
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquesta ruta escolta les sol·licituds PUT a <code>/items/:id</code>, actualitza l'element amb les dades proporcionades i retorna l'element actualitzat.</li>
</ul>
</div><h1>Operació d'Eliminació</h1>
<div class='content'></div><h2>Eliminar un element per ID</h2>
<div class='content'><p>Afegeix una ruta per eliminar un element.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwLmRlbGV0ZSgnL2l0ZW1zLzppZCcsIGFzeW5jIChyZXEsIHJlcykgPT4gewogIHRyeSB7CiAgICBjb25zdCBkZWxldGVkSXRlbSA9IGF3YWl0IEl0ZW0uZmluZEJ5SWRBbmREZWxldGUocmVxLnBhcmFtcy5pZCk7CiAgICBpZiAoIWRlbGV0ZWRJdGVtKSByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLmpzb24oeyBlcnJvcjogJ0l0ZW0gbm90IGZvdW5kJyB9KTsKICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgbWVzc2FnZTogJ0l0ZW0gZGVsZXRlZCBzdWNjZXNzZnVsbHknIH0pOwogIH0gY2F0Y2ggKGVycikgewogICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogZXJyLm1lc3NhZ2UgfSk7CiAgfQp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>app.delete('/items/:id', async (req, res) =&gt; {
  try {
    const deletedItem = await Item.findByIdAndDelete(req.params.id);
    if (!deletedItem) return res.status(404).json({ error: 'Item not found' });
    res.status(200).json({ message: 'Item deleted successfully' });
  } catch (err) {
    res.status(500).json({ error: err.message });
  }
});</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquesta ruta escolta les sol·licituds DELETE a <code>/items/:id</code> i elimina l'element especificat de la base de dades.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, has après com realitzar operacions bàsiques CRUD utilitzant Node.js i MongoDB. Has configurat una aplicació Node.js, l'has connectada a una base de dades MongoDB i has creat rutes per gestionar la creació, lectura, actualització i eliminació d'elements. Aquestes operacions formen la columna vertebral de la majoria d'aplicacions web, i dominar-les és crucial per a qualsevol desenvolupador.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
