<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Utilitzant MySQL amb Sequelize</title>

    <link rel="alternate" href="https://campusempresa.com/es/nodejs/mysql-sequelize" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nodejs/mysql-sequelize" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nodejs/mysql-sequelize" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/nodejs/mysql-sequelize" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='mongodb-mongoose'>&#x25C4;Utilitzant MongoDB amb Mongoose</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Utilitzant MySQL amb Sequelize</a>
	</div>
	<div class='col-4 text-end'>
					<a href='crud-operations'>Realitzant Operacions CRUD &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a Sequelize</h1>
<div class='content'><p>Sequelize és un ORM (Object-Relational Mapping) basat en promeses per a Node.js per a Postgres, MySQL, MariaDB, SQLite i Microsoft SQL Server. Disposa de suport sòlid per a transaccions, relacions, càrrega ansiosa i mandrosa, replicació de lectura i més.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>ORM (Object-Relational Mapping)</strong>: Una tècnica que et permet consultar i manipular dades d'una base de dades utilitzant un paradigma orientat a objectes.</li>
<li><strong>Models</strong>: Representen taules a la teva base de dades.</li>
<li><strong>Instàncies</strong>: Representen files a la teva base de dades.</li>
<li><strong>Consultes</strong>: Mètodes per interactuar amb la base de dades.</li>
</ul>
</div><h1>Configurant Sequelize amb MySQL</h1>
<div class='content'></div><h2>Instal·lació</h2>
<div class='content'><p>Primer, has d'instal·lar Sequelize i el controlador de MySQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bnBtIGluc3RhbGwgc2VxdWVsaXplIG15c3FsMg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>npm install sequelize mysql2</pre></div><div class='content'></div><h2>Inicialitzant Sequelize</h2>
<div class='content'><p>Crea una nova instància de Sequelize i connecta-la a la teva base de dades MySQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgeyBTZXF1ZWxpemUgfSA9IHJlcXVpcmUoJ3NlcXVlbGl6ZScpOwoKY29uc3Qgc2VxdWVsaXplID0gbmV3IFNlcXVlbGl6ZSgnZGF0YWJhc2UnLCAndXNlcm5hbWUnLCAncGFzc3dvcmQnLCB7CiAgaG9zdDogJ2xvY2FsaG9zdCcsCiAgZGlhbGVjdDogJ215c3FsJwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const { Sequelize } = require('sequelize');

const sequelize = new Sequelize('database', 'username', 'password', {
  host: 'localhost',
  dialect: 'mysql'
});</pre></div><div class='content'></div><h2>Provant la Connexió</h2>
<div class='content'><p>Pots provar la connexió per assegurar-te que tot està configurat correctament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VxdWVsaXplLmF1dGhlbnRpY2F0ZSgpCiAgLnRoZW4oKCkgPT4gewogICAgY29uc29sZS5sb2coJ0xhIGNvbm5leGnDsyBzXCdoYSBlc3RhYmxlcnQgY29ycmVjdGFtZW50LicpOwogIH0pCiAgLmNhdGNoKGVyciA9PiB7CiAgICBjb25zb2xlLmVycm9yKCdObyBzXCdoYSBwb2d1dCBjb25uZWN0YXIgYSBsYSBiYXNlIGRlIGRhZGVzOicsIGVycik7CiAgfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sequelize.authenticate()
  .then(() =&gt; {
    console.log('La connexi&oacute; s\'ha establert correctament.');
  })
  .catch(err =&gt; {
    console.error('No s\'ha pogut connectar a la base de dades:', err);
  });</pre></div><div class='content'></div><h1>Definint Models</h1>
<div class='content'><p>Els models són l'essència de Sequelize. Representen taules a la teva base de dades.</p>
</div><h2>Creant un Model</h2>
<div class='content'><p>Defineix un model per a una taula <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgVXNlciA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1VzZXInLCB7CiAgdXNlcm5hbWU6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcsCiAgICBhbGxvd051bGw6IGZhbHNlCiAgfSwKICBiaXJ0aGRheTogewogICAgdHlwZTogU2VxdWVsaXplLkRBVEUKICB9Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const User = sequelize.define('User', {
  username: {
    type: Sequelize.STRING,
    allowNull: false
  },
  birthday: {
    type: Sequelize.DATE
  }
});</pre></div><div class='content'></div><h2>Sincronitzant Models</h2>
<div class='content'><p>Sincronitza el model amb la base de dades per crear la taula.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VxdWVsaXplLnN5bmMoKQogIC50aGVuKCgpID0+IHsKICAgIGNvbnNvbGUubG9nKCdMYSB0YXVsYSBVc2VyIHNcJ2hhIGNyZWF0LicpOwogIH0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sequelize.sync()
  .then(() =&gt; {
    console.log('La taula User s\'ha creat.');
  });</pre></div><div class='content'></div><h1>Operacions CRUD</h1>
<div class='content'></div><h2>Creant Registres</h2>
<div class='content'><p>Afegeix un nou usuari a la taula <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci5jcmVhdGUoewogIHVzZXJuYW1lOiAnam9obl9kb2UnLAogIGJpcnRoZGF5OiBuZXcgRGF0ZSgxOTkwLCAxLCAxKQp9KS50aGVuKHVzZXIgPT4gewogIGNvbnNvbGUubG9nKCdVc3VhcmkgY3JlYXQ6JywgdXNlci50b0pTT04oKSk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.create({
  username: 'john_doe',
  birthday: new Date(1990, 1, 1)
}).then(user =&gt; {
  console.log('Usuari creat:', user.toJSON());
});</pre></div><div class='content'></div><h2>Llegint Registres</h2>
<div class='content'><p>Recupera tots els usuaris de la taula <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci5maW5kQWxsKCkudGhlbih1c2VycyA9PiB7CiAgY29uc29sZS5sb2coJ1RvdHMgZWxzIHVzdWFyaXM6JywgSlNPTi5zdHJpbmdpZnkodXNlcnMsIG51bGwsIDIpKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.findAll().then(users =&gt; {
  console.log('Tots els usuaris:', JSON.stringify(users, null, 2));
});</pre></div><div class='content'></div><h2>Actualitzant Registres</h2>
<div class='content'><p>Actualitza la informació d'un usuari.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci51cGRhdGUoeyB1c2VybmFtZTogJ2phbmVfZG9lJyB9LCB7CiAgd2hlcmU6IHsKICAgIHVzZXJuYW1lOiAnam9obl9kb2UnCiAgfQp9KS50aGVuKCgpID0+IHsKICBjb25zb2xlLmxvZygnVXN1YXJpIGFjdHVhbGl0emF0LicpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.update({ username: 'jane_doe' }, {
  where: {
    username: 'john_doe'
  }
}).then(() =&gt; {
  console.log('Usuari actualitzat.');
});</pre></div><div class='content'></div><h2>Eliminant Registres</h2>
<div class='content'><p>Elimina un usuari de la taula <code>User</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("VXNlci5kZXN0cm95KHsKICB3aGVyZTogewogICAgdXNlcm5hbWU6ICdqYW5lX2RvZScKICB9Cn0pLnRoZW4oKCkgPT4gewogIGNvbnNvbGUubG9nKCdVc3VhcmkgZWxpbWluYXQuJyk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>User.destroy({
  where: {
    username: 'jane_doe'
  }
}).then(() =&gt; {
  console.log('Usuari eliminat.');
});</pre></div><div class='content'></div><h1>Associacions</h1>
<div class='content'><p>Sequelize suporta diversos tipus d'associacions per definir relacions entre models.</p>
</div><h2>Un a Un</h2>
<div class='content'><p>Defineix una relació un a un entre <code>User</code> i <code>Profile</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgUHJvZmlsZSA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1Byb2ZpbGUnLCB7CiAgYmlvOiB7CiAgICB0eXBlOiBTZXF1ZWxpemUuU1RSSU5HCiAgfQp9KTsKClVzZXIuaGFzT25lKFByb2ZpbGUpOwpQcm9maWxlLmJlbG9uZ3NUbyhVc2VyKTsKCnNlcXVlbGl6ZS5zeW5jKCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Profile = sequelize.define('Profile', {
  bio: {
    type: Sequelize.STRING
  }
});

User.hasOne(Profile);
Profile.belongsTo(User);

sequelize.sync();</pre></div><div class='content'></div><h2>Un a Molts</h2>
<div class='content'><p>Defineix una relació un a molts entre <code>User</code> i <code>Post</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgUG9zdCA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1Bvc3QnLCB7CiAgdGl0bGU6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcKICB9LAogIGNvbnRlbnQ6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5URVhUCiAgfQp9KTsKClVzZXIuaGFzTWFueShQb3N0KTsKUG9zdC5iZWxvbmdzVG8oVXNlcik7CgpzZXF1ZWxpemUuc3luYygpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Post = sequelize.define('Post', {
  title: {
    type: Sequelize.STRING
  },
  content: {
    type: Sequelize.TEXT
  }
});

User.hasMany(Post);
Post.belongsTo(User);

sequelize.sync();</pre></div><div class='content'></div><h2>Molts a Molts</h2>
<div class='content'><p>Defineix una relació molts a molts entre <code>User</code> i <code>Project</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgUHJvamVjdCA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1Byb2plY3QnLCB7CiAgbmFtZTogewogICAgdHlwZTogU2VxdWVsaXplLlNUUklORwogIH0KfSk7Cgpjb25zdCBVc2VyUHJvamVjdCA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1VzZXJQcm9qZWN0Jywge30pOwoKVXNlci5iZWxvbmdzVG9NYW55KFByb2plY3QsIHsgdGhyb3VnaDogVXNlclByb2plY3QgfSk7ClByb2plY3QuYmVsb25nc1RvTWFueShVc2VyLCB7IHRocm91Z2g6IFVzZXJQcm9qZWN0IH0pOwoKc2VxdWVsaXplLnN5bmMoKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const Project = sequelize.define('Project', {
  name: {
    type: Sequelize.STRING
  }
});

const UserProject = sequelize.define('UserProject', {});

User.belongsToMany(Project, { through: UserProject });
Project.belongsToMany(User, { through: UserProject });

sequelize.sync();</pre></div><div class='content'></div><h1>Temes Avançats</h1>
<div class='content'></div><h2>Transaccions</h2>
<div class='content'><p>Les transaccions són essencials per assegurar la integritat de les dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c2VxdWVsaXplLnRyYW5zYWN0aW9uKHQgPT4gewogIHJldHVybiBVc2VyLmNyZWF0ZSh7CiAgICB1c2VybmFtZTogJ2FsaWNlJywKICAgIGJpcnRoZGF5OiBuZXcgRGF0ZSgxOTg1LCA2LCAyMCkKICB9LCB7IHRyYW5zYWN0aW9uOiB0IH0pLnRoZW4odXNlciA9PiB7CiAgICByZXR1cm4gUHJvZmlsZS5jcmVhdGUoewogICAgICBiaW86ICdFbCBwZXJmaWwgZFwnQWxpY2UnLAogICAgICBVc2VySWQ6IHVzZXIuaWQKICAgIH0sIHsgdHJhbnNhY3Rpb246IHQgfSk7CiAgfSk7Cn0pLnRoZW4ocmVzdWx0ID0+IHsKICBjb25zb2xlLmxvZygnTGEgdHJhbnNhY2Npw7Mgc1wnaGEgY29tcHJvbcOocy4nKTsKfSkuY2F0Y2goZXJyID0+IHsKICBjb25zb2xlLmVycm9yKCdMYSB0cmFuc2FjY2nDsyBzXCdoYSByZXZlcnRpdDonLCBlcnIpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sequelize.transaction(t =&gt; {
  return User.create({
    username: 'alice',
    birthday: new Date(1985, 6, 20)
  }, { transaction: t }).then(user =&gt; {
    return Profile.create({
      bio: 'El perfil d\'Alice',
      UserId: user.id
    }, { transaction: t });
  });
}).then(result =&gt; {
  console.log('La transacci&oacute; s\'ha comprom&egrave;s.');
}).catch(err =&gt; {
  console.error('La transacci&oacute; s\'ha revertit:', err);
});</pre></div><div class='content'></div><h2>Scopes</h2>
<div class='content'><p>Els scopes et permeten definir consultes reutilitzables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgVXNlciA9IHNlcXVlbGl6ZS5kZWZpbmUoJ1VzZXInLCB7CiAgdXNlcm5hbWU6IHsKICAgIHR5cGU6IFNlcXVlbGl6ZS5TVFJJTkcsCiAgICBhbGxvd051bGw6IGZhbHNlCiAgfSwKICBiaXJ0aGRheTogewogICAgdHlwZTogU2VxdWVsaXplLkRBVEUKICB9Cn0sIHsKICBzY29wZXM6IHsKICAgIGFkdWx0czogewogICAgICB3aGVyZTogewogICAgICAgIGJpcnRoZGF5OiB7CiAgICAgICAgICBbU2VxdWVsaXplLk9wLmx0ZV06IG5ldyBEYXRlKG5ldyBEYXRlKCkgLSAxOCAqIDM2NSAqIDI0ICogNjAgKiA2MCAqIDEwMDApCiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9KTsKClVzZXIuc2NvcGUoJ2FkdWx0cycpLmZpbmRBbGwoKS50aGVuKHVzZXJzID0+IHsKICBjb25zb2xlLmxvZygnVG90cyBlbHMgdXN1YXJpcyBhZHVsdHM6JywgSlNPTi5zdHJpbmdpZnkodXNlcnMsIG51bGwsIDIpKTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const User = sequelize.define('User', {
  username: {
    type: Sequelize.STRING,
    allowNull: false
  },
  birthday: {
    type: Sequelize.DATE
  }
}, {
  scopes: {
    adults: {
      where: {
        birthday: {
          [Sequelize.Op.lte]: new Date(new Date() - 18 * 365 * 24 * 60 * 60 * 1000)
        }
      }
    }
  }
});

User.scope('adults').findAll().then(users =&gt; {
  console.log('Tots els usuaris adults:', JSON.stringify(users, null, 2));
});</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Utilitzar Sequelize amb MySQL en un entorn Node.js simplifica les interaccions amb la base de dades proporcionant un ORM que abstrau consultes SQL complexes en codi JavaScript manejable. Entenent com configurar Sequelize, definir models, realitzar operacions CRUD i gestionar associacions, pots gestionar eficientment les teves operacions de base de dades. Funcionalitats avançades com les transaccions i els scopes milloren encara més la teva capacitat per mantenir la integritat de les dades i crear consultes reutilitzables.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='mongodb-mongoose'>&#x25C4;Utilitzant MongoDB amb Mongoose</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Utilitzant MySQL amb Sequelize</a>
	</div>
	<div class='col-4 text-end'>
					<a href='crud-operations'>Realitzant Operacions CRUD &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
