<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Callbacks a Node.js</title>

    <link rel="alternate" href="https://campusempresa.com/es/nodejs/callbacks" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nodejs/callbacks" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nodejs/callbacks" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/nodejs/callbacks" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='streams-and-events'>&#x25C4;Fluxos i Esdeveniments</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Callbacks a Node.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='promises'>Promises &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció als Callbacks</h1>
<div class='content'><p>Els callbacks són un concepte fonamental a Node.js, que permeten la programació asíncrona. Un callback és una funció passada a una altra funció com a argument, que després és invocada dins de la funció externa per completar algun tipus de rutina o acció.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Programació Asíncrona</strong>: Node.js utilitza callbacks per gestionar operacions asíncrones, permetent que el programa continuï executant altres codi mentre espera que operacions com la lectura de fitxers o sol·licituds de xarxa es completin.</li>
<li><strong>Funció de Callback</strong>: Una funció que es passa com a argument a una altra funció i s'executa després que alguna operació s'hagi completat.</li>
</ul>
</div><h1>Exemple Bàsic de Callbacks</h1>
<div class='content'><p>Comencem amb un exemple senzill per entendre com funcionen els callbacks a Node.js.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuY3Rpb24gZ3JlZXQobmFtZSwgY2FsbGJhY2spIHsKICAgIGNvbnNvbGUubG9nKCdIZWxsbyAnICsgbmFtZSk7CiAgICBjYWxsYmFjaygpOwp9CgpmdW5jdGlvbiBzYXlHb29kYnllKCkgewogICAgY29uc29sZS5sb2coJ0dvb2RieWUhJyk7Cn0KCmdyZWV0KCdBbGljZScsIHNheUdvb2RieWUpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>function greet(name, callback) {
    console.log('Hello ' + name);
    callback();
}

function sayGoodbye() {
    console.log('Goodbye!');
}

greet('Alice', sayGoodbye);</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li>La funció <code>greet</code> pren dos paràmetres: <code>name</code> i <code>callback</code>.</li>
<li>Primer, mostra un missatge de salutació a la consola.</li>
<li>Després, crida la funció <code>callback</code>.</li>
<li>En aquest exemple, <code>sayGoodbye</code> es passa com a funció de callback, que mostra &quot;Goodbye!&quot; a la consola després de la salutació.</li>
</ul>
</div><h1>Callbacks Asíncrons</h1>
<div class='content'><p>Node.js està dissenyat per ser no bloquejant i basat en esdeveniments. Això significa que les operacions d'E/S (com la lectura de fitxers, fer sol·licituds HTTP, etc.) es realitzen de manera asíncrona utilitzant callbacks.</p>
</div><h2>Exemple: Llegir un Fitxer Asíncronament</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKZnMucmVhZEZpbGUoJ2V4YW1wbGUudHh0JywgJ3V0ZjgnLCBmdW5jdGlvbihlcnIsIGRhdGEpIHsKICAgIGlmIChlcnIpIHsKICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGZpbGU6JywgZXJyKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBjb25zb2xlLmxvZygnRmlsZSBjb250ZW50OicsIGRhdGEpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');

fs.readFile('example.txt', 'utf8', function(err, data) {
    if (err) {
        console.error('Error reading file:', err);
        return;
    }
    console.log('File content:', data);
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>fs.readFile</code> és una funció asíncrona que llegeix el contingut d'un fitxer.</li>
<li>Pren tres arguments: el camí del fitxer, la codificació i una funció de callback.</li>
<li>La funció de callback té dos paràmetres: <code>err</code> i <code>data</code>.
<ul>
<li><code>err</code>: Si es produeix un error durant l'operació de lectura del fitxer, aquest paràmetre contindrà l'objecte d'error.</li>
<li><code>data</code>: Si el fitxer es llegeix correctament, aquest paràmetre contindrà el contingut del fitxer.</li>
</ul>
</li>
<li>La funció de callback mostra el contingut del fitxer a la consola si no hi ha cap error.</li>
</ul>
</div><h1>Gestió d'Errors en Callbacks</h1>
<div class='content'><p>La gestió d'errors és crucial en la programació asíncrona. Node.js segueix una convenció on el primer argument de la funció de callback és un objecte d'error (si n'hi ha), seguit del resultat.</p>
</div><h2>Exemple: Gestió d'Errors en Callbacks</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKZnMucmVhZEZpbGUoJ25vbmV4aXN0ZW50LnR4dCcsICd1dGY4JywgZnVuY3Rpb24oZXJyLCBkYXRhKSB7CiAgICBpZiAoZXJyKSB7CiAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgcmVhZGluZyBmaWxlOicsIGVyci5tZXNzYWdlKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBjb25zb2xlLmxvZygnRmlsZSBjb250ZW50OicsIGRhdGEpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');

fs.readFile('nonexistent.txt', 'utf8', function(err, data) {
    if (err) {
        console.error('Error reading file:', err.message);
        return;
    }
    console.log('File content:', data);
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li>La funció de callback comprova si <code>err</code> no és nul.</li>
<li>Si es produeix un error, mostra el missatge d'error a la consola i surt de la funció utilitzant <code>return</code>.</li>
<li>Si no es produeix cap error, mostra el contingut del fitxer.</li>
</ul>
</div><h1>Callbacks Imbricats i Callback Hell</h1>
<div class='content'><p>Quan es realitzen múltiples operacions asíncrones en seqüència, els callbacks poden arribar a estar profundament imbricats, donant lloc al que es coneix com a &quot;callback hell&quot;.</p>
</div><h2>Exemple: Callbacks Imbricats</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwoKZnMucmVhZEZpbGUoJ2ZpbGUxLnR4dCcsICd1dGY4JywgZnVuY3Rpb24oZXJyLCBkYXRhMSkgewogICAgaWYgKGVycikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgZmlsZTE6JywgZXJyKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBmcy5yZWFkRmlsZSgnZmlsZTIudHh0JywgJ3V0ZjgnLCBmdW5jdGlvbihlcnIsIGRhdGEyKSB7CiAgICAgICAgaWYgKGVycikgewogICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGZpbGUyOicsIGVycik7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgZnMucmVhZEZpbGUoJ2ZpbGUzLnR4dCcsICd1dGY4JywgZnVuY3Rpb24oZXJyLCBkYXRhMykgewogICAgICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZWFkaW5nIGZpbGUzOicsIGVycik7CiAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUxIGNvbnRlbnQ6JywgZGF0YTEpOwogICAgICAgICAgICBjb25zb2xlLmxvZygnRmlsZTIgY29udGVudDonLCBkYXRhMik7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdGaWxlMyBjb250ZW50OicsIGRhdGEzKTsKICAgICAgICB9KTsKICAgIH0pOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs');

fs.readFile('file1.txt', 'utf8', function(err, data1) {
    if (err) {
        console.error('Error reading file1:', err);
        return;
    }
    fs.readFile('file2.txt', 'utf8', function(err, data2) {
        if (err) {
            console.error('Error reading file2:', err);
            return;
        }
        fs.readFile('file3.txt', 'utf8', function(err, data3) {
            if (err) {
                console.error('Error reading file3:', err);
                return;
            }
            console.log('File1 content:', data1);
            console.log('File2 content:', data2);
            console.log('File3 content:', data3);
        });
    });
});</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li>Aquest exemple demostra la lectura de tres fitxers seqüencialment.</li>
<li>Cada crida a <code>fs.readFile</code> està imbricada dins del callback de l'anterior.</li>
<li>Aquesta imbricació fa que el codi sigui més difícil de llegir i mantenir.</li>
</ul>
</div><h1>Evitar el Callback Hell</h1>
<div class='content'><p>Per evitar el callback hell, pots utilitzar tècniques com:</p>
<ul>
<li><strong>Modularitzar Funcions</strong>: Descompondre els callbacks imbricats en funcions separades.</li>
<li><strong>Promises</strong>: Utilitzar promeses per gestionar operacions asíncrones de manera més elegant.</li>
<li><strong>Async/Await</strong>: Utilitzar la sintaxi <code>async</code> i <code>await</code> per a un flux de codi que sembli més sincrònic.</li>
</ul>
</div><h2>Exemple: Utilitzant Promises</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpLnByb21pc2VzOwoKYXN5bmMgZnVuY3Rpb24gcmVhZEZpbGVzKCkgewogICAgdHJ5IHsKICAgICAgICBjb25zdCBkYXRhMSA9IGF3YWl0IGZzLnJlYWRGaWxlKCdmaWxlMS50eHQnLCAndXRmOCcpOwogICAgICAgIGNvbnN0IGRhdGEyID0gYXdhaXQgZnMucmVhZEZpbGUoJ2ZpbGUyLnR4dCcsICd1dGY4Jyk7CiAgICAgICAgY29uc3QgZGF0YTMgPSBhd2FpdCBmcy5yZWFkRmlsZSgnZmlsZTMudHh0JywgJ3V0ZjgnKTsKICAgICAgICBjb25zb2xlLmxvZygnRmlsZTEgY29udGVudDonLCBkYXRhMSk7CiAgICAgICAgY29uc29sZS5sb2coJ0ZpbGUyIGNvbnRlbnQ6JywgZGF0YTIpOwogICAgICAgIGNvbnNvbGUubG9nKCdGaWxlMyBjb250ZW50OicsIGRhdGEzKTsKICAgIH0gY2F0Y2ggKGVycikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJlYWRpbmcgZmlsZTonLCBlcnIpOwogICAgfQp9CgpyZWFkRmlsZXMoKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const fs = require('fs').promises;

async function readFiles() {
    try {
        const data1 = await fs.readFile('file1.txt', 'utf8');
        const data2 = await fs.readFile('file2.txt', 'utf8');
        const data3 = await fs.readFile('file3.txt', 'utf8');
        console.log('File1 content:', data1);
        console.log('File2 content:', data2);
        console.log('File3 content:', data3);
    } catch (err) {
        console.error('Error reading file:', err);
    }
}

readFiles();</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li>La funció <code>fs.readFile</code> s'utilitza amb promeses requerint <code>fs.promises</code>.</li>
<li>La funció <code>readFiles</code> es declara com <code>async</code>, permetent l'ús de <code>await</code> dins d'ella.</li>
<li>Cada expressió <code>await</code> pausa l'execució de la funció <code>readFiles</code> fins que la promesa es resol.</li>
<li>Els errors es capturen utilitzant un bloc <code>try...catch</code>.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Els callbacks són essencials per gestionar operacions asíncrones a Node.js. Entendre com utilitzar-los de manera efectiva, gestionar errors i evitar el callback hell és crucial per escriure codi net i mantenible. A mesura que avancis, considera utilitzar promeses i async/await per gestionar el codi asíncron de manera més eficient.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='streams-and-events'>&#x25C4;Fluxos i Esdeveniments</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Callbacks a Node.js</a>
	</div>
	<div class='col-4 text-end'>
					<a href='promises'>Promises &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
