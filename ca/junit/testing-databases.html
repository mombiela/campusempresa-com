<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proves de Bases de Dades amb JUnit</title>

    <link rel="alternate" href="https://campusempresa.com/es/junit/testing-databases" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/junit/testing-databases" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/junit/testing-databases" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/junit/testing-databases" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Provar bases de dades és una part crucial per assegurar la fiabilitat i correcció de les teves aplicacions. En aquesta secció, explorarem com utilitzar JUnit per provar les interaccions amb la base de dades de manera efectiva. Cobrirem els conceptes bàsics de la configuració del teu entorn, l'escriptura de proves i tècniques avançades per a escenaris més complexos.</p>
</div><h1>Configuració del Teu Entorn</h1>
<div class='content'><p>Abans de començar a provar les teves interaccions amb la base de dades, necessites configurar el teu entorn.</p>
</div><h2>Dependències</h2>
<div class='content'><p>Primer, assegura't de tenir les dependències necessàries en el teu <code>pom.xml</code> si estàs utilitzant Maven:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY2llcz4KICAgIDwhLS0gRGVwZW5kw6huY2lhIGRlIEpVbml0IDUgLS0+CiAgICA8ZGVwZW5kZW5jeT4KICAgICAgICA8Z3JvdXBJZD5vcmcuanVuaXQuanVwaXRlcjwvZ3JvdXBJZD4KICAgICAgICA8YXJ0aWZhY3RJZD5qdW5pdC1qdXBpdGVyLWVuZ2luZTwvYXJ0aWZhY3RJZD4KICAgICAgICA8dmVyc2lvbj41LjcuMDwvdmVyc2lvbj4KICAgICAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CiAgICA8L2RlcGVuZGVuY3k+CiAgICA8IS0tIERlcGVuZMOobmNpYSBkZSBsYSBiYXNlIGRlIGRhZGVzIEgyIHBlciBhIHByb3ZlcyBlbiBtZW3DsnJpYSAtLT4KICAgIDxkZXBlbmRlbmN5PgogICAgICAgIDxncm91cElkPmNvbS5oMmRhdGFiYXNlPC9ncm91cElkPgogICAgICAgIDxhcnRpZmFjdElkPmgyPC9hcnRpZmFjdElkPgogICAgICAgIDxzY29wZT50ZXN0PC9zY29wZT4KICAgIDwvZGVwZW5kZW5jeT4KICAgIDwhLS0gRGVwZW5kw6huY2lhIGRlIFNwcmluZyBCb290IFRlc3Qgc2kgdXRpbGl0emVzIFNwcmluZyBCb290IC0tPgogICAgPGRlcGVuZGVuY3k+CiAgICAgICAgPGdyb3VwSWQ+b3JnLnNwcmluZ2ZyYW1ld29yay5ib290PC9ncm91cElkPgogICAgICAgIDxhcnRpZmFjdElkPnNwcmluZy1ib290LXN0YXJ0ZXItdGVzdDwvYXJ0aWZhY3RJZD4KICAgICAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CiAgICA8L2RlcGVuZGVuY3k+CjwvZGVwZW5kZW5jaWVzPg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependencies&gt;
    &lt;!-- Depend&egrave;ncia de JUnit 5 --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
        &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;
        &lt;version&gt;5.7.0&lt;/version&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- Depend&egrave;ncia de la base de dades H2 per a proves en mem&ograve;ria --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;com.h2database&lt;/groupId&gt;
        &lt;artifactId&gt;h2&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!-- Depend&egrave;ncia de Spring Boot Test si utilitzes Spring Boot --&gt;
    &lt;dependency&gt;
        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
        &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
&lt;/dependencies&gt;</pre></div><div class='content'></div><h2>Configuració</h2>
<div class='content'><p>Configura la teva aplicació per utilitzar una base de dades en memòria per a proves. Això es pot fer en el teu fitxer <code>application-test.properties</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3ByaW5nLmRhdGFzb3VyY2UudXJsPWpkYmM6aDI6bWVtOnRlc3RkYgpzcHJpbmcuZGF0YXNvdXJjZS5kcml2ZXJDbGFzc05hbWU9b3JnLmgyLkRyaXZlcgpzcHJpbmcuZGF0YXNvdXJjZS51c2VybmFtZT1zYQpzcHJpbmcuZGF0YXNvdXJjZS5wYXNzd29yZD1wYXNzd29yZApzcHJpbmcuanBhLmRhdGFiYXNlLXBsYXRmb3JtPW9yZy5oaWJlcm5hdGUuZGlhbGVjdC5IMkRpYWxlY3Q="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>spring.datasource.url=jdbc:h2:mem:testdb
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect</pre></div><div class='content'></div><h1>Escriure Proves Bàsiques de Bases de Dades</h1>
<div class='content'><p>Comencem amb algunes proves bàsiques per assegurar-nos que les nostres interaccions amb la base de dades funcionen com s'espera.</p>
</div><h2>Exemple: Provar un Repositori</h2>
<div class='content'><p>Suposem que tens una entitat <code>User</code> simple i un <code>UserRepository</code> corresponent. Així és com pots escriure una prova bàsica:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5qdW5pdC5qdXBpdGVyLmFwaS5UZXN0OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5iZWFucy5mYWN0b3J5LmFubm90YXRpb24uQXV0b3dpcmVkOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5ib290LnRlc3QuYXV0b2NvbmZpZ3VyZS5vcm0uanBhLkRhdGFKcGFUZXN0OwppbXBvcnQgc3RhdGljIG9yZy5hc3NlcnRqLmNvcmUuYXBpLkFzc2VydGlvbnMuYXNzZXJ0VGhhdDsKCkBEYXRhSnBhVGVzdApwdWJsaWMgY2xhc3MgVXNlclJlcG9zaXRvcnlUZXN0IHsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJSZXBvc2l0b3J5IHVzZXJSZXBvc2l0b3J5OwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0U2F2ZVVzZXIoKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoKTsKICAgICAgICB1c2VyLnNldE5hbWUoIkpvaG4gRG9lIik7CiAgICAgICAgdXNlci5zZXRFbWFpbCgiam9obi5kb2VAZXhhbXBsZS5jb20iKTsKCiAgICAgICAgdXNlclJlcG9zaXRvcnkuc2F2ZSh1c2VyKTsKCiAgICAgICAgVXNlciBmb3VuZFVzZXIgPSB1c2VyUmVwb3NpdG9yeS5maW5kQnlJZCh1c2VyLmdldElkKCkpLm9yRWxzZShudWxsKTsKICAgICAgICBhc3NlcnRUaGF0KGZvdW5kVXNlcikuaXNOb3ROdWxsKCk7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0TmFtZSgpKS5pc0VxdWFsVG8oIkpvaG4gRG9lIik7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0RW1haWwoKSkuaXNFcXVhbFRvKCJqb2huLmRvZUBleGFtcGxlLmNvbSIpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
import static org.assertj.core.api.Assertions.assertThat;

@DataJpaTest
public class UserRepositoryTest {

    @Autowired
    private UserRepository userRepository;

    @Test
    public void testSaveUser() {
        User user = new User();
        user.setName(&quot;John Doe&quot;);
        user.setEmail(&quot;john.doe@example.com&quot;);

        userRepository.save(user);

        User foundUser = userRepository.findById(user.getId()).orElse(null);
        assertThat(foundUser).isNotNull();
        assertThat(foundUser.getName()).isEqualTo(&quot;John Doe&quot;);
        assertThat(foundUser.getEmail()).isEqualTo(&quot;john.doe@example.com&quot;);
    }
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>@DataJpaTest</strong>: Aquesta anotació s'utilitza per configurar una prova de tall per a repositoris JPA.</li>
<li><strong>@Autowired</strong>: Injecta el bean <code>UserRepository</code>.</li>
<li><strong>assertThat</strong>: D'AssertJ, utilitzat per a afirmacions fluïdes.</li>
</ul>
</div><h1>Tècniques Avançades de Proves de Bases de Dades</h1>
<div class='content'><p>A mesura que et sentis més còmode amb les proves bàsiques, pots explorar tècniques més avançades.</p>
</div><h2>Utilitzant Testcontainers</h2>
<div class='content'><p>Testcontainers és una biblioteca Java que suporta proves JUnit, proporcionant instàncies lleugeres i descartables de bases de dades comunes.</p>
<h4>Exemple: Configurar Testcontainers</h4>
<p>Afegeix la dependència de Testcontainers al teu <code>pom.xml</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcudGVzdGNvbnRhaW5lcnM8L2dyb3VwSWQ+CiAgICA8YXJ0aWZhY3RJZD5qdW5pdC1qdXBpdGVyPC9hcnRpZmFjdElkPgogICAgPHZlcnNpb24+MS4xNS4zPC92ZXJzaW9uPgogICAgPHNjb3BlPnRlc3Q8L3Njb3BlPgo8L2RlcGVuZGVuY3k+CjxkZXBlbmRlbmN5PgogICAgPGdyb3VwSWQ+b3JnLnRlc3Rjb250YWluZXJzPC9ncm91cElkPgogICAgPGFydGlmYWN0SWQ+bXlzcWw8L2FydGlmYWN0SWQ+CiAgICA8dmVyc2lvbj4xLjE1LjM8L3ZlcnNpb24+CiAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CjwvZGVwZW5kZW5jeT4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.testcontainers&lt;/groupId&gt;
    &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
    &lt;version&gt;1.15.3&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.testcontainers&lt;/groupId&gt;
    &lt;artifactId&gt;mysql&lt;/artifactId&gt;
    &lt;version&gt;1.15.3&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div><div class='content'><h4>Exemple: Escriure una Prova amb Testcontainers</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5qdW5pdC5qdXBpdGVyLmFwaS5UZXN0OwppbXBvcnQgb3JnLmp1bml0Lmp1cGl0ZXIuYXBpLmV4dGVuc2lvbi5FeHRlbmRXaXRoOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5iZWFucy5mYWN0b3J5LmFubm90YXRpb24uQXV0b3dpcmVkOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5ib290LnRlc3QuYXV0b2NvbmZpZ3VyZS5vcm0uanBhLkRhdGFKcGFUZXN0OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay50ZXN0LmNvbnRleHQuanVuaXQuanVwaXRlci5TcHJpbmdFeHRlbnNpb247CmltcG9ydCBvcmcudGVzdGNvbnRhaW5lcnMuY29udGFpbmVycy5NeVNRTENvbnRhaW5lcjsKCmltcG9ydCBzdGF0aWMgb3JnLmFzc2VydGouY29yZS5hcGkuQXNzZXJ0aW9ucy5hc3NlcnRUaGF0OwoKQEV4dGVuZFdpdGgoU3ByaW5nRXh0ZW5zaW9uLmNsYXNzKQpARGF0YUpwYVRlc3QKcHVibGljIGNsYXNzIFVzZXJSZXBvc2l0b3J5VGVzdCB7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBVc2VyUmVwb3NpdG9yeSB1c2VyUmVwb3NpdG9yeTsKCiAgICBzdGF0aWMgTXlTUUxDb250YWluZXI8Pz4gbXlzcWwgPSBuZXcgTXlTUUxDb250YWluZXI8PigibXlzcWw6OC4wLjIyIikKICAgICAgICAgICAgLndpdGhEYXRhYmFzZU5hbWUoInRlc3RkYiIpCiAgICAgICAgICAgIC53aXRoVXNlcm5hbWUoInRlc3QiKQogICAgICAgICAgICAud2l0aFBhc3N3b3JkKCJ0ZXN0Iik7CgogICAgc3RhdGljIHsKICAgICAgICBteXNxbC5zdGFydCgpOwogICAgfQoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0U2F2ZVVzZXIoKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoKTsKICAgICAgICB1c2VyLnNldE5hbWUoIkpvaG4gRG9lIik7CiAgICAgICAgdXNlci5zZXRFbWFpbCgiam9obi5kb2VAZXhhbXBsZS5jb20iKTsKCiAgICAgICAgdXNlclJlcG9zaXRvcnkuc2F2ZSh1c2VyKTsKCiAgICAgICAgVXNlciBmb3VuZFVzZXIgPSB1c2VyUmVwb3NpdG9yeS5maW5kQnlJZCh1c2VyLmdldElkKCkpLm9yRWxzZShudWxsKTsKICAgICAgICBhc3NlcnRUaGF0KGZvdW5kVXNlcikuaXNOb3ROdWxsKCk7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0TmFtZSgpKS5pc0VxdWFsVG8oIkpvaG4gRG9lIik7CiAgICAgICAgYXNzZXJ0VGhhdChmb3VuZFVzZXIuZ2V0RW1haWwoKSkuaXNFcXVhbFRvKCJqb2huLmRvZUBleGFtcGxlLmNvbSIpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.junit.jupiter.api.Test;
import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.autoconfigure.orm.jpa.DataJpaTest;
import org.springframework.test.context.junit.jupiter.SpringExtension;
import org.testcontainers.containers.MySQLContainer;

import static org.assertj.core.api.Assertions.assertThat;

@ExtendWith(SpringExtension.class)
@DataJpaTest
public class UserRepositoryTest {

    @Autowired
    private UserRepository userRepository;

    static MySQLContainer&lt;?&gt; mysql = new MySQLContainer&lt;&gt;(&quot;mysql:8.0.22&quot;)
            .withDatabaseName(&quot;testdb&quot;)
            .withUsername(&quot;test&quot;)
            .withPassword(&quot;test&quot;);

    static {
        mysql.start();
    }

    @Test
    public void testSaveUser() {
        User user = new User();
        user.setName(&quot;John Doe&quot;);
        user.setEmail(&quot;john.doe@example.com&quot;);

        userRepository.save(user);

        User foundUser = userRepository.findById(user.getId()).orElse(null);
        assertThat(foundUser).isNotNull();
        assertThat(foundUser.getName()).isEqualTo(&quot;John Doe&quot;);
        assertThat(foundUser.getEmail()).isEqualTo(&quot;john.doe@example.com&quot;);
    }
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>MySQLContainer</strong>: Aquesta classe s'utilitza per crear i gestionar un contenidor MySQL.</li>
<li><strong>@ExtendWith(SpringExtension.class)</strong>: Integra el Spring TestContext Framework amb JUnit 5.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Provar bases de dades amb JUnit és essencial per assegurar la fiabilitat de la teva aplicació. Des de proves bàsiques utilitzant bases de dades en memòria fins a tècniques més avançades com Testcontainers, pots assegurar-te que les teves interaccions amb la base de dades estan ben provades. Recorda:</p>
<ul>
<li>Configurar correctament el teu entorn.</li>
<li>Escriure proves clares i concises.</li>
<li>Utilitzar eines i tècniques avançades segons sigui necessari.</li>
</ul>
<p>Seguint aquestes directrius, pots crear proves robustes que ajudaran a mantenir la integritat de la teva aplicació al llarg del temps.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
