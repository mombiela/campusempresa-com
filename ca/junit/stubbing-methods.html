<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/junit/stubbing-methods" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>La simulació de mètodes és un concepte crucial en les proves unitàries, que et permet controlar el comportament de les dependències en les teves proves. Aquest tema et guiarà des dels conceptes bàsics fins a tècniques avançades de simulació de mètodes utilitzant JUnit i Mockito.</p>
</div><h1>Què és la Simulació?</h1>
<div class='content'><ul>
<li><strong>Definició</strong>: La simulació és el procés de crear un &quot;stub&quot; o un objecte simulat que simula el comportament dels objectes reals.</li>
<li><strong>Propòsit</strong>: Aïlla la unitat de treball que s'està provant proporcionant respostes controlades de les dependències.</li>
</ul>
</div><h1>Configuració de JUnit i Mockito</h1>
<div class='content'><p>Abans de submergir-te en la simulació, assegura't de tenir JUnit i Mockito configurats en el teu projecte.</p>
</div><h2>Dependència Maven</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcuanVuaXQuanVwaXRlcjwvZ3JvdXBJZD4KICAgIDxhcnRpZmFjdElkPmp1bml0LWp1cGl0ZXItZW5naW5lPC9hcnRpZmFjdElkPgogICAgPHZlcnNpb24+NS43LjA8L3ZlcnNpb24+CiAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CjwvZGVwZW5kZW5jeT4KPGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcubW9ja2l0bzwvZ3JvdXBJZD4KICAgIDxhcnRpZmFjdElkPm1vY2tpdG8tY29yZTwvYXJ0aWZhY3RJZD4KICAgIDx2ZXJzaW9uPjMuNi4wPC92ZXJzaW9uPgogICAgPHNjb3BlPnRlc3Q8L3Njb3BlPgo8L2RlcGVuZGVuY3k+"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.junit.jupiter&lt;/groupId&gt;
    &lt;artifactId&gt;junit-jupiter-engine&lt;/artifactId&gt;
    &lt;version&gt;5.7.0&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mockito&lt;/groupId&gt;
    &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;
    &lt;version&gt;3.6.0&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div><div class='content'></div><h2>Dependència Gradle</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGVzdEltcGxlbWVudGF0aW9uICdvcmcuanVuaXQuanVwaXRlcjpqdW5pdC1qdXBpdGVyLWVuZ2luZTo1LjcuMCcKdGVzdEltcGxlbWVudGF0aW9uICdvcmcubW9ja2l0bzptb2NraXRvLWNvcmU6My42LjAn"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>testImplementation 'org.junit.jupiter:junit-jupiter-engine:5.7.0'
testImplementation 'org.mockito:mockito-core:3.6.0'</pre></div><div class='content'></div><h1>Simulació Bàsica amb Mockito</h1>
<h2>Creació d'un Stub</h2>
<div class='content'><p>Per crear un stub, necessites utilitzar el mètode <code>Mockito.mock()</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHN0YXRpYyBvcmcubW9ja2l0by5Nb2NraXRvLio7CmltcG9ydCBvcmcuanVuaXQuanVwaXRlci5hcGkuVGVzdDsKaW1wb3J0IHN0YXRpYyBvcmcuanVuaXQuanVwaXRlci5hcGkuQXNzZXJ0aW9ucy4qOwoKY2xhc3MgTXlTZXJ2aWNlVGVzdCB7CgogICAgQFRlc3QKICAgIHZvaWQgdGVzdFNlcnZpY2VNZXRob2QoKSB7CiAgICAgICAgLy8gQ3JlYXIgdW4gb2JqZWN0ZSBzaW11bGF0CiAgICAgICAgTXlEZXBlbmRlbmN5IGRlcGVuZGVuY3kgPSBtb2NrKE15RGVwZW5kZW5jeS5jbGFzcyk7CgogICAgICAgIC8vIERlZmluaXIgZWwgY29tcG9ydGFtZW50IGRlbCBzaW11bGFjcmUKICAgICAgICB3aGVuKGRlcGVuZGVuY3kuc29tZU1ldGhvZCgpKS50aGVuUmV0dXJuKCJzdHViYmVkIHJlc3BvbnNlIik7CgogICAgICAgIC8vIFV0aWxpdHphciBlbCBzaW11bGFjcmUgZW4gZWwgdGV1IHNlcnZlaQogICAgICAgIE15U2VydmljZSBzZXJ2aWNlID0gbmV3IE15U2VydmljZShkZXBlbmRlbmN5KTsKICAgICAgICBTdHJpbmcgcmVzdWx0ID0gc2VydmljZS5wZXJmb3JtQWN0aW9uKCk7CgogICAgICAgIC8vIFZlcmlmaWNhciBlbCByZXN1bHRhdAogICAgICAgIGFzc2VydEVxdWFscygic3R1YmJlZCByZXNwb25zZSIsIHJlc3VsdCk7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import static org.mockito.Mockito.*;
import org.junit.jupiter.api.Test;
import static org.junit.jupiter.api.Assertions.*;

class MyServiceTest {

    @Test
    void testServiceMethod() {
        // Crear un objecte simulat
        MyDependency dependency = mock(MyDependency.class);

        // Definir el comportament del simulacre
        when(dependency.someMethod()).thenReturn(&quot;stubbed response&quot;);

        // Utilitzar el simulacre en el teu servei
        MyService service = new MyService(dependency);
        String result = service.performAction();

        // Verificar el resultat
        assertEquals(&quot;stubbed response&quot;, result);
    }
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>Creació del Simulacre</strong>: <code>MyDependency dependency = mock(MyDependency.class);</code>
<ul>
<li>Això crea un objecte simulat de <code>MyDependency</code>.</li>
</ul>
</li>
<li><strong>Simulació</strong>: <code>when(dependency.someMethod()).thenReturn(&quot;stubbed response&quot;);</code>
<ul>
<li>Això indica a l'objecte simulat que retorni &quot;stubbed response&quot; quan es cridi <code>someMethod()</code>.</li>
</ul>
</li>
<li><strong>Ús del Simulacre</strong>: El simulacre es passa al servei, que l'utilitza com si fos una dependència real.</li>
<li><strong>Verificació</strong>: La prova verifica que el servei retorna la resposta simulada esperada.</li>
</ul>
</div><h1>Tècniques Avançades de Simulació</h1>
<h2>Simulació amb Arguments</h2>
<div class='content'><p>Pots simular mètodes per retornar diferents valors segons els arguments d'entrada.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2hlbihkZXBlbmRlbmN5LnNvbWVNZXRob2QoImlucHV0MSIpKS50aGVuUmV0dXJuKCJyZXNwb25zZTEiKTsKd2hlbihkZXBlbmRlbmN5LnNvbWVNZXRob2QoImlucHV0MiIpKS50aGVuUmV0dXJuKCJyZXNwb25zZTIiKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>when(dependency.someMethod(&quot;input1&quot;)).thenReturn(&quot;response1&quot;);
when(dependency.someMethod(&quot;input2&quot;)).thenReturn(&quot;response2&quot;);</pre></div><div class='content'></div><h2>Llançament d'Excepcions</h2>
<div class='content'><p>També pots simular mètodes per llançar excepcions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2hlbihkZXBlbmRlbmN5LnNvbWVNZXRob2QoKSkudGhlblRocm93KG5ldyBSdW50aW1lRXhjZXB0aW9uKCJTdHViYmVkIGV4Y2VwdGlvbiIpKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>when(dependency.someMethod()).thenThrow(new RuntimeException(&quot;Stubbed exception&quot;));</pre></div><div class='content'></div><h2>Simulació de Mètodes Void</h2>
<div class='content'><p>Per a mètodes que retornen void, utilitza <code>doNothing()</code>, <code>doThrow()</code>, etc.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZG9Ob3RoaW5nKCkud2hlbihkZXBlbmRlbmN5KS52b2lkTWV0aG9kKCk7CmRvVGhyb3cobmV3IFJ1bnRpbWVFeGNlcHRpb24oIlN0dWJiZWQgZXhjZXB0aW9uIikpLndoZW4oZGVwZW5kZW5jeSkudm9pZE1ldGhvZCgpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>doNothing().when(dependency).voidMethod();
doThrow(new RuntimeException(&quot;Stubbed exception&quot;)).when(dependency).voidMethod();</pre></div><div class='content'></div><h2>Simulació de Crides Consecutives</h2>
<div class='content'><p>Pots definir una seqüència de respostes per a crides consecutives.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("d2hlbihkZXBlbmRlbmN5LnNvbWVNZXRob2QoKSkKICAgIC50aGVuUmV0dXJuKCJyZXNwb25zZTEiKQogICAgLnRoZW5SZXR1cm4oInJlc3BvbnNlMiIpCiAgICAudGhlblRocm93KG5ldyBSdW50aW1lRXhjZXB0aW9uKCJTdHViYmVkIGV4Y2VwdGlvbiIpKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>when(dependency.someMethod())
    .thenReturn(&quot;response1&quot;)
    .thenReturn(&quot;response2&quot;)
    .thenThrow(new RuntimeException(&quot;Stubbed exception&quot;));</pre></div><div class='content'></div><h1>Millors Pràctiques</h1>
<div class='content'><ul>
<li><strong>Mantingues-ho Simple</strong>: Només simula el que és necessari per a la prova.</li>
<li><strong>Evita la Sobre-Simulació</strong>: Massa simulació pot fer que les proves siguin difícils de llegir i mantenir.</li>
<li><strong>Utilitza Anotacions</strong>: Utilitza les anotacions <code>@Mock</code> i <code>@InjectMocks</code> per simplificar la creació i injecció de simulacres.</li>
</ul>
</div><h2>Exemple amb Anotacions</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5tb2NraXRvLkluamVjdE1vY2tzOwppbXBvcnQgb3JnLm1vY2tpdG8uTW9jazsKaW1wb3J0IG9yZy5tb2NraXRvLmp1bml0Lmp1cGl0ZXIuTW9ja2l0b0V4dGVuc2lvbjsKaW1wb3J0IG9yZy5qdW5pdC5qdXBpdGVyLmFwaS5leHRlbnNpb24uRXh0ZW5kV2l0aDsKCkBFeHRlbmRXaXRoKE1vY2tpdG9FeHRlbnNpb24uY2xhc3MpCmNsYXNzIE15U2VydmljZVRlc3QgewoKICAgIEBNb2NrCiAgICBNeURlcGVuZGVuY3kgZGVwZW5kZW5jeTsKCiAgICBASW5qZWN0TW9ja3MKICAgIE15U2VydmljZSBzZXJ2aWNlOwoKICAgIEBUZXN0CiAgICB2b2lkIHRlc3RTZXJ2aWNlTWV0aG9kKCkgewogICAgICAgIHdoZW4oZGVwZW5kZW5jeS5zb21lTWV0aG9kKCkpLnRoZW5SZXR1cm4oInN0dWJiZWQgcmVzcG9uc2UiKTsKCiAgICAgICAgU3RyaW5nIHJlc3VsdCA9IHNlcnZpY2UucGVyZm9ybUFjdGlvbigpOwoKICAgICAgICBhc3NlcnRFcXVhbHMoInN0dWJiZWQgcmVzcG9uc2UiLCByZXN1bHQpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.mockito.InjectMocks;
import org.mockito.Mock;
import org.mockito.junit.jupiter.MockitoExtension;
import org.junit.jupiter.api.extension.ExtendWith;

@ExtendWith(MockitoExtension.class)
class MyServiceTest {

    @Mock
    MyDependency dependency;

    @InjectMocks
    MyService service;

    @Test
    void testServiceMethod() {
        when(dependency.someMethod()).thenReturn(&quot;stubbed response&quot;);

        String result = service.performAction();

        assertEquals(&quot;stubbed response&quot;, result);
    }
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>La simulació de mètodes és una tècnica poderosa en les proves unitàries que et permet aïllar la unitat sota prova controlant el comportament de les seves dependències. Dominant tant les tècniques bàsiques com les avançades de simulació, podràs escriure proves més efectives i mantenibles. Recorda seguir les millors pràctiques per mantenir les teves proves netes i llegibles.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
