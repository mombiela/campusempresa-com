<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/excel/creating-user-defined-functions" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>A Excel, les funcions definides per l'usuari (UDFs) et permeten crear funcions personalitzades utilitzant VBA (Visual Basic for Applications). Aquestes funcions es poden utilitzar en fórmules igual que les funcions integrades d'Excel. Aquest tema et guiarà a través del procés de creació i ús de les UDFs, des de nivells bàsics fins a avançats.</p>
</div><h1>Començant amb VBA</h1>
<div class='content'><p>Abans de crear UDFs, necessites entendre els conceptes bàsics de VBA. VBA és el llenguatge de programació utilitzat a Excel per automatitzar tasques i crear funcions personalitzades.</p>
</div><h2>Activant la Pestanya de Desenvolupador</h2>
<div class='content'><p>Per escriure codi VBA, necessites activar la pestanya de Desenvolupador a Excel:</p>
<ol>
<li>Ves a <code>Fitxer</code> &gt; <code>Opcions</code>.</li>
<li>Selecciona <code>Personalitza la Cinta</code>.</li>
<li>Marca l'opció <code>Desenvolupador</code> al panell de la dreta.</li>
<li>Fes clic a <code>D'acord</code>.</li>
</ol>
</div><h2>Obrint l'Editor de VBA</h2>
<div class='content'><ol>
<li>Fes clic a la pestanya <code>Desenvolupador</code>.</li>
<li>Selecciona <code>Visual Basic</code> per obrir l'editor de VBA.</li>
</ol>
</div><h1>Creant la Teva Primera Funció Definida per l'Usuari</h1>
<div class='content'><p>Comencem amb un exemple senzill d'una UDF que suma dos números.</p>
</div><h2>Exemple: Sumant Dos Números</h2>
<div class='content'><ol>
<li>Obre l'editor de VBA.</li>
<li>Insereix un nou mòdul: <code>Inserir</code> &gt; <code>Mòdul</code>.</li>
<li>Escriu el següent codi al mòdul:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQWRkVHdvTnVtYmVycyhhIEFzIERvdWJsZSwgYiBBcyBEb3VibGUpIEFzIERvdWJsZQogICAgQWRkVHdvTnVtYmVycyA9IGEgKyBiCkVuZCBGdW5jdGlvbg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function AddTwoNumbers(a As Double, b As Double) As Double
    AddTwoNumbers = a + b
End Function</pre></div><div class='content'><ol start="4">
<li>Desa el teu treball i tanca l'editor de VBA.</li>
</ol>
</div><h2>Utilitzant la UDF a Excel</h2>
<div class='content'><ol>
<li>Torna a la teva fulla de càlcul d'Excel.</li>
<li>En qualsevol cel·la, escriu <code>=AddTwoNumbers(3, 5)</code> i prem <code>Enter</code>.</li>
<li>La cel·la hauria de mostrar <code>8</code>.</li>
</ol>
</div><h1>UDFs Intermèdies</h1>
<div class='content'><p>Ara que saps com crear una UDF bàsica, explorem funcions més complexes.</p>
</div><h2>Exemple: Calculant l'Àrea d'un Cercle</h2>
<div class='content'><ol>
<li>Obre l'editor de VBA i insereix un nou mòdul si és necessari.</li>
<li>Escriu el següent codi:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gQ2lyY2xlQXJlYShyYWRpdXMgQXMgRG91YmxlKSBBcyBEb3VibGUKICAgIENpcmNsZUFyZWEgPSBXb3Jrc2hlZXRGdW5jdGlvbi5QaSgpICogcmFkaXVzICogcmFkaXVzCkVuZCBGdW5jdGlvbg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function CircleArea(radius As Double) As Double
    CircleArea = WorksheetFunction.Pi() * radius * radius
End Function</pre></div><div class='content'><ol start="3">
<li>Desa i tanca l'editor de VBA.</li>
</ol>
</div><h2>Utilitzant la UDF a Excel</h2>
<div class='content'><ol>
<li>En qualsevol cel·la, escriu <code>=CircleArea(5)</code> i prem <code>Enter</code>.</li>
<li>La cel·la hauria de mostrar <code>78.53981634</code>.</li>
</ol>
</div><h1>UDFs Avançades</h1>
<div class='content'><p>Les UDFs avançades poden incloure gestió d'errors i lògica més complexa.</p>
</div><h2>Exemple: Calculant la Seqüència de Fibonacci</h2>
<div class='content'><ol>
<li>Obre l'editor de VBA i insereix un nou mòdul si és necessari.</li>
<li>Escriu el següent codi:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RnVuY3Rpb24gRmlib25hY2NpKG4gQXMgSW50ZWdlcikgQXMgVmFyaWFudAogICAgSWYgbiA8IDEgVGhlbgogICAgICAgIEZpYm9uYWNjaSA9ICJFbnRyYWRhIEludsOgbGlkYSIKICAgIEVsc2VJZiBuID0gMSBPciBuID0gMiBUaGVuCiAgICAgICAgRmlib25hY2NpID0gMQogICAgRWxzZQogICAgICAgIEZpYm9uYWNjaSA9IEZpYm9uYWNjaShuIC0gMSkgKyBGaWJvbmFjY2kobiAtIDIpCiAgICBFbmQgSWYKRW5kIEZ1bmN0aW9u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Function Fibonacci(n As Integer) As Variant
    If n &lt; 1 Then
        Fibonacci = &quot;Entrada Inv&agrave;lida&quot;
    ElseIf n = 1 Or n = 2 Then
        Fibonacci = 1
    Else
        Fibonacci = Fibonacci(n - 1) + Fibonacci(n - 2)
    End If
End Function</pre></div><div class='content'><ol start="3">
<li>Desa i tanca l'editor de VBA.</li>
</ol>
</div><h2>Utilitzant la UDF a Excel</h2>
<div class='content'><ol>
<li>En qualsevol cel·la, escriu <code>=Fibonacci(10)</code> i prem <code>Enter</code>.</li>
<li>La cel·la hauria de mostrar <code>55</code>.</li>
</ol>
</div><h1>Millors Pràctiques per a les UDFs</h1>
<div class='content'><ul>
<li><strong>Gestió d'Errors</strong>: Inclou sempre gestió d'errors per manejar entrades inesperades.</li>
<li><strong>Comentaris</strong>: Afegeix comentaris al teu codi per explicar la lògica.</li>
<li><strong>Optimització</strong>: Optimitza el teu codi per al rendiment, especialment per a càlculs complexos.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Crear funcions definides per l'usuari a Excel utilitzant VBA pot augmentar enormement la teva productivitat i permetre't realitzar càlculs personalitzats que no són possibles amb les funcions integrades. Seguint els passos descrits en aquest tema, pots crear UDFs des de senzilles fins a avançades adaptades a les teves necessitats específiques. Practica escrivint diferents tipus de UDFs per convertir-te en un expert en VBA i automatització d'Excel.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
