<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/flask/handling-user-input-securely" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>Gestionar la entrada d'usuari de forma segura és un aspecte crític del desenvolupament web. En aquesta secció, explorarem com gestionar l'entrada d'usuari en aplicacions Flask per prevenir vulnerabilitats de seguretat comunes.</p>
</div><h1>Introducció a la Seguretat de l'Entrada d'Usuari</h1>
<div class='content'><ul>
<li><strong>Importància de la Seguretat</strong>: Entendre per què assegurar l'entrada d'usuari és crucial.</li>
<li><strong>Vulnerabilitats Comunes</strong>: Visió general dels problemes de seguretat comuns com la Injecció SQL, Cross-Site Scripting (XSS), i Cross-Site Request Forgery (CSRF).</li>
</ul>
</div><h1>Validar l'Entrada d'Usuari</h1>
<div class='content'><ul>
<li><strong>Validació del Costat del Client vs. Costat del Servidor</strong>:
<ul>
<li>La validació del costat del client millora l'experiència de l'usuari però no s'ha de confiar només en ella.</li>
<li>La validació del costat del servidor és essencial per a la seguretat.</li>
</ul>
</li>
</ul>
</div><h2>Exemple: Validació Simple de Formulari</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIHJlbmRlcl90ZW1wbGF0ZV9zdHJpbmcKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKQGFwcC5yb3V0ZSgnL3N1Ym1pdCcsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBzdWJtaXQoKToKICAgIHVzZXJuYW1lID0gcmVxdWVzdC5mb3JtLmdldCgndXNlcm5hbWUnKQogICAgaWYgbm90IHVzZXJuYW1lIG9yIGxlbih1c2VybmFtZSkgPCAzOgogICAgICAgIHJldHVybiAiSW52YWxpZCB1c2VybmFtZSIsIDQwMAogICAgcmV0dXJuIGYiV2VsY29tZSwge3VzZXJuYW1lfSEiCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/submit', methods=['POST'])
def submit():
    username = request.form.get('username')
    if not username or len(username) &lt; 3:
        return &quot;Invalid username&quot;, 400
    return f&quot;Welcome, {username}!&quot;

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquest exemple mostra una validació bàsica del costat del servidor on el nom d'usuari ha de tenir almenys 3 caràcters.</li>
</ul>
</div><h1>Sanititzar l'Entrada d'Usuari</h1>
<div class='content'><ul>
<li><strong>Per què Sanititzar?</strong>: Per eliminar caràcters o codi potencialment nocius de l'entrada d'usuari.</li>
<li><strong>Tècniques Comunes</strong>:
<ul>
<li>Escapar caràcters HTML.</li>
<li>Utilitzar biblioteques com <code>bleach</code> per netejar l'entrada.</li>
</ul>
</li>
</ul>
</div><h2>Exemple: Sanititzar l'Entrada amb Bleach</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGJsZWFjaApmcm9tIGZsYXNrIGltcG9ydCBGbGFzaywgcmVxdWVzdCwgcmVuZGVyX3RlbXBsYXRlX3N0cmluZwoKYXBwID0gRmxhc2soX19uYW1lX18pCgpAYXBwLnJvdXRlKCcvc3VibWl0JywgbWV0aG9kcz1bJ1BPU1QnXSkKZGVmIHN1Ym1pdCgpOgogICAgdXNlcm5hbWUgPSByZXF1ZXN0LmZvcm0uZ2V0KCd1c2VybmFtZScpCiAgICBzYW5pdGl6ZWRfdXNlcm5hbWUgPSBibGVhY2guY2xlYW4odXNlcm5hbWUpCiAgICByZXR1cm4gZiJXZWxjb21lLCB7c2FuaXRpemVkX3VzZXJuYW1lfSEiCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import bleach
from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/submit', methods=['POST'])
def submit():
    username = request.form.get('username')
    sanitized_username = bleach.clean(username)
    return f&quot;Welcome, {sanitized_username}!&quot;

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquest exemple utilitza la biblioteca <code>bleach</code> per sanititzar l'entrada del nom d'usuari, eliminant qualsevol etiqueta HTML o script potencialment nociu.</li>
</ul>
</div><h1>Protegir Contra la Injecció SQL</h1>
<div class='content'><ul>
<li><strong>Què és la Injecció SQL?</strong>: Una tècnica on els atacants poden executar codi SQL arbitrari a la teva base de dades.</li>
<li><strong>Utilitzar ORM</strong>: Les eines de Mapatge Objecte-Relacional (ORM) com SQLAlchemy poden ajudar a prevenir la injecció SQL.</li>
</ul>
</div><h2>Exemple: Utilitzar SQLAlchemy</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QKZnJvbSBmbGFza19zcWxhbGNoZW15IGltcG9ydCBTUUxBbGNoZW15CgphcHAgPSBGbGFzayhfX25hbWVfXykKYXBwLmNvbmZpZ1snU1FMQUxDSEVNWV9EQVRBQkFTRV9VUkknXSA9ICdzcWxpdGU6Ly8vdGVzdC5kYicKZGIgPSBTUUxBbGNoZW15KGFwcCkKCmNsYXNzIFVzZXIoZGIuTW9kZWwpOgogICAgaWQgPSBkYi5Db2x1bW4oZGIuSW50ZWdlciwgcHJpbWFyeV9rZXk9VHJ1ZSkKICAgIHVzZXJuYW1lID0gZGIuQ29sdW1uKGRiLlN0cmluZyg4MCksIHVuaXF1ZT1UcnVlLCBudWxsYWJsZT1GYWxzZSkKCkBhcHAucm91dGUoJy9hZGRfdXNlcicsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBhZGRfdXNlcigpOgogICAgdXNlcm5hbWUgPSByZXF1ZXN0LmZvcm0uZ2V0KCd1c2VybmFtZScpCiAgICBpZiBub3QgdXNlcm5hbWU6CiAgICAgICAgcmV0dXJuICJJbnZhbGlkIHVzZXJuYW1lIiwgNDAwCiAgICBuZXdfdXNlciA9IFVzZXIodXNlcm5hbWU9dXNlcm5hbWUpCiAgICBkYi5zZXNzaW9uLmFkZChuZXdfdXNlcikKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKICAgIHJldHVybiBmIlVzZXIge3VzZXJuYW1lfSBhZGRlZCEiCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///test.db'
db = SQLAlchemy(app)

class User(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    username = db.Column(db.String(80), unique=True, nullable=False)

@app.route('/add_user', methods=['POST'])
def add_user():
    username = request.form.get('username')
    if not username:
        return &quot;Invalid username&quot;, 400
    new_user = User(username=username)
    db.session.add(new_user)
    db.session.commit()
    return f&quot;User {username} added!&quot;

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquest exemple demostra com utilitzar SQLAlchemy per inserir de forma segura dades d'usuari a la base de dades, mitigant el risc de la injecció SQL.</li>
</ul>
</div><h1>Prevenir el Cross-Site Scripting (XSS)</h1>
<div class='content'><ul>
<li><strong>Què és XSS?</strong>: Una vulnerabilitat que permet als atacants injectar scripts maliciosos en pàgines web vistes per altres usuaris.</li>
<li><strong>Escapar el Contingut</strong>: Sempre escapar el contingut generat per l'usuari abans de renderitzar-lo en HTML.</li>
</ul>
</div><h2>Exemple: Escapar el Contingut</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlcXVlc3QsIHJlbmRlcl90ZW1wbGF0ZV9zdHJpbmcKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQoKQGFwcC5yb3V0ZSgnL3N1Ym1pdCcsIG1ldGhvZHM9WydQT1NUJ10pCmRlZiBzdWJtaXQoKToKICAgIHVzZXJuYW1lID0gcmVxdWVzdC5mb3JtLmdldCgndXNlcm5hbWUnKQogICAgZXNjYXBlZF91c2VybmFtZSA9IGVzY2FwZSh1c2VybmFtZSkKICAgIHJldHVybiByZW5kZXJfdGVtcGxhdGVfc3RyaW5nKCc8aDE+V2VsY29tZSwge3sgdXNlcm5hbWUgfX08L2gxPicsIHVzZXJuYW1lPWVzY2FwZWRfdXNlcm5hbWUpCgppZiBfX25hbWVfXyA9PSAnX19tYWluX18nOgogICAgYXBwLnJ1bihkZWJ1Zz1UcnVlKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, request, render_template_string

app = Flask(__name__)

@app.route('/submit', methods=['POST'])
def submit():
    username = request.form.get('username')
    escaped_username = escape(username)
    return render_template_string('&lt;h1&gt;Welcome, {{ username }}&lt;/h1&gt;', username=escaped_username)

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquest exemple utilitza la funció <code>escape</code> de Flask per sanititzar el nom d'usuari abans de renderitzar-lo en la plantilla HTML.</li>
</ul>
</div><h1>Implementar la Protecció CSRF</h1>
<div class='content'><ul>
<li><strong>Què és CSRF?</strong>: Un atac que enganya l'usuari perquè enviï una sol·licitud que no tenia intenció de fer.</li>
<li><strong>Utilitzar Flask-WTF</strong>: L'extensió Flask-WTF proporciona protecció CSRF de sèrie.</li>
</ul>
</div><h2>Exemple: Protecció CSRF amb Flask-WTF</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBmbGFzayBpbXBvcnQgRmxhc2ssIHJlbmRlcl90ZW1wbGF0ZSwgcmVxdWVzdApmcm9tIGZsYXNrX3d0ZiBpbXBvcnQgRmxhc2tGb3JtCmZyb20gd3Rmb3JtcyBpbXBvcnQgU3RyaW5nRmllbGQsIFN1Ym1pdEZpZWxkCmZyb20gd3Rmb3Jtcy52YWxpZGF0b3JzIGltcG9ydCBEYXRhUmVxdWlyZWQKZnJvbSBmbGFza193dGYuY3NyZiBpbXBvcnQgQ1NSRlByb3RlY3QKCmFwcCA9IEZsYXNrKF9fbmFtZV9fKQphcHAuY29uZmlnWydTRUNSRVRfS0VZJ10gPSAnbXlzZWNyZXQnCmNzcmYgPSBDU1JGUHJvdGVjdChhcHApCgpjbGFzcyBNeUZvcm0oRmxhc2tGb3JtKToKICAgIHVzZXJuYW1lID0gU3RyaW5nRmllbGQoJ1VzZXJuYW1lJywgdmFsaWRhdG9ycz1bRGF0YVJlcXVpcmVkKCldKQogICAgc3VibWl0ID0gU3VibWl0RmllbGQoJ1N1Ym1pdCcpCgpAYXBwLnJvdXRlKCcvc3VibWl0JywgbWV0aG9kcz1bJ0dFVCcsICdQT1NUJ10pCmRlZiBzdWJtaXQoKToKICAgIGZvcm0gPSBNeUZvcm0oKQogICAgaWYgZm9ybS52YWxpZGF0ZV9vbl9zdWJtaXQoKToKICAgICAgICB1c2VybmFtZSA9IGZvcm0udXNlcm5hbWUuZGF0YQogICAgICAgIHJldHVybiBmIldlbGNvbWUsIHt1c2VybmFtZX0hIgogICAgcmV0dXJuIHJlbmRlcl90ZW1wbGF0ZSgnZm9ybS5odG1sJywgZm9ybT1mb3JtKQoKaWYgX19uYW1lX18gPT0gJ19fbWFpbl9fJzoKICAgIGFwcC5ydW4oZGVidWc9VHJ1ZSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from flask import Flask, render_template, request
from flask_wtf import FlaskForm
from wtforms import StringField, SubmitField
from wtforms.validators import DataRequired
from flask_wtf.csrf import CSRFProtect

app = Flask(__name__)
app.config['SECRET_KEY'] = 'mysecret'
csrf = CSRFProtect(app)

class MyForm(FlaskForm):
    username = StringField('Username', validators=[DataRequired()])
    submit = SubmitField('Submit')

@app.route('/submit', methods=['GET', 'POST'])
def submit():
    form = MyForm()
    if form.validate_on_submit():
        username = form.username.data
        return f&quot;Welcome, {username}!&quot;
    return render_template('form.html', form=form)

if __name__ == '__main__':
    app.run(debug=True)</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>: Aquest exemple mostra com utilitzar Flask-WTF per crear un formulari amb protecció CSRF. La classe <code>CSRFProtect</code> assegura que tots els formularis incloguin un token CSRF.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Assegurar l'entrada d'usuari és un aspecte fonamental per construir aplicacions Flask robustes. Validant, sanititzant i protegint contra vulnerabilitats comunes com la Injecció SQL, XSS i CSRF, pots millorar significativament la seguretat de les teves aplicacions web. Mantingues-te sempre actualitzat amb les últimes pràctiques de seguretat i revisa regularment el teu codi per detectar possibles vulnerabilitats.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
