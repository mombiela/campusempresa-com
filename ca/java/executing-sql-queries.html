<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Executar consultes SQL</title>

    <link rel="alternate" href="https://campusempresa.com/es/java/executing-sql-queries" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/java/executing-sql-queries" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/java/executing-sql-queries" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/java/executing-sql-queries" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Executar consultes SQL en Java és una habilitat fonamental per a qualsevol desenvolupador que treballi amb bases de dades. Aquesta secció cobrirà com connectar-se a una base de dades, executar consultes SQL i gestionar els resultats. Començarem amb conceptes bàsics i gradualment passarem a temes més avançats.</p>
</div><h1>Prerequisits</h1>
<div class='content'><p>Abans d'endinsar-nos en l'execució de consultes SQL en Java, assegura't de tenir:</p>
<ul>
<li>Comprensió bàsica de la programació en Java.</li>
<li>Coneixements bàsics de SQL.</li>
<li>Un sistema de gestió de bases de dades (SGBD) instal·lat (per exemple, MySQL, PostgreSQL).</li>
</ul>
</div><h1>Configuració de l'entorn</h1>
<div class='content'><p>Per executar consultes SQL en Java, necessites configurar el teu entorn de desenvolupament:</p>
<ol>
<li><strong>Instal·lar el controlador JDBC</strong>: Descarrega i afegeix el controlador JDBC per a la teva base de dades al teu projecte.</li>
<li><strong>Connexió a la base de dades</strong>: Estableix una connexió a la teva base de dades utilitzant JDBC.</li>
</ol>
</div><h2>Exemple: Configurar una connexió MySQL</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZhLnNxbC5Ecml2ZXJNYW5hZ2VyOwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwoKcHVibGljIGNsYXNzIERhdGFiYXNlQ29ubmVjdGlvbiB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgU3RyaW5nIHVybCA9ICJqZGJjOm15c3FsOi8vbG9jYWxob3N0OjMzMDYvbXlkYXRhYmFzZSI7CiAgICAgICAgU3RyaW5nIHVzZXIgPSAicm9vdCI7CiAgICAgICAgU3RyaW5nIHBhc3N3b3JkID0gInBhc3N3b3JkIjsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgQ29ubmVjdGlvbiBjb25uZWN0aW9uID0gRHJpdmVyTWFuYWdlci5nZXRDb25uZWN0aW9uKHVybCwgdXNlciwgcGFzc3dvcmQpOwogICAgICAgICAgICBTeXN0ZW0ub3V0LnByaW50bG4oIkNvbm5lY3RhdCBhIGxhIGJhc2UgZGUgZGFkZXMgYW1iIMOoeGl0ISIpOwogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgfQogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;

public class DatabaseConnection {
    public static void main(String[] args) {
        String url = &quot;jdbc:mysql://localhost:3306/mydatabase&quot;;
        String user = &quot;root&quot;;
        String password = &quot;password&quot;;

        try {
            Connection connection = DriverManager.getConnection(url, user, password);
            System.out.println(&quot;Connectat a la base de dades amb &egrave;xit!&quot;);
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>DriverManager.getConnection(url, user, password)</code>: Estableix una connexió amb la base de dades.</li>
<li><code>url</code>: L'URL de la base de dades.</li>
<li><code>user</code>: El nom d'usuari de la base de dades.</li>
<li><code>password</code>: La contrasenya de la base de dades.</li>
</ul>
</li>
</ul>
</div><h1>Executar consultes SQL</h1>
<div class='content'><p>Un cop establerta la connexió, pots executar consultes SQL utilitzant les classes <code>Statement</code> o <code>PreparedStatement</code>.</p>
</div><h2>Utilitzant `Statement`</h2>
<div class='content'><p>La classe <code>Statement</code> s'utilitza per executar sentències SQL estàtiques.</p>
<h4>Exemple: Executar una consulta simple</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZhLnNxbC5Ecml2ZXJNYW5hZ2VyOwppbXBvcnQgamF2YS5zcWwuUmVzdWx0U2V0OwppbXBvcnQgamF2YS5zcWwuU1FMRXhjZXB0aW9uOwppbXBvcnQgamF2YS5zcWwuU3RhdGVtZW50OwoKcHVibGljIGNsYXNzIEV4ZWN1dGVRdWVyeSB7CiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB7CiAgICAgICAgU3RyaW5nIHVybCA9ICJqZGJjOm15c3FsOi8vbG9jYWxob3N0OjMzMDYvbXlkYXRhYmFzZSI7CiAgICAgICAgU3RyaW5nIHVzZXIgPSAicm9vdCI7CiAgICAgICAgU3RyaW5nIHBhc3N3b3JkID0gInBhc3N3b3JkIjsKCiAgICAgICAgdHJ5IChDb25uZWN0aW9uIGNvbm5lY3Rpb24gPSBEcml2ZXJNYW5hZ2VyLmdldENvbm5lY3Rpb24odXJsLCB1c2VyLCBwYXNzd29yZCk7CiAgICAgICAgICAgICBTdGF0ZW1lbnQgc3RhdGVtZW50ID0gY29ubmVjdGlvbi5jcmVhdGVTdGF0ZW1lbnQoKSkgewoKICAgICAgICAgICAgU3RyaW5nIHF1ZXJ5ID0gIlNFTEVDVCAqIEZST00gdXNlcnMiOwogICAgICAgICAgICBSZXN1bHRTZXQgcmVzdWx0U2V0ID0gc3RhdGVtZW50LmV4ZWN1dGVRdWVyeShxdWVyeSk7CgogICAgICAgICAgICB3aGlsZSAocmVzdWx0U2V0Lm5leHQoKSkgewogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJJRCBkJ3VzdWFyaTogIiArIHJlc3VsdFNldC5nZXRJbnQoImlkIikpOwogICAgICAgICAgICAgICAgU3lzdGVtLm91dC5wcmludGxuKCJOb20gZCd1c3Vhcmk6ICIgKyByZXN1bHRTZXQuZ2V0U3RyaW5nKCJ1c2VybmFtZSIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0gY2F0Y2ggKFNRTEV4Y2VwdGlvbiBlKSB7CiAgICAgICAgICAgIGUucHJpbnRTdGFja1RyYWNlKCk7CiAgICAgICAgfQogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class ExecuteQuery {
    public static void main(String[] args) {
        String url = &quot;jdbc:mysql://localhost:3306/mydatabase&quot;;
        String user = &quot;root&quot;;
        String password = &quot;password&quot;;

        try (Connection connection = DriverManager.getConnection(url, user, password);
             Statement statement = connection.createStatement()) {

            String query = &quot;SELECT * FROM users&quot;;
            ResultSet resultSet = statement.executeQuery(query);

            while (resultSet.next()) {
                System.out.println(&quot;ID d'usuari: &quot; + resultSet.getInt(&quot;id&quot;));
                System.out.println(&quot;Nom d'usuari: &quot; + resultSet.getString(&quot;username&quot;));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>Statement statement = connection.createStatement()</code>: Crea un objecte <code>Statement</code>.</li>
<li><code>ResultSet resultSet = statement.executeQuery(query)</code>: Executa la consulta i retorna el conjunt de resultats.</li>
<li><code>resultSet.next()</code>: Mou el cursor a la següent fila del conjunt de resultats.</li>
</ul>
</li>
</ul>
</div><h2>Utilitzant `PreparedStatement`</h2>
<div class='content'><p>La classe <code>PreparedStatement</code> s'utilitza per executar sentències SQL parametritzades, cosa que ajuda a prevenir la injecció SQL.</p>
<h4>Exemple: Executar una consulta parametritzada</h4>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGphdmEuc3FsLkNvbm5lY3Rpb247CmltcG9ydCBqYXZhLnNxbC5Ecml2ZXJNYW5hZ2VyOwppbXBvcnQgamF2YS5zcWwuUHJlcGFyZWRTdGF0ZW1lbnQ7CmltcG9ydCBqYXZhLnNxbC5SZXN1bHRTZXQ7CmltcG9ydCBqYXZhLnNxbC5TUUxFeGNlcHRpb247CgpwdWJsaWMgY2xhc3MgRXhlY3V0ZVByZXBhcmVkU3RhdGVtZW50IHsKICAgIHB1YmxpYyBzdGF0aWMgdm9pZCBtYWluKFN0cmluZ1tdIGFyZ3MpIHsKICAgICAgICBTdHJpbmcgdXJsID0gImpkYmM6bXlzcWw6Ly9sb2NhbGhvc3Q6MzMwNi9teWRhdGFiYXNlIjsKICAgICAgICBTdHJpbmcgdXNlciA9ICJyb290IjsKICAgICAgICBTdHJpbmcgcGFzc3dvcmQgPSAicGFzc3dvcmQiOwoKICAgICAgICB0cnkgKENvbm5lY3Rpb24gY29ubmVjdGlvbiA9IERyaXZlck1hbmFnZXIuZ2V0Q29ubmVjdGlvbih1cmwsIHVzZXIsIHBhc3N3b3JkKTsKICAgICAgICAgICAgIFByZXBhcmVkU3RhdGVtZW50IHByZXBhcmVkU3RhdGVtZW50ID0gY29ubmVjdGlvbi5wcmVwYXJlU3RhdGVtZW50KCJTRUxFQ1QgKiBGUk9NIHVzZXJzIFdIRVJFIGlkID0gPyIpKSB7CgogICAgICAgICAgICBwcmVwYXJlZFN0YXRlbWVudC5zZXRJbnQoMSwgMSk7IC8vIEVzdGFibGVpeCBlbCBwcmltZXIgcGFyw6BtZXRyZSBhIDEKICAgICAgICAgICAgUmVzdWx0U2V0IHJlc3VsdFNldCA9IHByZXBhcmVkU3RhdGVtZW50LmV4ZWN1dGVRdWVyeSgpOwoKICAgICAgICAgICAgd2hpbGUgKHJlc3VsdFNldC5uZXh0KCkpIHsKICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiSUQgZCd1c3Vhcmk6ICIgKyByZXN1bHRTZXQuZ2V0SW50KCJpZCIpKTsKICAgICAgICAgICAgICAgIFN5c3RlbS5vdXQucHJpbnRsbigiTm9tIGQndXN1YXJpOiAiICsgcmVzdWx0U2V0LmdldFN0cmluZygidXNlcm5hbWUiKSk7CiAgICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewogICAgICAgICAgICBlLnByaW50U3RhY2tUcmFjZSgpOwogICAgICAgIH0KICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;

public class ExecutePreparedStatement {
    public static void main(String[] args) {
        String url = &quot;jdbc:mysql://localhost:3306/mydatabase&quot;;
        String user = &quot;root&quot;;
        String password = &quot;password&quot;;

        try (Connection connection = DriverManager.getConnection(url, user, password);
             PreparedStatement preparedStatement = connection.prepareStatement(&quot;SELECT * FROM users WHERE id = ?&quot;)) {

            preparedStatement.setInt(1, 1); // Estableix el primer par&agrave;metre a 1
            ResultSet resultSet = preparedStatement.executeQuery();

            while (resultSet.next()) {
                System.out.println(&quot;ID d'usuari: &quot; + resultSet.getInt(&quot;id&quot;));
                System.out.println(&quot;Nom d'usuari: &quot; + resultSet.getString(&quot;username&quot;));
            }
        } catch (SQLException e) {
            e.printStackTrace();
        }
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>PreparedStatement preparedStatement = connection.prepareStatement(query)</code>: Crea un objecte <code>PreparedStatement</code>.</li>
<li><code>preparedStatement.setInt(1, 1)</code>: Estableix el primer paràmetre de la consulta a 1.</li>
<li><code>ResultSet resultSet = preparedStatement.executeQuery()</code>: Executa la consulta i retorna el conjunt de resultats.</li>
</ul>
</li>
</ul>
</div><h1>Gestió d'excepcions SQL</h1>
<div class='content'><p>Gestionar les excepcions és crucial quan es treballa amb bases de dades per assegurar que la teva aplicació pugui gestionar els errors de manera elegant.</p>
</div><h2>Exemple: Gestió d'excepcions SQL</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJ5IHsKICAgIC8vIE9wZXJhY2lvbnMgZGUgYmFzZSBkZSBkYWRlcwp9IGNhdGNoIChTUUxFeGNlcHRpb24gZSkgewogICAgU3lzdGVtLmVyci5wcmludGxuKCJFcnJvciBTUUw6ICIgKyBlLmdldE1lc3NhZ2UoKSk7CiAgICBlLnByaW50U3RhY2tUcmFjZSgpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>try {
    // Operacions de base de dades
} catch (SQLException e) {
    System.err.println(&quot;Error SQL: &quot; + e.getMessage());
    e.printStackTrace();
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>SQLException e</code>: Captura les excepcions SQL.</li>
<li><code>e.getMessage()</code>: Recupera el missatge d'error.</li>
<li><code>e.printStackTrace()</code>: Imprimeix la traça de l'error per a depuració.</li>
</ul>
</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Executar consultes SQL en Java implica establir una connexió amb la base de dades, utilitzar <code>Statement</code> o <code>PreparedStatement</code> per executar consultes i gestionar els resultats. Una gestió adequada de les excepcions assegura que la teva aplicació pugui gestionar els errors de manera efectiva. Dominant aquestes habilitats, podràs interactuar eficientment amb bases de dades en les teves aplicacions Java.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
