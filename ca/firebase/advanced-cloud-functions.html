<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Funcions Cloud Avançades</title>

    <link rel="alternate" href="https://campusempresa.com/es/firebase/advanced-cloud-functions" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/firebase/advanced-cloud-functions" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/firebase/advanced-cloud-functions" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/firebase/advanced-cloud-functions" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='triggering-functions'>&#x25C4;Activar Funcions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Funcions Cloud Avançades</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-firebase-hosting'>Introducció a Firebase Hosting &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquesta secció, aprofundirem en conceptes i tècniques avançades per utilitzar les Funcions Cloud de Firebase. Això inclourà l'optimització del rendiment, la gestió d'estructures de dades complexes i la integració amb altres serveis de Firebase i API de tercers.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Tècniques d'Optimització</strong>: Aprèn a optimitzar les teves Funcions Cloud per a rendiment i eficiència de costos.</li>
<li><strong>Gestió de Dades Complexes</strong>: Entén com gestionar i manipular estructures de dades complexes dins de les teves funcions.</li>
<li><strong>Integració amb Serveis de Firebase</strong>: Explora com integrar les Funcions Cloud amb altres serveis de Firebase com Firestore, Autenticació i Emmagatzematge.</li>
<li><strong>Integració amb API de Tercers</strong>: Aprèn a connectar les teves Funcions Cloud amb API externes per ampliar la funcionalitat.</li>
</ul>
</div><h1>Tècniques d'Optimització</h1>
<h2>Inicis en Fred</h2>
<div class='content'><p>Els inicis en fred es produeixen quan una Funció Cloud s'invoca després d'estar inactiva durant un temps, cosa que provoca una latència augmentada. Per minimitzar els inicis en fred:</p>
<ul>
<li><strong>Utilitza Variables Globals</strong>: Declara variables fora de l'àmbit de la funció per reutilitzar-les entre invocacions.</li>
<li><strong>Mantingues les Funcions Calentes</strong>: Utilitza eines com Cloud Scheduler per invocar periòdicament les funcions.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhlbXBsZSBkJ8O6cyBkZSB2YXJpYWJsZXMgZ2xvYmFscyBwZXIgcmVkdWlyIGVscyBpbmljaXMgZW4gZnJlZApsZXQgY2FjaGVkRGF0YTsKCmV4cG9ydHMubXlGdW5jdGlvbiA9IGZ1bmN0aW9ucy5odHRwcy5vblJlcXVlc3QoKHJlcSwgcmVzKSA9PiB7CiAgaWYgKCFjYWNoZWREYXRhKSB7CiAgICBjYWNoZWREYXRhID0gZmV0Y2hEYXRhRnJvbURhdGFiYXNlKCk7IC8vIFNpbXVsYSB1bmEgdHJ1Y2FkYSBhIGxhIGJhc2UgZGUgZGFkZXMKICB9CiAgcmVzLnNlbmQoY2FjaGVkRGF0YSk7Cn0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Exemple d'&uacute;s de variables globals per reduir els inicis en fred
let cachedData;

exports.myFunction = functions.https.onRequest((req, res) =&gt; {
  if (!cachedData) {
    cachedData = fetchDataFromDatabase(); // Simula una trucada a la base de dades
  }
  res.send(cachedData);
});</pre></div><div class='content'></div><h2>Configuració de Memòria i Temps d'Espera</h2>
<div class='content'><p>Ajusta la memòria i els temps d'espera segons els requisits de la teva funció per optimitzar el rendiment i els costos.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhlbXBsZSBkZSBjb25maWd1cmFjacOzIGRlIG1lbcOycmlhIGkgdGVtcHMgZCdlc3BlcmEKZXhwb3J0cy5teUZ1bmN0aW9uID0gZnVuY3Rpb25zLnJ1bldpdGgoewogIG1lbW9yeTogJzUxMk1CJywKICB0aW1lb3V0U2Vjb25kczogNjAKfSkuaHR0cHMub25SZXF1ZXN0KChyZXEsIHJlcykgPT4gewogIC8vIEzDsmdpY2EgZGUgbGEgZnVuY2nDsyBhcXXDrQp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Exemple de configuraci&oacute; de mem&ograve;ria i temps d'espera
exports.myFunction = functions.runWith({
  memory: '512MB',
  timeoutSeconds: 60
}).https.onRequest((req, res) =&gt; {
  // L&ograve;gica de la funci&oacute; aqu&iacute;
});</pre></div><div class='content'></div><h1>Gestió de Dades Complexes</h1>
<h2>Treballant amb Firestore</h2>
<div class='content'><p>Gestionar estructures de dades niades a Firestore pot ser un repte. Utilitza escriptures en lot i transaccions per gestionar dades complexes de manera eficient.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhlbXBsZSBkJ3VuYSBlc2NyaXB0dXJhIGVuIGxvdCBhIEZpcmVzdG9yZQpjb25zdCBiYXRjaCA9IGRiLmJhdGNoKCk7Cgpjb25zdCBkb2NSZWYxID0gZGIuY29sbGVjdGlvbigndXNlcnMnKS5kb2MoJ3VzZXIxJyk7CmJhdGNoLnNldChkb2NSZWYxLCB7IG5hbWU6ICdKb2huIERvZScgfSk7Cgpjb25zdCBkb2NSZWYyID0gZGIuY29sbGVjdGlvbigndXNlcnMnKS5kb2MoJ3VzZXIyJyk7CmJhdGNoLnVwZGF0ZShkb2NSZWYyLCB7IGFnZTogMzAgfSk7CgpiYXRjaC5jb21taXQoKS50aGVuKCgpID0+IHsKICBjb25zb2xlLmxvZygnRXNjcmlwdHVyYSBlbiBsb3QgY29tcGxldGFkYScpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Exemple d'una escriptura en lot a Firestore
const batch = db.batch();

const docRef1 = db.collection('users').doc('user1');
batch.set(docRef1, { name: 'John Doe' });

const docRef2 = db.collection('users').doc('user2');
batch.update(docRef2, { age: 30 });

batch.commit().then(() =&gt; {
  console.log('Escriptura en lot completada');
});</pre></div><div class='content'></div><h2>Transaccions</h2>
<div class='content'><p>Les transaccions asseguren que una sèrie d'operacions de lectura i escriptura s'executin de manera atòmica.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhlbXBsZSBkJ3VuYSB0cmFuc2FjY2nDsyBhIEZpcmVzdG9yZQpkYi5ydW5UcmFuc2FjdGlvbihhc3luYyAodHJhbnNhY3Rpb24pID0+IHsKICBjb25zdCBkb2NSZWYgPSBkYi5jb2xsZWN0aW9uKCd1c2VycycpLmRvYygndXNlcjEnKTsKICBjb25zdCBkb2MgPSBhd2FpdCB0cmFuc2FjdGlvbi5nZXQoZG9jUmVmKTsKICAKICBpZiAoIWRvYy5leGlzdHMpIHsKICAgIHRocm93ICJFbCBkb2N1bWVudCBubyBleGlzdGVpeCEiOwogIH0KCiAgY29uc3QgbmV3QWdlID0gZG9jLmRhdGEoKS5hZ2UgKyAxOwogIHRyYW5zYWN0aW9uLnVwZGF0ZShkb2NSZWYsIHsgYWdlOiBuZXdBZ2UgfSk7Cn0pLnRoZW4oKCkgPT4gewogIGNvbnNvbGUubG9nKCdUcmFuc2FjY2nDsyBjb21wcm9tZXNhIGFtYiDDqHhpdCcpOwp9KS5jYXRjaCgoZXJyb3IpID0+IHsKICBjb25zb2xlLmxvZygnVHJhbnNhY2Npw7MgZmFsbGlkYTogJywgZXJyb3IpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Exemple d'una transacci&oacute; a Firestore
db.runTransaction(async (transaction) =&gt; {
  const docRef = db.collection('users').doc('user1');
  const doc = await transaction.get(docRef);
  
  if (!doc.exists) {
    throw &quot;El document no existeix!&quot;;
  }

  const newAge = doc.data().age + 1;
  transaction.update(docRef, { age: newAge });
}).then(() =&gt; {
  console.log('Transacci&oacute; compromesa amb &egrave;xit');
}).catch((error) =&gt; {
  console.log('Transacci&oacute; fallida: ', error);
});</pre></div><div class='content'></div><h1>Integració amb Serveis de Firebase</h1>
<h2>Triggers de Firestore</h2>
<div class='content'><p>Els triggers de Firestore permeten executar funcions en resposta a canvis a la teva base de dades de Firestore.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhlbXBsZSBkJ3VuIHRyaWdnZXIgZGUgRmlyZXN0b3JlCmV4cG9ydHMub25Vc2VyQ3JlYXRlID0gZnVuY3Rpb25zLmZpcmVzdG9yZQogIC5kb2N1bWVudCgndXNlcnMve3VzZXJJZH0nKQogIC5vbkNyZWF0ZSgoc25hcCwgY29udGV4dCkgPT4gewogICAgY29uc3QgbmV3VmFsdWUgPSBzbmFwLmRhdGEoKTsKICAgIGNvbnNvbGUubG9nKCdOb3UgdXN1YXJpIGNyZWF0OicsIG5ld1ZhbHVlKTsKICB9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Exemple d'un trigger de Firestore
exports.onUserCreate = functions.firestore
  .document('users/{userId}')
  .onCreate((snap, context) =&gt; {
    const newValue = snap.data();
    console.log('Nou usuari creat:', newValue);
  });</pre></div><div class='content'></div><h2>Triggers d'Autenticació</h2>
<div class='content'><p>Els triggers d'autenticació es poden utilitzar per realitzar accions quan els usuaris es registren o eliminen els seus comptes.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRXhlbXBsZSBkJ3VuIHRyaWdnZXIgZCdhdXRlbnRpY2FjacOzCmV4cG9ydHMub25Vc2VyU2lnblVwID0gZnVuY3Rpb25zLmF1dGgudXNlcigpLm9uQ3JlYXRlKCh1c2VyKSA9PiB7CiAgY29uc29sZS5sb2coJ05vdSB1c3VhcmkgcmVnaXN0cmF0OicsIHVzZXIuZW1haWwpOwp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Exemple d'un trigger d'autenticaci&oacute;
exports.onUserSignUp = functions.auth.user().onCreate((user) =&gt; {
  console.log('Nou usuari registrat:', user.email);
});</pre></div><div class='content'></div><h1>Integració amb API de Tercers</h1>
<h2>Realitzant Peticions HTTP</h2>
<div class='content'><p>Utilitza la biblioteca <code>axios</code> per realitzar peticions HTTP a API de tercers des de les teves Funcions Cloud.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwoKZXhwb3J0cy5jYWxsRXh0ZXJuYWxBUEkgPSBmdW5jdGlvbnMuaHR0cHMub25SZXF1ZXN0KChyZXEsIHJlcykgPT4gewogIGF4aW9zLmdldCgnaHR0cHM6Ly9hcGkuZXhhbXBsZS5jb20vZGF0YScpCiAgICAudGhlbihyZXNwb25zZSA9PiB7CiAgICAgIHJlcy5zZW5kKHJlc3BvbnNlLmRhdGEpOwogICAgfSkKICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHRydWNhbnQgYSBsJ0FQSSBleHRlcm5hOicsIGVycm9yKTsKICAgICAgcmVzLnN0YXR1cyg1MDApLnNlbmQoJ0Vycm9yIHRydWNhbnQgYSBsJ0FQSSBleHRlcm5hJyk7CiAgICB9KTsKfSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>const axios = require('axios');

exports.callExternalAPI = functions.https.onRequest((req, res) =&gt; {
  axios.get('https://api.example.com/data')
    .then(response =&gt; {
      res.send(response.data);
    })
    .catch(error =&gt; {
      console.error('Error trucant a l'API externa:', error);
      res.status(500).send('Error trucant a l'API externa');
    });
});</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem cobert temes avançats en Funcions Cloud de Firebase, incloent tècniques d'optimització, gestió d'estructures de dades complexes i integració amb serveis de Firebase i API de tercers. En dominar aquests conceptes, podràs construir aplicacions més eficients, escalables i amb més funcionalitats utilitzant les Funcions Cloud de Firebase.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='triggering-functions'>&#x25C4;Activar Funcions</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Funcions Cloud Avançades</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-firebase-hosting'>Introducció a Firebase Hosting &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
