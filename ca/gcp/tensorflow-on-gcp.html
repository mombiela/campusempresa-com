<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TensorFlow a GCP</title>

    <link rel="alternate" href="https://campusempresa.com/es/gcp/tensorflow-on-gcp" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/gcp/tensorflow-on-gcp" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/gcp/tensorflow-on-gcp" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/gcp/tensorflow-on-gcp" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='automl'>&#x25C4; AutoML</a></div><div class='col-6 text-end'><a href='cloud-build'>Cloud Build &#x25BA;</a></div></div><div class='content'></div><h1>Introducció a TensorFlow i GCP</h1>
<div class='content'><p>TensorFlow és un marc de treball de machine learning de codi obert desenvolupat per Google, i GCP (Google Cloud Platform) proporciona un conjunt de serveis de computació en núvol que funcionen sobre la mateixa infraestructura que Google utilitza internament. Combinar TensorFlow amb GCP permet fluxos de treball de machine learning escalables, eficients i potents.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>TensorFlow</strong>: Un ecosistema complet i flexible d'eines, biblioteques i recursos comunitaris que permet als investigadors avançar en l'estat de l'art en ML, i als desenvolupadors construir i desplegar aplicacions impulsades per ML fàcilment.</li>
<li><strong>GCP</strong>: Un conjunt de serveis de computació en núvol que inclou computació, emmagatzematge de dades, anàlisi de dades i machine learning.</li>
</ul>
</div><h1>Configuració de TensorFlow a GCP</h1>
<div class='content'><p>Abans d'endinsar-nos en TensorFlow a GCP, cal configurar el teu entorn.</p>
</div><h2>Creació d'un Compte GCP</h2>
<div class='content'><ol>
<li>Ves al <a href="https://console.cloud.google.com/">Google Cloud Console</a>.</li>
<li>Registra't per a un nou compte o inicia sessió amb el teu compte de Google existent.</li>
<li>Configura la informació de facturació per accedir als serveis de nivell gratuït.</li>
</ol>
</div><h2>Configuració d'una Màquina Virtual</h2>
<div class='content'><ol>
<li>Navega a la secció Compute Engine.</li>
<li>Crea una nova instància de VM.</li>
<li>Tria un tipus de màquina adequat per a la teva càrrega de treball (per exemple, n1-standard-4).</li>
<li>Selecciona una imatge de TensorFlow del Google Cloud Marketplace.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGNvbXB1dGUgaW5zdGFuY2VzIGNyZWF0ZSB0ZW5zb3JmbG93LWluc3RhbmNlIFwKICAgIC0taW1hZ2UtZmFtaWx5PXRmLWxhdGVzdC1ncHUgXAogICAgLS1pbWFnZS1wcm9qZWN0PWRlZXBsZWFybmluZy1wbGF0Zm9ybS1yZWxlYXNlIFwKICAgIC0tbWFjaGluZS10eXBlPW4xLXN0YW5kYXJkLTQgXAogICAgLS16b25lPXVzLWNlbnRyYWwxLWE="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud compute instances create tensorflow-instance \
    --image-family=tf-latest-gpu \
    --image-project=deeplearning-platform-release \
    --machine-type=n1-standard-4 \
    --zone=us-central1-a</pre></div><div class='content'></div><h2>Instal·lació de TensorFlow</h2>
<div class='content'><p>Si prefereixes instal·lar TensorFlow manualment, pots SSH a la teva VM i executar:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3VkbyBhcHQtZ2V0IHVwZGF0ZQpzdWRvIGFwdC1nZXQgaW5zdGFsbCBweXRob24zLXBpcApwaXAzIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>sudo apt-get update
sudo apt-get install python3-pip
pip3 install tensorflow</pre></div><div class='content'></div><h1>Construcció i Entrenament de Models</h1>
<div class='content'><p>Un cop el teu entorn està configurat, pots començar a construir i entrenar models.</p>
</div><h2>Exemple: Regressió Lineal amb TensorFlow</h2>
<div class='content'><p>Aquí tens un exemple senzill de regressió lineal utilitzant TensorFlow.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKaW1wb3J0IG51bXB5IGFzIG5wCgojIEdlbmVyYXIgZGFkZXMgc2ludMOodGlxdWVzClggPSBucC5hcnJheShbMS4wLCAyLjAsIDMuMCwgNC4wXSwgZHR5cGU9bnAuZmxvYXQzMikKWSA9IG5wLmFycmF5KFsyLjAsIDQuMCwgNi4wLCA4LjBdLCBkdHlwZT1ucC5mbG9hdDMyKQoKIyBEZWZpbmlyIGVsIG1vZGVsCm1vZGVsID0gdGYua2VyYXMuU2VxdWVudGlhbChbdGYua2VyYXMubGF5ZXJzLkRlbnNlKHVuaXRzPTEsIGlucHV0X3NoYXBlPVsxXSldKQoKIyBDb21waWxhciBlbCBtb2RlbAptb2RlbC5jb21waWxlKG9wdGltaXplcj0nc2dkJywgbG9zcz0nbWVhbl9zcXVhcmVkX2Vycm9yJykKCiMgRW50cmVuYXIgZWwgbW9kZWwKbW9kZWwuZml0KFgsIFksIGVwb2Nocz01MDApCgojIFByZWRpcgpwcmludChtb2RlbC5wcmVkaWN0KFs1LjBdKSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
import numpy as np

# Generar dades sint&egrave;tiques
X = np.array([1.0, 2.0, 3.0, 4.0], dtype=np.float32)
Y = np.array([2.0, 4.0, 6.0, 8.0], dtype=np.float32)

# Definir el model
model = tf.keras.Sequential([tf.keras.layers.Dense(units=1, input_shape=[1])])

# Compilar el model
model.compile(optimizer='sgd', loss='mean_squared_error')

# Entrenar el model
model.fit(X, Y, epochs=500)

# Predir
print(model.predict([5.0]))</pre></div><div class='content'></div><h2>Utilitzant GCP AI Platform per a l'Entrenament</h2>
<div class='content'><p>GCP AI Platform proporciona serveis gestionats per entrenar i desplegar models de ML.</p>
<ol>
<li><strong>Prepara la teva aplicació d'entrenament</strong>: Empaqueta el teu codi de TensorFlow.</li>
<li><strong>Envia una feina d'entrenament</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGFpLXBsYXRmb3JtIGpvYnMgc3VibWl0IHRyYWluaW5nIG15X2pvYiBcCiAgICAtLW1vZHVsZS1uYW1lIHRyYWluZXIudGFzayBcCiAgICAtLXBhY2thZ2UtcGF0aCAuL3RyYWluZXIgXAogICAgLS1yZWdpb24gdXMtY2VudHJhbDEgXAogICAgLS1weXRob24tdmVyc2lvbiAzLjcgXAogICAgLS1ydW50aW1lLXZlcnNpb24gMi4x"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud ai-platform jobs submit training my_job \
    --module-name trainer.task \
    --package-path ./trainer \
    --region us-central1 \
    --python-version 3.7 \
    --runtime-version 2.1</pre></div><div class='content'></div><h1>Desplegament de Models a GCP</h1>
<div class='content'><p>Després d'entrenar el teu model, pots desplegar-lo a GCP per servir prediccions.</p>
</div><h2>Utilitzant AI Platform per al Desplegament de Models</h2>
<div class='content'><ol>
<li><strong>Guarda el teu model</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bW9kZWwuc2F2ZSgnbXlfbW9kZWwuaDUnKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>model.save('my_model.h5')</pre></div><div class='content'><ol start="2">
<li><strong>Carrega el model a Google Cloud Storage</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z3N1dGlsIGNwIG15X21vZGVsLmg1IGdzOi8vbXktYnVja2V0L21vZGVscy9teV9tb2RlbC5oNQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gsutil cp my_model.h5 gs://my-bucket/models/my_model.h5</pre></div><div class='content'><ol start="3">
<li><strong>Crea un model a AI Platform</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGFpLXBsYXRmb3JtIG1vZGVscyBjcmVhdGUgbXlfbW9kZWw="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud ai-platform models create my_model</pre></div><div class='content'><ol start="4">
<li><strong>Crea una versió del model</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Z2Nsb3VkIGFpLXBsYXRmb3JtIHZlcnNpb25zIGNyZWF0ZSB2MSBcCiAgICAtLW1vZGVsIG15X21vZGVsIFwKICAgIC0tb3JpZ2luIGdzOi8vbXktYnVja2V0L21vZGVscy9teV9tb2RlbC5oNSBcCiAgICAtLXJ1bnRpbWUtdmVyc2lvbiAyLjEgXAogICAgLS1weXRob24tdmVyc2lvbiAzLjc="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>gcloud ai-platform versions create v1 \
    --model my_model \
    --origin gs://my-bucket/models/my_model.h5 \
    --runtime-version 2.1 \
    --python-version 3.7</pre></div><div class='content'><ol start="5">
<li><strong>Fes prediccions</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGFpcGxhdGZvcm0KCmNsaWVudCA9IGFpcGxhdGZvcm0uZ2FwaWMuUHJlZGljdGlvblNlcnZpY2VDbGllbnQoKQpuYW1lID0gY2xpZW50Lm1vZGVsX3BhdGgoJ215X3Byb2plY3QnLCAnbXlfbW9kZWwnLCAndjEnKQpyZXNwb25zZSA9IGNsaWVudC5wcmVkaWN0KG5hbWU9bmFtZSwgaW5zdGFuY2VzPVtbNS4wXV0pCnByaW50KHJlc3BvbnNlKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import aiplatform

client = aiplatform.gapic.PredictionServiceClient()
name = client.model_path('my_project', 'my_model', 'v1')
response = client.predict(name=name, instances=[[5.0]])
print(response)</pre></div><div class='content'></div><h1>Monitorització i Optimització</h1>
<div class='content'><p>Monitoritzar i optimitzar els teus models de TensorFlow a GCP és crucial per mantenir el rendiment i l'eficiència de costos.</p>
</div><h2>Monitorització amb Stackdriver</h2>
<div class='content'><ul>
<li><strong>Configura Stackdriver</strong>: Utilitza Stackdriver per monitoritzar les teves instàncies de VM i les feines de TensorFlow.</li>
<li><strong>Registra mètriques</strong>: Integra el registre en el teu codi de TensorFlow per fer un seguiment de les mètriques de rendiment.</li>
</ul>
</div><h2>Consells d'Optimització</h2>
<div class='content'><ul>
<li><strong>Utilitza VMs Preemptibles</strong>: Redueix costos utilitzant VMs preemptibles per a càrregues de treball no crítiques.</li>
<li><strong>Optimitza els Pipelines de Dades</strong>: Utilitza serveis de GCP com Dataflow i BigQuery per optimitzar el processament de dades.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>TensorFlow a GCP ofereix una combinació potent per construir, entrenar i desplegar models de machine learning a escala. Aprofitant la infraestructura de GCP i les capacitats de TensorFlow, pots crear fluxos de treball de ML eficients i escalables. Aquest curs ha cobert els conceptes bàsics de la configuració del teu entorn, la construcció i entrenament de models, el seu desplegament i la monitorització del seu rendiment. Amb aquestes habilitats, estàs ben preparat per abordar projectes de machine learning més avançats a GCP.</p>
</div><div class='row navigation'><div class='col-6'><a href='automl'>&#x25C4; AutoML</a></div><div class='col-6 text-end'><a href='cloud-build'>Cloud Build &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
