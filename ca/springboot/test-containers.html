<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Contenidors de prova a Spring Boot</title>

    <link rel="alternate" href="https://campusempresa.com/es/springboot/test-containers" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/springboot/test-containers" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/springboot/test-containers" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/springboot/test-containers" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='testing-restful-web-services'>&#x25C4; Proves de Serveis Web RESTful</a></div><div class='col-6 text-end'><a href='spring-boot-actuator'>Spring Boot Actuator &#x25BA;</a></div></div><div class='content'></div><h1>Introducció als contenidors de prova</h1>
<div class='content'><p>Test Containers és una biblioteca Java que dóna suport a les proves JUnit proporcionant instàncies lleugeres i descartables de bases de dades comunes, navegadors web Selenium o qualsevol altra cosa que pugui executar-se en un contenidor Docker. Això permet als desenvolupadors escriure proves d'integració fiables que interactuen amb instàncies reals dels serveis dels quals depèn la seva aplicació.</p>
</div><h2>Conceptes clau</h2>
<div class='content'><ul>
<li><strong>Contenidors Docker</strong>: Paquets de programari lleugers, autònoms i executables que inclouen tot el necessari per executar un tros de programari, incloent-hi el codi, el temps d'execució, les biblioteques i les configuracions.</li>
<li><strong>JUnit</strong>: Un marc de proves popular per a aplicacions Java.</li>
<li><strong>Proves d'integració</strong>: Proves en les quals els mòduls de programari es combinen i es proven com a grup per assegurar-se que funcionen junts com s'espera.</li>
</ul>
</div><h1>Configuració dels contenidors de prova</h1>
<div class='content'><p>Per utilitzar Test Containers en un projecte Spring Boot, cal afegir les dependències necessàries al teu fitxer <code>pom.xml</code> o <code>build.gradle</code>.</p>
</div><h2>Dependència Maven</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcudGVzdGNvbnRhaW5lcnM8L2dyb3VwSWQ+CiAgICA8YXJ0aWZhY3RJZD50ZXN0Y29udGFpbmVyczwvYXJ0aWZhY3RJZD4KICAgIDx2ZXJzaW9uPjEuMTYuMDwvdmVyc2lvbj4KICAgIDxzY29wZT50ZXN0PC9zY29wZT4KPC9kZXBlbmRlbmN5Pgo8ZGVwZW5kZW5jeT4KICAgIDxncm91cElkPm9yZy50ZXN0Y29udGFpbmVyczwvZ3JvdXBJZD4KICAgIDxhcnRpZmFjdElkPmp1bml0LWp1cGl0ZXI8L2FydGlmYWN0SWQ+CiAgICA8dmVyc2lvbj4xLjE2LjA8L3ZlcnNpb24+CiAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CjwvZGVwZW5kZW5jeT4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.testcontainers&lt;/groupId&gt;
    &lt;artifactId&gt;testcontainers&lt;/artifactId&gt;
    &lt;version&gt;1.16.0&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.testcontainers&lt;/groupId&gt;
    &lt;artifactId&gt;junit-jupiter&lt;/artifactId&gt;
    &lt;version&gt;1.16.0&lt;/version&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div><div class='content'></div><h2>Dependència Gradle</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dGVzdEltcGxlbWVudGF0aW9uICdvcmcudGVzdGNvbnRhaW5lcnM6dGVzdGNvbnRhaW5lcnM6MS4xNi4wJwp0ZXN0SW1wbGVtZW50YXRpb24gJ29yZy50ZXN0Y29udGFpbmVyczpqdW5pdC1qdXBpdGVyOjEuMTYuMCc="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>testImplementation 'org.testcontainers:testcontainers:1.16.0'
testImplementation 'org.testcontainers:junit-jupiter:1.16.0'</pre></div><div class='content'></div><h1>Ús dels contenidors de prova amb Spring Boot</h1>
<h2>Exemple: Executar un contenidor PostgreSQL</h2>
<div class='content'><p>Per demostrar com utilitzar Test Containers, configurem un contenidor PostgreSQL per a proves d'integració.</p>
<ol>
<li>
<p><strong>Defineix el contenidor PostgreSQL</strong>:</p>
<pre><code class="language-java">import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import org.testcontainers.containers.PostgreSQLContainer;

@SpringBootTest
public class PostgresContainerTest {

    static PostgreSQLContainer&lt;?&gt; postgresContainer = new PostgreSQLContainer&lt;&gt;(&quot;postgres:13.1&quot;)
            .withDatabaseName(&quot;testdb&quot;)
            .withUsername(&quot;testuser&quot;)
            .withPassword(&quot;testpass&quot;);

    static {
        postgresContainer.start();
    }

    @Test
    void contextLoads() {
        // La teva lògica de prova aquí
    }
}
</code></pre>
</li>
<li>
<p><strong>Configura Spring Boot per utilitzar el contenidor</strong>:
Actualitza el teu <code>application.properties</code> per utilitzar la configuració de la base de dades del contenidor.</p>
<pre><code class="language-properties">spring.datasource.url=jdbc:postgresql://localhost:${postgresContainer.getMappedPort(5432)}/testdb
spring.datasource.username=testuser
spring.datasource.password=testpass
spring.datasource.driver-class-name=org.postgresql.Driver
</code></pre>
</li>
</ol>
</div><h2>Exemple: Executar un contenidor Redis</h2>
<div class='content'><ol>
<li>
<p><strong>Defineix el contenidor Redis</strong>:</p>
<pre><code class="language-java">import org.junit.jupiter.api.Test;
import org.springframework.boot.test.context.SpringBootTest;
import org.testcontainers.containers.GenericContainer;

@SpringBootTest
public class RedisContainerTest {

    static GenericContainer&lt;?&gt; redisContainer = new GenericContainer&lt;&gt;(&quot;redis:6.2.5&quot;)
            .withExposedPorts(6379);

    static {
        redisContainer.start();
    }

    @Test
    void contextLoads() {
        // La teva lògica de prova aquí
    }
}
</code></pre>
</li>
<li>
<p><strong>Configura Spring Boot per utilitzar el contenidor</strong>:
Actualitza el teu <code>application.properties</code> per utilitzar la configuració de Redis del contenidor.</p>
<pre><code class="language-properties">spring.redis.host=localhost
spring.redis.port=${redisContainer.getMappedPort(6379)}
</code></pre>
</li>
</ol>
</div><h1>Ús avançat</h1>
<h2>Personalització dels contenidors</h2>
<div class='content'><p>Pots personalitzar els contenidors afegint variables d'entorn, muntant volums o enllaçant contenidors.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UG9zdGdyZVNRTENvbnRhaW5lcjw/PiBwb3N0Z3Jlc0NvbnRhaW5lciA9IG5ldyBQb3N0Z3JlU1FMQ29udGFpbmVyPD4oInBvc3RncmVzOjEzLjEiKQogICAgICAgIC53aXRoRGF0YWJhc2VOYW1lKCJ0ZXN0ZGIiKQogICAgICAgIC53aXRoVXNlcm5hbWUoInRlc3R1c2VyIikKICAgICAgICAud2l0aFBhc3N3b3JkKCJ0ZXN0cGFzcyIpCiAgICAgICAgLndpdGhFbnYoIlBPU1RHUkVTX0lOSVREQl9BUkdTIiwgIi0tZW5jb2Rpbmc9VVRGLTgiKQogICAgICAgIC53aXRoRmlsZVN5c3RlbUJpbmQoIi9wYXRoL3RvL2luaXQuc3FsIiwgIi9kb2NrZXItZW50cnlwb2ludC1pbml0ZGIuZC9pbml0LnNxbCIpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PostgreSQLContainer&lt;?&gt; postgresContainer = new PostgreSQLContainer&lt;&gt;(&quot;postgres:13.1&quot;)
        .withDatabaseName(&quot;testdb&quot;)
        .withUsername(&quot;testuser&quot;)
        .withPassword(&quot;testpass&quot;)
        .withEnv(&quot;POSTGRES_INITDB_ARGS&quot;, &quot;--encoding=UTF-8&quot;)
        .withFileSystemBind(&quot;/path/to/init.sql&quot;, &quot;/docker-entrypoint-initdb.d/init.sql&quot;);</pre></div><div class='content'></div><h2>Reutilització dels contenidors</h2>
<div class='content'><p>Per accelerar les proves, pots reutilitzar els contenidors en diverses classes de prova.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5qdW5pdC5qdXBpdGVyLmFwaS5leHRlbnNpb24uRXh0ZW5kV2l0aDsKaW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsudGVzdC5jb250ZXh0Lmp1bml0Lmp1cGl0ZXIuU3ByaW5nRXh0ZW5zaW9uOwppbXBvcnQgb3JnLnRlc3Rjb250YWluZXJzLmp1bml0Lmp1cGl0ZXIuQ29udGFpbmVyOwppbXBvcnQgb3JnLnRlc3Rjb250YWluZXJzLmp1bml0Lmp1cGl0ZXIuVGVzdGNvbnRhaW5lcnM7CgpAVGVzdGNvbnRhaW5lcnMKQEV4dGVuZFdpdGgoU3ByaW5nRXh0ZW5zaW9uLmNsYXNzKQpwdWJsaWMgY2xhc3MgUmV1c2VDb250YWluZXJUZXN0IHsKCiAgICBAQ29udGFpbmVyCiAgICBwcml2YXRlIHN0YXRpYyBmaW5hbCBQb3N0Z3JlU1FMQ29udGFpbmVyPD8+IHBvc3RncmVzQ29udGFpbmVyID0gbmV3IFBvc3RncmVTUUxDb250YWluZXI8PigicG9zdGdyZXM6MTMuMSIpCiAgICAgICAgICAgIC53aXRoRGF0YWJhc2VOYW1lKCJ0ZXN0ZGIiKQogICAgICAgICAgICAud2l0aFVzZXJuYW1lKCJ0ZXN0dXNlciIpCiAgICAgICAgICAgIC53aXRoUGFzc3dvcmQoInRlc3RwYXNzIik7CgogICAgQFRlc3QKICAgIHZvaWQgdGVzdDEoKSB7CiAgICAgICAgLy8gTMOyZ2ljYSBkZSBwcm92YQogICAgfQoKICAgIEBUZXN0CiAgICB2b2lkIHRlc3QyKCkgewogICAgICAgIC8vIEzDsmdpY2EgZGUgcHJvdmEKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.junit.jupiter.api.extension.ExtendWith;
import org.springframework.test.context.junit.jupiter.SpringExtension;
import org.testcontainers.junit.jupiter.Container;
import org.testcontainers.junit.jupiter.Testcontainers;

@Testcontainers
@ExtendWith(SpringExtension.class)
public class ReuseContainerTest {

    @Container
    private static final PostgreSQLContainer&lt;?&gt; postgresContainer = new PostgreSQLContainer&lt;&gt;(&quot;postgres:13.1&quot;)
            .withDatabaseName(&quot;testdb&quot;)
            .withUsername(&quot;testuser&quot;)
            .withPassword(&quot;testpass&quot;);

    @Test
    void test1() {
        // L&ograve;gica de prova
    }

    @Test
    void test2() {
        // L&ograve;gica de prova
    }
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Test Containers proporcionen una manera poderosa de realitzar proves d'integració en aplicacions Spring Boot aprofitant els contenidors Docker. Permeten provar la teva aplicació contra instàncies reals dels serveis dels quals depèn, assegurant una major fiabilitat i consistència en les teves proves. Seguint els exemples i les directrius proporcionades, pots configurar i personalitzar Test Containers per adaptar-los a les teves necessitats de prova, des de contenidors de bases de dades simples fins a configuracions més complexes de múltiples serveis.</p>
</div><div class='row navigation'><div class='col-6'><a href='testing-restful-web-services'>&#x25C4; Proves de Serveis Web RESTful</a></div><div class='col-6 text-end'><a href='spring-boot-actuator'>Spring Boot Actuator &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
