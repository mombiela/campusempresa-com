<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proves de serveis web RESTful</title>

    <link rel="alternate" href="https://campusempresa.com/es/springboot/testing-restful-web-services" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/springboot/testing-restful-web-services" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/springboot/testing-restful-web-services" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/springboot/testing-restful-web-services" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Les proves són un aspecte crucial del desenvolupament de programari, assegurant que la teva aplicació es comporti com s'espera. En aquesta secció, cobrirem com provar serveis web RESTful en una aplicació Spring Boot, des de proves unitàries bàsiques fins a proves d'integració més avançades.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Proves Unitàries</strong>: Provar components individuals en aïllament.</li>
<li><strong>Proves d'Integració</strong>: Provar la interacció entre múltiples components.</li>
<li><strong>Mocking</strong>: Simular el comportament d'objectes complexos.</li>
<li><strong>Test RestTemplate</strong>: Una utilitat de Spring per provar serveis RESTful.</li>
<li><strong>JUnit</strong>: Un popular marc de proves en Java.</li>
<li><strong>Mockito</strong>: Un marc de mocking per a proves unitàries.</li>
</ul>
</div><h1>Configuració de l'Entorn de Proves</h1>
<div class='content'><p>Abans de començar a escriure proves, configurem el nostre entorn de proves.</p>
<ol>
<li>
<p><strong>Afegir Dependències</strong>: Assegura't de tenir les dependències necessàries en el teu fitxer <code>pom.xml</code>.</p>
<pre><code class="language-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.mockito&lt;/groupId&gt;
    &lt;artifactId&gt;mockito-core&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
</li>
<li>
<p><strong>Anotacions</strong>: Familiaritza't amb les anotacions clau.</p>
<ul>
<li><code>@SpringBootTest</code>: Utilitzada per a proves d'integració.</li>
<li><code>@WebMvcTest</code>: Utilitzada per provar controladors Spring MVC.</li>
<li><code>@MockBean</code>: Utilitzada per afegir mocks al Spring ApplicationContext.</li>
</ul>
</li>
</ol>
</div><h1>Proves Unitàries de Controladors REST</h1>
<div class='content'><p>Les proves unitàries es concentren en components individuals. Per als controladors REST, podem utilitzar <code>@WebMvcTest</code>.</p>
</div><h2>Exemple: Provar un Controlador REST</h2>
<div class='content'><p>Suposem que tenim un simple <code>UserController</code> amb un endpoint <code>GET</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJlc3RDb250cm9sbGVyCkBSZXF1ZXN0TWFwcGluZygiL3VzZXJzIikKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyIHsKICAgIEBHZXRNYXBwaW5nKCIve2lkfSIpCiAgICBwdWJsaWMgUmVzcG9uc2VFbnRpdHk8VXNlcj4gZ2V0VXNlckJ5SWQoQFBhdGhWYXJpYWJsZSBMb25nIGlkKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoaWQsICJKb2huIERvZSIpOwogICAgICAgIHJldHVybiBSZXNwb25zZUVudGl0eS5vayh1c2VyKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RestController
@RequestMapping(&quot;/users&quot;)
public class UserController {
    @GetMapping(&quot;/{id}&quot;)
    public ResponseEntity&lt;User&gt; getUserById(@PathVariable Long id) {
        User user = new User(id, &quot;John Doe&quot;);
        return ResponseEntity.ok(user);
    }
}</pre></div><div class='content'></div><h2>Escriure la Prova Unitària</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAV2ViTXZjVGVzdChVc2VyQ29udHJvbGxlci5jbGFzcykKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyVGVzdCB7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBNb2NrTXZjIG1vY2tNdmM7CgogICAgQFRlc3QKICAgIHB1YmxpYyB2b2lkIHRlc3RHZXRVc2VyQnlJZCgpIHRocm93cyBFeGNlcHRpb24gewogICAgICAgIG1vY2tNdmMucGVyZm9ybShnZXQoIi91c2Vycy8xIikpCiAgICAgICAgICAgICAgICAuYW5kRXhwZWN0KHN0YXR1cygpLmlzT2soKSkKICAgICAgICAgICAgICAgIC5hbmRFeHBlY3QoanNvblBhdGgoIiQubmFtZSIpLnZhbHVlKCJKb2huIERvZSIpKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@WebMvcTest(UserController.class)
public class UserControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @Test
    public void testGetUserById() throws Exception {
        mockMvc.perform(get(&quot;/users/1&quot;))
                .andExpect(status().isOk())
                .andExpect(jsonPath(&quot;$.name&quot;).value(&quot;John Doe&quot;));
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>@RunWith(SpringRunner.class)</code>: Integra el Spring TestContext Framework amb JUnit.</li>
<li><code>@WebMvcTest(UserController.class)</code>: Configura la infraestructura Spring MVC per provar el <code>UserController</code>.</li>
<li><code>MockMvc</code>: Una classe per realitzar sol·licituds i verificar respostes.</li>
<li><code>mockMvc.perform(get(&quot;/users/1&quot;))</code>: Simula una sol·licitud GET a <code>/users/1</code>.</li>
<li><code>andExpect(status().isOk())</code>: Assegura que l'estat de la resposta és 200 OK.</li>
<li><code>andExpect(jsonPath(&quot;$.name&quot;).value(&quot;John Doe&quot;))</code>: Assegura que la resposta JSON conté el nom esperat.</li>
</ul>
</li>
</ul>
</div><h1>Proves d'Integració de Serveis RESTful</h1>
<div class='content'><p>Les proves d'integració verifiquen la interacció entre múltiples components. Per això, utilitzem <code>@SpringBootTest</code>.</p>
</div><h2>Exemple: Prova d'Integració</h2>
<div class='content'><p>Suposem que tenim un <code>UserService</code> que interactua amb una base de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFNlcnZpY2UKcHVibGljIGNsYXNzIFVzZXJTZXJ2aWNlIHsKICAgIHB1YmxpYyBVc2VyIGdldFVzZXJCeUlkKExvbmcgaWQpIHsKICAgICAgICByZXR1cm4gbmV3IFVzZXIoaWQsICJKb2huIERvZSIpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Service
public class UserService {
    public User getUserById(Long id) {
        return new User(id, &quot;John Doe&quot;);
    }
}</pre></div><div class='content'></div><h2>Escriure la Prova d'Integració</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAU3ByaW5nQm9vdFRlc3QKcHVibGljIGNsYXNzIFVzZXJTZXJ2aWNlSW50ZWdyYXRpb25UZXN0IHsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJTZXJ2aWNlIHVzZXJTZXJ2aWNlOwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0VXNlckJ5SWQoKSB7CiAgICAgICAgVXNlciB1c2VyID0gdXNlclNlcnZpY2UuZ2V0VXNlckJ5SWQoMUwpOwogICAgICAgIGFzc2VydE5vdE51bGwodXNlcik7CiAgICAgICAgYXNzZXJ0RXF1YWxzKCJKb2huIERvZSIsIHVzZXIuZ2V0TmFtZSgpKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@SpringBootTest
public class UserServiceIntegrationTest {

    @Autowired
    private UserService userService;

    @Test
    public void testGetUserById() {
        User user = userService.getUserById(1L);
        assertNotNull(user);
        assertEquals(&quot;John Doe&quot;, user.getName());
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>@SpringBootTest</code>: Carrega el context complet de l'aplicació.</li>
<li><code>@Autowired</code>: Injecta el bean <code>UserService</code>.</li>
<li><code>assertNotNull(user)</code>: Assegura que l'objecte user no és nul.</li>
<li><code>assertEquals(&quot;John Doe&quot;, user.getName())</code>: Assegura que el nom de l'usuari és &quot;John Doe&quot;.</li>
</ul>
</li>
</ul>
</div><h1>Mocking de Dependències</h1>
<div class='content'><p>Quan es fan proves unitàries, sovint cal fer mocking de dependències per aïllar el component sota prova.</p>
</div><h2>Exemple: Mocking d'un Servei</h2>
<div class='content'><p>Suposem que <code>UserController</code> depèn de <code>UserService</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJlc3RDb250cm9sbGVyCkBSZXF1ZXN0TWFwcGluZygiL3VzZXJzIikKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyIHsKICAgIEBBdXRvd2lyZWQKICAgIHByaXZhdGUgVXNlclNlcnZpY2UgdXNlclNlcnZpY2U7CgogICAgQEdldE1hcHBpbmcoIi97aWR9IikKICAgIHB1YmxpYyBSZXNwb25zZUVudGl0eTxVc2VyPiBnZXRVc2VyQnlJZChAUGF0aFZhcmlhYmxlIExvbmcgaWQpIHsKICAgICAgICBVc2VyIHVzZXIgPSB1c2VyU2VydmljZS5nZXRVc2VyQnlJZChpZCk7CiAgICAgICAgcmV0dXJuIFJlc3BvbnNlRW50aXR5Lm9rKHVzZXIpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RestController
@RequestMapping(&quot;/users&quot;)
public class UserController {
    @Autowired
    private UserService userService;

    @GetMapping(&quot;/{id}&quot;)
    public ResponseEntity&lt;User&gt; getUserById(@PathVariable Long id) {
        User user = userService.getUserById(id);
        return ResponseEntity.ok(user);
    }
}</pre></div><div class='content'></div><h2>Escriure la Prova amb Mocking</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAV2ViTXZjVGVzdChVc2VyQ29udHJvbGxlci5jbGFzcykKcHVibGljIGNsYXNzIFVzZXJDb250cm9sbGVyVGVzdCB7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBNb2NrTXZjIG1vY2tNdmM7CgogICAgQE1vY2tCZWFuCiAgICBwcml2YXRlIFVzZXJTZXJ2aWNlIHVzZXJTZXJ2aWNlOwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0R2V0VXNlckJ5SWQoKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBVc2VyIG1vY2tVc2VyID0gbmV3IFVzZXIoMUwsICJKb2huIERvZSIpOwogICAgICAgIHdoZW4odXNlclNlcnZpY2UuZ2V0VXNlckJ5SWQoMUwpKS50aGVuUmV0dXJuKG1vY2tVc2VyKTsKCiAgICAgICAgbW9ja012Yy5wZXJmb3JtKGdldCgiL3VzZXJzLzEiKSkKICAgICAgICAgICAgICAgIC5hbmRFeHBlY3Qoc3RhdHVzKCkuaXNPaygpKQogICAgICAgICAgICAgICAgLmFuZEV4cGVjdChqc29uUGF0aCgiJC5uYW1lIikudmFsdWUoIkpvaG4gRG9lIikpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@WebMvcTest(UserController.class)
public class UserControllerTest {

    @Autowired
    private MockMvc mockMvc;

    @MockBean
    private UserService userService;

    @Test
    public void testGetUserById() throws Exception {
        User mockUser = new User(1L, &quot;John Doe&quot;);
        when(userService.getUserById(1L)).thenReturn(mockUser);

        mockMvc.perform(get(&quot;/users/1&quot;))
                .andExpect(status().isOk())
                .andExpect(jsonPath(&quot;$.name&quot;).value(&quot;John Doe&quot;));
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>@MockBean</code>: Crea un mock de <code>UserService</code> i l'injecta en el context de l'aplicació.</li>
<li><code>when(userService.getUserById(1L)).thenReturn(mockUser)</code>: Configura el mock per retornar <code>mockUser</code> quan es crida <code>getUserById</code>.</li>
</ul>
</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Provar serveis web RESTful en Spring Boot implica tant proves unitàries com proves d'integració. Les proves unitàries es concentren en components individuals, sovint utilitzant mocking per aïllar dependències, mentre que les proves d'integració verifiquen la interacció entre múltiples components. Utilitzant eines com <code>MockMvc</code>, <code>JUnit</code> i <code>Mockito</code>, pots assegurar-te que els teus serveis RESTful es comportin com s'espera, portant a aplicacions més robustes i fiables.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
