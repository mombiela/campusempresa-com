<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Autenticació i Autorització en Spring Boot</title>

    <link rel="alternate" href="https://campusempresa.com/es/springboot/authentication-and-authorization" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/springboot/authentication-and-authorization" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/springboot/authentication-and-authorization" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/springboot/authentication-and-authorization" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='securing-restful-web-services'>&#x25C4; Assegurant Serveis Web RESTful</a></div><div class='col-6 text-end'><a href='jwt-authentication'>Autenticació JWT (JSON Web Token) &#x25BA;</a></div></div><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>L'autenticació i l'autorització són components crítics de qualsevol aplicació segura. En aquesta secció, explorarem com implementar aquests conceptes en una aplicació Spring Boot. Cobrirem els conceptes bàsics per a principiants i gradualment passarem a temes més avançats.</p>
</div><h1>Autenticació</h1>
<div class='content'></div><h2>Què és l'Autenticació?</h2>
<div class='content'><p>L'autenticació és el procés de verificar la identitat d'un usuari o sistema. Assegura que l'entitat que intenta accedir al sistema és qui diu ser.</p>
</div><h2>Autenticació Bàsica amb Spring Security</h2>
<div class='content'><p>Spring Security és un marc d'autenticació i control d'accés potent i altament personalitzable. És l'estàndard de facto per assegurar aplicacions basades en Spring.</p>
<h4>Afegint la Dependència de Spring Security</h4>
<p>Primer, afegeix la dependència de Spring Security al teu fitxer <code>pom.xml</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcuc3ByaW5nZnJhbWV3b3JrLmJvb3Q8L2dyb3VwSWQ+CiAgICA8YXJ0aWZhY3RJZD5zcHJpbmctYm9vdC1zdGFydGVyLXNlY3VyaXR5PC9hcnRpZmFjdElkPgo8L2RlcGVuZGVuY3k+"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;
&lt;/dependency&gt;</pre></div><div class='content'><h4>Configurant l'Autenticació Bàsica</h4>
<p>Crea una classe de configuració de seguretat per configurar l'autenticació bàsica:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuY29udGV4dC5hbm5vdGF0aW9uLkNvbmZpZ3VyYXRpb247CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnNlY3VyaXR5LmNvbmZpZy5hbm5vdGF0aW9uLmF1dGhlbnRpY2F0aW9uLmJ1aWxkZXJzLkF1dGhlbnRpY2F0aW9uTWFuYWdlckJ1aWxkZXI7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnNlY3VyaXR5LmNvbmZpZy5hbm5vdGF0aW9uLndlYi5idWlsZGVycy5IdHRwU2VjdXJpdHk7CmltcG9ydCBvcmcuc3ByaW5nZnJhbWV3b3JrLnNlY3VyaXR5LmNvbmZpZy5hbm5vdGF0aW9uLndlYi5jb25maWd1cmF0aW9uLkVuYWJsZVdlYlNlY3VyaXR5OwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5zZWN1cml0eS5jb25maWcuYW5ub3RhdGlvbi53ZWIuY29uZmlndXJhdGlvbi5XZWJTZWN1cml0eUNvbmZpZ3VyZXJBZGFwdGVyOwoKQENvbmZpZ3VyYXRpb24KQEVuYWJsZVdlYlNlY3VyaXR5CnB1YmxpYyBjbGFzcyBTZWN1cml0eUNvbmZpZyBleHRlbmRzIFdlYlNlY3VyaXR5Q29uZmlndXJlckFkYXB0ZXIgewoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgY29uZmlndXJlKEF1dGhlbnRpY2F0aW9uTWFuYWdlckJ1aWxkZXIgYXV0aCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICAgICAgYXV0aC5pbk1lbW9yeUF1dGhlbnRpY2F0aW9uKCkKICAgICAgICAgICAgLndpdGhVc2VyKCJ1c2VyIikucGFzc3dvcmQoIntub29wfXBhc3N3b3JkIikucm9sZXMoIlVTRVIiKQogICAgICAgICAgICAuYW5kKCkKICAgICAgICAgICAgLndpdGhVc2VyKCJhZG1pbiIpLnBhc3N3b3JkKCJ7bm9vcH1hZG1pbiIpLnJvbGVzKCJBRE1JTiIpOwogICAgfQoKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIHZvaWQgY29uZmlndXJlKEh0dHBTZWN1cml0eSBodHRwKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBodHRwCiAgICAgICAgICAgIC5hdXRob3JpemVSZXF1ZXN0cygpCiAgICAgICAgICAgICAgICAuYW55UmVxdWVzdCgpLmF1dGhlbnRpY2F0ZWQoKQogICAgICAgICAgICAgICAgLmFuZCgpCiAgICAgICAgICAgIC5odHRwQmFzaWMoKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.context.annotation.Configuration;
import org.springframework.security.config.annotation.authentication.builders.AuthenticationManagerBuilder;
import org.springframework.security.config.annotation.web.builders.HttpSecurity;
import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;
import org.springframework.security.config.annotation.web.configuration.WebSecurityConfigurerAdapter;

@Configuration
@EnableWebSecurity
public class SecurityConfig extends WebSecurityConfigurerAdapter {

    @Override
    protected void configure(AuthenticationManagerBuilder auth) throws Exception {
        auth.inMemoryAuthentication()
            .withUser(&quot;user&quot;).password(&quot;{noop}password&quot;).roles(&quot;USER&quot;)
            .and()
            .withUser(&quot;admin&quot;).password(&quot;{noop}admin&quot;).roles(&quot;ADMIN&quot;);
    }

    @Override
    protected void configure(HttpSecurity http) throws Exception {
        http
            .authorizeRequests()
                .anyRequest().authenticated()
                .and()
            .httpBasic();
    }
}</pre></div><div class='content'><ul>
<li><code>@EnableWebSecurity</code>: Habilita el suport de seguretat web de Spring Security.</li>
<li><code>configure(AuthenticationManagerBuilder auth)</code>: Configura l'autenticació en memòria amb dos usuaris.</li>
<li><code>configure(HttpSecurity http)</code>: Configura l'autenticació bàsica HTTP.</li>
</ul>
</div><h2>Autenticació Basada en Formulari</h2>
<div class='content'><p>L'autenticació basada en formulari permet als usuaris iniciar sessió mitjançant un formulari HTML personalitzat.</p>
<h4>Configurant l'Autenticació Basada en Formulari</h4>
<p>Modifica la classe <code>SecurityConfig</code> per utilitzar l'autenticació basada en formulari:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QE92ZXJyaWRlCnByb3RlY3RlZCB2b2lkIGNvbmZpZ3VyZShIdHRwU2VjdXJpdHkgaHR0cCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICBodHRwCiAgICAgICAgLmF1dGhvcml6ZVJlcXVlc3RzKCkKICAgICAgICAgICAgLmFueVJlcXVlc3QoKS5hdXRoZW50aWNhdGVkKCkKICAgICAgICAgICAgLmFuZCgpCiAgICAgICAgLmZvcm1Mb2dpbigpCiAgICAgICAgICAgIC5sb2dpblBhZ2UoIi9sb2dpbiIpCiAgICAgICAgICAgIC5wZXJtaXRBbGwoKQogICAgICAgICAgICAuYW5kKCkKICAgICAgICAubG9nb3V0KCkKICAgICAgICAgICAgLnBlcm1pdEFsbCgpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Override
protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .anyRequest().authenticated()
            .and()
        .formLogin()
            .loginPage(&quot;/login&quot;)
            .permitAll()
            .and()
        .logout()
            .permitAll();
}</pre></div><div class='content'><ul>
<li><code>formLogin()</code>: Configura l'inici de sessió basat en formulari.</li>
<li><code>loginPage(&quot;/login&quot;)</code>: Especifica la pàgina d'inici de sessió personalitzada.</li>
</ul>
<h4>Creant una Pàgina d'Inici de Sessió Personalitzada</h4>
<p>Crea un fitxer HTML anomenat <code>login.html</code> al directori <code>src/main/resources/templates</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDx0aXRsZT5Mb2dpbjwvdGl0bGU+CjwvaGVhZD4KPGJvZHk+CiAgICA8aDI+TG9naW48L2gyPgogICAgPGZvcm0gbWV0aG9kPSJwb3N0IiBhY3Rpb249Ii9sb2dpbiI+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGxhYmVsPlVzZXJuYW1lOjwvbGFiZWw+CiAgICAgICAgICAgIDxpbnB1dCB0eXBlPSJ0ZXh0IiBuYW1lPSJ1c2VybmFtZSIvPgogICAgICAgIDwvZGl2PgogICAgICAgIDxkaXY+CiAgICAgICAgICAgIDxsYWJlbD5QYXNzd29yZDo8L2xhYmVsPgogICAgICAgICAgICA8aW5wdXQgdHlwZT0icGFzc3dvcmQiIG5hbWU9InBhc3N3b3JkIi8+CiAgICAgICAgPC9kaXY+CiAgICAgICAgPGRpdj4KICAgICAgICAgICAgPGJ1dHRvbiB0eXBlPSJzdWJtaXQiPkxvZ2luPC9idXR0b24+CiAgICAgICAgPC9kaXY+CiAgICA8L2Zvcm0+CjwvYm9keT4KPC9odG1sPg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Login&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;h2&gt;Login&lt;/h2&gt;
    &lt;form method=&quot;post&quot; action=&quot;/login&quot;&gt;
        &lt;div&gt;
            &lt;label&gt;Username:&lt;/label&gt;
            &lt;input type=&quot;text&quot; name=&quot;username&quot;/&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;label&gt;Password:&lt;/label&gt;
            &lt;input type=&quot;password&quot; name=&quot;password&quot;/&gt;
        &lt;/div&gt;
        &lt;div&gt;
            &lt;button type=&quot;submit&quot;&gt;Login&lt;/button&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</pre></div><div class='content'></div><h1>Autorització</h1>
<div class='content'></div><h2>Què és l'Autorització?</h2>
<div class='content'><p>L'autorització és el procés de determinar si un usuari autenticat té permís per accedir a un recurs o realitzar una acció.</p>
</div><h2>Control d'Accés Basat en Rols (RBAC)</h2>
<div class='content'><p>RBAC restringeix l'accés basat en els rols assignats als usuaris.</p>
<h4>Configurant el Control d'Accés Basat en Rols</h4>
<p>Actualitza la classe <code>SecurityConfig</code> per restringir l'accés basat en rols:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QE92ZXJyaWRlCnByb3RlY3RlZCB2b2lkIGNvbmZpZ3VyZShIdHRwU2VjdXJpdHkgaHR0cCkgdGhyb3dzIEV4Y2VwdGlvbiB7CiAgICBodHRwCiAgICAgICAgLmF1dGhvcml6ZVJlcXVlc3RzKCkKICAgICAgICAgICAgLmFudE1hdGNoZXJzKCIvYWRtaW4vKioiKS5oYXNSb2xlKCJBRE1JTiIpCiAgICAgICAgICAgIC5hbnRNYXRjaGVycygiL3VzZXIvKioiKS5oYXNSb2xlKCJVU0VSIikKICAgICAgICAgICAgLmFueVJlcXVlc3QoKS5hdXRoZW50aWNhdGVkKCkKICAgICAgICAgICAgLmFuZCgpCiAgICAgICAgLmZvcm1Mb2dpbigpCiAgICAgICAgICAgIC5sb2dpblBhZ2UoIi9sb2dpbiIpCiAgICAgICAgICAgIC5wZXJtaXRBbGwoKQogICAgICAgICAgICAuYW5kKCkKICAgICAgICAubG9nb3V0KCkKICAgICAgICAgICAgLnBlcm1pdEFsbCgpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Override
protected void configure(HttpSecurity http) throws Exception {
    http
        .authorizeRequests()
            .antMatchers(&quot;/admin/**&quot;).hasRole(&quot;ADMIN&quot;)
            .antMatchers(&quot;/user/**&quot;).hasRole(&quot;USER&quot;)
            .anyRequest().authenticated()
            .and()
        .formLogin()
            .loginPage(&quot;/login&quot;)
            .permitAll()
            .and()
        .logout()
            .permitAll();
}</pre></div><div class='content'><ul>
<li><code>antMatchers(&quot;/admin/**&quot;).hasRole(&quot;ADMIN&quot;)</code>: Restringeix l'accés a les URL que comencen amb <code>/admin</code> als usuaris amb el rol <code>ADMIN</code>.</li>
<li><code>antMatchers(&quot;/user/**&quot;).hasRole(&quot;USER&quot;)</code>: Restringeix l'accés a les URL que comencen amb <code>/user</code> als usuaris amb el rol <code>USER</code>.</li>
</ul>
</div><h2>Seguretat a Nivell de Mètode</h2>
<div class='content'><p>Spring Security també permet assegurar mètodes a la capa de servei.</p>
<h4>Habilitant la Seguretat a Nivell de Mètode</h4>
<p>Habilita la seguretat a nivell de mètode afegint l'anotació <code>@EnableGlobalMethodSecurity</code> a la teva classe de configuració de seguretat:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuY29uZmlnLmFubm90YXRpb24ubWV0aG9kLmNvbmZpZ3VyYXRpb24uRW5hYmxlR2xvYmFsTWV0aG9kU2VjdXJpdHk7CgpAQ29uZmlndXJhdGlvbgpARW5hYmxlV2ViU2VjdXJpdHkKQEVuYWJsZUdsb2JhbE1ldGhvZFNlY3VyaXR5KHByZVBvc3RFbmFibGVkID0gdHJ1ZSkKcHVibGljIGNsYXNzIFNlY3VyaXR5Q29uZmlnIGV4dGVuZHMgV2ViU2VjdXJpdHlDb25maWd1cmVyQWRhcHRlciB7CiAgICAvLyBjb2RpIGV4aXN0ZW50Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.security.config.annotation.method.configuration.EnableGlobalMethodSecurity;

@Configuration
@EnableWebSecurity
@EnableGlobalMethodSecurity(prePostEnabled = true)
public class SecurityConfig extends WebSecurityConfigurerAdapter {
    // codi existent
}</pre></div><div class='content'><h4>Assegurant Mètodes amb Anotacions</h4>
<p>Utilitza anotacions per assegurar mètodes a les teves classes de servei:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5zcHJpbmdmcmFtZXdvcmsuc2VjdXJpdHkuYWNjZXNzLnByZXBvc3QuUHJlQXV0aG9yaXplOwppbXBvcnQgb3JnLnNwcmluZ2ZyYW1ld29yay5zdGVyZW90eXBlLlNlcnZpY2U7CgpAU2VydmljZQpwdWJsaWMgY2xhc3MgTXlTZXJ2aWNlIHsKCiAgICBAUHJlQXV0aG9yaXplKCJoYXNSb2xlKCdBRE1JTicpIikKICAgIHB1YmxpYyB2b2lkIGFkbWluTWV0aG9kKCkgewogICAgICAgIC8vIGzDsmdpY2EgZGVsIG3DqHRvZGUKICAgIH0KCiAgICBAUHJlQXV0aG9yaXplKCJoYXNSb2xlKCdVU0VSJykiKQogICAgcHVibGljIHZvaWQgdXNlck1ldGhvZCgpIHsKICAgICAgICAvLyBsw7JnaWNhIGRlbCBtw6h0b2RlCiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.springframework.security.access.prepost.PreAuthorize;
import org.springframework.stereotype.Service;

@Service
public class MyService {

    @PreAuthorize(&quot;hasRole('ADMIN')&quot;)
    public void adminMethod() {
        // l&ograve;gica del m&egrave;tode
    }

    @PreAuthorize(&quot;hasRole('USER')&quot;)
    public void userMethod() {
        // l&ograve;gica del m&egrave;tode
    }
}</pre></div><div class='content'><ul>
<li><code>@PreAuthorize(&quot;hasRole('ADMIN')&quot;)</code>: Assegura que només els usuaris amb el rol <code>ADMIN</code> poden accedir al mètode <code>adminMethod</code>.</li>
<li><code>@PreAuthorize(&quot;hasRole('USER')&quot;)</code>: Assegura que només els usuaris amb el rol <code>USER</code> poden accedir al mètode <code>userMethod</code>.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem cobert els conceptes bàsics d'autenticació i autorització en Spring Boot utilitzant Spring Security. Hem començat amb l'autenticació bàsica, hem passat a l'autenticació basada en formulari, i després hem explorat el control d'accés basat en rols i la seguretat a nivell de mètode. Entenent aquests conceptes, pots assegurar les teves aplicacions Spring Boot de manera efectiva.</p>
</div><div class='row navigation'><div class='col-6'><a href='securing-restful-web-services'>&#x25C4; Assegurant Serveis Web RESTful</a></div><div class='col-6 text-end'><a href='jwt-authentication'>Autenticació JWT (JSON Web Token) &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
