<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/springboot/integration-testing" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>Les proves d'integració són una part crucial del cicle de vida del desenvolupament de programari, especialment en aplicacions Spring Boot. Asseguren que diferents parts de l'aplicació funcionin juntes com s'espera. Aquest tema et guiarà a través dels conceptes essencials de les proves d'integració en Spring Boot, des de nivells bàsics fins a avançats.</p>
</div><h1>Què són les Proves d'Integració?</h1>
<div class='content'><p>Les proves d'integració impliquen provar les interaccions entre diferents mòduls o components d'una aplicació. A diferència de les proves unitàries, que proven components individuals de manera aïllada, les proves d'integració verifiquen que els components funcionin correctament junts.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Proves d'Integració vs. Proves Unitàries</strong>: Les proves unitàries se centren en components individuals, mentre que les proves d'integració se centren en la interacció entre components.</li>
<li><strong>Context de Spring</strong>: En Spring Boot, les proves d'integració sovint impliquen carregar el context de l'aplicació Spring per provar les interaccions entre beans.</li>
<li><strong>Entorn de Prova</strong>: Les proves d'integració poden requerir una configuració més complexa, incloent bases de dades, serveis externs i altres dependències.</li>
</ul>
</div><h1>Configuració de Proves d'Integració en Spring Boot</h1>
<div class='content'><p>Per configurar proves d'integració en Spring Boot, necessites incloure les dependències necessàries i configurar el teu entorn de prova.</p>
</div><h2>Dependències</h2>
<div class='content'><p>Afegeix les següents dependències al teu fitxer <code>pom.xml</code> o <code>build.gradle</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCEtLSBQZXIgYSBNYXZlbiAtLT4KPGRlcGVuZGVuY3k+CiAgICA8Z3JvdXBJZD5vcmcuc3ByaW5nZnJhbWV3b3JrLmJvb3Q8L2dyb3VwSWQ+CiAgICA8YXJ0aWZhY3RJZD5zcHJpbmctYm9vdC1zdGFydGVyLXRlc3Q8L2FydGlmYWN0SWQ+CiAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CjwvZGVwZW5kZW5jeT4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!-- Per a Maven --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div><div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gUGVyIGEgR3JhZGxlCnRlc3RJbXBsZW1lbnRhdGlvbiAnb3JnLnNwcmluZ2ZyYW1ld29yay5ib290OnNwcmluZy1ib290LXN0YXJ0ZXItdGVzdCc="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Per a Gradle
testImplementation 'org.springframework.boot:spring-boot-starter-test'</pre></div><div class='content'></div><h2>Configuració</h2>
<div class='content'><p>Spring Boot proporciona diverses anotacions per ajudar a configurar les teves proves d'integració:</p>
<ul>
<li><code>@SpringBootTest</code>: Carrega el context complet de l'aplicació.</li>
<li><code>@TestConfiguration</code>: Defineix beans o configuracions addicionals per a les proves.</li>
<li><code>@MockBean</code>: Crea i injecta mocks en el context de Spring.</li>
</ul>
</div><h1>Escriure la Teva Primera Prova d'Integració</h1>
<div class='content'><p>Escrivim una simple prova d'integració per a una aplicació Spring Boot.</p>
</div><h2>Aplicació d'Exemple</h2>
<div class='content'><p>Suposem que tenim un simple <code>UserService</code> que interactua amb un <code>UserRepository</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFNlcnZpY2UKcHVibGljIGNsYXNzIFVzZXJTZXJ2aWNlIHsKICAgIEBBdXRvd2lyZWQKICAgIHByaXZhdGUgVXNlclJlcG9zaXRvcnkgdXNlclJlcG9zaXRvcnk7CgogICAgcHVibGljIFVzZXIgZ2V0VXNlckJ5SWQoTG9uZyBpZCkgewogICAgICAgIHJldHVybiB1c2VyUmVwb3NpdG9yeS5maW5kQnlJZChpZCkub3JFbHNlKG51bGwpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@Service
public class UserService {
    @Autowired
    private UserRepository userRepository;

    public User getUserById(Long id) {
        return userRepository.findById(id).orElse(null);
    }
}</pre></div><div class='content'></div><h2>Exemple de Prova d'Integració</h2>
<div class='content'><p>Aquí tens com pots escriure una prova d'integració per al <code>UserService</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAU3ByaW5nQm9vdFRlc3QKcHVibGljIGNsYXNzIFVzZXJTZXJ2aWNlSW50ZWdyYXRpb25UZXN0IHsKCiAgICBAQXV0b3dpcmVkCiAgICBwcml2YXRlIFVzZXJTZXJ2aWNlIHVzZXJTZXJ2aWNlOwoKICAgIEBBdXRvd2lyZWQKICAgIHByaXZhdGUgVXNlclJlcG9zaXRvcnkgdXNlclJlcG9zaXRvcnk7CgogICAgQEJlZm9yZQogICAgcHVibGljIHZvaWQgc2V0VXAoKSB7CiAgICAgICAgVXNlciB1c2VyID0gbmV3IFVzZXIoKTsKICAgICAgICB1c2VyLnNldElkKDFMKTsKICAgICAgICB1c2VyLnNldE5hbWUoIkpvaG4gRG9lIik7CiAgICAgICAgdXNlclJlcG9zaXRvcnkuc2F2ZSh1c2VyKTsKICAgIH0KCiAgICBAVGVzdAogICAgcHVibGljIHZvaWQgdGVzdEdldFVzZXJCeUlkKCkgewogICAgICAgIFVzZXIgdXNlciA9IHVzZXJTZXJ2aWNlLmdldFVzZXJCeUlkKDFMKTsKICAgICAgICBhc3NlcnROb3ROdWxsKHVzZXIpOwogICAgICAgIGFzc2VydEVxdWFscygiSm9obiBEb2UiLCB1c2VyLmdldE5hbWUoKSk7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@SpringBootTest
public class UserServiceIntegrationTest {

    @Autowired
    private UserService userService;

    @Autowired
    private UserRepository userRepository;

    @Before
    public void setUp() {
        User user = new User();
        user.setId(1L);
        user.setName(&quot;John Doe&quot;);
        userRepository.save(user);
    }

    @Test
    public void testGetUserById() {
        User user = userService.getUserById(1L);
        assertNotNull(user);
        assertEquals(&quot;John Doe&quot;, user.getName());
    }
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>Anotacions</strong>:
<ul>
<li><code>@RunWith(SpringRunner.class)</code>: Integra el Spring TestContext Framework amb JUnit.</li>
<li><code>@SpringBootTest</code>: Carrega el context complet de l'aplicació.</li>
</ul>
</li>
<li><strong>Mètode de Configuració</strong>: El mètode <code>setUp</code> inicialitza les dades de prova.</li>
<li><strong>Mètode de Prova</strong>: El mètode <code>testGetUserById</code> verifica que el <code>UserService</code> recuperi correctament un usuari per ID.</li>
</ul>
</div><h1>Proves d'Integració Avançades</h1>
<div class='content'><p>A mesura que avances, potser necessitaràs provar escenaris més complexos, com les interaccions amb serveis externs o bases de dades.</p>
</div><h2>Simulació de Serveis Externs</h2>
<div class='content'><p>Utilitza <code>@MockBean</code> per simular serveis externs en les teves proves d'integració.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QFJ1bldpdGgoU3ByaW5nUnVubmVyLmNsYXNzKQpAU3ByaW5nQm9vdFRlc3QKcHVibGljIGNsYXNzIEV4dGVybmFsU2VydmljZUludGVncmF0aW9uVGVzdCB7CgogICAgQE1vY2tCZWFuCiAgICBwcml2YXRlIEV4dGVybmFsU2VydmljZSBleHRlcm5hbFNlcnZpY2U7CgogICAgQEF1dG93aXJlZAogICAgcHJpdmF0ZSBNeVNlcnZpY2UgbXlTZXJ2aWNlOwoKICAgIEBUZXN0CiAgICBwdWJsaWMgdm9pZCB0ZXN0RXh0ZXJuYWxTZXJ2aWNlSW50ZXJhY3Rpb24oKSB7CiAgICAgICAgd2hlbihleHRlcm5hbFNlcnZpY2UuY2FsbEV4dGVybmFsQXBpKCkpLnRoZW5SZXR1cm4oIk1vY2sgUmVzcG9uc2UiKTsKCiAgICAgICAgU3RyaW5nIHJlc3BvbnNlID0gbXlTZXJ2aWNlLmNhbGxFeHRlcm5hbFNlcnZpY2UoKTsKICAgICAgICBhc3NlcnRFcXVhbHMoIk1vY2sgUmVzcG9uc2UiLCByZXNwb25zZSk7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@RunWith(SpringRunner.class)
@SpringBootTest
public class ExternalServiceIntegrationTest {

    @MockBean
    private ExternalService externalService;

    @Autowired
    private MyService myService;

    @Test
    public void testExternalServiceInteraction() {
        when(externalService.callExternalApi()).thenReturn(&quot;Mock Response&quot;);

        String response = myService.callExternalService();
        assertEquals(&quot;Mock Response&quot;, response);
    }
}</pre></div><div class='content'></div><h2>Proves amb Bases de Dades</h2>
<div class='content'><p>Per a proves d'integració amb bases de dades, pots utilitzar una base de dades en memòria com H2.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("PCEtLSBBZmVnZWl4IGxhIGRlcGVuZMOobmNpYSBIMiBlbiBwb20ueG1sIC0tPgo8ZGVwZW5kZW5jeT4KICAgIDxncm91cElkPmNvbS5oMmRhdGFiYXNlPC9ncm91cElkPgogICAgPGFydGlmYWN0SWQ+aDI8L2FydGlmYWN0SWQ+CiAgICA8c2NvcGU+dGVzdDwvc2NvcGU+CjwvZGVwZW5kZW5jeT4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>&lt;!-- Afegeix la depend&egrave;ncia H2 en pom.xml --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;com.h2database&lt;/groupId&gt;
    &lt;artifactId&gt;h2&lt;/artifactId&gt;
    &lt;scope&gt;test&lt;/scope&gt;
&lt;/dependency&gt;</pre></div><div class='content'><p>Configura la teva aplicació per utilitzar la base de dades H2 per a les proves:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBhcHBsaWNhdGlvbi10ZXN0LnltbApzcHJpbmc6CiAgZGF0YXNvdXJjZToKICAgIHVybDogamRiYzpoMjptZW06dGVzdGRiCiAgICBkcml2ZXJDbGFzc05hbWU6IG9yZy5oMi5Ecml2ZXIKICAgIHVzZXJuYW1lOiBzYQogICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgaDI6CiAgICBjb25zb2xlOgogICAgICBlbmFibGVkOiB0cnVlCiAganBhOgogICAgaGliZXJuYXRlOgogICAgICBkZGwtYXV0bzogdXBkYXRlCiAgICBzaG93LXNxbDogdHJ1ZQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># application-test.yml
spring:
  datasource:
    url: jdbc:h2:mem:testdb
    driverClassName: org.h2.Driver
    username: sa
    password: password
  h2:
    console:
      enabled: true
  jpa:
    hibernate:
      ddl-auto: update
    show-sql: true</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Les proves d'integració en Spring Boot són essencials per assegurar que diferents parts de la teva aplicació funcionin conjuntament sense problemes. Entenent els conceptes clau, configurant el teu entorn de prova i escrivint proves efectives, pots millorar significativament la fiabilitat i robustesa de la teva aplicació. A mesura que progressis, pots explorar escenaris més avançats, com la simulació de serveis externs i les proves amb bases de dades, per cobrir tots els aspectes de la funcionalitat de la teva aplicació.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
