<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subrutines i Procediments en CL (Llenguatge de Control)</title>

    <link rel="alternate" href="https://campusempresa.com/es/cl/subroutines-procedures" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/cl/subroutines-procedures" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/cl/subroutines-procedures" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/cl/subroutines-procedures" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='error-handling'>&#x25C4;Gestió d'Errors</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Subrutines i Procediments en CL (Llenguatge de Control)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='advanced-file-operations'>Operacions Avançades amb Fitxers &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a les Subrutines i Procediments</h1>
<div class='content'><p>Les subrutines i els procediments són conceptes fonamentals en el Llenguatge de Control (CL) que et permeten modularitzar el teu codi, fent-lo més llegible, mantenible i reutilitzable. Aquesta secció et guiarà des dels conceptes bàsics fins a l'ús avançat de subrutines i procediments en CL.</p>
</div><h1>Entenent les Subrutines</h1>
<div class='content'><p>Les subrutines en CL són blocs de codi que realitzen tasques específiques i es poden cridar des de diferents parts d'un programa. Ajuden a descompondre tasques complexes en peces més simples i manejables.</p>
</div><h2>Conceptes Clau de les Subrutines</h2>
<div class='content'><ul>
<li><strong>Definició</strong>: Una subrutina es defineix dins d'un programa CL utilitzant la comanda <code>SUBR</code>.</li>
<li><strong>Cridar una Subrutina</strong>: Utilitza la comanda <code>CALLSUBR</code> per invocar una subrutina.</li>
<li><strong>Retornar d'una Subrutina</strong>: Utilitza la comanda <code>RTNSUBR</code> per retornar el control al programa que ha cridat.</li>
</ul>
</div><h2>Exemple d'una Subrutina Simple</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UEdNCiAgICBEQ0wgVkFSKCZNU0cpIFRZUEUoKkNIQVIpIExFTig1MCkKICAgIAogICAgQ0FMTFNVQlIgU1VCUihNWV9TVUJST1VUSU5FKQogICAgCiAgICAvKiBFbCBwcm9ncmFtYSBwcmluY2lwYWwgY29udGludWEgYXF1w60gKi8KICAgIFNORFBHTU1TRyBNU0coJk1TRykKICAgIEVORFBHTQoKU1VCUiBNWV9TVUJST1VUSU5FCiAgICBDSEdWQVIgVkFSKCZNU0cpIFZBTFVFKCdIb2xhIGRlcyBkZSBsYSBzdWJydXRpbmEhJykKICAgIFJUTlNVQlI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PGM
    DCL VAR(&amp;MSG) TYPE(*CHAR) LEN(50)
    
    CALLSUBR SUBR(MY_SUBROUTINE)
    
    /* El programa principal continua aqu&iacute; */
    SNDPGMMSG MSG(&amp;MSG)
    ENDPGM

SUBR MY_SUBROUTINE
    CHGVAR VAR(&amp;MSG) VALUE('Hola des de la subrutina!')
    RTNSUBR</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>DCL VAR(&amp;MSG) TYPE(*CHAR) LEN(50)</code>: Declara una variable <code>&amp;MSG</code>.</li>
<li><code>CALLSUBR SUBR(MY_SUBROUTINE)</code>: Crida la subrutina anomenada <code>MY_SUBROUTINE</code>.</li>
<li><code>CHGVAR VAR(&amp;MSG) VALUE('Hola des de la subrutina!')</code>: Canvia el valor de <code>&amp;MSG</code> dins de la subrutina.</li>
<li><code>RTNSUBR</code>: Retorna el control al programa principal.</li>
</ul>
</li>
</ul>
</div><h1>Procediments en CL</h1>
<div class='content'><p>Els procediments són similars a les subrutines però ofereixen més flexibilitat i funcionalitat. Poden acceptar paràmetres, retornar valors i es defineixen fora del programa principal.</p>
</div><h2>Conceptes Clau dels Procediments</h2>
<div class='content'><ul>
<li><strong>Definició</strong>: Els procediments es defineixen utilitzant la comanda <code>PROC</code>.</li>
<li><strong>Cridar un Procediment</strong>: Utilitza la comanda <code>CALLPRC</code> per invocar un procediment.</li>
<li><strong>Retornar d'un Procediment</strong>: Utilitza la comanda <code>RETURN</code> per retornar un valor d'un procediment.</li>
</ul>
</div><h2>Exemple d'un Procediment Simple</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UEdNCiAgICBEQ0wgVkFSKCZSRVNVTFQpIFRZUEUoKkRFQykgTEVOKDUgMikKICAgIAogICAgQ0FMTFBSQyBQUkMoQ0FMQ1VMQVRFX1NVTSkgUEFSTSgxMCAyMCkgUlROVkFMKCZSRVNVTFQpCiAgICAKICAgIC8qIEVsIHByb2dyYW1hIHByaW5jaXBhbCBjb250aW51YSBhcXXDrSAqLwogICAgU05EUEdNTVNHIE1TRygnTGEgc3VtYSDDqXMgJyAqQ0FUICZSRVNVTFQpCiAgICBFTkRQR00KClBST0MgQ0FMQ1VMQVRFX1NVTQogICAgRENMIFZBUigmTlVNMSkgVFlQRSgqREVDKSBMRU4oNSAyKQogICAgRENMIFZBUigmTlVNMikgVFlQRSgqREVDKSBMRU4oNSAyKQogICAgRENMIFZBUigmU1VNKSBUWVBFKCpERUMpIExFTig1IDIpCiAgICAKICAgIC8qIFJlY3VwZXJhciBwYXLDoG1ldHJlcyAqLwogICAgQ0hHVkFSIFZBUigmTlVNMSkgVkFMVUUoJVBBUk0oMSkpCiAgICBDSEdWQVIgVkFSKCZOVU0yKSBWQUxVRSglUEFSTSgyKSkKICAgIAogICAgLyogQ2FsY3VsYXIgc3VtYSAqLwogICAgQ0hHVkFSIFZBUigmU1VNKSBWQUxVRSgmTlVNMSArICZOVU0yKQogICAgCiAgICAvKiBSZXRvcm5hciBlbCByZXN1bHRhdCAqLwogICAgUkVUVVJOIFZBTFVFKCZTVU0p"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PGM
    DCL VAR(&amp;RESULT) TYPE(*DEC) LEN(5 2)
    
    CALLPRC PRC(CALCULATE_SUM) PARM(10 20) RTNVAL(&amp;RESULT)
    
    /* El programa principal continua aqu&iacute; */
    SNDPGMMSG MSG('La suma &eacute;s ' *CAT &amp;RESULT)
    ENDPGM

PROC CALCULATE_SUM
    DCL VAR(&amp;NUM1) TYPE(*DEC) LEN(5 2)
    DCL VAR(&amp;NUM2) TYPE(*DEC) LEN(5 2)
    DCL VAR(&amp;SUM) TYPE(*DEC) LEN(5 2)
    
    /* Recuperar par&agrave;metres */
    CHGVAR VAR(&amp;NUM1) VALUE(%PARM(1))
    CHGVAR VAR(&amp;NUM2) VALUE(%PARM(2))
    
    /* Calcular suma */
    CHGVAR VAR(&amp;SUM) VALUE(&amp;NUM1 + &amp;NUM2)
    
    /* Retornar el resultat */
    RETURN VALUE(&amp;SUM)</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>DCL VAR(&amp;RESULT) TYPE(*DEC) LEN(5 2)</code>: Declara una variable <code>&amp;RESULT</code>.</li>
<li><code>CALLPRC PRC(CALCULATE_SUM) PARM(10 20) RTNVAL(&amp;RESULT)</code>: Crida el procediment <code>CALCULATE_SUM</code> amb paràmetres 10 i 20, i emmagatzema el valor retornat en <code>&amp;RESULT</code>.</li>
<li><code>DCL VAR(&amp;NUM1) TYPE(*DEC) LEN(5 2)</code>: Declara una variable <code>&amp;NUM1</code> dins del procediment.</li>
<li><code>CHGVAR VAR(&amp;NUM1) VALUE(%PARM(1))</code>: Recupera el primer paràmetre.</li>
<li><code>CHGVAR VAR(&amp;SUM) VALUE(&amp;NUM1 + &amp;NUM2)</code>: Calcula la suma de <code>&amp;NUM1</code> i <code>&amp;NUM2</code>.</li>
<li><code>RETURN VALUE(&amp;SUM)</code>: Retorna la suma calculada.</li>
</ul>
</li>
</ul>
</div><h1>Ús Avançat de Subrutines i Procediments</h1>
<h2>Passar Paràmetres a Subrutines</h2>
<div class='content'><p>Encara que les subrutines en CL no suporten nativament el pas de paràmetres com els procediments, pots utilitzar variables globals per compartir dades entre el programa principal i les subrutines.</p>
</div><h2>Exemple amb Variables Globals</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UEdNCiAgICBEQ0wgVkFSKCZOVU0xKSBUWVBFKCpERUMpIExFTig1IDIpIFZBTFVFKDE1KQogICAgRENMIFZBUigmTlVNMikgVFlQRSgqREVDKSBMRU4oNSAyKSBWQUxVRSgyNSkKICAgIERDTCBWQVIoJlNVTSkgVFlQRSgqREVDKSBMRU4oNSAyKQogICAgCiAgICBDQUxMU1VCUiBTVUJSKENBTENVTEFURV9TVU0pCiAgICAKICAgIC8qIEVsIHByb2dyYW1hIHByaW5jaXBhbCBjb250aW51YSBhcXXDrSAqLwogICAgU05EUEdNTVNHIE1TRygnTGEgc3VtYSDDqXMgJyAqQ0FUICZTVU0pCiAgICBFTkRQR00KClNVQlIgQ0FMQ1VMQVRFX1NVTQogICAgQ0hHVkFSIFZBUigmU1VNKSBWQUxVRSgmTlVNMSArICZOVU0yKQogICAgUlROU1VCUg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>PGM
    DCL VAR(&amp;NUM1) TYPE(*DEC) LEN(5 2) VALUE(15)
    DCL VAR(&amp;NUM2) TYPE(*DEC) LEN(5 2) VALUE(25)
    DCL VAR(&amp;SUM) TYPE(*DEC) LEN(5 2)
    
    CALLSUBR SUBR(CALCULATE_SUM)
    
    /* El programa principal continua aqu&iacute; */
    SNDPGMMSG MSG('La suma &eacute;s ' *CAT &amp;SUM)
    ENDPGM

SUBR CALCULATE_SUM
    CHGVAR VAR(&amp;SUM) VALUE(&amp;NUM1 + &amp;NUM2)
    RTNSUBR</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li>Les variables globals <code>&amp;NUM1</code>, <code>&amp;NUM2</code> i <code>&amp;SUM</code> es declaren en el programa principal.</li>
<li>La subrutina <code>CALCULATE_SUM</code> accedeix a aquestes variables globals per realitzar el càlcul.</li>
</ul>
</li>
</ul>
</div><h1>Resum</h1>
<div class='content'><ul>
<li><strong>Subrutines</strong>: Útils per modularitzar el codi dins d'un únic programa CL. Es defineixen utilitzant <code>SUBR</code> i es criden amb <code>CALLSUBR</code>.</li>
<li><strong>Procediments</strong>: Més flexibles que les subrutines, permetent el pas de paràmetres i retornant valors. Es defineixen utilitzant <code>PROC</code> i es criden amb <code>CALLPRC</code>.</li>
<li><strong>Tècniques Avançades</strong>: Utilitza variables globals per passar dades a subrutines, i aprofita els procediments per a tasques més complexes que requereixen el pas de paràmetres i el retorn de valors.</li>
</ul>
<p>Entendre i utilitzar subrutines i procediments de manera efectiva pot millorar enormement l'estructura i la mantenibilitat dels teus programes CL.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='error-handling'>&#x25C4;Gestió d'Errors</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Subrutines i Procediments en CL (Llenguatge de Control)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='advanced-file-operations'>Operacions Avançades amb Fitxers &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
