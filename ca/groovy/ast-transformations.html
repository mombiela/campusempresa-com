<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformacions AST en Groovy</title>

    <link rel="alternate" href="https://campusempresa.com/es/groovy/ast-transformations" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/groovy/ast-transformations" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/groovy/ast-transformations" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/groovy/ast-transformations" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='dsls'>&#x25C4;DSLs (Llenguatges Específics de Domini)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Transformacions AST en Groovy</a>
	</div>
	<div class='col-4 text-end'>
					<a href='groovy-and-xml'>Groovy i XML &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a les Transformacions AST</h1>
<div class='content'><p>Les Transformacions Abstract Syntax Tree (AST) són una característica poderosa en Groovy que permet als desenvolupadors modificar l'estructura del codi en temps de compilació. Això es pot utilitzar per injectar codi, realitzar optimitzacions o fer complir estàndards de codificació.</p>
<ul>
<li><strong>AST</strong>: Abstract Syntax Tree, una representació en arbre de l'estructura sintàctica abstracta del codi font.</li>
<li><strong>Transformació</strong>: Modificar l'AST per canviar com es comporta o es compila el codi.</li>
</ul>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Metaprogramació en temps de compilació</strong>: Les transformacions AST ocorren durant la fase de compilació, permetent modificacions abans que el codi s'executi.</li>
<li><strong>Anotacions</strong>: Groovy utilitza anotacions per desencadenar transformacions AST.</li>
<li><strong>Fases</strong>: El procés de compilació de Groovy es divideix en diverses fases, i les transformacions es poden aplicar en diferents etapes.</li>
</ul>
</div><h1>Transformacions AST Comunes</h1>
<div class='content'><p>Groovy proporciona diverses transformacions AST integrades que es poden utilitzar per simplificar el codi i afegir funcionalitat.</p>
</div><h2>@ToString</h2>
<div class='content'><p>Genera un mètode <code>toString()</code> per a una classe.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGdyb292eS50cmFuc2Zvcm0uVG9TdHJpbmcKCkBUb1N0cmluZwpjbGFzcyBQZXJzb24gewogICAgU3RyaW5nIG5hbWUKICAgIGludCBhZ2UKfQoKZGVmIHBlcnNvbiA9IG5ldyBQZXJzb24obmFtZTogJ0pvaG4nLCBhZ2U6IDMwKQpwcmludGxuIHBlcnNvbi50b1N0cmluZygpIC8vIE91dHB1dDogUGVyc29uKEpvaG4sIDMwKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import groovy.transform.ToString

@ToString
class Person {
    String name
    int age
}

def person = new Person(name: 'John', age: 30)
println person.toString() // Output: Person(John, 30)</pre></div><div class='content'></div><h2>@EqualsAndHashCode</h2>
<div class='content'><p>Genera els mètodes <code>equals()</code> i <code>hashCode()</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGdyb292eS50cmFuc2Zvcm0uRXF1YWxzQW5kSGFzaENvZGUKCkBFcXVhbHNBbmRIYXNoQ29kZQpjbGFzcyBQZXJzb24gewogICAgU3RyaW5nIG5hbWUKICAgIGludCBhZ2UKfQoKZGVmIHBlcnNvbjEgPSBuZXcgUGVyc29uKG5hbWU6ICdKb2huJywgYWdlOiAzMCkKZGVmIHBlcnNvbjIgPSBuZXcgUGVyc29uKG5hbWU6ICdKb2huJywgYWdlOiAzMCkKYXNzZXJ0IHBlcnNvbjEgPT0gcGVyc29uMiAvLyB0cnVl"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import groovy.transform.EqualsAndHashCode

@EqualsAndHashCode
class Person {
    String name
    int age
}

def person1 = new Person(name: 'John', age: 30)
def person2 = new Person(name: 'John', age: 30)
assert person1 == person2 // true</pre></div><div class='content'></div><h2>@Immutable</h2>
<div class='content'><p>Fa que una classe sigui immutable generant camps finals i proporcionant un constructor.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGdyb292eS50cmFuc2Zvcm0uSW1tdXRhYmxlCgpASW1tdXRhYmxlCmNsYXNzIFBvaW50IHsKICAgIGludCB4LCB5Cn0KCmRlZiBwb2ludCA9IG5ldyBQb2ludCgxMCwgMjApCmFzc2VydCBwb2ludC54ID09IDEwCmFzc2VydCBwb2ludC55ID09IDIw"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import groovy.transform.Immutable

@Immutable
class Point {
    int x, y
}

def point = new Point(10, 20)
assert point.x == 10
assert point.y == 20</pre></div><div class='content'></div><h1>Transformacions AST Personalitzades</h1>
<div class='content'><p>Crear transformacions AST personalitzades permet modificacions més avançades i específiques.</p>
</div><h2>Escriure una Transformació AST Simple</h2>
<div class='content'><ol>
<li><strong>Crear l'Anotació</strong>: Definir una anotació per marcar on s'ha d'aplicar la transformació.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLkVsZW1lbnRUeXBlCmltcG9ydCBqYXZhLmxhbmcuYW5ub3RhdGlvbi5SZXRlbnRpb24KaW1wb3J0IGphdmEubGFuZy5hbm5vdGF0aW9uLlJldGVudGlvblBvbGljeQppbXBvcnQgamF2YS5sYW5nLmFubm90YXRpb24uVGFyZ2V0CgpAUmV0ZW50aW9uKFJldGVudGlvblBvbGljeS5TT1VSQ0UpCkBUYXJnZXQoW0VsZW1lbnRUeXBlLlRZUEVdKQpAaW50ZXJmYWNlIE15VHJhbnNmb3JtYXRpb24ge30="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import java.lang.annotation.ElementType
import java.lang.annotation.Retention
import java.lang.annotation.RetentionPolicy
import java.lang.annotation.Target

@Retention(RetentionPolicy.SOURCE)
@Target([ElementType.TYPE])
@interface MyTransformation {}</pre></div><div class='content'><ol start="2">
<li><strong>Implementar la Transformació</strong>: Crear una classe que implementi <code>ASTTransformation</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5jb2RlaGF1cy5ncm9vdnkuYXN0LioKaW1wb3J0IG9yZy5jb2RlaGF1cy5ncm9vdnkuYXN0LmJ1aWxkZXIuQXN0QnVpbGRlcgppbXBvcnQgb3JnLmNvZGVoYXVzLmdyb292eS5jb250cm9sLioKaW1wb3J0IG9yZy5jb2RlaGF1cy5ncm9vdnkudHJhbnNmb3JtLioKCkBHcm9vdnlBU1RUcmFuc2Zvcm1hdGlvbihwaGFzZSA9IENvbXBpbGVQaGFzZS5DQU5PTklDQUxJWkFUSU9OKQpjbGFzcyBNeVRyYW5zZm9ybWF0aW9uSW1wbCBpbXBsZW1lbnRzIEFTVFRyYW5zZm9ybWF0aW9uIHsKICAgIHZvaWQgdmlzaXQoQVNUTm9kZVtdIG5vZGVzLCBTb3VyY2VVbml0IHNvdXJjZSkgewogICAgICAgIG5vZGVzLmVhY2ggeyBub2RlIC0+CiAgICAgICAgICAgIGlmIChub2RlIGluc3RhbmNlb2YgQ2xhc3NOb2RlKSB7CiAgICAgICAgICAgICAgICBDbGFzc05vZGUgY2xhc3NOb2RlID0gKENsYXNzTm9kZSkgbm9kZQogICAgICAgICAgICAgICAgLy8gRXhlbXBsZTogQWZlZ2lyIHVuIG5vdSBtw6h0b2RlIGEgbGEgY2xhc3NlCiAgICAgICAgICAgICAgICBjbGFzc05vZGUuYWRkTWV0aG9kKAogICAgICAgICAgICAgICAgICAgIG5ldyBNZXRob2ROb2RlKAogICAgICAgICAgICAgICAgICAgICAgICAnbmV3TWV0aG9kJywKICAgICAgICAgICAgICAgICAgICAgICAgQUNDX1BVQkxJQywKICAgICAgICAgICAgICAgICAgICAgICAgQ2xhc3NIZWxwZXIuVk9JRF9UWVBFLAogICAgICAgICAgICAgICAgICAgICAgICBbXSBhcyBQYXJhbWV0ZXJbXSwKICAgICAgICAgICAgICAgICAgICAgICAgW10gYXMgQ2xhc3NOb2RlW10sCiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBCbG9ja1N0YXRlbWVudCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtuZXcgRXhwcmVzc2lvblN0YXRlbWVudChuZXcgQ29uc3RhbnRFeHByZXNzaW9uKCdIZWxsbyBmcm9tIEFTVCBUcmFuc2Zvcm1hdGlvbiEnKSldLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFZhcmlhYmxlU2NvcGUoKQogICAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.codehaus.groovy.ast.*
import org.codehaus.groovy.ast.builder.AstBuilder
import org.codehaus.groovy.control.*
import org.codehaus.groovy.transform.*

@GroovyASTTransformation(phase = CompilePhase.CANONICALIZATION)
class MyTransformationImpl implements ASTTransformation {
    void visit(ASTNode[] nodes, SourceUnit source) {
        nodes.each { node -&gt;
            if (node instanceof ClassNode) {
                ClassNode classNode = (ClassNode) node
                // Exemple: Afegir un nou m&egrave;tode a la classe
                classNode.addMethod(
                    new MethodNode(
                        'newMethod',
                        ACC_PUBLIC,
                        ClassHelper.VOID_TYPE,
                        [] as Parameter[],
                        [] as ClassNode[],
                        new BlockStatement(
                            [new ExpressionStatement(new ConstantExpression('Hello from AST Transformation!'))],
                            new VariableScope()
                        )
                    )
                )
            }
        }
    }
}</pre></div><div class='content'><ol start="3">
<li><strong>Aplicar l'Anotació</strong>: Utilitzar l'anotació en el teu codi.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QE15VHJhbnNmb3JtYXRpb24KY2xhc3MgRXhhbXBsZSB7fQoKZGVmIGV4YW1wbGUgPSBuZXcgRXhhbXBsZSgpCmV4YW1wbGUubmV3TWV0aG9kKCkgLy8gT3V0cHV0OiBIZWxsbyBmcm9tIEFTVCBUcmFuc2Zvcm1hdGlvbiE="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>@MyTransformation
class Example {}

def example = new Example()
example.newMethod() // Output: Hello from AST Transformation!</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Les Transformacions AST en Groovy proporcionen un mecanisme robust per modificar el codi en temps de compilació, permetent capacitats poderoses de metaprogramació. Entenent i utilitzant tant les transformacions integrades com les personalitzades, els desenvolupadors poden escriure codi més concís, mantenible i eficient. A mesura que avancis en Groovy, dominar les transformacions AST millorarà significativament la teva capacitat per manipular i optimitzar la teva base de codi.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='dsls'>&#x25C4;DSLs (Llenguatges Específics de Domini)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Transformacions AST en Groovy</a>
	</div>
	<div class='col-4 text-end'>
					<a href='groovy-and-xml'>Groovy i XML &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
