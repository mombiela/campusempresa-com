<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registre i Gestió de Registres</title>

    <link rel="alternate" href="https://campusempresa.com/es/nginx/logging-and-log-management" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/nginx/logging-and-log-management" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/nginx/logging-and-log-management" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/nginx/logging-and-log-management" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció al Registre en NGINX</h1>
<div class='content'><p>El registre és un aspecte essencial de la gestió i manteniment de servidors web. Ajuda a monitoritzar el rendiment del servidor, depurar problemes i entendre el comportament dels usuaris. NGINX, un servidor web d'alt rendiment, proporciona capacitats robustes de registre.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Registres d'Accés</strong>: Registren les sol·licituds dels clients processades pel servidor.</li>
<li><strong>Registres d'Errors</strong>: Capturen els errors trobats pel servidor.</li>
<li><strong>Formats de Registre</strong>: Defineixen l'estructura i el contingut de les entrades de registre.</li>
<li><strong>Nivells de Registre</strong>: Determinen la gravetat dels missatges registrats en els registres d'errors.</li>
</ul>
</div><h1>Configuració dels Registres d'Accés</h1>
<div class='content'><p>Els registres d'accés en NGINX registren detalls sobre cada sol·licitud del client. Per defecte, NGINX registra la informació d'accés en un format predefinit.</p>
</div><h2>Configuració Bàsica</h2>
<div class='content'><p>Per habilitar el registre d'accés, afegeix la següent directiva al teu fitxer de configuració de NGINX (<code>nginx.conf</code>):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBhY2Nlc3NfbG9nIC92YXIvbG9nL25naW54L2FjY2Vzcy5sb2c7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    access_log /var/log/nginx/access.log;
}</pre></div><div class='content'></div><h2>Formats de Registre Personalitzats</h2>
<div class='content'><p>Pots definir formats de registre personalitzats per incloure informació específica. Utilitza la directiva <code>log_format</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBsb2dfZm9ybWF0IGN1c3RvbSAnJHJlbW90ZV9hZGRyIC0gJHJlbW90ZV91c2VyIFskdGltZV9sb2NhbF0gIiRyZXF1ZXN0IiAnCiAgICAgICAgICAgICAgICAgICAgICAnJHN0YXR1cyAkYm9keV9ieXRlc19zZW50ICIkaHR0cF9yZWZlcmVyIiAnCiAgICAgICAgICAgICAgICAgICAgICAnIiRodHRwX3VzZXJfYWdlbnQiICIkaHR0cF94X2ZvcndhcmRlZF9mb3IiJzsKCiAgICBhY2Nlc3NfbG9nIC92YXIvbG9nL25naW54L2FjY2Vzcy5sb2cgY3VzdG9tOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    log_format custom '$remote_addr - $remote_user [$time_local] &quot;$request&quot; '
                      '$status $body_bytes_sent &quot;$http_referer&quot; '
                      '&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;';

    access_log /var/log/nginx/access.log custom;
}</pre></div><div class='content'></div><h2>Exemple Explicat</h2>
<div class='content'><ul>
<li><code>$remote_addr</code>: Adreça IP del client.</li>
<li><code>$remote_user</code>: Usuari autenticat (si n'hi ha).</li>
<li><code>$time_local</code>: Hora local de la sol·licitud.</li>
<li><code>$request</code>: Línia de sol·licitud del client.</li>
<li><code>$status</code>: Codi d'estat HTTP.</li>
<li><code>$body_bytes_sent</code>: Nombre de bytes enviats al client.</li>
<li><code>$http_referer</code>: Capçalera Referer del client.</li>
<li><code>$http_user_agent</code>: Capçalera User-Agent del client.</li>
<li><code>$http_x_forwarded_for</code>: Capçalera X-Forwarded-For (útil per identificar la IP original del client quan està darrere d'un proxy).</li>
</ul>
</div><h1>Configuració dels Registres d'Errors</h1>
<div class='content'><p>Els registres d'errors capturen problemes trobats pel servidor. Pots especificar el fitxer de registre i el nivell de detall.</p>
</div><h2>Configuració Bàsica</h2>
<div class='content'><p>Per habilitar el registre d'errors, afegeix la següent directiva al teu fitxer de configuració de NGINX:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aHR0cCB7CiAgICBlcnJvcl9sb2cgL3Zhci9sb2cvbmdpbngvZXJyb3IubG9nIHdhcm47Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>http {
    error_log /var/log/nginx/error.log warn;
}</pre></div><div class='content'></div><h2>Nivells de Registre</h2>
<div class='content'><p>NGINX suporta diversos nivells de registre:</p>
<ul>
<li><code>debug</code>: Informació detallada de depuració.</li>
<li><code>info</code>: Missatges informatius.</li>
<li><code>notice</code>: Condicions normals però significatives.</li>
<li><code>warn</code>: Condicions d'advertència.</li>
<li><code>error</code>: Condicions d'error.</li>
<li><code>crit</code>: Condicions crítiques.</li>
<li><code>alert</code>: Acció immediata requerida.</li>
<li><code>emerg</code>: El sistema és inutilitzable.</li>
</ul>
</div><h2>Exemple Explicat</h2>
<div class='content'><p>El nivell <code>warn</code> en l'exemple anterior registrarà advertències, errors, problemes crítics, alertes i emergències.</p>
</div><h1>Gestió dels Fitxers de Registre</h1>
<div class='content'><p>Una gestió adequada dels registres és crucial per mantenir el rendiment del servidor i assegurar que els registres siguin útils.</p>
</div><h2>Rotació de Registres</h2>
<div class='content'><p>La rotació de registres evita que els fitxers de registre creixin indefinidament, cosa que pot consumir espai de disc i dificultar l'anàlisi dels registres. Utilitza eines com <code>logrotate</code> per gestionar la rotació de registres.</p>
</div><h2>Exemple de Configuració de Logrotate</h2>
<div class='content'><p>Crea un fitxer de configuració per als registres de NGINX (<code>/etc/logrotate.d/nginx</code>):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("L3Zhci9sb2cvbmdpbngvKi5sb2cgewogICAgZGFpbHkKICAgIG1pc3NpbmdvawogICAgcm90YXRlIDE0CiAgICBjb21wcmVzcwogICAgZGVsYXljb21wcmVzcwogICAgbm90aWZlbXB0eQogICAgY3JlYXRlIDA2NDAgd3d3LWRhdGEgYWRtCiAgICBzaGFyZWRzY3JpcHRzCiAgICBwb3N0cm90YXRlCiAgICAgICAgWyAtZiAvdmFyL3J1bi9uZ2lueC5waWQgXSAmJiBraWxsIC1VU1IxIGBjYXQgL3Zhci9ydW4vbmdpbngucGlkYAogICAgZW5kc2NyaXB0Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>/var/log/nginx/*.log {
    daily
    missingok
    rotate 14
    compress
    delaycompress
    notifempty
    create 0640 www-data adm
    sharedscripts
    postrotate
        [ -f /var/run/nginx.pid ] &amp;&amp; kill -USR1 `cat /var/run/nginx.pid`
    endscript
}</pre></div><div class='content'></div><h2>Exemple Explicat</h2>
<div class='content'><ul>
<li><code>daily</code>: Rota els registres diàriament.</li>
<li><code>missingok</code>: Ignora els fitxers de registre que falten.</li>
<li><code>rotate 14</code>: Manté 14 dies de registres.</li>
<li><code>compress</code>: Comprimeix els fitxers de registre antics.</li>
<li><code>delaycompress</code>: Retarda la compressió fins a la següent rotació.</li>
<li><code>notifempty</code>: No rota els fitxers de registre buits.</li>
<li><code>create 0640 www-data adm</code>: Estableix els permisos i la propietat dels nous fitxers de registre.</li>
<li><code>sharedscripts</code>: Executa el script post-rotació només una vegada.</li>
<li><code>postrotate</code>: Comanda per executar després de la rotació (recarrega NGINX per iniciar nous fitxers de registre).</li>
</ul>
</div><h1>Tècniques Avançades de Gestió de Registres</h1>
<div class='content'><p>Per a una gestió avançada de registres, considera utilitzar solucions de registre centralitzat i eines d'anàlisi de registres.</p>
</div><h2>Registre Centralitzat</h2>
<div class='content'><p>El registre centralitzat agrega registres de múltiples servidors en una única ubicació per facilitar la gestió i l'anàlisi. Es poden utilitzar eines com ELK Stack (Elasticsearch, Logstash, Kibana) o Graylog.</p>
</div><h2>Exemple de Configuració de ELK Stack</h2>
<div class='content'><ol>
<li><strong>Elasticsearch</strong>: Emmagatzema i indexa les dades de registre.</li>
<li><strong>Logstash</strong>: Recull, processa i envia les dades de registre.</li>
<li><strong>Kibana</strong>: Visualitza les dades de registre.</li>
</ol>
</div><h2>Anàlisi de Registres</h2>
<div class='content'><p>Analitzar els registres ajuda a identificar tendències, detectar anomalies i resoldre problemes. Es poden utilitzar eines com <code>GoAccess</code> o <code>AWStats</code> per a l'anàlisi de registres en temps real.</p>
</div><h1>Conclusió</h1>
<div class='content'><p>El registre i la gestió de registres són components crítics per mantenir un servidor NGINX. Configurant els registres d'accés i d'errors, gestionant els fitxers de registre i utilitzant tècniques avançades com el registre centralitzat i l'anàlisi de registres, pots assegurar que el teu servidor funcioni eficientment i que els problemes es resolguin ràpidament. Una gestió adequada dels registres no només ajuda a resoldre problemes, sinó que també proporciona informació valuosa sobre el rendiment del servidor i el comportament dels usuaris.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
