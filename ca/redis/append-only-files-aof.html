<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fitxers Només-Afegeix (AOF)</title>

    <link rel="alternate" href="https://campusempresa.com/es/redis/append-only-files-aof" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/redis/append-only-files-aof" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/redis/append-only-files-aof" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/redis/append-only-files-aof" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='snapshots-rdb'>&#x25C4;Snapshots (RDB)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Fitxers Només-Afegeix (AOF)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='persistence-configuration'>Configuració de la Persistència &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a AOF</h1>
<div class='content'><p>Els Fitxers Només-Afegeix (AOF) són un mecanisme de persistència en Redis que registra cada operació d'escriptura rebuda pel servidor. Aquest registre s'utilitza després per reconstruir el conjunt de dades quan el servidor es reinicia. AOF proporciona una manera més duradora de persistir dades en comparació amb les instantànies RDB (Redis Database) per defecte.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Persistència</strong>: Assegurar que les dades no es perdin en cas d'una fallada del servidor.</li>
<li><strong>Registre Previ a l'Escriptura</strong>: Registrar cada operació d'escriptura abans que s'apliqui al conjunt de dades.</li>
<li><strong>Reconstrucció</strong>: Utilitzar el registre AOF per reconstruir el conjunt de dades en reiniciar el servidor.</li>
</ul>
</div><h1>Activació d'AOF</h1>
<div class='content'><p>Per activar AOF en Redis, cal modificar el fitxer de configuració de Redis (<code>redis.conf</code>).</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kb25seSB5ZXM="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendonly yes</pre></div><div class='content'></div><h1>Opcions de Configuració d'AOF</h1>
<div class='content'><p>Redis proporciona diverses opcions de configuració per ajustar el comportament d'AOF:</p>
<ul>
<li><strong>appendfsync</strong>: Controla amb quina freqüència Redis sincronitzarà el fitxer AOF al disc.
<ul>
<li><code>always</code>: Sincronitza després de cada operació d'escriptura (més durador, menys rendiment).</li>
<li><code>everysec</code>: Sincronitza cada segon (equilibri entre durabilitat i rendiment).</li>
<li><code>no</code>: Deixa que el sistema operatiu decideixi quan sincronitzar (menys durador, més rendiment).</li>
</ul>
</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kZnN5bmMgZXZlcnlzZWM="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendfsync everysec</pre></div><div class='content'><ul>
<li><strong>auto-aof-rewrite-percentage</strong>: Activa una reescriptura d'AOF quan la mida del fitxer AOF creix un cert percentatge des de l'última reescriptura.</li>
<li><strong>auto-aof-rewrite-min-size</strong>: Estableix la mida mínima que ha d'assolir el fitxer AOF abans que es desencadeni una reescriptura automàtica.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXV0by1hb2YtcmV3cml0ZS1wZXJjZW50YWdlIDEwMAphdXRvLWFvZi1yZXdyaXRlLW1pbi1zaXplIDY0bWI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb</pre></div><div class='content'></div><h1>Com Funciona AOF</h1>
<div class='content'><ol>
<li><strong>Registre</strong>: Cada operació d'escriptura es registra al fitxer AOF.</li>
<li><strong>Sincronització</strong>: El fitxer AOF es sincronitza al disc segons la configuració de <code>appendfsync</code>.</li>
<li><strong>Reescriptura</strong>: Periòdicament, Redis reescriu el fitxer AOF per optimitzar la seva mida i rendiment.</li>
</ol>
</div><h1>Exemple: Configuració Bàsica d'AOF</h1>
<div class='content'><p>Aquí teniu un exemple d'una configuració bàsica d'AOF en <code>redis.conf</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YXBwZW5kb25seSB5ZXMKYXBwZW5kZnN5bmMgZXZlcnlzZWMKYXV0by1hb2YtcmV3cml0ZS1wZXJjZW50YWdlIDEwMAphdXRvLWFvZi1yZXdyaXRlLW1pbi1zaXplIDY0bWI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>appendonly yes
appendfsync everysec
auto-aof-rewrite-percentage 100
auto-aof-rewrite-min-size 64mb</pre></div><div class='content'></div><h1>Reescriptura d'AOF</h1>
<div class='content'><p>La reescriptura d'AOF és un procés en què Redis crea un nou fitxer AOF llegint el conjunt de dades actual en memòria i escrivint-lo en un nou fitxer en una forma més compacta. Això ajuda a reduir la mida del fitxer AOF i a millorar el rendiment.</p>
</div><h2>Activació Manual de la Reescriptura d'AOF</h2>
<div class='content'><p>Podeu activar una reescriptura d'AOF manualment utilitzant la comanda <code>BGREWRITEAOF</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QkdSRVdSSVRFQU9G"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>BGREWRITEAOF</pre></div><div class='content'></div><h1>AOF vs RDB</h1>
<div class='content'><p>| Característica    | AOF                          | RDB                          |
|-------------------|------------------------------|------------------------------|
| Persistència      | Registra cada operació d'escriptura   | Instantànies periòdiques           |
| Durabilitat       | Superior (depèn de <code>appendfsync</code>) | Inferior (depèn de la freqüència de les instantànies) |
| Rendiment         | Inferior (més I/O de disc)        | Superior (menys freqüència d'I/O de disc) |
| Mida del Fitxer   | Major (conté totes les operacions) | Menor (instantània del conjunt de dades) |
| Velocitat de Recuperació | Més lenta (reprodueix totes les operacions) | Més ràpida (carrega instantània)      |</p>
</div><h1>Exemple de Codi: Utilitzant AOF en Redis</h1>
<div class='content'><p>Aquí teniu un exemple senzill per demostrar com funciona AOF en Redis:</p>
<ol>
<li><strong>Activar AOF</strong>: Modifiqueu <code>redis.conf</code> per activar AOF.</li>
<li><strong>Iniciar el Servidor Redis</strong>: Inicieu el servidor Redis amb la configuració modificada.</li>
<li><strong>Realitzar Operacions d'Escriptura</strong>: Executeu algunes operacions d'escriptura.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VUIHVzZXI6MSAiQWxpY2UiClNFVCB1c2VyOjIgIkJvYiI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SET user:1 &quot;Alice&quot;
SET user:2 &quot;Bob&quot;</pre></div><div class='content'><ol start="4">
<li><strong>Comprovar el Fitxer AOF</strong>: El fitxer AOF (<code>appendonly.aof</code>) contindrà les operacions d'escriptura.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KjMKJDMKU0VUCiQ2CnVzZXI6MQokNQpBbGljZQoqMwokMwpTRVQKJDYKdXNlcjoyCiQzCkJvYg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>*3
$3
SET
$6
user:1
$5
Alice
*3
$3
SET
$6
user:2
$3
Bob</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Els Fitxers Només-Afegeix (AOF) proporcionen un mecanisme robust per assegurar la durabilitat de les dades en Redis. Registrant cada operació d'escriptura, AOF permet una recuperació precisa de les dades en cas de fallada del servidor. Entendre com configurar i gestionar AOF és crucial per mantenir un desplegament de Redis fiable. Tot i que AOF ofereix una durabilitat més alta en comparació amb les instantànies RDB, comporta compromisos en termes de rendiment i mida del fitxer. Una configuració adequada i reescriptures periòdiques poden ajudar a equilibrar aquests compromisos per adaptar-se a les necessitats de la vostra aplicació.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='snapshots-rdb'>&#x25C4;Snapshots (RDB)</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Fitxers Només-Afegeix (AOF)</a>
	</div>
	<div class='col-4 text-end'>
					<a href='persistence-configuration'>Configuració de la Persistència &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
