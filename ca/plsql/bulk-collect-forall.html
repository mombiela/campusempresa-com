<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bulk Collect i FORALL en PL/SQL</title>

    <link rel="alternate" href="https://campusempresa.com/es/plsql/bulk-collect-forall" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/plsql/bulk-collect-forall" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/plsql/bulk-collect-forall" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/plsql/bulk-collect-forall" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En PL/SQL, <code>BULK COLLECT</code> i <code>FORALL</code> són característiques poderoses que et permeten realitzar operacions massives de manera eficient. Aquestes característiques són particularment útils quan es treballa amb grans volums de dades, ja que poden millorar significativament el rendiment reduint els canvis de context entre el motor PL/SQL i el motor SQL.</p>
</div><h1>BULK COLLECT</h1>
<div class='content'><p><code>BULK COLLECT</code> s'utilitza per recuperar múltiples files d'una consulta en una col·lecció en una sola operació, en lloc de recuperar una fila a la vegada.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Col·leccions</strong>: Estructures de dades PL/SQL que poden contenir múltiples valors, com ara VARRAYs, Taules Imbricades i Arrays Associatius.</li>
<li><strong>Eficiència</strong>: Redueix el nombre de canvis de context entre els motors SQL i PL/SQL, millorant el rendiment.</li>
</ul>
</div><h2>Sintaxi</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U0VMRUNUIGNvbHVtbjEsIGNvbHVtbjIsIC4uLgpCVUxLIENPTExFQ1QgSU5UTyBjb2xsZWN0aW9uMSwgY29sbGVjdGlvbjIsIC4uLgpGUk9NIHRhYmxlX25hbWUKV0hFUkUgY29uZGl0aW9uOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>SELECT column1, column2, ...
BULK COLLECT INTO collection1, collection2, ...
FROM table_name
WHERE condition;</pre></div><div class='content'></div><h2>Exemple</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgVFlQRSBOdW1MaXN0IElTIFRBQkxFIE9GIE5VTUJFUjsKICAgIFRZUEUgTmFtZUxpc3QgSVMgVEFCTEUgT0YgVkFSQ0hBUjIoNTApOwogICAgbnVtYmVycyBOdW1MaXN0OwogICAgbmFtZXMgTmFtZUxpc3Q7CkJFR0lOCiAgICBTRUxFQ1QgZW1wbG95ZWVfaWQsIGZpcnN0X25hbWUKICAgIEJVTEsgQ09MTEVDVCBJTlRPIG51bWJlcnMsIG5hbWVzCiAgICBGUk9NIGVtcGxveWVlcwogICAgV0hFUkUgZGVwYXJ0bWVudF9pZCA9IDEwOwogICAgCiAgICBGT1IgaSBJTiAxLi5udW1iZXJzLkNPVU5UIExPT1AKICAgICAgICBEQk1TX09VVFBVVC5QVVRfTElORSgnSUQ6ICcgfHwgbnVtYmVycyhpKSB8fCAnLCBOYW1lOiAnIHx8IG5hbWVzKGkpKTsKICAgIEVORCBMT09QOwpFTkQ7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    TYPE NumList IS TABLE OF NUMBER;
    TYPE NameList IS TABLE OF VARCHAR2(50);
    numbers NumList;
    names NameList;
BEGIN
    SELECT employee_id, first_name
    BULK COLLECT INTO numbers, names
    FROM employees
    WHERE department_id = 10;
    
    FOR i IN 1..numbers.COUNT LOOP
        DBMS_OUTPUT.PUT_LINE('ID: ' || numbers(i) || ', Name: ' || names(i));
    END LOOP;
END;</pre></div><div class='content'><p>En aquest exemple, <code>BULK COLLECT</code> s'utilitza per recuperar <code>employee_id</code> i <code>first_name</code> de la taula <code>employees</code> en dues col·leccions, <code>numbers</code> i <code>names</code>.</p>
</div><h1>FORALL</h1>
<div class='content'><p><code>FORALL</code> s'utilitza per realitzar operacions massives de DML (INSERT, UPDATE, DELETE) de manera eficient reduint els canvis de context.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Operacions DML</strong>: Operacions del Llenguatge de Manipulació de Dades com INSERT, UPDATE i DELETE.</li>
<li><strong>Eficiència</strong>: Executa múltiples instruccions DML en un sol canvi de context.</li>
</ul>
</div><h2>Sintaxi</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Rk9SQUxMIGluZGV4IElOIGxvd2VyX2JvdW5kLi51cHBlcl9ib3VuZAogICAgRE1MX3N0YXRlbWVudDs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>FORALL index IN lower_bound..upper_bound
    DML_statement;</pre></div><div class='content'></div><h2>Exemple</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgVFlQRSBOdW1MaXN0IElTIFRBQkxFIE9GIE5VTUJFUjsKICAgIGVtcGxveWVlX2lkcyBOdW1MaXN0IDo9IE51bUxpc3QoMTAwMSwgMTAwMiwgMTAwMyk7CkJFR0lOCiAgICBGT1JBTEwgaSBJTiBlbXBsb3llZV9pZHMuRklSU1QuLmVtcGxveWVlX2lkcy5MQVNUCiAgICAgICAgVVBEQVRFIGVtcGxveWVlcwogICAgICAgIFNFVCBzYWxhcnkgPSBzYWxhcnkgKiAxLjEwCiAgICAgICAgV0hFUkUgZW1wbG95ZWVfaWQgPSBlbXBsb3llZV9pZHMoaSk7CkVORDs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    TYPE NumList IS TABLE OF NUMBER;
    employee_ids NumList := NumList(1001, 1002, 1003);
BEGIN
    FORALL i IN employee_ids.FIRST..employee_ids.LAST
        UPDATE employees
        SET salary = salary * 1.10
        WHERE employee_id = employee_ids(i);
END;</pre></div><div class='content'><p>En aquest exemple, <code>FORALL</code> s'utilitza per actualitzar els salaris dels empleats amb IDs 1001, 1002 i 1003 en una sola operació.</p>
</div><h1>Combinació de BULK COLLECT i FORALL</h1>
<div class='content'><p>Pots combinar <code>BULK COLLECT</code> i <code>FORALL</code> per recuperar dades en col·leccions i després realitzar operacions massives de DML sobre aquestes dades.</p>
</div><h2>Exemple</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgVFlQRSBOdW1MaXN0IElTIFRBQkxFIE9GIE5VTUJFUjsKICAgIFRZUEUgTmFtZUxpc3QgSVMgVEFCTEUgT0YgVkFSQ0hBUjIoNTApOwogICAgZW1wbG95ZWVfaWRzIE51bUxpc3Q7CiAgICBlbXBsb3llZV9uYW1lcyBOYW1lTGlzdDsKQkVHSU4KICAgIC0tIFJlY29sbGlkYSBtYXNzaXZhIGRlIGRhZGVzIGVuIGNvbMK3bGVjY2lvbnMKICAgIFNFTEVDVCBlbXBsb3llZV9pZCwgZmlyc3RfbmFtZQogICAgQlVMSyBDT0xMRUNUIElOVE8gZW1wbG95ZWVfaWRzLCBlbXBsb3llZV9uYW1lcwogICAgRlJPTSBlbXBsb3llZXMKICAgIFdIRVJFIGRlcGFydG1lbnRfaWQgPSAxMDsKICAgIAogICAgLS0gUmVhbGl0emFyIGFjdHVhbGl0emFjacOzIG1hc3NpdmEgdXRpbGl0emFudCBGT1JBTEwKICAgIEZPUkFMTCBpIElOIGVtcGxveWVlX2lkcy5GSVJTVC4uZW1wbG95ZWVfaWRzLkxBU1QKICAgICAgICBVUERBVEUgZW1wbG95ZWVzCiAgICAgICAgU0VUIHNhbGFyeSA9IHNhbGFyeSAqIDEuMTAKICAgICAgICBXSEVSRSBlbXBsb3llZV9pZCA9IGVtcGxveWVlX2lkcyhpKTsKICAgIAogICAgLS0gTW9zdHJhciBlbHMgbm9tcyBhY3R1YWxpdHphdHMKICAgIEZPUiBpIElOIGVtcGxveWVlX2lkcy5GSVJTVC4uZW1wbG95ZWVfaWRzLkxBU1QgTE9PUAogICAgICAgIERCTVNfT1VUUFVULlBVVF9MSU5FKCdVcGRhdGVkIEVtcGxveWVlOiAnIHx8IGVtcGxveWVlX25hbWVzKGkpKTsKICAgIEVORCBMT09QOwpFTkQ7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    TYPE NumList IS TABLE OF NUMBER;
    TYPE NameList IS TABLE OF VARCHAR2(50);
    employee_ids NumList;
    employee_names NameList;
BEGIN
    -- Recollida massiva de dades en col&middot;leccions
    SELECT employee_id, first_name
    BULK COLLECT INTO employee_ids, employee_names
    FROM employees
    WHERE department_id = 10;
    
    -- Realitzar actualitzaci&oacute; massiva utilitzant FORALL
    FORALL i IN employee_ids.FIRST..employee_ids.LAST
        UPDATE employees
        SET salary = salary * 1.10
        WHERE employee_id = employee_ids(i);
    
    -- Mostrar els noms actualitzats
    FOR i IN employee_ids.FIRST..employee_ids.LAST LOOP
        DBMS_OUTPUT.PUT_LINE('Updated Employee: ' || employee_names(i));
    END LOOP;
END;</pre></div><div class='content'><p>En aquest exemple, <code>BULK COLLECT</code> s'utilitza per recuperar IDs i noms d'empleats en col·leccions, i <code>FORALL</code> s'utilitza per actualitzar els salaris d'aquests empleats en una sola operació.</p>
</div><h1>Conclusió</h1>
<div class='content'><p><code>BULK COLLECT</code> i <code>FORALL</code> són eines essencials en PL/SQL per gestionar grans volums de dades de manera eficient. Reduint els canvis de context entre els motors PL/SQL i SQL, aquestes característiques poden millorar significativament el rendiment dels teus programes PL/SQL. Entendre i utilitzar aquestes característiques t'ajudarà a escriure codi PL/SQL més eficient i escalable.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
