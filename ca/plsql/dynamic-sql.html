<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/plsql/dynamic-sql" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>El SQL dinàmic és una característica poderosa en PL/SQL que et permet construir i executar sentències SQL dinàmicament en temps d'execució. Això és particularment útil quan la sentència SQL exacta no es coneix fins al temps d'execució, com quan es construeixen consultes complexes basades en l'entrada de l'usuari o altres condicions de temps d'execució.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>SQL estàtic vs. SQL dinàmic</strong>: Les sentències SQL estàtiques estan codificades en el bloc PL/SQL i es coneixen en temps de compilació, mentre que les sentències SQL dinàmiques es construeixen i s'executen en temps d'execució.</li>
<li><strong>EXECUTE IMMEDIATE</strong>: Una comanda PL/SQL utilitzada per executar una única sentència SQL o un bloc PL/SQL dinàmicament.</li>
<li><strong>Paquet DBMS_SQL</strong>: Un paquet PL/SQL que proporciona una manera més flexible d'executar SQL dinàmic, especialment útil per executar múltiples sentències SQL o gestionar consultes complexes.</li>
</ul>
</div><h1>SQL estàtic vs. SQL dinàmic</h1>
<div class='content'><p>| Característica    | SQL estàtic                          | SQL dinàmic                          |
|-------------------|--------------------------------------|--------------------------------------|
| Compilació        | Conegut en temps de compilació       | Construït i executat en temps d'execució |
| Rendiment         | Generalment més ràpid degut a la precompilació | Pot ser més lent degut a l'anàlisi en temps d'execució |
| Flexibilitat      | Menys flexible, estructura fixa      | Altament flexible, pot canviar en temps d'execució |</p>
</div><h1>Ús de EXECUTE IMMEDIATE</h1>
<div class='content'><p><code>EXECUTE IMMEDIATE</code> és la manera més senzilla d'executar SQL dinàmic en PL/SQL. Et permet executar una única sentència SQL o un bloc PL/SQL.</p>
</div><h2>Exemple: Executant una Sentència SQL Simple</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgc3FsX3N0bXQgVkFSQ0hBUjIoMTAwKTsKQkVHSU4KICAgIHNxbF9zdG10IDo9ICdVUERBVEUgZW1wbG95ZWVzIFNFVCBzYWxhcnkgPSBzYWxhcnkgKiAxLjEgV0hFUkUgZGVwYXJ0bWVudF9pZCA9IDEwJzsKICAgIEVYRUNVVEUgSU1NRURJQVRFIHNxbF9zdG10OwogICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ1NhbGFyaXMgYWN0dWFsaXR6YXRzIGFtYiDDqHhpdC4nKTsKRU5EOwov"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    sql_stmt VARCHAR2(100);
BEGIN
    sql_stmt := 'UPDATE employees SET salary = salary * 1.1 WHERE department_id = 10';
    EXECUTE IMMEDIATE sql_stmt;
    DBMS_OUTPUT.PUT_LINE('Salaris actualitzats amb &egrave;xit.');
END;
/</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>sql_stmt</strong>: Una variable per contenir la sentència SQL dinàmica.</li>
<li><strong>EXECUTE IMMEDIATE</strong>: Executa la sentència SQL emmagatzemada en <code>sql_stmt</code>.</li>
<li><strong>DBMS_OUTPUT.PUT_LINE</strong>: Mostra un missatge indicant que l'operació ha estat exitosa.</li>
</ul>
</div><h2>Exemple: Ús de Variables de Vinculació</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgc3FsX3N0bXQgVkFSQ0hBUjIoMTAwKTsKICAgIGRlcHRfaWQgTlVNQkVSIDo9IDEwOwogICAgaW5jcmVtZW50IE5VTUJFUiA6PSAxLjE7CkJFR0lOCiAgICBzcWxfc3RtdCA6PSAnVVBEQVRFIGVtcGxveWVlcyBTRVQgc2FsYXJ5ID0gc2FsYXJ5ICogOmluY3JlbWVudCBXSEVSRSBkZXBhcnRtZW50X2lkID0gOmRlcHRfaWQnOwogICAgRVhFQ1VURSBJTU1FRElBVEUgc3FsX3N0bXQgVVNJTkcgaW5jcmVtZW50LCBkZXB0X2lkOwogICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ1NhbGFyaXMgYWN0dWFsaXR6YXRzIGFtYiDDqHhpdC4nKTsKRU5EOwov"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    sql_stmt VARCHAR2(100);
    dept_id NUMBER := 10;
    increment NUMBER := 1.1;
BEGIN
    sql_stmt := 'UPDATE employees SET salary = salary * :increment WHERE department_id = :dept_id';
    EXECUTE IMMEDIATE sql_stmt USING increment, dept_id;
    DBMS_OUTPUT.PUT_LINE('Salaris actualitzats amb &egrave;xit.');
END;
/</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>Variables de Vinculació</strong>: <code>:increment</code> i <code>:dept_id</code> són marcadors de posició en la sentència SQL.</li>
<li><strong>Clàusula USING</strong>: Proporciona valors per a les variables de vinculació en temps d'execució.</li>
</ul>
</div><h1>Ús del Paquet DBMS_SQL</h1>
<div class='content'><p>El paquet <code>DBMS_SQL</code> ofereix més control i flexibilitat per executar SQL dinàmic, especialment per a escenaris complexos.</p>
</div><h2>Exemple: Executant una Consulta amb DBMS_SQL</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("REVDTEFSRQogICAgY3Vyc29yX2lkIElOVEVHRVI7CiAgICBzcWxfc3RtdCBWQVJDSEFSMigyMDApOwogICAgZW1wX25hbWUgVkFSQ0hBUjIoNTApOwpCRUdJTgogICAgc3FsX3N0bXQgOj0gJ1NFTEVDVCBmaXJzdF9uYW1lIEZST00gZW1wbG95ZWVzIFdIRVJFIGVtcGxveWVlX2lkID0gOmVtcF9pZCc7CiAgICBjdXJzb3JfaWQgOj0gREJNU19TUUwuT1BFTl9DVVJTT1I7CiAgICBEQk1TX1NRTC5QQVJTRShjdXJzb3JfaWQsIHNxbF9zdG10LCBEQk1TX1NRTC5OQVRJVkUpOwogICAgREJNU19TUUwuQklORF9WQVJJQUJMRShjdXJzb3JfaWQsICc6ZW1wX2lkJywgMTAwKTsKICAgIERCTVNfU1FMLkRFRklORV9DT0xVTU4oY3Vyc29yX2lkLCAxLCBlbXBfbmFtZSk7CiAgICAKICAgIElGIERCTVNfU1FMLkVYRUNVVEVfQU5EX0ZFVENIKGN1cnNvcl9pZCkgPiAwIFRIRU4KICAgICAgICBEQk1TX1NRTC5DT0xVTU5fVkFMVUUoY3Vyc29yX2lkLCAxLCBlbXBfbmFtZSk7CiAgICAgICAgREJNU19PVVRQVVQuUFVUX0xJTkUoJ05vbSBkZSBsJ2VtcGxlYXQ6ICcgfHwgZW1wX25hbWUpOwogICAgRU5EIElGOwogICAgCiAgICBEQk1TX1NRTC5DTE9TRV9DVVJTT1IoY3Vyc29yX2lkKTsKRU5EOwov"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>DECLARE
    cursor_id INTEGER;
    sql_stmt VARCHAR2(200);
    emp_name VARCHAR2(50);
BEGIN
    sql_stmt := 'SELECT first_name FROM employees WHERE employee_id = :emp_id';
    cursor_id := DBMS_SQL.OPEN_CURSOR;
    DBMS_SQL.PARSE(cursor_id, sql_stmt, DBMS_SQL.NATIVE);
    DBMS_SQL.BIND_VARIABLE(cursor_id, ':emp_id', 100);
    DBMS_SQL.DEFINE_COLUMN(cursor_id, 1, emp_name);
    
    IF DBMS_SQL.EXECUTE_AND_FETCH(cursor_id) &gt; 0 THEN
        DBMS_SQL.COLUMN_VALUE(cursor_id, 1, emp_name);
        DBMS_OUTPUT.PUT_LINE('Nom de l'empleat: ' || emp_name);
    END IF;
    
    DBMS_SQL.CLOSE_CURSOR(cursor_id);
END;
/</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>OPEN_CURSOR</strong>: Obre un nou cursor per a la sentència SQL dinàmica.</li>
<li><strong>PARSE</strong>: Analitza la sentència SQL.</li>
<li><strong>BIND_VARIABLE</strong>: Vincula un valor a la variable de vinculació <code>:emp_id</code>.</li>
<li><strong>DEFINE_COLUMN</strong>: Defineix la variable de sortida per al conjunt de resultats.</li>
<li><strong>EXECUTE_AND_FETCH</strong>: Executa la sentència SQL i obté el resultat.</li>
<li><strong>COLUMN_VALUE</strong>: Recupera el valor de la columna especificada.</li>
<li><strong>CLOSE_CURSOR</strong>: Tanca el cursor.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>El SQL dinàmic en PL/SQL proporciona la flexibilitat per construir i executar sentències SQL en temps d'execució, fent-lo una eina poderosa per gestionar consultes complexes i variables. La comanda <code>EXECUTE IMMEDIATE</code> és adequada per a execucions més senzilles i d'una sola sentència, mentre que el paquet <code>DBMS_SQL</code> ofereix capacitats més avançades per gestionar múltiples sentències i escenaris complexos. Entendre quan i com utilitzar aquestes eines de manera efectiva pot millorar enormement la versatilitat i funcionalitat dels teus programes PL/SQL.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
