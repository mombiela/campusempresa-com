<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analitzant el Rendiment de les Consultes</title>

    <link rel="alternate" href="https://campusempresa.com/es/postgresql/analyzing-query-performance" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/postgresql/analyzing-query-performance" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/postgresql/analyzing-query-performance" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/postgresql/analyzing-query-performance" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Analitzar el rendiment de les consultes és crucial per optimitzar les operacions de la base de dades i assegurar una recuperació eficient de les dades. En aquesta secció, cobrirem els conceptes bàsics de l'anàlisi del rendiment de les consultes en PostgreSQL, progressant des de tècniques per a principiants fins a tècniques avançades.</p>
</div><h1>Entenent el Rendiment de les Consultes</h1>
<div class='content'><ul>
<li><strong>Temps d'Execució de la Consulta</strong>: La durada que triga una consulta a executar-se.</li>
<li><strong>Utilització de Recursos</strong>: Recursos de CPU, memòria i I/O consumits per la consulta.</li>
<li><strong>Índexs</strong>: Estructures que milloren la velocitat de recuperació de dades.</li>
<li><strong>Plans de Consulta</strong>: La seqüència d'operacions que PostgreSQL utilitza per executar una consulta.</li>
</ul>
</div><h1>Eines per Analitzar el Rendiment de les Consultes</h1>
<h2>EXPLAIN i EXPLAIN ANALYZE</h2>
<div class='content'><ul>
<li><strong>EXPLAIN</strong>: Proporciona el pla d'execució d'una consulta sense executar-la.</li>
<li><strong>EXPLAIN ANALYZE</strong>: Executa la consulta i proporciona el pla d'execució juntament amb els temps d'execució reals.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVXNhbnQgRVhQTEFJTgpFWFBMQUlOIFNFTEVDVCAqIEZST00gZW1wbG95ZWVzIFdIRVJFIGRlcGFydG1lbnQgPSAnU2FsZXMnOwoKLS0gVXNhbnQgRVhQTEFJTiBBTkFMWVpFCkVYUExBSU4gQU5BTFlaRSBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Usant EXPLAIN
EXPLAIN SELECT * FROM employees WHERE department = 'Sales';

-- Usant EXPLAIN ANALYZE
EXPLAIN ANALYZE SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'></div><h2>pg_stat_statements</h2>
<div class='content'><ul>
<li><strong>pg_stat_statements</strong>: Una extensió que rastreja les estadístiques d'execució de totes les instruccions SQL executades per un servidor.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQWN0aXZhbnQgcGdfc3RhdF9zdGF0ZW1lbnRzCkNSRUFURSBFWFRFTlNJT04gcGdfc3RhdF9zdGF0ZW1lbnRzOwoKLS0gQ29uc3VsdGFyIHBnX3N0YXRfc3RhdGVtZW50cwpTRUxFQ1QgKiBGUk9NIHBnX3N0YXRfc3RhdGVtZW50cyBPUkRFUiBCWSB0b3RhbF90aW1lIERFU0MgTElNSVQgNTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Activant pg_stat_statements
CREATE EXTENSION pg_stat_statements;

-- Consultar pg_stat_statements
SELECT * FROM pg_stat_statements ORDER BY total_time DESC LIMIT 5;</pre></div><div class='content'></div><h1>Índexs i el Seu Impacte</h1>
<h2>Tipus d'Índexs</h2>
<div class='content'><ul>
<li><strong>Índexs B-tree</strong>: Tipus d'índex per defecte, adequat per a la majoria de consultes.</li>
<li><strong>Índexs Hash</strong>: Útils per a comparacions d'igualtat.</li>
<li><strong>Índexs GIN i GiST</strong>: Adequats per a la cerca de text complet i tipus de dades complexos.</li>
</ul>
</div><h2>Creació i Ús d'Índexs</h2>
<div class='content'><ul>
<li><strong>Creació d'un Índex</strong>: Millora el rendiment de la consulta reduint la quantitat de dades escanejades.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYW50IHVuIMOtbmRleCBCLXRyZWUKQ1JFQVRFIElOREVYIGlkeF9kZXBhcnRtZW50IE9OIGVtcGxveWVlcyhkZXBhcnRtZW50KTsKCi0tIENvbnN1bHRhIHVzYW50IGwnw61uZGV4ClNFTEVDVCAqIEZST00gZW1wbG95ZWVzIFdIRVJFIGRlcGFydG1lbnQgPSAnU2FsZXMnOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Creant un &iacute;ndex B-tree
CREATE INDEX idx_department ON employees(department);

-- Consulta usant l'&iacute;ndex
SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'></div><h2>Analitzant l'Ús dels Índexs</h2>
<div class='content'><ul>
<li><strong>Comprovant l'Ús dels Índexs</strong>: Utilitza el comandament <code>EXPLAIN</code> per veure si s'està utilitzant un índex.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RVhQTEFJTiBTRUxFQ1QgKiBGUk9NIGVtcGxveWVlcyBXSEVSRSBkZXBhcnRtZW50ID0gJ1NhbGVzJzs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>EXPLAIN SELECT * FROM employees WHERE department = 'Sales';</pre></div><div class='content'></div><h1>Optimitzant Consultes</h1>
<h2>Reescriptura de Consultes</h2>
<div class='content'><ul>
<li><strong>Usant Subconsultes</strong>: De vegades, descompondre consultes complexes en subconsultes pot millorar el rendiment.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVXNhbnQgdW5hIHN1YmNvbnN1bHRhClNFTEVDVCAqIEZST00gZW1wbG95ZWVzIFdIRVJFIGRlcGFydG1lbnRfaWQgSU4gKFNFTEVDVCBpZCBGUk9NIGRlcGFydG1lbnRzIFdIRVJFIG5hbWUgPSAnU2FsZXMnKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Usant una subconsulta
SELECT * FROM employees WHERE department_id IN (SELECT id FROM departments WHERE name = 'Sales');</pre></div><div class='content'></div><h2>Evitant Errors Comuns</h2>
<div class='content'><ul>
<li>**Evitant SELECT *<strong>:</strong> Especifica només les columnes que necessites.</li>
<li><strong>Usant JOINs Eficientment</strong>: Assegura't que els JOINs siguin necessaris i estiguin adequadament indexats.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRXZpdGFudCBTRUxFQ1QgKgpTRUxFQ1QgaWQsIG5hbWUgRlJPTSBlbXBsb3llZXMgV0hFUkUgZGVwYXJ0bWVudCA9ICdTYWxlcyc7CgotLSBKT0lOIGVmaWNpZW50ClNFTEVDVCBlLm5hbWUsIGQubmFtZSAKRlJPTSBlbXBsb3llZXMgZQpKT0lOIGRlcGFydG1lbnRzIGQgT04gZS5kZXBhcnRtZW50X2lkID0gZC5pZApXSEVSRSBkLm5hbWUgPSAnU2FsZXMnOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Evitant SELECT *
SELECT id, name FROM employees WHERE department = 'Sales';

-- JOIN eficient
SELECT e.name, d.name 
FROM employees e
JOIN departments d ON e.department_id = d.id
WHERE d.name = 'Sales';</pre></div><div class='content'></div><h1>Tècniques Avançades</h1>
<h2>Particionament</h2>
<div class='content'><ul>
<li><strong>Particionament de Taules</strong>: Dividir taules grans en peces més petites i manejables.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYW50IHVuYSB0YXVsYSBwYXJ0aWNpb25hZGEKQ1JFQVRFIFRBQkxFIGVtcGxveWVlcyAoCiAgICBpZCBTRVJJQUwgUFJJTUFSWSBLRVksCiAgICBuYW1lIFZBUkNIQVIoMTAwKSwKICAgIGRlcGFydG1lbnQgVkFSQ0hBUig1MCksCiAgICBoaXJlX2RhdGUgREFURQopIFBBUlRJVElPTiBCWSBSQU5HRSAoaGlyZV9kYXRlKTsKCi0tIENyZWFudCBwYXJ0aWNpb25zCkNSRUFURSBUQUJMRSBlbXBsb3llZXNfMjAyMCBQQVJUSVRJT04gT0YgZW1wbG95ZWVzIEZPUiBWQUxVRVMgRlJPTSAoJzIwMjAtMDEtMDEnKSBUTyAoJzIwMjEtMDEtMDEnKTsKQ1JFQVRFIFRBQkxFIGVtcGxveWVlc18yMDIxIFBBUlRJVElPTiBPRiBlbXBsb3llZXMgRk9SIFZBTFVFUyBGUk9NICgnMjAyMS0wMS0wMScpIFRPICgnMjAyMi0wMS0wMScpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Creant una taula particionada
CREATE TABLE employees (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100),
    department VARCHAR(50),
    hire_date DATE
) PARTITION BY RANGE (hire_date);

-- Creant particions
CREATE TABLE employees_2020 PARTITION OF employees FOR VALUES FROM ('2020-01-01') TO ('2021-01-01');
CREATE TABLE employees_2021 PARTITION OF employees FOR VALUES FROM ('2021-01-01') TO ('2022-01-01');</pre></div><div class='content'></div><h2>Usant CTEs (Expressions de Taula Comunes)</h2>
<div class='content'><ul>
<li><strong>CTEs</strong>: Milloren la llegibilitat i mantenibilitat de consultes complexes.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gVXNhbnQgdW5hIENURQpXSVRIIFNhbGVzRW1wbG95ZWVzIEFTICgKICAgIFNFTEVDVCAqIEZST00gZW1wbG95ZWVzIFdIRVJFIGRlcGFydG1lbnQgPSAnU2FsZXMnCikKU0VMRUNUICogRlJPTSBTYWxlc0VtcGxveWVlcyBXSEVSRSBoaXJlX2RhdGUgPiAnMjAyMC0wMS0wMSc7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Usant una CTE
WITH SalesEmployees AS (
    SELECT * FROM employees WHERE department = 'Sales'
)
SELECT * FROM SalesEmployees WHERE hire_date &gt; '2020-01-01';</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Analitzar el rendiment de les consultes en PostgreSQL implica entendre els plans d'execució, utilitzar índexs de manera efectiva i optimitzar les consultes mitjançant diverses tècniques. Aprofitant eines com <code>EXPLAIN</code>, <code>pg_stat_statements</code> i funcions avançades com el particionament i les CTEs, pots millorar significativament el rendiment de les teves consultes a la base de dades. Monitoritzar i analitzar regularment el rendiment de les consultes és clau per mantenir una base de dades PostgreSQL eficient i responsiva.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
