<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Estudis de cas</title>

    <link rel="alternate" href="https://campusempresa.com/es/bigquery/case-studies" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/bigquery/case-studies" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/bigquery/case-studies" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/bigquery/case-studies" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquesta secció, explorarem estudis de cas del món real per entendre com es pot aplicar BigQuery per resoldre diversos reptes de dades. Examinant aquests estudis de cas, obtindreu informació sobre aplicacions pràctiques, millors pràctiques i tècniques avançades.</p>
</div><h1>Estudi de cas 1: Anàlisi de dades de comerç electrònic</h1>
<div class='content'></div><h2>Visió general</h2>
<div class='content'><p>Una empresa de comerç electrònic vol analitzar les seves dades de vendes per entendre el comportament dels clients, optimitzar l'inventari i millorar les estratègies de màrqueting.</p>
</div><h2>Conceptes clau</h2>
<div class='content'><ul>
<li><strong>Ingestió de dades</strong>: Carregar dades de vendes a BigQuery.</li>
<li><strong>Transformació de dades</strong>: Netejar i transformar les dades per a l'anàlisi.</li>
<li><strong>Optimització de consultes</strong>: Escriure consultes eficients per gestionar grans conjunts de dades.</li>
<li><strong>Visualització</strong>: Utilitzar eines com Google Data Studio per visualitzar els resultats.</li>
</ul>
</div><h2>Passos i exemples de codi</h2>
<div class='content'><h4>Ingestió de dades</h4>
<p>Primer, carrega les dades de vendes a BigQuery. Suposem que les dades estan en un fitxer CSV emmagatzemat a Google Cloud Storage.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FycmVnYXIgZGFkZXMgZGVzIGRlIEdvb2dsZSBDbG91ZCBTdG9yYWdlIGEgQmlnUXVlcnkKTE9BRCBEQVRBIElOVE8gYHByb2plY3QuZGF0YXNldC5zYWxlc2AKRlJPTSAnZ3M6Ly9idWNrZXRfbmFtZS9zYWxlc19kYXRhLmNzdicKV0lUSAogIEZPUk1BVCA9IENTViwKICBGSUVMRF9ERUxJTUlURVIgPSAnLCcsCiAgU0tJUF9MRUFESU5HX1JPV1MgPSAxOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Carregar dades des de Google Cloud Storage a BigQuery
LOAD DATA INTO `project.dataset.sales`
FROM 'gs://bucket_name/sales_data.csv'
WITH
  FORMAT = CSV,
  FIELD_DELIMITER = ',',
  SKIP_LEADING_ROWS = 1;</pre></div><div class='content'><h4>Transformació de dades</h4>
<p>Neteja i transforma les dades per fer-les adequades per a l'anàlisi.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ3JlYXIgdW5hIG5vdmEgdGF1bGEgYW1iIGRhZGVzIG5ldGVqYWRlcwpDUkVBVEUgVEFCTEUgYHByb2plY3QuZGF0YXNldC5jbGVhbmVkX3NhbGVzYCBBUwpTRUxFQ1QKICBvcmRlcl9pZCwKICBjdXN0b21lcl9pZCwKICBwcm9kdWN0X2lkLAogIENBU1Qob3JkZXJfZGF0ZSBBUyBEQVRFKSBBUyBvcmRlcl9kYXRlLAogIENBU1QocXVhbnRpdHkgQVMgSU5UNjQpIEFTIHF1YW50aXR5LAogIENBU1QocHJpY2UgQVMgRkxPQVQ2NCkgQVMgcHJpY2UsCiAgcXVhbnRpdHkgKiBwcmljZSBBUyB0b3RhbF9hbW91bnQKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuc2FsZXNgCldIRVJFCiAgb3JkZXJfZGF0ZSBJUyBOT1QgTlVMTAogIEFORCBxdWFudGl0eSA+IDAKICBBTkQgcHJpY2UgPiAwOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Crear una nova taula amb dades netejades
CREATE TABLE `project.dataset.cleaned_sales` AS
SELECT
  order_id,
  customer_id,
  product_id,
  CAST(order_date AS DATE) AS order_date,
  CAST(quantity AS INT64) AS quantity,
  CAST(price AS FLOAT64) AS price,
  quantity * price AS total_amount
FROM
  `project.dataset.sales`
WHERE
  order_date IS NOT NULL
  AND quantity &gt; 0
  AND price &gt; 0;</pre></div><div class='content'><h4>Optimització de consultes</h4>
<p>Escriu consultes optimitzades per analitzar les dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FsY3VsYXIgbGVzIHZlbmRlcyB0b3RhbHMgcGVyIHByb2R1Y3RlClNFTEVDVAogIHByb2R1Y3RfaWQsCiAgU1VNKHRvdGFsX2Ftb3VudCkgQVMgdG90YWxfc2FsZXMKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuY2xlYW5lZF9zYWxlc2AKR1JPVVAgQlkKICBwcm9kdWN0X2lkCk9SREVSIEJZCiAgdG90YWxfc2FsZXMgREVTQzs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Calcular les vendes totals per producte
SELECT
  product_id,
  SUM(total_amount) AS total_sales
FROM
  `project.dataset.cleaned_sales`
GROUP BY
  product_id
ORDER BY
  total_sales DESC;</pre></div><div class='content'><h4>Visualització</h4>
<p>Utilitza Google Data Studio per crear visualitzacions basades en els resultats de la consulta.</p>
</div><h1>Estudi de cas 2: Analítica en temps real per a dispositius IoT</h1>
<div class='content'></div><h2>Visió general</h2>
<div class='content'><p>Una empresa vol realitzar analítiques en temps real sobre les dades generades per dispositius IoT per monitoritzar el rendiment i detectar anomalies.</p>
</div><h2>Conceptes clau</h2>
<div class='content'><ul>
<li><strong>Dades en streaming</strong>: Ingestió de dades en temps real a BigQuery.</li>
<li><strong>Funcions de finestra</strong>: Utilitzar funcions de finestra per analitzar dades de sèries temporals.</li>
<li><strong>Detecció d'anomalies</strong>: Identificar anomalies en les dades.</li>
</ul>
</div><h2>Passos i exemples de codi</h2>
<div class='content'><h4>Dades en streaming</h4>
<p>Ingestió de dades en temps real des de dispositius IoT utilitzant l'API de streaming de BigQuery.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBnb29nbGUuY2xvdWQgaW1wb3J0IGJpZ3F1ZXJ5CgpjbGllbnQgPSBiaWdxdWVyeS5DbGllbnQoKQp0YWJsZV9pZCA9ICJwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGEiCgpyb3dzX3RvX2luc2VydCA9IFsKICAgIHsiZGV2aWNlX2lkIjogImRldmljZV8xIiwgInRpbWVzdGFtcCI6ICIyMDIzLTEwLTAxVDEyOjAwOjAwWiIsICJ0ZW1wZXJhdHVyZSI6IDIyLjV9LAogICAgeyJkZXZpY2VfaWQiOiAiZGV2aWNlXzIiLCAidGltZXN0YW1wIjogIjIwMjMtMTAtMDFUMTI6MDE6MDBaIiwgInRlbXBlcmF0dXJlIjogMjMuMH0sCl0KCmVycm9ycyA9IGNsaWVudC5pbnNlcnRfcm93c19qc29uKHRhYmxlX2lkLCByb3dzX3RvX2luc2VydCkKaWYgZXJyb3JzID09IFtdOgogICAgcHJpbnQoIk5ldyByb3dzIGhhdmUgYmVlbiBhZGRlZC4iKQplbHNlOgogICAgcHJpbnQoIkVuY291bnRlcmVkIGVycm9ycyB3aGlsZSBpbnNlcnRpbmcgcm93czoge30iLmZvcm1hdChlcnJvcnMpKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from google.cloud import bigquery

client = bigquery.Client()
table_id = &quot;project.dataset.iot_data&quot;

rows_to_insert = [
    {&quot;device_id&quot;: &quot;device_1&quot;, &quot;timestamp&quot;: &quot;2023-10-01T12:00:00Z&quot;, &quot;temperature&quot;: 22.5},
    {&quot;device_id&quot;: &quot;device_2&quot;, &quot;timestamp&quot;: &quot;2023-10-01T12:01:00Z&quot;, &quot;temperature&quot;: 23.0},
]

errors = client.insert_rows_json(table_id, rows_to_insert)
if errors == []:
    print(&quot;New rows have been added.&quot;)
else:
    print(&quot;Encountered errors while inserting rows: {}&quot;.format(errors))</pre></div><div class='content'><h4>Funcions de finestra</h4>
<p>Utilitza funcions de finestra per analitzar les dades de sèries temporals.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQ2FsY3VsYXIgbGEgdGVtcGVyYXR1cmEgbWl0amFuYSBtw7JiaWwgcGVyIGEgY2FkYSBkaXNwb3NpdGl1ClNFTEVDVAogIGRldmljZV9pZCwKICB0aW1lc3RhbXAsCiAgdGVtcGVyYXR1cmUsCiAgQVZHKHRlbXBlcmF0dXJlKSBPVkVSIChQQVJUSVRJT04gQlkgZGV2aWNlX2lkIE9SREVSIEJZIHRpbWVzdGFtcCBST1dTIEJFVFdFRU4gMiBQUkVDRURJTkcgQU5EIENVUlJFTlQgUk9XKSBBUyBtb3ZpbmdfYXZnX3RlbXAKRlJPTQogIGBwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGFgOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Calcular la temperatura mitjana m&ograve;bil per a cada dispositiu
SELECT
  device_id,
  timestamp,
  temperature,
  AVG(temperature) OVER (PARTITION BY device_id ORDER BY timestamp ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS moving_avg_temp
FROM
  `project.dataset.iot_data`;</pre></div><div class='content'><h4>Detecció d'anomalies</h4>
<p>Identifica anomalies en les dades de temperatura.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gRGV0ZWN0YXIgYW5vbWFsaWVzIGRlIHRlbXBlcmF0dXJhCldJVEggdGVtcF9zdGF0cyBBUyAoCiAgU0VMRUNUCiAgICBkZXZpY2VfaWQsCiAgICBBVkcodGVtcGVyYXR1cmUpIEFTIGF2Z190ZW1wLAogICAgU1REREVWKHRlbXBlcmF0dXJlKSBBUyBzdGRkZXZfdGVtcAogIEZST00KICAgIGBwcm9qZWN0LmRhdGFzZXQuaW90X2RhdGFgCiAgR1JPVVAgQlkKICAgIGRldmljZV9pZAopClNFTEVDVAogIGlvdC5kZXZpY2VfaWQsCiAgaW90LnRpbWVzdGFtcCwKICBpb3QudGVtcGVyYXR1cmUsCiAgQ0FTRQogICAgV0hFTiBBQlMoaW90LnRlbXBlcmF0dXJlIC0gdHMuYXZnX3RlbXApID4gMyAqIHRzLnN0ZGRldl90ZW1wIFRIRU4gJ0Fub21hbHknCiAgICBFTFNFICdOb3JtYWwnCiAgRU5EIEFTIHN0YXR1cwpGUk9NCiAgYHByb2plY3QuZGF0YXNldC5pb3RfZGF0YWAgQVMgaW90CkpPSU4KICB0ZW1wX3N0YXRzIEFTIHRzCk9OCiAgaW90LmRldmljZV9pZCA9IHRzLmRldmljZV9pZDs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Detectar anomalies de temperatura
WITH temp_stats AS (
  SELECT
    device_id,
    AVG(temperature) AS avg_temp,
    STDDEV(temperature) AS stddev_temp
  FROM
    `project.dataset.iot_data`
  GROUP BY
    device_id
)
SELECT
  iot.device_id,
  iot.timestamp,
  iot.temperature,
  CASE
    WHEN ABS(iot.temperature - ts.avg_temp) &gt; 3 * ts.stddev_temp THEN 'Anomaly'
    ELSE 'Normal'
  END AS status
FROM
  `project.dataset.iot_data` AS iot
JOIN
  temp_stats AS ts
ON
  iot.device_id = ts.device_id;</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Examinant aquests estudis de cas, heu après com aplicar BigQuery a escenaris del món real. Heu vist com ingerir, transformar i analitzar dades, així com com optimitzar consultes i visualitzar resultats. Aquests exemples haurien de proporcionar una base sòlida per abordar els vostres propis reptes de dades utilitzant BigQuery.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
