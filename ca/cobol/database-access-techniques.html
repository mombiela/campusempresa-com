<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tècniques d'Accés a Bases de Dades en COBOL</title>

    <link rel="alternate" href="https://campusempresa.com/es/cobol/database-access-techniques" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/cobol/database-access-techniques" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/cobol/database-access-techniques" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/cobol/database-access-techniques" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='embedded-sql-in-cobol'>&#x25C4;SQL Integrat en COBOL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Tècniques d'Accés a Bases de Dades en COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-transactions'>Gestió de Transaccions &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquesta secció, explorarem diverses tècniques per accedir a bases de dades utilitzant COBOL. Això inclou entendre els conceptes bàsics de la connectivitat a bases de dades, executar consultes SQL, gestionar transaccions i administrar la recuperació i actualització de dades. Al final d'aquest tema, seràs capaç d'interactuar eficaçment amb bases de dades en els teus programes COBOL.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>SQL Inserit</strong>: Sentències SQL escrites directament dins del codi COBOL.</li>
<li><strong>Gestió de Cursors</strong>: Tècniques per gestionar múltiples files de dades.</li>
<li><strong>Control de Transaccions</strong>: Gestionar transaccions de bases de dades per assegurar la integritat de les dades.</li>
<li><strong>Gestió d'Errors</strong>: Tècniques per gestionar errors durant les operacions de bases de dades.</li>
</ul>
</div><h1>Connexió a una Base de Dades</h1>
<div class='content'><p>Per interactuar amb una base de dades, primer has d'establir una connexió. Això normalment implica especificar el nom de la base de dades, les credencials d'usuari i altres paràmetres de connexió.</p>
</div><h2>Exemple: Establir una Connexió a una Base de Dades</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIENvbm5lY3RUb0RhdGFiYXNlLgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxICBEQi1DT05ORUNUSU9OLVNUQVRVUyAgUElDIFgoMTApLgoKRVhFQyBTUUwKICAgIElOQ0xVREUgU1FMQ0EKRU5ELUVYRUMuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIENPTk5FQ1QgVE8gJ2RhdGFiYXNlX25hbWUnCiAgICAgICAgVVNFUiAndXNlcm5hbWUnCiAgICAgICAgVVNJTkcgJ3Bhc3N3b3JkJwogICAgRU5ELUVYRUMuCgogICAgSUYgU1FMQ09ERSA9IDAKICAgICAgICBESVNQTEFZICdDb25uZXhpw7MgZXhpdG9zYS4nCiAgICBFTFNFCiAgICAgICAgRElTUExBWSAnQ29ubmV4acOzIGZhbGxpZGEuIFNRTENPREU6ICcgU1FMQ09ERQogICAgRU5ELUlGLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ConnectToDatabase.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  DB-CONNECTION-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        CONNECT TO 'database_name'
        USER 'username'
        USING 'password'
    END-EXEC.

    IF SQLCODE = 0
        DISPLAY 'Connexi&oacute; exitosa.'
    ELSE
        DISPLAY 'Connexi&oacute; fallida. SQLCODE: ' SQLCODE
    END-IF.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>SQLCA</strong>: Àrea de Comunicació SQL, utilitzada per a la gestió d'errors.</li>
<li><strong>SQLCODE</strong>: Variable que conté l'estat de l'última sentència SQL executada.</li>
</ul>
</div><h1>Executar Consultes SQL</h1>
<div class='content'><p>Un cop connectat, pots executar consultes SQL per interactuar amb la base de dades. Això inclou operacions SELECT, INSERT, UPDATE i DELETE.</p>
</div><h2>Exemple: Executar una Consulta SELECT</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFNlbGVjdFF1ZXJ5LgoKREFUQSBESVZJU0lPTi4KV09SS0lORy1TVE9SQUdFIFNFQ1RJT04uCjAxICBFTVAtSUQgICAgICAgICAgICBQSUMgOSg1KS4KMDEgIEVNUC1OQU1FICAgICAgICAgIFBJQyBYKDIwKS4KMDEgIFNRTC1RVUVSWS1TVEFUVVMgIFBJQyBYKDEwKS4KCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBERUNMQVJFIEMxIENVUlNPUiBGT1IKICAgICAgICBTRUxFQ1QgRU1QX0lELCBFTVBfTkFNRQogICAgICAgIEZST00gRU1QTE9ZRUUKICAgIEVORC1FWEVDLgoKICAgIEVYRUMgU1FMCiAgICAgICAgT1BFTiBDMQogICAgRU5ELUVYRUMuCgogICAgUEVSRk9STSBVTlRJTCBTUUxDT0RFIDw+IDAKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBGRVRDSCBDMSBJTlRPIDpFTVAtSUQsIDpFTVAtTkFNRQogICAgICAgIEVORC1FWEVDCgogICAgICAgIElGIFNRTENPREUgPSAwCiAgICAgICAgICAgIERJU1BMQVkgJ0lEIGRlIGwnZW1wbGVhdDogJyBFTVAtSUQKICAgICAgICAgICAgRElTUExBWSAnTm9tIGRlIGwnZW1wbGVhdDogJyBFTVAtTkFNRQogICAgICAgIEVORC1JRgogICAgRU5ELVBFUkZPUk0uCgogICAgRVhFQyBTUUwKICAgICAgICBDTE9TRSBDMQogICAgRU5ELUVYRUMuCgogICAgU1RPUCBSVU4u"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. SelectQuery.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  EMP-ID            PIC 9(5).
01  EMP-NAME          PIC X(20).
01  SQL-QUERY-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        DECLARE C1 CURSOR FOR
        SELECT EMP_ID, EMP_NAME
        FROM EMPLOYEE
    END-EXEC.

    EXEC SQL
        OPEN C1
    END-EXEC.

    PERFORM UNTIL SQLCODE &lt;&gt; 0
        EXEC SQL
            FETCH C1 INTO :EMP-ID, :EMP-NAME
        END-EXEC

        IF SQLCODE = 0
            DISPLAY 'ID de l'empleat: ' EMP-ID
            DISPLAY 'Nom de l'empleat: ' EMP-NAME
        END-IF
    END-PERFORM.

    EXEC SQL
        CLOSE C1
    END-EXEC.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>DECLARE CURSOR</strong>: Defineix un cursor per recuperar múltiples files.</li>
<li><strong>OPEN CURSOR</strong>: Obre el cursor per recuperar dades.</li>
<li><strong>FETCH</strong>: Recupera la següent fila del cursor.</li>
<li><strong>CLOSE CURSOR</strong>: Tanca el cursor després de recuperar totes les files.</li>
</ul>
</div><h1>Control de Transaccions</h1>
<div class='content'><p>Les transaccions asseguren que una sèrie d'operacions de bases de dades s'executin com una unitat única. Això és crucial per mantenir la integritat de les dades.</p>
</div><h2>Exemple: Gestionar Transaccions</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIFRyYW5zYWN0aW9uQ29udHJvbC4KCkRBVEEgRElWSVNJT04uCldPUktJTkctU1RPUkFHRSBTRUNUSU9OLgowMSAgU1FMLVNUQVRVUyAgUElDIFgoMTApLgoKRVhFQyBTUUwKICAgIElOQ0xVREUgU1FMQ0EKRU5ELUVYRUMuCgpQUk9DRURVUkUgRElWSVNJT04uCiAgICBFWEVDIFNRTAogICAgICAgIEJFR0lOIFRSQU5TQUNUSU9OCiAgICBFTkQtRVhFQy4KCiAgICBFWEVDIFNRTAogICAgICAgIFVQREFURSBFTVBMT1lFRQogICAgICAgIFNFVCBTQUxBUlkgPSBTQUxBUlkgKiAxLjEKICAgICAgICBXSEVSRSBERVBUX0lEID0gMTAKICAgIEVORC1FWEVDLgoKICAgIElGIFNRTENPREUgPSAwCiAgICAgICAgRVhFQyBTUUwKICAgICAgICAgICAgQ09NTUlUCiAgICAgICAgRU5ELUVYRUMKICAgICAgICBESVNQTEFZICdUcmFuc2FjY2nDsyBjb25maXJtYWRhLicKICAgIEVMU0UKICAgICAgICBFWEVDIFNRTAogICAgICAgICAgICBST0xMQkFDSwogICAgICAgIEVORC1FWEVDCiAgICAgICAgRElTUExBWSAnVHJhbnNhY2Npw7MgcmV2ZXJ0aWRhLiBTUUxDT0RFOiAnIFNRTENPREUKICAgIEVORC1JRi4KCiAgICBTVE9QIFJVTi4="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. TransactionControl.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  SQL-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        BEGIN TRANSACTION
    END-EXEC.

    EXEC SQL
        UPDATE EMPLOYEE
        SET SALARY = SALARY * 1.1
        WHERE DEPT_ID = 10
    END-EXEC.

    IF SQLCODE = 0
        EXEC SQL
            COMMIT
        END-EXEC
        DISPLAY 'Transacci&oacute; confirmada.'
    ELSE
        EXEC SQL
            ROLLBACK
        END-EXEC
        DISPLAY 'Transacci&oacute; revertida. SQLCODE: ' SQLCODE
    END-IF.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>BEGIN TRANSACTION</strong>: Comença una nova transacció.</li>
<li><strong>COMMIT</strong>: Confirma la transacció, fent tots els canvis permanents.</li>
<li><strong>ROLLBACK</strong>: Reverteix la transacció, desfer tots els canvis.</li>
</ul>
</div><h1>Gestió d'Errors</h1>
<div class='content'><p>Una correcta gestió d'errors és essencial per a operacions robustes de bases de dades. L'estructura SQLCA proporciona informació detallada sobre els errors.</p>
</div><h2>Exemple: Gestió d'Errors</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SURFTlRJRklDQVRJT04gRElWSVNJT04uClBST0dSQU0tSUQuIEVycm9ySGFuZGxpbmcuCgpEQVRBIERJVklTSU9OLgpXT1JLSU5HLVNUT1JBR0UgU0VDVElPTi4KMDEgIFNRTC1TVEFUVVMgIFBJQyBYKDEwKS4KCkVYRUMgU1FMCiAgICBJTkNMVURFIFNRTENBCkVORC1FWEVDLgoKUFJPQ0VEVVJFIERJVklTSU9OLgogICAgRVhFQyBTUUwKICAgICAgICBERUxFVEUgRlJPTSBFTVBMT1lFRQogICAgICAgIFdIRVJFIEVNUF9JRCA9IDk5OTk5CiAgICBFTkQtRVhFQy4KCiAgICBJRiBTUUxDT0RFIDw+IDAKICAgICAgICBESVNQTEFZICdTJ2hhIHByb2R1w690IHVuIGVycm9yLiBTUUxDT0RFOiAnIFNRTENPREUKICAgICAgICBESVNQTEFZICdTUUxFUlJNOiAnIFNRTEVSUk0KICAgIEVMU0UKICAgICAgICBESVNQTEFZICdSZWdpc3RyZSBlbGltaW5hdCBhbWIgw6h4aXQuJwogICAgRU5ELUlGLgoKICAgIFNUT1AgUlVOLg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>IDENTIFICATION DIVISION.
PROGRAM-ID. ErrorHandling.

DATA DIVISION.
WORKING-STORAGE SECTION.
01  SQL-STATUS  PIC X(10).

EXEC SQL
    INCLUDE SQLCA
END-EXEC.

PROCEDURE DIVISION.
    EXEC SQL
        DELETE FROM EMPLOYEE
        WHERE EMP_ID = 99999
    END-EXEC.

    IF SQLCODE &lt;&gt; 0
        DISPLAY 'S'ha produ&iuml;t un error. SQLCODE: ' SQLCODE
        DISPLAY 'SQLERRM: ' SQLERRM
    ELSE
        DISPLAY 'Registre eliminat amb &egrave;xit.'
    END-IF.

    STOP RUN.</pre></div><div class='content'><ul>
<li><strong>SQLERRM</strong>: Proporciona un missatge descriptiu de l'error.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem cobert les tècniques essencials per accedir a bases de dades utilitzant COBOL. Hem explorat com establir una connexió, executar consultes SQL, gestionar transaccions i manejar errors. Amb aquestes habilitats, pots interactuar eficaçment amb bases de dades en les teves aplicacions COBOL, assegurant la integritat de les dades i una gestió robusta dels errors.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='embedded-sql-in-cobol'>&#x25C4;SQL Integrat en COBOL</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Tècniques d'Accés a Bases de Dades en COBOL</a>
	</div>
	<div class='col-4 text-end'>
					<a href='handling-transactions'>Gestió de Transaccions &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
