<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/swift/using-core-data" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>Core Data és un potent framework proporcionat per Apple per gestionar la capa de model de la teva aplicació. Et permet treballar amb gràfics d'objectes i persistir dades de manera eficient. Aquest tema et guiarà des dels conceptes bàsics fins a l'ús avançat de Core Data en Swift.</p>
</div><h1>Introducció a Core Data</h1>
<div class='content'><p>Core Data és un framework de gràfics d'objectes i persistència proporcionat per Apple. Permet als desenvolupadors gestionar els objectes de la capa de model en les seves aplicacions. Core Data es pot utilitzar per emmagatzemar dades en una base de dades SQLite, fitxers binaris o en memòria.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Model d'Objectes Gestionats</strong>: Defineix l'estructura de les teves dades.</li>
<li><strong>Context d'Objectes Gestionats</strong>: Actua com una pissarra per als objectes gestionats.</li>
<li><strong>Coordinador de Magatzem Persistent</strong>: Coordina entre el context d'objectes gestionats i el magatzem persistent.</li>
<li><strong>Objecte Gestionat</strong>: Instàncies de les entitats del teu model de dades.</li>
</ul>
</div><h1>Configuració de Core Data en un Projecte Swift</h1>
<div class='content'><p>Per utilitzar Core Data en el teu projecte, cal configurar-lo correctament. Això implica crear un model de dades i configurar la pila de Core Data.</p>
</div><h2>Creació d'un Model de Dades</h2>
<div class='content'><ol>
<li>
<p><strong>Afegeix un Fitxer de Model de Dades</strong>:</p>
<ul>
<li>Ves a Fitxer &gt; Nou &gt; Fitxer.</li>
<li>Tria Model de Dades i posa-li un nom (per exemple, <code>Model.xcdatamodeld</code>).</li>
</ul>
</li>
<li>
<p><strong>Defineix Entitats i Atributs</strong>:</p>
<ul>
<li>Obre el fitxer <code>.xcdatamodeld</code>.</li>
<li>Afegeix entitats (per exemple, <code>Person</code>) i atributs (per exemple, <code>name</code>, <code>age</code>).</li>
</ul>
</li>
</ol>
</div><h2>Configuració de la Pila de Core Data</h2>
<div class='content'><p>La pila de Core Data és el cor de Core Data. Consta del model d'objectes gestionats, el coordinador de magatzem persistent i el context d'objectes gestionats.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IENvcmVEYXRhCgpjbGFzcyBDb3JlRGF0YVN0YWNrIHsKICAgIHN0YXRpYyBsZXQgc2hhcmVkID0gQ29yZURhdGFTdGFjaygpCgogICAgcHJpdmF0ZSBpbml0KCkge30KCiAgICBsYXp5IHZhciBwZXJzaXN0ZW50Q29udGFpbmVyOiBOU1BlcnNpc3RlbnRDb250YWluZXIgPSB7CiAgICAgICAgbGV0IGNvbnRhaW5lciA9IE5TUGVyc2lzdGVudENvbnRhaW5lcihuYW1lOiAiTW9kZWwiKQogICAgICAgIGNvbnRhaW5lci5sb2FkUGVyc2lzdGVudFN0b3JlcyB7IHN0b3JlRGVzY3JpcHRpb24sIGVycm9yIGluCiAgICAgICAgICAgIGlmIGxldCBlcnJvciA9IGVycm9yIGFzIE5TRXJyb3I/IHsKICAgICAgICAgICAgICAgIGZhdGFsRXJyb3IoIlVucmVzb2x2ZWQgZXJyb3IgXChlcnJvciksIFwoZXJyb3IudXNlckluZm8pIikKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gY29udGFpbmVyCiAgICB9KCkKCiAgICB2YXIgY29udGV4dDogTlNNYW5hZ2VkT2JqZWN0Q29udGV4dCB7CiAgICAgICAgcmV0dXJuIHBlcnNpc3RlbnRDb250YWluZXIudmlld0NvbnRleHQKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import CoreData

class CoreDataStack {
    static let shared = CoreDataStack()

    private init() {}

    lazy var persistentContainer: NSPersistentContainer = {
        let container = NSPersistentContainer(name: &quot;Model&quot;)
        container.loadPersistentStores { storeDescription, error in
            if let error = error as NSError? {
                fatalError(&quot;Unresolved error \(error), \(error.userInfo)&quot;)
            }
        }
        return container
    }()

    var context: NSManagedObjectContext {
        return persistentContainer.viewContext
    }
}</pre></div><div class='content'></div><h1>Operacions Bàsiques amb Core Data</h1>
<div class='content'><p>Un cop la pila de Core Data està configurada, pots realitzar operacions bàsiques com crear, llegir, actualitzar i eliminar (CRUD) dades.</p>
</div><h2>Creació de Dades</h2>
<div class='content'><p>Per crear un nou objecte gestionat, cal inserir-lo en el context d'objectes gestionats.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBjcmVhdGVQZXJzb24obmFtZTogU3RyaW5nLCBhZ2U6IEludDE2KSB7CiAgICBsZXQgY29udGV4dCA9IENvcmVEYXRhU3RhY2suc2hhcmVkLmNvbnRleHQKICAgIGxldCBwZXJzb24gPSBQZXJzb24oY29udGV4dDogY29udGV4dCkKICAgIHBlcnNvbi5uYW1lID0gbmFtZQogICAgcGVyc29uLmFnZSA9IGFnZQoKICAgIGRvIHsKICAgICAgICB0cnkgY29udGV4dC5zYXZlKCkKICAgIH0gY2F0Y2ggewogICAgICAgIHByaW50KCJGYWlsZWQgdG8gc2F2ZSBwZXJzb246IFwoZXJyb3IpIikKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func createPerson(name: String, age: Int16) {
    let context = CoreDataStack.shared.context
    let person = Person(context: context)
    person.name = name
    person.age = age

    do {
        try context.save()
    } catch {
        print(&quot;Failed to save person: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h2>Lectura de Dades</h2>
<div class='content'><p>Per obtenir dades, utilitzes <code>NSFetchRequest</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBmZXRjaFBlb3BsZSgpIC0+IFtQZXJzb25dPyB7CiAgICBsZXQgY29udGV4dCA9IENvcmVEYXRhU3RhY2suc2hhcmVkLmNvbnRleHQKICAgIGxldCBmZXRjaFJlcXVlc3Q6IE5TRmV0Y2hSZXF1ZXN0PFBlcnNvbj4gPSBQZXJzb24uZmV0Y2hSZXF1ZXN0KCkKCiAgICBkbyB7CiAgICAgICAgbGV0IHBlb3BsZSA9IHRyeSBjb250ZXh0LmZldGNoKGZldGNoUmVxdWVzdCkKICAgICAgICByZXR1cm4gcGVvcGxlCiAgICB9IGNhdGNoIHsKICAgICAgICBwcmludCgiRmFpbGVkIHRvIGZldGNoIHBlb3BsZTogXChlcnJvcikiKQogICAgICAgIHJldHVybiBuaWwKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func fetchPeople() -&gt; [Person]? {
    let context = CoreDataStack.shared.context
    let fetchRequest: NSFetchRequest&lt;Person&gt; = Person.fetchRequest()

    do {
        let people = try context.fetch(fetchRequest)
        return people
    } catch {
        print(&quot;Failed to fetch people: \(error)&quot;)
        return nil
    }
}</pre></div><div class='content'></div><h2>Actualització de Dades</h2>
<div class='content'><p>Per actualitzar un objecte gestionat, primer l'has d'obtenir, després modificar les seves propietats i guardar el context.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyB1cGRhdGVQZXJzb24ocGVyc29uOiBQZXJzb24sIG5ld05hbWU6IFN0cmluZykgewogICAgbGV0IGNvbnRleHQgPSBDb3JlRGF0YVN0YWNrLnNoYXJlZC5jb250ZXh0CiAgICBwZXJzb24ubmFtZSA9IG5ld05hbWUKCiAgICBkbyB7CiAgICAgICAgdHJ5IGNvbnRleHQuc2F2ZSgpCiAgICB9IGNhdGNoIHsKICAgICAgICBwcmludCgiRmFpbGVkIHRvIHVwZGF0ZSBwZXJzb246IFwoZXJyb3IpIikKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func updatePerson(person: Person, newName: String) {
    let context = CoreDataStack.shared.context
    person.name = newName

    do {
        try context.save()
    } catch {
        print(&quot;Failed to update person: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h2>Eliminació de Dades</h2>
<div class='content'><p>Per eliminar un objecte gestionat, primer l'has d'obtenir, després eliminar-lo del context i guardar.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBkZWxldGVQZXJzb24ocGVyc29uOiBQZXJzb24pIHsKICAgIGxldCBjb250ZXh0ID0gQ29yZURhdGFTdGFjay5zaGFyZWQuY29udGV4dAogICAgY29udGV4dC5kZWxldGUocGVyc29uKQoKICAgIGRvIHsKICAgICAgICB0cnkgY29udGV4dC5zYXZlKCkKICAgIH0gY2F0Y2ggewogICAgICAgIHByaW50KCJGYWlsZWQgdG8gZGVsZXRlIHBlcnNvbjogXChlcnJvcikiKQogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func deletePerson(person: Person) {
    let context = CoreDataStack.shared.context
    context.delete(person)

    do {
        try context.save()
    } catch {
        print(&quot;Failed to delete person: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h1>Funcionalitats Avançades de Core Data</h1>
<div class='content'><p>Core Data ofereix funcionalitats avançades com relacions, operacions en bloc i versionat.</p>
</div><h2>Relacions</h2>
<div class='content'><p>Les entitats poden tenir relacions amb altres entitats. Per exemple, una entitat <code>Person</code> podria tenir una relació amb una entitat <code>Car</code>.</p>
<ul>
<li><strong>Un-a-Un</strong>: Una persona té un cotxe.</li>
<li><strong>Un-a-Molts</strong>: Una persona té molts cotxes.</li>
<li><strong>Molts-a-Molts</strong>: Moltes persones poden tenir molts cotxes.</li>
</ul>
</div><h2>Operacions en Bloc</h2>
<div class='content'><p>Les operacions en bloc et permeten realitzar accions sobre múltiples registres de manera eficient.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnVuYyBiYXRjaFVwZGF0ZVBlcnNvbkFnZSgpIHsKICAgIGxldCBjb250ZXh0ID0gQ29yZURhdGFTdGFjay5zaGFyZWQuY29udGV4dAogICAgbGV0IGJhdGNoVXBkYXRlUmVxdWVzdCA9IE5TQmF0Y2hVcGRhdGVSZXF1ZXN0KGVudGl0eU5hbWU6ICJQZXJzb24iKQogICAgYmF0Y2hVcGRhdGVSZXF1ZXN0LnByb3BlcnRpZXNUb1VwZGF0ZSA9IFsiYWdlIjogMzBdCiAgICBiYXRjaFVwZGF0ZVJlcXVlc3QucmVzdWx0VHlwZSA9IC51cGRhdGVkT2JqZWN0SURzUmVzdWx0VHlwZQoKICAgIGRvIHsKICAgICAgICBsZXQgcmVzdWx0ID0gdHJ5IGNvbnRleHQuZXhlY3V0ZShiYXRjaFVwZGF0ZVJlcXVlc3QpIGFzPyBOU0JhdGNoVXBkYXRlUmVzdWx0CiAgICAgICAgaWYgbGV0IG9iamVjdElEcyA9IHJlc3VsdD8ucmVzdWx0IGFzPyBbTlNNYW5hZ2VkT2JqZWN0SURdIHsKICAgICAgICAgICAgZm9yIG9iamVjdElEIGluIG9iamVjdElEcyB7CiAgICAgICAgICAgICAgICBsZXQgbWFuYWdlZE9iamVjdCA9IGNvbnRleHQub2JqZWN0KHdpdGg6IG9iamVjdElEKQogICAgICAgICAgICAgICAgY29udGV4dC5yZWZyZXNoKG1hbmFnZWRPYmplY3QsIG1lcmdlQ2hhbmdlczogZmFsc2UpCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICB9IGNhdGNoIHsKICAgICAgICBwcmludCgiRmFpbGVkIHRvIHBlcmZvcm0gYmF0Y2ggdXBkYXRlOiBcKGVycm9yKSIpCiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>func batchUpdatePersonAge() {
    let context = CoreDataStack.shared.context
    let batchUpdateRequest = NSBatchUpdateRequest(entityName: &quot;Person&quot;)
    batchUpdateRequest.propertiesToUpdate = [&quot;age&quot;: 30]
    batchUpdateRequest.resultType = .updatedObjectIDsResultType

    do {
        let result = try context.execute(batchUpdateRequest) as? NSBatchUpdateResult
        if let objectIDs = result?.result as? [NSManagedObjectID] {
            for objectID in objectIDs {
                let managedObject = context.object(with: objectID)
                context.refresh(managedObject, mergeChanges: false)
            }
        }
    } catch {
        print(&quot;Failed to perform batch update: \(error)&quot;)
    }
}</pre></div><div class='content'></div><h2>Versionat i Migració</h2>
<div class='content'><p>Quan canvies el teu model de dades, necessites migrar les dades existents al nou model. Core Data proporciona migració lleugera per gestionar canvis simples.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("bGV0IGNvbnRhaW5lciA9IE5TUGVyc2lzdGVudENvbnRhaW5lcihuYW1lOiAiTW9kZWwiKQpsZXQgZGVzY3JpcHRpb24gPSBjb250YWluZXIucGVyc2lzdGVudFN0b3JlRGVzY3JpcHRpb25zLmZpcnN0CmRlc2NyaXB0aW9uPy5zaG91bGRNaWdyYXRlU3RvcmVBdXRvbWF0aWNhbGx5ID0gdHJ1ZQpkZXNjcmlwdGlvbj8uc2hvdWxkSW5mZXJNYXBwaW5nTW9kZWxBdXRvbWF0aWNhbGx5ID0gdHJ1ZQpjb250YWluZXIubG9hZFBlcnNpc3RlbnRTdG9yZXMgeyBzdG9yZURlc2NyaXB0aW9uLCBlcnJvciBpbgogICAgaWYgbGV0IGVycm9yID0gZXJyb3IgYXMgTlNFcnJvcj8gewogICAgICAgIGZhdGFsRXJyb3IoIlVucmVzb2x2ZWQgZXJyb3IgXChlcnJvciksIFwoZXJyb3IudXNlckluZm8pIikKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>let container = NSPersistentContainer(name: &quot;Model&quot;)
let description = container.persistentStoreDescriptions.first
description?.shouldMigrateStoreAutomatically = true
description?.shouldInferMappingModelAutomatically = true
container.loadPersistentStores { storeDescription, error in
    if let error = error as NSError? {
        fatalError(&quot;Unresolved error \(error), \(error.userInfo)&quot;)
    }
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Core Data és un framework robust per gestionar i persistir dades en aplicacions iOS. Entenent els seus conceptes clau i aprenent a realitzar operacions bàsiques i avançades, pots gestionar eficientment la capa de dades de la teva aplicació. Recorda sempre gestionar els errors de manera adequada i considerar les implicacions de rendiment de les teves operacions de dades. Amb pràctica, podràs aprofitar Core Data per construir aplicacions potents i eficients.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
