<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projecte de Predicció de Sèries Temporals</title>

    <link rel="alternate" href="https://campusempresa.com/es/tensorflow/time-series-forecasting-project" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/tensorflow/time-series-forecasting-project" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/tensorflow/time-series-forecasting-project" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/tensorflow/time-series-forecasting-project" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='natural-language-processing-project'>&#x25C4; Projecte de processament del llenguatge natural</a></div><div class='col-6 text-end'><a href='custom-project'>Projecte personalitzat &#x25BA;</a></div></div><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>La predicció de sèries temporals és un aspecte crucial de moltes aplicacions del món real, com la predicció del mercat de valors, la predicció meteorològica i la planificació de la demanda. En aquesta secció, explorarem com utilitzar TensorFlow per construir i entrenar models per a la predicció de sèries temporals. Aquest tema et guiarà des dels conceptes bàsics fins a tècniques avançades, assegurant una comprensió completa del tema.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Dades de Sèries Temporals</strong>: Una seqüència de punts de dades recollits o registrats a intervals de temps específics.</li>
<li><strong>Predicció</strong>: El procés de fer prediccions sobre punts de dades futurs basant-se en dades històriques.</li>
<li><strong>TensorFlow</strong>: Un marc de treball de codi obert per a l'aprenentatge automàtic desenvolupat per Google.</li>
</ul>
</div><h1>Configuració de l'Entorn</h1>
<div class='content'><p>Abans de començar, assegura't de tenir TensorFlow instal·lat. Pots instal·lar-lo utilitzant pip:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgdGVuc29yZmxvdw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install tensorflow</pre></div><div class='content'></div><h1>Preparació de les Dades</h1>
<h2>Carregar el Conjunt de Dades</h2>
<div class='content'><p>Per a aquest projecte, utilitzarem un conjunt de dades de mostra que conté lectures diàries de temperatura.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHBhbmRhcyBhcyBwZAoKIyBDYXJyZWdhciBlbCBjb25qdW50IGRlIGRhZGVzCnVybCA9ICdodHRwczovL2V4YW1wbGUuY29tL2RhaWx5LXRlbXBlcmF0dXJlLmNzdicKZGF0YSA9IHBkLnJlYWRfY3N2KHVybCwgcGFyc2VfZGF0ZXM9WydkYXRlJ10sIGluZGV4X2NvbD0nZGF0ZScpCgojIE1vc3RyYXIgbGVzIHByaW1lcmVzIGZpbGVzCnByaW50KGRhdGEuaGVhZCgpKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import pandas as pd

# Carregar el conjunt de dades
url = 'https://example.com/daily-temperature.csv'
data = pd.read_csv(url, parse_dates=['date'], index_col='date')

# Mostrar les primeres files
print(data.head())</pre></div><div class='content'></div><h2>Preprocessament de les Dades</h2>
<div class='content'><ul>
<li><strong>Normalització</strong>: Escalar les dades a un rang adequat per a les xarxes neuronals.</li>
<li><strong>Divisió Train-Test</strong>: Dividir les dades en conjunts d'entrenament i prova.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLnByZXByb2Nlc3NpbmcgaW1wb3J0IE1pbk1heFNjYWxlcgoKIyBOb3JtYWxpdHphciBsZXMgZGFkZXMKc2NhbGVyID0gTWluTWF4U2NhbGVyKCkKZGF0YVsndGVtcGVyYXR1cmUnXSA9IHNjYWxlci5maXRfdHJhbnNmb3JtKGRhdGFbWyd0ZW1wZXJhdHVyZSddXSkKCiMgRGl2aWRpciBsZXMgZGFkZXMKdHJhaW5fc2l6ZSA9IGludChsZW4oZGF0YSkgKiAwLjgpCnRyYWluX2RhdGEgPSBkYXRhWzp0cmFpbl9zaXplXQp0ZXN0X2RhdGEgPSBkYXRhW3RyYWluX3NpemU6XQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.preprocessing import MinMaxScaler

# Normalitzar les dades
scaler = MinMaxScaler()
data['temperature'] = scaler.fit_transform(data[['temperature']])

# Dividir les dades
train_size = int(len(data) * 0.8)
train_data = data[:train_size]
test_data = data[train_size:]</pre></div><div class='content'></div><h1>Construcció del Model</h1>
<h2>Creació del Conjunt de Dades de Sèries Temporals</h2>
<div class='content'><p>Necessitem crear seqüències de dades perquè el model pugui aprendre.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCgpkZWYgY3JlYXRlX2RhdGFzZXQoZGF0YSwgdGltZV9zdGVwPTEpOgogICAgWCwgeSA9IFtdLCBbXQogICAgZm9yIGkgaW4gcmFuZ2UobGVuKGRhdGEpIC0gdGltZV9zdGVwIC0gMSk6CiAgICAgICAgWC5hcHBlbmQoZGF0YVtpOihpICsgdGltZV9zdGVwKSwgMF0pCiAgICAgICAgeS5hcHBlbmQoZGF0YVtpICsgdGltZV9zdGVwLCAwXSkKICAgIHJldHVybiBucC5hcnJheShYKSwgbnAuYXJyYXkoeSkKCnRpbWVfc3RlcCA9IDEwClhfdHJhaW4sIHlfdHJhaW4gPSBjcmVhdGVfZGF0YXNldCh0cmFpbl9kYXRhLnZhbHVlcywgdGltZV9zdGVwKQpYX3Rlc3QsIHlfdGVzdCA9IGNyZWF0ZV9kYXRhc2V0KHRlc3RfZGF0YS52YWx1ZXMsIHRpbWVfc3RlcCkKCiMgUmVtb2RlbGFyIGwnZW50cmFkYSBwZXIgYSBzZXIgW21vc3RyZXMsIHBhc3NvcyBkZSB0ZW1wcywgY2FyYWN0ZXLDrXN0aXF1ZXNdClhfdHJhaW4gPSBYX3RyYWluLnJlc2hhcGUoWF90cmFpbi5zaGFwZVswXSwgdGltZV9zdGVwLCAxKQpYX3Rlc3QgPSBYX3Rlc3QucmVzaGFwZShYX3Rlc3Quc2hhcGVbMF0sIHRpbWVfc3RlcCwgMSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np

def create_dataset(data, time_step=1):
    X, y = [], []
    for i in range(len(data) - time_step - 1):
        X.append(data[i:(i + time_step), 0])
        y.append(data[i + time_step, 0])
    return np.array(X), np.array(y)

time_step = 10
X_train, y_train = create_dataset(train_data.values, time_step)
X_test, y_test = create_dataset(test_data.values, time_step)

# Remodelar l'entrada per a ser [mostres, passos de temps, caracter&iacute;stiques]
X_train = X_train.reshape(X_train.shape[0], time_step, 1)
X_test = X_test.reshape(X_test.shape[0], time_step, 1)</pre></div><div class='content'></div><h2>Definició del Model</h2>
<div class='content'><p>Utilitzarem una xarxa LSTM (Long Short-Term Memory) simple per a aquesta tasca.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IHRlbnNvcmZsb3cgYXMgdGYKZnJvbSB0ZW5zb3JmbG93LmtlcmFzLm1vZGVscyBpbXBvcnQgU2VxdWVudGlhbApmcm9tIHRlbnNvcmZsb3cua2VyYXMubGF5ZXJzIGltcG9ydCBMU1RNLCBEZW5zZQoKbW9kZWwgPSBTZXF1ZW50aWFsKCkKbW9kZWwuYWRkKExTVE0oNTAsIHJldHVybl9zZXF1ZW5jZXM9VHJ1ZSwgaW5wdXRfc2hhcGU9KHRpbWVfc3RlcCwgMSkpKQptb2RlbC5hZGQoTFNUTSg1MCwgcmV0dXJuX3NlcXVlbmNlcz1GYWxzZSkpCm1vZGVsLmFkZChEZW5zZSgxKSkKbW9kZWwuY29tcGlsZShvcHRpbWl6ZXI9J2FkYW0nLCBsb3NzPSdtZWFuX3NxdWFyZWRfZXJyb3InKQoKbW9kZWwuc3VtbWFyeSgp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import tensorflow as tf
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import LSTM, Dense

model = Sequential()
model.add(LSTM(50, return_sequences=True, input_shape=(time_step, 1)))
model.add(LSTM(50, return_sequences=False))
model.add(Dense(1))
model.compile(optimizer='adam', loss='mean_squared_error')

model.summary()</pre></div><div class='content'></div><h2>Entrenament del Model</h2>
<div class='content'><p>Entrenar el model utilitzant les dades d'entrenament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aGlzdG9yeSA9IG1vZGVsLmZpdChYX3RyYWluLCB5X3RyYWluLCB2YWxpZGF0aW9uX2RhdGE9KFhfdGVzdCwgeV90ZXN0KSwgZXBvY2hzPTUwLCBiYXRjaF9zaXplPTMyLCB2ZXJib3NlPTEp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>history = model.fit(X_train, y_train, validation_data=(X_test, y_test), epochs=50, batch_size=32, verbose=1)</pre></div><div class='content'></div><h1>Avaluació del Model</h1>
<h2>Visualització de la Pèrdua</h2>
<div class='content'><p>Traçar la pèrdua d'entrenament i validació per comprovar si hi ha sobreajustament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKcGx0LnBsb3QoaGlzdG9yeS5oaXN0b3J5Wydsb3NzJ10sIGxhYmVsPSdQw6hyZHVhIGTigJlFbnRyZW5hbWVudCcpCnBsdC5wbG90KGhpc3RvcnkuaGlzdG9yeVsndmFsX2xvc3MnXSwgbGFiZWw9J1DDqHJkdWEgZGUgVmFsaWRhY2nDsycpCnBsdC5sZWdlbmQoKQpwbHQuc2hvdygp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import matplotlib.pyplot as plt

plt.plot(history.history['loss'], label='P&egrave;rdua d&rsquo;Entrenament')
plt.plot(history.history['val_loss'], label='P&egrave;rdua de Validaci&oacute;')
plt.legend()
plt.show()</pre></div><div class='content'></div><h2>Fer Prediccions</h2>
<div class='content'><p>Utilitzar el model entrenat per fer prediccions sobre les dades de prova.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dHJhaW5fcHJlZGljdCA9IG1vZGVsLnByZWRpY3QoWF90cmFpbikKdGVzdF9wcmVkaWN0ID0gbW9kZWwucHJlZGljdChYX3Rlc3QpCgojIFRyYW5zZm9ybWFyIGludmVyc2FtZW50IHBlciBvYnRlbmlyIHZhbG9ycyBhY3R1YWxzCnRyYWluX3ByZWRpY3QgPSBzY2FsZXIuaW52ZXJzZV90cmFuc2Zvcm0odHJhaW5fcHJlZGljdCkKdGVzdF9wcmVkaWN0ID0gc2NhbGVyLmludmVyc2VfdHJhbnNmb3JtKHRlc3RfcHJlZGljdCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>train_predict = model.predict(X_train)
test_predict = model.predict(X_test)

# Transformar inversament per obtenir valors actuals
train_predict = scaler.inverse_transform(train_predict)
test_predict = scaler.inverse_transform(test_predict)</pre></div><div class='content'></div><h2>Traçar els Resultats</h2>
<div class='content'><p>Comparar els valors predits amb els valors reals.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEZXNwbGHDp2FyIGxlcyBwcmVkaWNjaW9ucyBkJ2VudHJlbmFtZW50IHBlciBhIHRyYcOnYXIKdHJhaW5fcHJlZGljdF9wbG90ID0gbnAuZW1wdHlfbGlrZShkYXRhLnZhbHVlcykKdHJhaW5fcHJlZGljdF9wbG90WzosIDpdID0gbnAubmFuCnRyYWluX3ByZWRpY3RfcGxvdFt0aW1lX3N0ZXA6bGVuKHRyYWluX3ByZWRpY3QpICsgdGltZV9zdGVwLCA6XSA9IHRyYWluX3ByZWRpY3QKCiMgRGVzcGxhw6dhciBsZXMgcHJlZGljY2lvbnMgZGUgcHJvdmEgcGVyIGEgdHJhw6dhcgp0ZXN0X3ByZWRpY3RfcGxvdCA9IG5wLmVtcHR5X2xpa2UoZGF0YS52YWx1ZXMpCnRlc3RfcHJlZGljdF9wbG90WzosIDpdID0gbnAubmFuCnRlc3RfcHJlZGljdF9wbG90W2xlbih0cmFpbl9wcmVkaWN0KSArICh0aW1lX3N0ZXAgKiAyKSArIDE6bGVuKGRhdGEpIC0gMSwgOl0gPSB0ZXN0X3ByZWRpY3QKCiMgVHJhw6dhciBsYSBsw61uaWEgYmFzZSBpIGxlcyBwcmVkaWNjaW9ucwpwbHQucGxvdChzY2FsZXIuaW52ZXJzZV90cmFuc2Zvcm0oZGF0YS52YWx1ZXMpLCBsYWJlbD0nRGFkZXMgUmVhbHMnKQpwbHQucGxvdCh0cmFpbl9wcmVkaWN0X3Bsb3QsIGxhYmVsPSdQcmVkaWNjacOzIGTigJlFbnRyZW5hbWVudCcpCnBsdC5wbG90KHRlc3RfcHJlZGljdF9wbG90LCBsYWJlbD0nUHJlZGljY2nDsyBkZSBQcm92YScpCnBsdC5sZWdlbmQoKQpwbHQuc2hvdygp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Despla&ccedil;ar les prediccions d'entrenament per a tra&ccedil;ar
train_predict_plot = np.empty_like(data.values)
train_predict_plot[:, :] = np.nan
train_predict_plot[time_step:len(train_predict) + time_step, :] = train_predict

# Despla&ccedil;ar les prediccions de prova per a tra&ccedil;ar
test_predict_plot = np.empty_like(data.values)
test_predict_plot[:, :] = np.nan
test_predict_plot[len(train_predict) + (time_step * 2) + 1:len(data) - 1, :] = test_predict

# Tra&ccedil;ar la l&iacute;nia base i les prediccions
plt.plot(scaler.inverse_transform(data.values), label='Dades Reals')
plt.plot(train_predict_plot, label='Predicci&oacute; d&rsquo;Entrenament')
plt.plot(test_predict_plot, label='Predicci&oacute; de Prova')
plt.legend()
plt.show()</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquest tema, hem cobert els aspectes essencials de la predicció de sèries temporals utilitzant TensorFlow. Hem començat amb la preparació de les dades, hem passat a la construcció i entrenament d'un model LSTM, i finalment hem avaluat el rendiment del model. Seguint aquests passos, ara hauries de tenir una base sòlida per abordar projectes de predicció de sèries temporals més complexos.</p>
</div><div class='row navigation'><div class='col-6'><a href='natural-language-processing-project'>&#x25C4; Projecte de processament del llenguatge natural</a></div><div class='col-6 text-end'><a href='custom-project'>Projecte personalitzat &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
