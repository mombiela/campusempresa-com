<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Funcions i Traits Insegurs</title>

    <link rel="alternate" href="https://campusempresa.com/es/rust/unsafe-functions-and-traits" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/rust/unsafe-functions-and-traits" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/rust/unsafe-functions-and-traits" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/rust/unsafe-functions-and-traits" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='raw-pointers'>&#x25C4;Punteres Crues</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Funcions i Traits Insegurs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-tests'>Escriure Proves &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a Unsafe Rust</h1>
<div class='content'><p>Rust està dissenyat per ser un llenguatge de programació de sistemes segur, però hi ha moments en què necessites realitzar operacions que el compilador de Rust no pot garantir que siguin segures. Aquí és on entra en joc <code>unsafe</code>. La paraula clau <code>unsafe</code> en Rust et permet passar per alt algunes de les comprovacions de seguretat de Rust, donant-te més control però també més responsabilitat.</p>
<ul>
<li><strong>Conceptes Clau:</strong>
<ul>
<li>Paraula clau <code>unsafe</code></li>
<li>Funcions insegures</li>
<li>Traits insegurs</li>
<li>Blocs insegurs</li>
</ul>
</li>
</ul>
</div><h1>Paraula Clau Unsafe</h1>
<div class='content'><p>La paraula clau <code>unsafe</code> en Rust s'utilitza per indicar que un bloc de codi, una funció o un trait té operacions que el compilador de Rust no pot garantir que siguin segures.</p>
<ul>
<li><strong>Blocs Insegurs:</strong> Et permeten realitzar operacions insegures dins d'una funció segura.</li>
<li><strong>Funcions Insegures:</strong> Funcions que contenen codi insegur i que s'han de cridar dins d'un bloc insegur.</li>
<li><strong>Traits Insegurs:</strong> Traits que tenen mètodes que només es poden implementar utilitzant codi insegur.</li>
</ul>
</div><h2>Blocs Insegurs</h2>
<div class='content'><p>Un bloc insegur et permet realitzar operacions que el compilador de Rust no pot verificar com a segures. Això inclou desreferenciar punters crus, cridar funcions insegures i accedir a variables estàtiques mutables.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm4gbWFpbigpIHsKICAgIGxldCBtdXQgbnVtID0gNTsKICAgIGxldCByMSA9ICZudW0gYXMgKmNvbnN0IGkzMjsKICAgIGxldCByMiA9ICZtdXQgbnVtIGFzICptdXQgaTMyOwoKICAgIHVuc2FmZSB7CiAgICAgICAgcHJpbnRsbiEoInIxIMOpczoge30iLCAqcjEpOwogICAgICAgIHByaW50bG4hKCJyMiDDqXM6IHt9IiwgKnIyKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>fn main() {
    let mut num = 5;
    let r1 = &amp;num as *const i32;
    let r2 = &amp;mut num as *mut i32;

    unsafe {
        println!(&quot;r1 &eacute;s: {}&quot;, *r1);
        println!(&quot;r2 &eacute;s: {}&quot;, *r2);
    }
}</pre></div><div class='content'><p>En aquest exemple, desreferenciar punters crus és una operació insegura, així que s'ha de fer dins d'un bloc insegur.</p>
</div><h2>Funcions Insegures</h2>
<div class='content'><p>Les funcions insegures són funcions que contenen codi insegur. S'han de cridar dins d'un bloc insegur.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIGZuIGRhbmdlcm91cygpIHsKICAgIC8vIE9wZXJhY2lvbnMgaW5zZWd1cmVzCn0KCmZuIG1haW4oKSB7CiAgICB1bnNhZmUgewogICAgICAgIGRhbmdlcm91cygpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe fn dangerous() {
    // Operacions insegures
}

fn main() {
    unsafe {
        dangerous();
    }
}</pre></div><div class='content'><p>Aquí, la funció <code>dangerous</code> està marcada com a insegura, i s'ha de cridar dins d'un bloc insegur.</p>
</div><h2>Traits Insegurs</h2>
<div class='content'><p>Els traits insegurs són traits que tenen mètodes que només es poden implementar utilitzant codi insegur.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIHRyYWl0IFVuc2FmZVRyYWl0IHsKICAgIC8vIE3DqHRvZGVzIHF1ZSByZXF1ZXJlaXhlbiBpbXBsZW1lbnRhY2nDsyBpbnNlZ3VyYQp9Cgp1bnNhZmUgaW1wbCBVbnNhZmVUcmFpdCBwZXIgU29tZVR5cGUgewogICAgLy8gSW1wbGVtZW50YWNpw7MgaW5zZWd1cmEKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe trait UnsafeTrait {
    // M&egrave;todes que requereixen implementaci&oacute; insegura
}

unsafe impl UnsafeTrait per SomeType {
    // Implementaci&oacute; insegura
}</pre></div><div class='content'><p>En aquest exemple, <code>UnsafeTrait</code> és un trait insegur, i s'implementa per a <code>SomeType</code> utilitzant codi insegur.</p>
</div><h1>Quan Utilitzar Unsafe Rust</h1>
<div class='content'><p>Utilitzar <code>unsafe</code> en Rust s'ha de fer amb precaució. Aquí hi ha alguns escenaris on <code>unsafe</code> podria ser necessari:</p>
<ul>
<li><strong>Interfície amb C:</strong> Quan es criden funcions C o s'utilitza FFI (Foreign Function Interface).</li>
<li><strong>Optimització de Rendiment:</strong> Quan necessites realitzar optimitzacions de baix nivell que el compilador de Rust no pot garantir com a segures.</li>
<li><strong>Implementació de Traits Insegurs:</strong> Quan s'implementen traits que requereixen codi insegur.</li>
</ul>
</div><h1>Exemples i Exercicis</h1>
<div class='content'></div><h2>Exemple 1: Desreferenciar Punters Crus</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Zm4gbWFpbigpIHsKICAgIGxldCBtdXQgbnVtID0gMTA7CiAgICBsZXQgcjEgPSAmbnVtIGFzICpjb25zdCBpMzI7CiAgICBsZXQgcjIgPSAmbXV0IG51bSBhcyAqbXV0IGkzMjsKCiAgICB1bnNhZmUgewogICAgICAgIHByaW50bG4hKCJyMSBhcHVudGEgYToge30iLCAqcjEpOwogICAgICAgIHByaW50bG4hKCJyMiBhcHVudGEgYToge30iLCAqcjIpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>fn main() {
    let mut num = 10;
    let r1 = &amp;num as *const i32;
    let r2 = &amp;mut num as *mut i32;

    unsafe {
        println!(&quot;r1 apunta a: {}&quot;, *r1);
        println!(&quot;r2 apunta a: {}&quot;, *r2);
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació:</strong> Aquest exemple demostra com desreferenciar punters crus dins d'un bloc insegur.</li>
</ul>
</div><h2>Exercici 1: Crear una Funció Insegura</h2>
<div class='content'><p>Crea una funció insegura anomenada <code>unsafe_add</code> que prengui dos punters crus a enters i retorni la seva suma.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIGZuIHVuc2FmZV9hZGQoYTogKmNvbnN0IGkzMiwgYjogKmNvbnN0IGkzMikgLT4gaTMyIHsKICAgICphICsgKmIKfQoKZm4gbWFpbigpIHsKICAgIGxldCB4ID0gNTsKICAgIGxldCB5ID0gMTA7CiAgICBsZXQgc3VtID0gdW5zYWZlIHsKICAgICAgICB1bnNhZmVfYWRkKCZ4LCAmeSkKICAgIH07CiAgICBwcmludGxuISgiU3VtYToge30iLCBzdW0pOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe fn unsafe_add(a: *const i32, b: *const i32) -&gt; i32 {
    *a + *b
}

fn main() {
    let x = 5;
    let y = 10;
    let sum = unsafe {
        unsafe_add(&amp;x, &amp;y)
    };
    println!(&quot;Suma: {}&quot;, sum);
}</pre></div><div class='content'></div><h2>Exemple 2: Implementació d'un Trait Insegur</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIHRyYWl0IFVuc2FmZVRyYWl0IHsKICAgIGZuIHVuc2FmZV9tZXRob2QoJnNlbGYpOwp9CgpzdHJ1Y3QgTXlTdHJ1Y3Q7Cgp1bnNhZmUgaW1wbCBVbnNhZmVUcmFpdCBwZXIgTXlTdHJ1Y3QgewogICAgZm4gdW5zYWZlX21ldGhvZCgmc2VsZikgewogICAgICAgIHByaW50bG4hKCJNw6h0b2RlIGluc2VndXIgY3JpZGF0Iik7CiAgICB9Cn0KCmZuIG1haW4oKSB7CiAgICBsZXQgaW5zdGFuY2UgPSBNeVN0cnVjdDsKICAgIHVuc2FmZSB7CiAgICAgICAgaW5zdGFuY2UudW5zYWZlX21ldGhvZCgpOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe trait UnsafeTrait {
    fn unsafe_method(&amp;self);
}

struct MyStruct;

unsafe impl UnsafeTrait per MyStruct {
    fn unsafe_method(&amp;self) {
        println!(&quot;M&egrave;tode insegur cridat&quot;);
    }
}

fn main() {
    let instance = MyStruct;
    unsafe {
        instance.unsafe_method();
    }
}</pre></div><div class='content'><ul>
<li><strong>Explicació:</strong> Aquest exemple mostra com definir i implementar un trait insegur.</li>
</ul>
</div><h2>Exercici 2: Implementar un Trait Insegur</h2>
<div class='content'><p>Defineix un trait insegur anomenat <code>UnsafeMath</code> amb un mètode <code>unsafe_multiply</code> que multiplica dos enters. Implementa aquest trait per a una estructura anomenada <code>Calculator</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dW5zYWZlIHRyYWl0IFVuc2FmZU1hdGggewogICAgZm4gdW5zYWZlX211bHRpcGx5KCZzZWxmLCBhOiBpMzIsIGI6IGkzMikgLT4gaTMyOwp9CgpzdHJ1Y3QgQ2FsY3VsYXRvcjsKCnVuc2FmZSBpbXBsIFVuc2FmZU1hdGggcGVyIENhbGN1bGF0b3IgewogICAgZm4gdW5zYWZlX211bHRpcGx5KCZzZWxmLCBhOiBpMzIsIGI6IGkzMikgLT4gaTMyIHsKICAgICAgICBhICogYgogICAgfQp9CgpmbiBtYWluKCkgewogICAgbGV0IGNhbGMgPSBDYWxjdWxhdG9yOwogICAgbGV0IHJlc3VsdCA9IHVuc2FmZSB7CiAgICAgICAgY2FsYy51bnNhZmVfbXVsdGlwbHkoMywgNCkKICAgIH07CiAgICBwcmludGxuISgiUmVzdWx0YXQ6IHt9IiwgcmVzdWx0KTsKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>unsafe trait UnsafeMath {
    fn unsafe_multiply(&amp;self, a: i32, b: i32) -&gt; i32;
}

struct Calculator;

unsafe impl UnsafeMath per Calculator {
    fn unsafe_multiply(&amp;self, a: i32, b: i32) -&gt; i32 {
        a * b
    }
}

fn main() {
    let calc = Calculator;
    let result = unsafe {
        calc.unsafe_multiply(3, 4)
    };
    println!(&quot;Resultat: {}&quot;, result);
}</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Utilitzar <code>unsafe</code> en Rust et permet realitzar operacions que el compilador no pot garantir que siguin segures. Tot i que proporciona més control i flexibilitat, també comporta una major responsabilitat. Utilitza sempre <code>unsafe</code> amb precaució i assegura't d'entendre les implicacions de passar per alt les comprovacions de seguretat de Rust.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='raw-pointers'>&#x25C4;Punteres Crues</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Funcions i Traits Insegurs</a>
	</div>
	<div class='col-4 text-end'>
					<a href='writing-tests'>Escriure Proves &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
