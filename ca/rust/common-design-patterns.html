<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patrons de Disseny Comuns en Rust</title>

    <link rel="alternate" href="https://campusempresa.com/es/rust/common-design-patterns" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/rust/common-design-patterns" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/rust/common-design-patterns" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/rust/common-design-patterns" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='code-style-and-formatting'>&#x25C4;Estil de Codi i Formatació</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Patrons de Disseny Comuns en Rust</a>
	</div>
	<div class='col-4 text-end'>
					<a href='performance-optimization'>Optimització del Rendiment &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Els patrons de disseny són solucions típiques a problemes comuns en el disseny de programari. Són com plànols que es poden personalitzar per resoldre un problema de disseny particular en el teu codi. En aquesta secció, explorarem alguns dels patrons de disseny més comuns i com implementar-los en Rust.</p>
</div><h1>Patró Singleton</h1>
<div class='content'><p>El patró Singleton assegura que una classe tingui només una instància i proporciona un punt d'accés global a aquesta.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Instància Única</strong>: Només es crea una instància de la classe.</li>
<li><strong>Accés Global</strong>: La instància és accessible globalment.</li>
</ul>
</div><h2>Implementació en Rust</h2>
<div class='content'><p>En Rust, podem utilitzar el crate <code>lazy_static</code> per implementar el patró Singleton.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("I1ttYWNyb191c2VdCmV4dGVybiBjcmF0ZSBsYXp5X3N0YXRpYzsKdXNlIHN0ZDo6c3luYzo6TXV0ZXg7CgpzdHJ1Y3QgU2luZ2xldG9uIHsKICAgIHZhbHVlOiBpMzIsCn0KCmltcGwgU2luZ2xldG9uIHsKICAgIGZuIG5ldygpIC0+IFNpbmdsZXRvbiB7CiAgICAgICAgU2luZ2xldG9uIHsgdmFsdWU6IDAgfQogICAgfQoKICAgIGZuIHNldF92YWx1ZSgmbXV0IHNlbGYsIHZhbHVlOiBpMzIpIHsKICAgICAgICBzZWxmLnZhbHVlID0gdmFsdWU7CiAgICB9CgogICAgZm4gZ2V0X3ZhbHVlKCZzZWxmKSAtPiBpMzIgewogICAgICAgIHNlbGYudmFsdWUKICAgIH0KfQoKbGF6eV9zdGF0aWMhIHsKICAgIHN0YXRpYyByZWYgU0lOR0xFVE9OOiBNdXRleDxTaW5nbGV0b24+ID0gTXV0ZXg6Om5ldyhTaW5nbGV0b246Om5ldygpKTsKfQoKZm4gbWFpbigpIHsKICAgIHsKICAgICAgICBsZXQgbXV0IHNpbmdsZXRvbiA9IFNJTkdMRVRPTi5sb2NrKCkudW53cmFwKCk7CiAgICAgICAgc2luZ2xldG9uLnNldF92YWx1ZSg0Mik7CiAgICB9CgogICAgewogICAgICAgIGxldCBzaW5nbGV0b24gPSBTSU5HTEVUT04ubG9jaygpLnVud3JhcCgpOwogICAgICAgIHByaW50bG4hKCJWYWxvciBkZWwgU2luZ2xldG9uOiB7fSIsIHNpbmdsZXRvbi5nZXRfdmFsdWUoKSk7CiAgICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>#[macro_use]
extern crate lazy_static;
use std::sync::Mutex;

struct Singleton {
    value: i32,
}

impl Singleton {
    fn new() -&gt; Singleton {
        Singleton { value: 0 }
    }

    fn set_value(&amp;mut self, value: i32) {
        self.value = value;
    }

    fn get_value(&amp;self) -&gt; i32 {
        self.value
    }
}

lazy_static! {
    static ref SINGLETON: Mutex&lt;Singleton&gt; = Mutex::new(Singleton::new());
}

fn main() {
    {
        let mut singleton = SINGLETON.lock().unwrap();
        singleton.set_value(42);
    }

    {
        let singleton = SINGLETON.lock().unwrap();
        println!(&quot;Valor del Singleton: {}&quot;, singleton.get_value());
    }
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>lazy_static!</strong>: Aquesta macro ens permet definir variables estàtiques que requereixen que s'executi codi en temps d'execució.</li>
<li><strong>Mutex</strong>: Assegura que només un fil pot accedir a la instància del Singleton a la vegada, fent-lo segur per a fils.</li>
</ul>
</div><h1>Patró Builder</h1>
<div class='content'><p>El patró Builder s'utilitza per construir un objecte complex pas a pas. Separa la construcció d'un objecte complex de la seva representació.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Construcció Pas a Pas</strong>: Construir l'objecte pas a pas.</li>
<li><strong>Separació de Responsabilitats</strong>: Separar el procés de construcció de la representació final.</li>
</ul>
</div><h2>Implementació en Rust</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("c3RydWN0IEhvdXNlIHsKICAgIHdhbGxzOiB1MzIsCiAgICBkb29yczogdTMyLAogICAgd2luZG93czogdTMyLAp9CgpzdHJ1Y3QgSG91c2VCdWlsZGVyIHsKICAgIHdhbGxzOiB1MzIsCiAgICBkb29yczogdTMyLAogICAgd2luZG93czogdTMyLAp9CgppbXBsIEhvdXNlQnVpbGRlciB7CiAgICBmbiBuZXcoKSAtPiBIb3VzZUJ1aWxkZXIgewogICAgICAgIEhvdXNlQnVpbGRlciB7CiAgICAgICAgICAgIHdhbGxzOiAwLAogICAgICAgICAgICBkb29yczogMCwKICAgICAgICAgICAgd2luZG93czogMCwKICAgICAgICB9CiAgICB9CgogICAgZm4gd2FsbHMobXV0IHNlbGYsIGNvdW50OiB1MzIpIC0+IEhvdXNlQnVpbGRlciB7CiAgICAgICAgc2VsZi53YWxscyA9IGNvdW50OwogICAgICAgIHNlbGYKICAgIH0KCiAgICBmbiBkb29ycyhtdXQgc2VsZiwgY291bnQ6IHUzMikgLT4gSG91c2VCdWlsZGVyIHsKICAgICAgICBzZWxmLmRvb3JzID0gY291bnQ7CiAgICAgICAgc2VsZgogICAgfQoKICAgIGZuIHdpbmRvd3MobXV0IHNlbGYsIGNvdW50OiB1MzIpIC0+IEhvdXNlQnVpbGRlciB7CiAgICAgICAgc2VsZi53aW5kb3dzID0gY291bnQ7CiAgICAgICAgc2VsZgogICAgfQoKICAgIGZuIGJ1aWxkKHNlbGYpIC0+IEhvdXNlIHsKICAgICAgICBIb3VzZSB7CiAgICAgICAgICAgIHdhbGxzOiBzZWxmLndhbGxzLAogICAgICAgICAgICBkb29yczogc2VsZi5kb29ycywKICAgICAgICAgICAgd2luZG93czogc2VsZi53aW5kb3dzLAogICAgICAgIH0KICAgIH0KfQoKZm4gbWFpbigpIHsKICAgIGxldCBob3VzZSA9IEhvdXNlQnVpbGRlcjo6bmV3KCkKICAgICAgICAud2FsbHMoNCkKICAgICAgICAuZG9vcnMoMikKICAgICAgICAud2luZG93cyg2KQogICAgICAgIC5idWlsZCgpOwoKICAgIHByaW50bG4hKCJMYSBjYXNhIHTDqSB7fSBwYXJldHMsIHt9IHBvcnRlcywgaSB7fSBmaW5lc3RyZXMuIiwgaG91c2Uud2FsbHMsIGhvdXNlLmRvb3JzLCBob3VzZS53aW5kb3dzKTsKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>struct House {
    walls: u32,
    doors: u32,
    windows: u32,
}

struct HouseBuilder {
    walls: u32,
    doors: u32,
    windows: u32,
}

impl HouseBuilder {
    fn new() -&gt; HouseBuilder {
        HouseBuilder {
            walls: 0,
            doors: 0,
            windows: 0,
        }
    }

    fn walls(mut self, count: u32) -&gt; HouseBuilder {
        self.walls = count;
        self
    }

    fn doors(mut self, count: u32) -&gt; HouseBuilder {
        self.doors = count;
        self
    }

    fn windows(mut self, count: u32) -&gt; HouseBuilder {
        self.windows = count;
        self
    }

    fn build(self) -&gt; House {
        House {
            walls: self.walls,
            doors: self.doors,
            windows: self.windows,
        }
    }
}

fn main() {
    let house = HouseBuilder::new()
        .walls(4)
        .doors(2)
        .windows(6)
        .build();

    println!(&quot;La casa t&eacute; {} parets, {} portes, i {} finestres.&quot;, house.walls, house.doors, house.windows);
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>Interfície Fluida</strong>: Els mètodes del constructor retornen <code>self</code>, permetent l'encadenament de mètodes.</li>
<li><strong>Construcció Final</strong>: El mètode <code>build</code> construeix l'objecte final <code>House</code>.</li>
</ul>
</div><h1>Patró Observer</h1>
<div class='content'><p>El patró Observer defineix una dependència de un-a-molts entre objectes de manera que quan un objecte canvia d'estat, tots els seus dependents són notificats i actualitzats automàticament.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Subjecte</strong>: L'objecte que està sent observat.</li>
<li><strong>Observadors</strong>: Els objectes que són notificats dels canvis en el subjecte.</li>
</ul>
</div><h2>Implementació en Rust</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dXNlIHN0ZDo6Y2VsbDo6UmVmQ2VsbDsKdXNlIHN0ZDo6cmM6OlJjOwoKdHJhaXQgT2JzZXJ2ZXIgewogICAgZm4gdXBkYXRlKCZzZWxmKTsKfQoKc3RydWN0IFN1YmplY3QgewogICAgb2JzZXJ2ZXJzOiBWZWM8UmM8UmVmQ2VsbDxkeW4gT2JzZXJ2ZXI+Pj4sCn0KCmltcGwgU3ViamVjdCB7CiAgICBmbiBuZXcoKSAtPiBTdWJqZWN0IHsKICAgICAgICBTdWJqZWN0IHsKICAgICAgICAgICAgb2JzZXJ2ZXJzOiBWZWM6Om5ldygpLAogICAgICAgIH0KICAgIH0KCiAgICBmbiBhZGRfb2JzZXJ2ZXIoJm11dCBzZWxmLCBvYnNlcnZlcjogUmM8UmVmQ2VsbDxkeW4gT2JzZXJ2ZXI+PikgewogICAgICAgIHNlbGYub2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpOwogICAgfQoKICAgIGZuIG5vdGlmeV9vYnNlcnZlcnMoJnNlbGYpIHsKICAgICAgICBmb3Igb2JzZXJ2ZXIgaW4gJnNlbGYub2JzZXJ2ZXJzIHsKICAgICAgICAgICAgb2JzZXJ2ZXIuYm9ycm93KCkudXBkYXRlKCk7CiAgICAgICAgfQogICAgfQp9CgpzdHJ1Y3QgQ29uY3JldGVPYnNlcnZlciB7CiAgICBpZDogdTMyLAp9CgppbXBsIE9ic2VydmVyIHBlciBDb25jcmV0ZU9ic2VydmVyIHsKICAgIGZuIHVwZGF0ZSgmc2VsZikgewogICAgICAgIHByaW50bG4hKCJMJ29ic2VydmFkb3Ige30gaGEgZXN0YXQgbm90aWZpY2F0ISIsIHNlbGYuaWQpOwogICAgfQp9CgpmbiBtYWluKCkgewogICAgbGV0IG11dCBzdWJqZWN0ID0gU3ViamVjdDo6bmV3KCk7CgogICAgbGV0IG9ic2VydmVyMSA9IFJjOjpuZXcoUmVmQ2VsbDo6bmV3KENvbmNyZXRlT2JzZXJ2ZXIgeyBpZDogMSB9KSk7CiAgICBsZXQgb2JzZXJ2ZXIyID0gUmM6Om5ldyhSZWZDZWxsOjpuZXcoQ29uY3JldGVPYnNlcnZlciB7IGlkOiAyIH0pKTsKCiAgICBzdWJqZWN0LmFkZF9vYnNlcnZlcihvYnNlcnZlcjEuY2xvbmUoKSk7CiAgICBzdWJqZWN0LmFkZF9vYnNlcnZlcihvYnNlcnZlcjIuY2xvbmUoKSk7CgogICAgc3ViamVjdC5ub3RpZnlfb2JzZXJ2ZXJzKCk7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>use std::cell::RefCell;
use std::rc::Rc;

trait Observer {
    fn update(&amp;self);
}

struct Subject {
    observers: Vec&lt;Rc&lt;RefCell&lt;dyn Observer&gt;&gt;&gt;,
}

impl Subject {
    fn new() -&gt; Subject {
        Subject {
            observers: Vec::new(),
        }
    }

    fn add_observer(&amp;mut self, observer: Rc&lt;RefCell&lt;dyn Observer&gt;&gt;) {
        self.observers.push(observer);
    }

    fn notify_observers(&amp;self) {
        for observer in &amp;self.observers {
            observer.borrow().update();
        }
    }
}

struct ConcreteObserver {
    id: u32,
}

impl Observer per ConcreteObserver {
    fn update(&amp;self) {
        println!(&quot;L'observador {} ha estat notificat!&quot;, self.id);
    }
}

fn main() {
    let mut subject = Subject::new();

    let observer1 = Rc::new(RefCell::new(ConcreteObserver { id: 1 }));
    let observer2 = Rc::new(RefCell::new(ConcreteObserver { id: 2 }));

    subject.add_observer(observer1.clone());
    subject.add_observer(observer2.clone());

    subject.notify_observers();
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>Rc i RefCell</strong>: Utilitzats per a punters intel·ligents amb comptatge de referències i mutabilitat interior, respectivament.</li>
<li><strong>Despatx Dinàmic</strong>: El trait <code>Observer</code> permet diferents tipus d'observadors.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Els patrons de disseny proporcionen solucions reutilitzables a problemes comuns en el disseny de programari. En Rust, aquests patrons es poden implementar utilitzant diverses característiques del llenguatge com traits, punters intel·ligents i primitives de concurrència. Entenent i aplicant aquests patrons, pots escriure codi en Rust més robust i mantenible.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='code-style-and-formatting'>&#x25C4;Estil de Codi i Formatació</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Patrons de Disseny Comuns en Rust</a>
	</div>
	<div class='col-4 text-end'>
					<a href='performance-optimization'>Optimització del Rendiment &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
