<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/apachespark/clustering" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció al Clustering</h1>
<div class='content'><p>El clustering és un tipus d'aprenentatge no supervisat que implica agrupar un conjunt d'objectes de manera que els objectes del mateix grup (o clúster) siguin més similars entre ells que amb els d'altres grups. En Apache Spark, el clustering es pot realitzar de manera eficient utilitzant la biblioteca MLlib.</p>
<ul>
<li><strong>Aprenentatge No Supervisat</strong>: No es proporcionen dades etiquetades; l'algoritme intenta aprendre els patrons i l'estructura de les dades per si mateix.</li>
<li><strong>Aplicacions</strong>: Segmentació de mercat, anàlisi de xarxes socials, compressió d'imatges, etc.</li>
</ul>
</div><h1>Clustering K-Means</h1>
<div class='content'><p>K-Means és un dels algoritmes de clustering més simples i populars. Divideix les dades en K clústers, on cada punt de dades pertany al clúster amb la mitjana més propera.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Centroide</strong>: El centre d'un clúster.</li>
<li><strong>Inèrcia</strong>: La suma de les distàncies quadrades de les mostres al seu centre de clúster més proper.</li>
</ul>
</div><h2>Passos en l'Algoritme K-Means</h2>
<div class='content'><ol>
<li>Inicialitzar K centroids aleatòriament.</li>
<li>Assignar cada punt de dades al centroid més proper.</li>
<li>Recalcular els centroids com la mitjana de tots els punts del clúster.</li>
<li>Repetir els passos 2 i 3 fins a la convergència (els centroids no canvien).</li>
</ol>
</div><h2>Exemple de Codi</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsdXN0ZXJpbmcgaW1wb3J0IEtNZWFucwpmcm9tIHB5c3BhcmsubWwuZXZhbHVhdGlvbiBpbXBvcnQgQ2x1c3RlcmluZ0V2YWx1YXRvcgpmcm9tIHB5c3Bhcmsuc3FsIGltcG9ydCBTcGFya1Nlc3Npb24KCiMgSW5pY2lhbGl0emFyIGxhIHNlc3Npw7MgZGUgU3BhcmsKc3BhcmsgPSBTcGFya1Nlc3Npb24uYnVpbGRlci5hcHBOYW1lKCJLTWVhbnNFeGFtcGxlIikuZ2V0T3JDcmVhdGUoKQoKIyBDYXJyZWdhciBkYWRlcwpkYXRhc2V0ID0gc3BhcmsucmVhZC5mb3JtYXQoImxpYnN2bSIpLmxvYWQoImRhdGEvbWxsaWIvc2FtcGxlX2ttZWFuc19kYXRhLnR4dCIpCgojIEVudHJlbmFyIHVuIG1vZGVsIEtNZWFucwprbWVhbnMgPSBLTWVhbnMoKS5zZXRLKDIpLnNldFNlZWQoMSkKbW9kZWwgPSBrbWVhbnMuZml0KGRhdGFzZXQpCgojIEZlciBwcmVkaWNjaW9ucwpwcmVkaWN0aW9ucyA9IG1vZGVsLnRyYW5zZm9ybShkYXRhc2V0KQoKIyBBdmFsdWFyIGVsIGNsdXN0ZXJpbmcgY2FsY3VsYW50IGVsIFNpbGhvdWV0dGUgc2NvcmUKZXZhbHVhdG9yID0gQ2x1c3RlcmluZ0V2YWx1YXRvcigpCgpzaWxob3VldHRlID0gZXZhbHVhdG9yLmV2YWx1YXRlKHByZWRpY3Rpb25zKQpwcmludChmIlNpbGhvdWV0dGUgYW1iIGRpc3TDoG5jaWEgZXVjbGlkaWFuYSBxdWFkcmFkYSA9IHtzaWxob3VldHRlfSIpCgojIE1vc3RyYXIgZWwgcmVzdWx0YXQKY2VudGVycyA9IG1vZGVsLmNsdXN0ZXJDZW50ZXJzKCkKcHJpbnQoIkNlbnRyZXMgZGUgQ2zDunN0ZXI6ICIpCmZvciBjZW50ZXIgaW4gY2VudGVyczoKICAgIHByaW50KGNlbnRlcikKCiMgQXR1cmFyIGxhIHNlc3Npw7MgZGUgU3BhcmsKc3Bhcmsuc3RvcCgp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.clustering import KMeans
from pyspark.ml.evaluation import ClusteringEvaluator
from pyspark.sql import SparkSession

# Inicialitzar la sessi&oacute; de Spark
spark = SparkSession.builder.appName(&quot;KMeansExample&quot;).getOrCreate()

# Carregar dades
dataset = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_kmeans_data.txt&quot;)

# Entrenar un model KMeans
kmeans = KMeans().setK(2).setSeed(1)
model = kmeans.fit(dataset)

# Fer prediccions
predictions = model.transform(dataset)

# Avaluar el clustering calculant el Silhouette score
evaluator = ClusteringEvaluator()

silhouette = evaluator.evaluate(predictions)
print(f&quot;Silhouette amb dist&agrave;ncia euclidiana quadrada = {silhouette}&quot;)

# Mostrar el resultat
centers = model.clusterCenters()
print(&quot;Centres de Cl&uacute;ster: &quot;)
for center in centers:
    print(center)

# Aturar la sessi&oacute; de Spark
spark.stop()</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>SparkSession</strong>: Punt d'entrada per programar amb Spark.</li>
<li><strong>KMeans</strong>: La classe KMeans s'utilitza per crear un model KMeans.</li>
<li><strong>fit()</strong>: Entrena el model.</li>
<li><strong>transform()</strong>: Fa prediccions.</li>
<li><strong>ClusteringEvaluator</strong>: Avalua el model de clustering utilitzant mètriques com el Silhouette score.</li>
</ul>
</div><h1>Model de Mescla Gaussiana (GMM)</h1>
<div class='content'><p>El Model de Mescla Gaussiana és un model probabilístic que assumeix que tots els punts de dades es generen a partir d'una mescla de diverses distribucions gaussianes amb paràmetres desconeguts.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Expectativa-Maximització (EM)</strong>: Algoritme utilitzat per trobar les estimacions de màxima versemblança dels paràmetres en GMM.</li>
<li><strong>Matriu de Covariància</strong>: Descriu la forma de les distribucions gaussianes.</li>
</ul>
</div><h2>Exemple de Codi</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsdXN0ZXJpbmcgaW1wb3J0IEdhdXNzaWFuTWl4dHVyZQoKIyBJbmljaWFsaXR6YXIgbGEgc2Vzc2nDsyBkZSBTcGFyawpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyLmFwcE5hbWUoIkdNTUV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIENhcnJlZ2FyIGRhZGVzCmRhdGFzZXQgPSBzcGFyay5yZWFkLmZvcm1hdCgibGlic3ZtIikubG9hZCgiZGF0YS9tbGxpYi9zYW1wbGVfa21lYW5zX2RhdGEudHh0IikKCiMgRW50cmVuYXIgdW4gbW9kZWwgR2F1c3NpYW5NaXh0dXJlCmdtbSA9IEdhdXNzaWFuTWl4dHVyZSgpLnNldEsoMikuc2V0U2VlZCgxKQptb2RlbCA9IGdtbS5maXQoZGF0YXNldCkKCiMgRmVyIHByZWRpY2Npb25zCnByZWRpY3Rpb25zID0gbW9kZWwudHJhbnNmb3JtKGRhdGFzZXQpCgojIE1vc3RyYXIgZWwgcmVzdWx0YXQKcHJpbnQoIkdhdXNzaWFucyBtb3N0cmF0cyBjb20gdW4gRGF0YUZyYW1lOiAiKQptb2RlbC5nYXVzc2lhbnNERi5zaG93KHRydW5jYXRlPUZhbHNlKQoKIyBBdHVyYXIgbGEgc2Vzc2nDsyBkZSBTcGFyawpzcGFyay5zdG9wKCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.clustering import GaussianMixture

# Inicialitzar la sessi&oacute; de Spark
spark = SparkSession.builder.appName(&quot;GMMExample&quot;).getOrCreate()

# Carregar dades
dataset = spark.read.format(&quot;libsvm&quot;).load(&quot;data/mllib/sample_kmeans_data.txt&quot;)

# Entrenar un model GaussianMixture
gmm = GaussianMixture().setK(2).setSeed(1)
model = gmm.fit(dataset)

# Fer prediccions
predictions = model.transform(dataset)

# Mostrar el resultat
print(&quot;Gaussians mostrats com un DataFrame: &quot;)
model.gaussiansDF.show(truncate=False)

# Aturar la sessi&oacute; de Spark
spark.stop()</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>GaussianMixture</strong>: La classe GaussianMixture s'utilitza per crear un model GMM.</li>
<li><strong>gaussiansDF</strong>: DataFrame que conté els paràmetres per a cada distribució gaussiana.</li>
</ul>
</div><h1>Clustering Jeràrquic</h1>
<div class='content'><p>El clustering jeràrquic construeix una jerarquia de clústers ja sigui fusionant petits clústers en uns de més grans (aglomeratiu) o dividint grans clústers en uns de més petits (divisiu).</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Dendrograma</strong>: Un diagrama en forma d'arbre que registra les seqüències de fusions o divisions.</li>
<li><strong>Criteri d'Enllaç</strong>: Determina la distància entre conjunts d'observacions (simple, complet, mitjà).</li>
</ul>
</div><h2>Exemple de Codi</h2>
<div class='content'><p>El clustering jeràrquic no està directament suportat en Spark MLlib, però es pot implementar utilitzant biblioteques de tercers o codi personalitzat.</p>
</div><h1>Conclusió</h1>
<div class='content'><p>El clustering és una tècnica poderosa per descobrir patrons i estructures en les dades. Apache Spark proporciona eines robustes per implementar algoritmes de clustering com K-Means i Models de Mescla Gaussiana. Entendre aquests algoritmes i la seva implementació en Spark pot millorar significativament la teva capacitat per analitzar i interpretar grans conjunts de dades.</p>
<ul>
<li><strong>K-Means</strong>: Simple i eficient, però requereix especificar el nombre de clústers.</li>
<li><strong>GMM</strong>: Més flexible, pot modelar clústers amb diferents formes i mides.</li>
<li><strong>Clustering Jeràrquic</strong>: Útil per crear una jerarquia de clústers, tot i que no està suportat nativament en Spark MLlib.</li>
</ul>
<p>En dominar aquestes tècniques de clustering, pots aplicar-les a una àmplia gamma de problemes del món real, des de la segmentació de mercat fins a l'anàlisi d'imatges.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
