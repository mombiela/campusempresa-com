<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Serialització de Dades a Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/data-serialization" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/data-serialization" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/data-serialization" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/apachespark/data-serialization" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='memory-management'>&#x25C4; Gestió de Memòria</a></div><div class='col-6 text-end'><a href='partitioning-and-shuffling'>Particionament i Shuffling &#x25BA;</a></div></div><div class='content'><p>La serialització de dades és un aspecte crucial dels marcs de computació distribuïda com Apache Spark. Implica convertir estructures de dades o objectes en un format que es pugui emmagatzemar o transmetre fàcilment i després reconstruir més tard. En aquest tema, cobrirem els conceptes bàsics de la serialització de dades, la seva importància a Spark i tècniques avançades per optimitzar la serialització per obtenir un millor rendiment.</p>
</div><h1>Introducció a la Serialització de Dades</h1>
<div class='content'><ul>
<li><strong>Definició</strong>: La serialització de dades és el procés de convertir un objecte en un flux de bytes per emmagatzemar l'objecte o transmetre'l a la memòria, una base de dades o un fitxer.</li>
<li><strong>Deserialització</strong>: El procés invers de la serialització, on el flux de bytes es converteix de nou en una còpia de l'objecte original.</li>
<li><strong>Importància a Spark</strong>: La serialització eficient és crítica a Spark per al rendiment, especialment quan les dades es barregen entre nodes en un clúster.</li>
</ul>
</div><h1>Formats de Serialització</h1>
<div class='content'></div><h2>Serialització Java</h2>
<div class='content'><ul>
<li><strong>Per defecte a Spark</strong>: La serialització Java és el mecanisme de serialització per defecte a Spark.</li>
<li><strong>Pros</strong>:
<ul>
<li>Fàcil d'utilitzar amb objectes Java.</li>
<li>No requereix configuració addicional.</li>
</ul>
</li>
<li><strong>Contres</strong>:
<ul>
<li>Rendiment lent.</li>
<li>Formats serialitzats grans.</li>
</ul>
</li>
</ul>
</div><h2>Serialització Kryo</h2>
<div class='content'><ul>
<li><strong>Alternativa a la Serialització Java</strong>: Kryo és un marc de serialització més ràpid i compacte.</li>
<li><strong>Pros</strong>:
<ul>
<li>Més ràpid que la serialització Java.</li>
<li>Produeix formats serialitzats més petits.</li>
</ul>
</li>
<li><strong>Contres</strong>:
<ul>
<li>Requereix el registre de classes personalitzades.</li>
<li>Més complex de configurar.</li>
</ul>
</li>
</ul>
</div><h2>Exemple: Canviar a la Serialització Kryo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuU3BhcmtDb25mCmltcG9ydCBvcmcuYXBhY2hlLnNwYXJrLlNwYXJrQ29udGV4dAoKdmFsIGNvbmYgPSBuZXcgU3BhcmtDb25mKCkKICAuc2V0QXBwTmFtZSgiS3J5b0V4YW1wbGUiKQogIC5zZXRNYXN0ZXIoImxvY2FsIikKICAuc2V0KCJzcGFyay5zZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUuc3Bhcmsuc2VyaWFsaXplci5LcnlvU2VyaWFsaXplciIpCiAgLnJlZ2lzdGVyS3J5b0NsYXNzZXMoQXJyYXkoY2xhc3NPZltZb3VyQ3VzdG9tQ2xhc3NdKSkKCnZhbCBzYyA9IG5ldyBTcGFya0NvbnRleHQoY29uZik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.SparkConf
import org.apache.spark.SparkContext

val conf = new SparkConf()
  .setAppName(&quot;KryoExample&quot;)
  .setMaster(&quot;local&quot;)
  .set(&quot;spark.serializer&quot;, &quot;org.apache.spark.serializer.KryoSerializer&quot;)
  .registerKryoClasses(Array(classOf[YourCustomClass]))

val sc = new SparkContext(conf)</pre></div><div class='content'></div><h2>Comparació entre Serialització Java i Kryo</h2>
<div class='content'><p>| Característica         | Serialització Java       | Serialització Kryo       |
|------------------------|--------------------------|--------------------------|
| Velocitat              | Més lenta                | Més ràpida               |
| Mida Serialitzada      | Més gran                 | Més petita               |
| Facilitat d'Ús         | Més fàcil                | Requereix configuració   |
| Suport de Classes Personalitzades | Automàtic                | Requereix registre       |</p>
</div><h1>Optimització de la Serialització</h1>
<div class='content'></div><h2>Millors Pràctiques</h2>
<div class='content'><ul>
<li><strong>Utilitzar Serialització Kryo</strong>: Per obtenir un millor rendiment, canvia a la serialització Kryo.</li>
<li><strong>Registrar Classes Personalitzades</strong>: Registra totes les classes personalitzades amb Kryo per evitar la sobrecàrrega de la serialització del nom de la classe.</li>
<li><strong>Evitar Objectes Grans</strong>: Intenta evitar serialitzar objectes molt grans. En canvi, divideix-los en trossos més petits si és possible.</li>
<li><strong>Utilitzar Variables Broadcast</strong>: Per a dades de només lectura que necessiten ser compartides entre tasques, utilitza les variables broadcast de Spark per reduir la sobrecàrrega de la serialització.</li>
</ul>
</div><h2>Exemple: Registrar Classes Personalitzades amb Kryo</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3BhcmsuU3BhcmtDb25mCmltcG9ydCBvcmcuYXBhY2hlLnNwYXJrLlNwYXJrQ29udGV4dAoKdmFsIGNvbmYgPSBuZXcgU3BhcmtDb25mKCkKICAuc2V0QXBwTmFtZSgiS3J5b0V4YW1wbGUiKQogIC5zZXRNYXN0ZXIoImxvY2FsIikKICAuc2V0KCJzcGFyay5zZXJpYWxpemVyIiwgIm9yZy5hcGFjaGUuc3Bhcmsuc2VyaWFsaXplci5LcnlvU2VyaWFsaXplciIpCiAgLnJlZ2lzdGVyS3J5b0NsYXNzZXMoQXJyYXkoY2xhc3NPZltZb3VyQ3VzdG9tQ2xhc3NdLCBjbGFzc09mW0Fub3RoZXJDdXN0b21DbGFzc10pKQoKdmFsIHNjID0gbmV3IFNwYXJrQ29udGV4dChjb25mKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.SparkConf
import org.apache.spark.SparkContext

val conf = new SparkConf()
  .setAppName(&quot;KryoExample&quot;)
  .setMaster(&quot;local&quot;)
  .set(&quot;spark.serializer&quot;, &quot;org.apache.spark.serializer.KryoSerializer&quot;)
  .registerKryoClasses(Array(classOf[YourCustomClass], classOf[AnotherCustomClass]))

val sc = new SparkContext(conf)</pre></div><div class='content'></div><h1>Tècniques Avançades de Serialització</h1>
<div class='content'></div><h2>Serialització Personalitzada</h2>
<div class='content'><ul>
<li><strong>Serialitzadors Personalitzats</strong>: Implementa serialitzadors personalitzats per a objectes complexos per optimitzar la serialització.</li>
<li><strong>Exemple</strong>: Implementació d'un serialitzador personalitzat per a un objecte complex.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGNvbS5lc290ZXJpY3NvZnR3YXJlLmtyeW8uS3J5bwppbXBvcnQgY29tLmVzb3Rlcmljc29mdHdhcmUua3J5by5TZXJpYWxpemVyCmltcG9ydCBjb20uZXNvdGVyaWNzb2Z0d2FyZS5rcnlvLmlvLklucHV0CmltcG9ydCBjb20uZXNvdGVyaWNzb2Z0d2FyZS5rcnlvLmlvLk91dHB1dAoKY2xhc3MgQ3VzdG9tQ2xhc3ModmFsIGRhdGE6IFN0cmluZywgdmFsIG51bWJlcjogSW50KQoKY2xhc3MgQ3VzdG9tQ2xhc3NTZXJpYWxpemVyIGV4dGVuZHMgU2VyaWFsaXplcltDdXN0b21DbGFzc10gewogIG92ZXJyaWRlIGRlZiB3cml0ZShrcnlvOiBLcnlvLCBvdXRwdXQ6IE91dHB1dCwgb2JqOiBDdXN0b21DbGFzcyk6IFVuaXQgPSB7CiAgICBvdXRwdXQud3JpdGVTdHJpbmcob2JqLmRhdGEpCiAgICBvdXRwdXQud3JpdGVJbnQob2JqLm51bWJlcikKICB9CgogIG92ZXJyaWRlIGRlZiByZWFkKGtyeW86IEtyeW8sIGlucHV0OiBJbnB1dCwgYHR5cGVgOiBDbGFzc1tDdXN0b21DbGFzc10pOiBDdXN0b21DbGFzcyA9IHsKICAgIHZhbCBkYXRhID0gaW5wdXQucmVhZFN0cmluZygpCiAgICB2YWwgbnVtYmVyID0gaW5wdXQucmVhZEludCgpCiAgICBuZXcgQ3VzdG9tQ2xhc3MoZGF0YSwgbnVtYmVyKQogIH0KfQoKLy8gUmVnaXN0cmUgZGVsIHNlcmlhbGl0emFkb3IgcGVyc29uYWxpdHphdAp2YWwgY29uZiA9IG5ldyBTcGFya0NvbmYoKQogIC5zZXRBcHBOYW1lKCJDdXN0b21TZXJpYWxpemVyRXhhbXBsZSIpCiAgLnNldE1hc3RlcigibG9jYWwiKQogIC5zZXQoInNwYXJrLnNlcmlhbGl6ZXIiLCAib3JnLmFwYWNoZS5zcGFyay5zZXJpYWxpemVyLktyeW9TZXJpYWxpemVyIikKICAucmVnaXN0ZXJLcnlvQ2xhc3NlcyhBcnJheShjbGFzc09mW0N1c3RvbUNsYXNzXSkpCiAgLnJlZ2lzdGVyS3J5b1NlcmlhbGl6ZXIoY2xhc3NPZltDdXN0b21DbGFzc10sIGNsYXNzT2ZbQ3VzdG9tQ2xhc3NTZXJpYWxpemVyXSkKCnZhbCBzYyA9IG5ldyBTcGFya0NvbnRleHQoY29uZik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import com.esotericsoftware.kryo.Kryo
import com.esotericsoftware.kryo.Serializer
import com.esotericsoftware.kryo.io.Input
import com.esotericsoftware.kryo.io.Output

class CustomClass(val data: String, val number: Int)

class CustomClassSerializer extends Serializer[CustomClass] {
  override def write(kryo: Kryo, output: Output, obj: CustomClass): Unit = {
    output.writeString(obj.data)
    output.writeInt(obj.number)
  }

  override def read(kryo: Kryo, input: Input, `type`: Class[CustomClass]): CustomClass = {
    val data = input.readString()
    val number = input.readInt()
    new CustomClass(data, number)
  }
}

// Registre del serialitzador personalitzat
val conf = new SparkConf()
  .setAppName(&quot;CustomSerializerExample&quot;)
  .setMaster(&quot;local&quot;)
  .set(&quot;spark.serializer&quot;, &quot;org.apache.spark.serializer.KryoSerializer&quot;)
  .registerKryoClasses(Array(classOf[CustomClass]))
  .registerKryoSerializer(classOf[CustomClass], classOf[CustomClassSerializer])

val sc = new SparkContext(conf)</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>La serialització de dades és un concepte fonamental a Apache Spark que impacta significativament en el rendiment. Entenent i optimitzant les tècniques de serialització, com canviar a Kryo i registrar classes personalitzades, pots millorar l'eficiència de les teves aplicacions Spark. Considera sempre els compromisos entre facilitat d'ús i rendiment quan triïs un mètode de serialització.</p>
</div><div class='row navigation'><div class='col-6'><a href='memory-management'>&#x25C4; Gestió de Memòria</a></div><div class='col-6 text-end'><a href='partitioning-and-shuffling'>Particionament i Shuffling &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
