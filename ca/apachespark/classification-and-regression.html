<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Classificació i Regressió a Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/classification-and-regression" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/classification-and-regression" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/classification-and-regression" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/apachespark/classification-and-regression" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Apache Spark és un potent motor de processament de codi obert construït al voltant de la velocitat, la facilitat d'ús i l'analítica sofisticada. En aquesta secció, explorarem dos tipus fonamentals de tasques d'aprenentatge automàtic: Classificació i Regressió. Aquestes tasques són essencials per a la modelització predictiva i s'utilitzen àmpliament en diverses aplicacions com la detecció de correu brossa, el reconeixement d'imatges i la predicció de preus de cases.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'></div><h2>Classificació</h2>
<div class='content'><ul>
<li><strong>Definició</strong>: La classificació és una tasca d'aprenentatge supervisat on l'objectiu és predir l'etiqueta categòrica d'una entrada donada basada en dades d'entrenament.</li>
<li><strong>Exemples</strong>: Detecció de correu brossa, classificació d'imatges, anàlisi de sentiments.</li>
<li><strong>Algoritmes</strong>: Regressió Logística, Arbres de Decisió, Bosc Aleatori, Arbres Potenciats per Gradient, Màquines de Suport Vectorial (SVM).</li>
</ul>
</div><h2>Regressió</h2>
<div class='content'><ul>
<li><strong>Definició</strong>: La regressió és una tasca d'aprenentatge supervisat on l'objectiu és predir un valor continu per a una entrada donada basada en dades d'entrenament.</li>
<li><strong>Exemples</strong>: Predicció de preus de cases, previsió del mercat de valors, predicció de temperatures.</li>
<li><strong>Algoritmes</strong>: Regressió Lineal, Arbres de Decisió, Bosc Aleatori, Arbres Potenciats per Gradient.</li>
</ul>
</div><h1>Configuració d'Apache Spark</h1>
<div class='content'><p>Abans d'endinsar-nos en la classificació i la regressió, assegureu-vos que teniu Apache Spark instal·lat. Podeu utilitzar el següent codi per configurar Spark en un entorn Python:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaWNpYWxpdHphciB1bmEgc2Vzc2nDsyBkZSBTcGFyawpzcGFyayA9IFNwYXJrU2Vzc2lvbi5idWlsZGVyIFwKICAgIC5hcHBOYW1lKCJDbGFzc2lmaWNhY2nDsyBpIFJlZ3Jlc3Npw7MiKSBcCiAgICAuZ2V0T3JDcmVhdGUoKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Inicialitzar una sessi&oacute; de Spark
spark = SparkSession.builder \
    .appName(&quot;Classificaci&oacute; i Regressi&oacute;&quot;) \
    .getOrCreate()</pre></div><div class='content'></div><h1>Classificació amb Apache Spark</h1>
<div class='content'></div><h2>Exemple de Regressió Logística</h2>
<div class='content'><p>La Regressió Logística és un algoritme popular per a tasques de classificació binària. A continuació es mostra un exemple de com implementar la Regressió Logística utilitzant PySpark:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBMb2dpc3RpY1JlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFZlY3RvckFzc2VtYmxlcgpmcm9tIHB5c3BhcmsubWwuZXZhbHVhdGlvbiBpbXBvcnQgQmluYXJ5Q2xhc3NpZmljYXRpb25FdmFsdWF0b3IKCiMgQ2FycmVnYXIgaSBwcmVwYXJhciBsZXMgZGFkZXMKZGF0YSA9IHNwYXJrLnJlYWQuY3N2KCJkYXRhLmNzdiIsIGhlYWRlcj1UcnVlLCBpbmZlclNjaGVtYT1UcnVlKQphc3NlbWJsZXIgPSBWZWN0b3JBc3NlbWJsZXIoaW5wdXRDb2xzPVsiZmVhdHVyZTEiLCAiZmVhdHVyZTIiXSwgb3V0cHV0Q29sPSJmZWF0dXJlcyIpCmRhdGEgPSBhc3NlbWJsZXIudHJhbnNmb3JtKGRhdGEpCgojIERpdmlkaXIgbGVzIGRhZGVzIGVuIGNvbmp1bnRzIGQnZW50cmVuYW1lbnQgaSBwcm92YQp0cmFpbl9kYXRhLCB0ZXN0X2RhdGEgPSBkYXRhLnJhbmRvbVNwbGl0KFswLjcsIDAuM10pCgojIEluaWNpYWxpdHphciBpIGVudHJlbmFyIGVsIG1vZGVsIGRlIFJlZ3Jlc3Npw7MgTG9nw61zdGljYQpsciA9IExvZ2lzdGljUmVncmVzc2lvbihsYWJlbENvbD0ibGFiZWwiLCBmZWF0dXJlc0NvbD0iZmVhdHVyZXMiKQpscl9tb2RlbCA9IGxyLmZpdCh0cmFpbl9kYXRhKQoKIyBGZXIgcHJlZGljY2lvbnMKcHJlZGljdGlvbnMgPSBscl9tb2RlbC50cmFuc2Zvcm0odGVzdF9kYXRhKQoKIyBBdmFsdWFyIGVsIG1vZGVsCmV2YWx1YXRvciA9IEJpbmFyeUNsYXNzaWZpY2F0aW9uRXZhbHVhdG9yKGxhYmVsQ29sPSJsYWJlbCIpCmFjY3VyYWN5ID0gZXZhbHVhdG9yLmV2YWx1YXRlKHByZWRpY3Rpb25zKQpwcmludChmIlByZWNpc2nDszoge2FjY3VyYWN5fSIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import LogisticRegression
from pyspark.ml.feature import VectorAssembler
from pyspark.ml.evaluation import BinaryClassificationEvaluator

# Carregar i preparar les dades
data = spark.read.csv(&quot;data.csv&quot;, header=True, inferSchema=True)
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;], outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Dividir les dades en conjunts d'entrenament i prova
train_data, test_data = data.randomSplit([0.7, 0.3])

# Inicialitzar i entrenar el model de Regressi&oacute; Log&iacute;stica
lr = LogisticRegression(labelCol=&quot;label&quot;, featuresCol=&quot;features&quot;)
lr_model = lr.fit(train_data)

# Fer prediccions
predictions = lr_model.transform(test_data)

# Avaluar el model
evaluator = BinaryClassificationEvaluator(labelCol=&quot;label&quot;)
accuracy = evaluator.evaluate(predictions)
print(f&quot;Precisi&oacute;: {accuracy}&quot;)</pre></div><div class='content'></div><h2>Exemple d'Arbres de Decisió</h2>
<div class='content'><p>Els Arbres de Decisió poden gestionar tant tasques de classificació com de regressió. Aquí teniu un exemple per a la classificació:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmNsYXNzaWZpY2F0aW9uIGltcG9ydCBEZWNpc2lvblRyZWVDbGFzc2lmaWVyCgojIEluaWNpYWxpdHphciBpIGVudHJlbmFyIGVsIG1vZGVsIGQnQXJicmUgZGUgRGVjaXNpw7MKZHQgPSBEZWNpc2lvblRyZWVDbGFzc2lmaWVyKGxhYmVsQ29sPSJsYWJlbCIsIGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIpCmR0X21vZGVsID0gZHQuZml0KHRyYWluX2RhdGEpCgojIEZlciBwcmVkaWNjaW9ucwpwcmVkaWN0aW9ucyA9IGR0X21vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIEF2YWx1YXIgZWwgbW9kZWwKYWNjdXJhY3kgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYiUHJlY2lzacOzOiB7YWNjdXJhY3l9Iik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.classification import DecisionTreeClassifier

# Inicialitzar i entrenar el model d'Arbre de Decisi&oacute;
dt = DecisionTreeClassifier(labelCol=&quot;label&quot;, featuresCol=&quot;features&quot;)
dt_model = dt.fit(train_data)

# Fer prediccions
predictions = dt_model.transform(test_data)

# Avaluar el model
accuracy = evaluator.evaluate(predictions)
print(f&quot;Precisi&oacute;: {accuracy}&quot;)</pre></div><div class='content'></div><h1>Regressió amb Apache Spark</h1>
<div class='content'></div><h2>Exemple de Regressió Lineal</h2>
<div class='content'><p>La Regressió Lineal és un algoritme fonamental per a tasques de regressió. A continuació es mostra un exemple de com implementar la Regressió Lineal utilitzant PySpark:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IExpbmVhclJlZ3Jlc3Npb24KZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKCiMgSW5pY2lhbGl0emFyIGkgZW50cmVuYXIgZWwgbW9kZWwgZGUgUmVncmVzc2nDsyBMaW5lYWwKbHIgPSBMaW5lYXJSZWdyZXNzaW9uKGxhYmVsQ29sPSJsYWJlbCIsIGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIpCmxyX21vZGVsID0gbHIuZml0KHRyYWluX2RhdGEpCgojIEZlciBwcmVkaWNjaW9ucwpwcmVkaWN0aW9ucyA9IGxyX21vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIEF2YWx1YXIgZWwgbW9kZWwKZXZhbHVhdG9yID0gUmVncmVzc2lvbkV2YWx1YXRvcihsYWJlbENvbD0ibGFiZWwiLCBwcmVkaWN0aW9uQ29sPSJwcmVkaWN0aW9uIiwgbWV0cmljTmFtZT0icm1zZSIpCnJtc2UgPSBldmFsdWF0b3IuZXZhbHVhdGUocHJlZGljdGlvbnMpCnByaW50KGYnRXJyb3IgUXVhZHLDoHRpYyBNaXRqw6AgQXJyZWxhdCAoUk1TRSk6IHtybXNlfScp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.regression import LinearRegression
from pyspark.ml.evaluation import RegressionEvaluator

# Inicialitzar i entrenar el model de Regressi&oacute; Lineal
lr = LinearRegression(labelCol=&quot;label&quot;, featuresCol=&quot;features&quot;)
lr_model = lr.fit(train_data)

# Fer prediccions
predictions = lr_model.transform(test_data)

# Avaluar el model
evaluator = RegressionEvaluator(labelCol=&quot;label&quot;, predictionCol=&quot;prediction&quot;, metricName=&quot;rmse&quot;)
rmse = evaluator.evaluate(predictions)
print(f'Error Quadr&agrave;tic Mitj&agrave; Arrelat (RMSE): {rmse}')</pre></div><div class='content'></div><h2>Exemple de Regressió amb Bosc Aleatori</h2>
<div class='content'><p>El Bosc Aleatori és un algoritme versàtil que es pot utilitzar tant per a la classificació com per a la regressió. Aquí teniu un exemple per a la regressió:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IFJhbmRvbUZvcmVzdFJlZ3Jlc3NvcgoKIyBJbmljaWFsaXR6YXIgaSBlbnRyZW5hciBlbCBtb2RlbCBkZSBCb3NjIEFsZWF0b3JpCnJmID0gUmFuZG9tRm9yZXN0UmVncmVzc29yKGxhYmVsQ29sPSJsYWJlbCIsIGZlYXR1cmVzQ29sPSJmZWF0dXJlcyIpCnJmX21vZGVsID0gcmYuZml0KHRyYWluX2RhdGEpCgojIEZlciBwcmVkaWNjaW9ucwpwcmVkaWN0aW9ucyA9IHJmX21vZGVsLnRyYW5zZm9ybSh0ZXN0X2RhdGEpCgojIEF2YWx1YXIgZWwgbW9kZWwKcm1zZSA9IGV2YWx1YXRvci5ldmFsdWF0ZShwcmVkaWN0aW9ucykKcHJpbnQoZidFcnJvciBRdWFkcsOgdGljIE1pdGrDoCBBcnJlbGF0IChSTVNFKToge3Jtc2V9Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.regression import RandomForestRegressor

# Inicialitzar i entrenar el model de Bosc Aleatori
rf = RandomForestRegressor(labelCol=&quot;label&quot;, featuresCol=&quot;features&quot;)
rf_model = rf.fit(train_data)

# Fer prediccions
predictions = rf_model.transform(test_data)

# Avaluar el model
rmse = evaluator.evaluate(predictions)
print(f'Error Quadr&agrave;tic Mitj&agrave; Arrelat (RMSE): {rmse}')</pre></div><div class='content'></div><h1>Resum</h1>
<div class='content'><p>En aquesta secció, hem cobert els conceptes bàsics de la classificació i la regressió utilitzant Apache Spark. Hem explorat conceptes clau, configurat Spark i implementat diversos algoritmes per a ambdues tasques. Entendre aquestes tasques fonamentals d'aprenentatge automàtic i com implementar-les a Spark és crucial per construir models predictius robustos. A mesura que avanceu, podeu experimentar amb diferents algoritmes i paràmetres de sintonització per millorar el rendiment dels vostres models.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
