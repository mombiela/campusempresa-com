<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introducció a Spark MLlib</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/introduction-to-spark-mllib" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/introduction-to-spark-mllib" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/introduction-to-spark-mllib" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/apachespark/introduction-to-spark-mllib" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='structured-streaming'>&#x25C4;Streaming Estructurat</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Introducció a Spark MLlib</a>
	</div>
	<div class='col-4 text-end'>
					<a href='basic-statistics'>Estadístiques Bàsiques &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Apache Spark MLlib és una biblioteca d'aprenentatge automàtic escalable que proporciona diversos algorismes i utilitats per a tasques d'aprenentatge automàtic. Aquesta secció us introduirà als conceptes bàsics de Spark MLlib, els seus components clau i com utilitzar-lo per construir models d'aprenentatge automàtic.</p>
</div><h1>Què és Spark MLlib?</h1>
<div class='content'><p>Spark MLlib és una biblioteca dins d'Apache Spark que proporciona:</p>
<ul>
<li><strong>Algorismes d'aprenentatge automàtic escalables</strong>: Incloent classificació, regressió, agrupament i filtratge col·laboratiu.</li>
<li><strong>Eines per a l'extracció, transformació i selecció de característiques</strong>.</li>
<li><strong>Pipelines</strong>: Per construir i ajustar fluxos de treball d'aprenentatge automàtic.</li>
<li><strong>Utilitats</strong>: Per guardar i carregar models, avaluar models i treballar amb dades.</li>
</ul>
</div><h1>Conceptes Clau en Spark MLlib</h1>
<div class='content'><ul>
<li><strong>DataFrames</strong>: L'estructura de dades principal utilitzada en Spark MLlib per gestionar dades.</li>
<li><strong>Transformers</strong>: Objectes que transformen DataFrames en altres DataFrames.</li>
<li><strong>Estimators</strong>: Algorismes que es poden ajustar sobre DataFrames per produir Transformers.</li>
<li><strong>Pipelines</strong>: Seqüències de Transformers i Estimators per agilitzar el flux de treball d'aprenentatge automàtic.</li>
</ul>
</div><h1>Configuració de Spark MLlib</h1>
<div class='content'><p>Abans d'endinsar-vos en Spark MLlib, assegureu-vos que teniu Apache Spark instal·lat. Podeu instal·lar-lo utilitzant la següent comanda:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cGlwIGluc3RhbGwgcHlzcGFyaw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>pip install pyspark</pre></div><div class='content'></div><h1>Flux de Treball Bàsic en Spark MLlib</h1>
<div class='content'><ol>
<li><strong>Carregar i Preparar Dades</strong>: Carregar dades en un DataFrame i preparar-les per a l'anàlisi.</li>
<li><strong>Enginyeria de Característiques</strong>: Transformar dades en brut en característiques adequades per a l'aprenentatge automàtic.</li>
<li><strong>Entrenament del Model</strong>: Entrenar un model d'aprenentatge automàtic utilitzant un Estimator.</li>
<li><strong>Avaluació del Model</strong>: Avaluar el rendiment del model.</li>
<li><strong>Ajust del Model</strong>: Optimitzar els paràmetres del model.</li>
<li><strong>Desplegament del Model</strong>: Guardar i carregar el model per a ús futur.</li>
</ol>
</div><h1>Exemple: Regressió Lineal amb Spark MLlib</h1>
<div class='content'></div><h2>Pas 1: Carregar i Preparar Dades</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLnNxbCBpbXBvcnQgU3BhcmtTZXNzaW9uCgojIEluaWNpYWxpdHphciBsYSBzZXNzacOzIGRlIFNwYXJrCnNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIuYXBwTmFtZSgiTGluZWFyUmVncmVzc2lvbkV4YW1wbGUiKS5nZXRPckNyZWF0ZSgpCgojIENhcnJlZ2FyIGRhZGVzCmRhdGEgPSBzcGFyay5yZWFkLmNzdigiZGF0YS5jc3YiLCBoZWFkZXI9VHJ1ZSwgaW5mZXJTY2hlbWE9VHJ1ZSkKCiMgTW9zdHJhciBsZXMgcHJpbWVyZXMgZmlsZXMgZGVsIERhdGFGcmFtZQpkYXRhLnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.sql import SparkSession

# Inicialitzar la sessi&oacute; de Spark
spark = SparkSession.builder.appName(&quot;LinearRegressionExample&quot;).getOrCreate()

# Carregar dades
data = spark.read.csv(&quot;data.csv&quot;, header=True, inferSchema=True)

# Mostrar les primeres files del DataFrame
data.show()</pre></div><div class='content'></div><h2>Pas 2: Enginyeria de Característiques</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmZlYXR1cmUgaW1wb3J0IFZlY3RvckFzc2VtYmxlcgoKIyBBZ3J1cGFyIGNhcmFjdGVyw61zdGlxdWVzIGVuIHVuIMO6bmljIHZlY3Rvcgphc3NlbWJsZXIgPSBWZWN0b3JBc3NlbWJsZXIoaW5wdXRDb2xzPVsiZmVhdHVyZTEiLCAiZmVhdHVyZTIiXSwgb3V0cHV0Q29sPSJmZWF0dXJlcyIpCmRhdGEgPSBhc3NlbWJsZXIudHJhbnNmb3JtKGRhdGEpCgojIE1vc3RyYXIgZWwgRGF0YUZyYW1lIHRyYW5zZm9ybWF0CmRhdGEuc2hvdygp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.feature import VectorAssembler

# Agrupar caracter&iacute;stiques en un &uacute;nic vector
assembler = VectorAssembler(inputCols=[&quot;feature1&quot;, &quot;feature2&quot;], outputCol=&quot;features&quot;)
data = assembler.transform(data)

# Mostrar el DataFrame transformat
data.show()</pre></div><div class='content'></div><h2>Pas 3: Entrenament del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnJlZ3Jlc3Npb24gaW1wb3J0IExpbmVhclJlZ3Jlc3Npb24KCiMgSW5pY2lhbGl0emFyIGVsIG1vZGVsIGRlIFJlZ3Jlc3Npw7MgTGluZWFsCmxyID0gTGluZWFyUmVncmVzc2lvbihmZWF0dXJlc0NvbD0iZmVhdHVyZXMiLCBsYWJlbENvbD0ibGFiZWwiKQoKIyBBanVzdGFyIGVsIG1vZGVsCmxyX21vZGVsID0gbHIuZml0KGRhdGEpCgojIE1vc3RyYXIgZWxzIGNvZWZpY2llbnRzIGkgbGEgaW50ZXJjZXBjacOzIGRlbCBtb2RlbApwcmludChmIkNvZWZmaWNpZW50czoge2xyX21vZGVsLmNvZWZmaWNpZW50c30iKQpwcmludChmIkludGVyY2VwdDoge2xyX21vZGVsLmludGVyY2VwdH0iKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.regression import LinearRegression

# Inicialitzar el model de Regressi&oacute; Lineal
lr = LinearRegression(featuresCol=&quot;features&quot;, labelCol=&quot;label&quot;)

# Ajustar el model
lr_model = lr.fit(data)

# Mostrar els coeficients i la intercepci&oacute; del model
print(f&quot;Coefficients: {lr_model.coefficients}&quot;)
print(f&quot;Intercept: {lr_model.intercept}&quot;)</pre></div><div class='content'></div><h2>Pas 4: Avaluació del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLmV2YWx1YXRpb24gaW1wb3J0IFJlZ3Jlc3Npb25FdmFsdWF0b3IKCiMgRmVyIHByZWRpY2Npb25zCnByZWRpY3Rpb25zID0gbHJfbW9kZWwudHJhbnNmb3JtKGRhdGEpCgojIEluaWNpYWxpdHphciBsJ2F2YWx1YWRvcgpldmFsdWF0b3IgPSBSZWdyZXNzaW9uRXZhbHVhdG9yKHByZWRpY3Rpb25Db2w9InByZWRpY3Rpb24iLCBsYWJlbENvbD0ibGFiZWwiLCBtZXRyaWNOYW1lPSJybXNlIikKCiMgQXZhbHVhciBlbCBtb2RlbApybXNlID0gZXZhbHVhdG9yLmV2YWx1YXRlKHByZWRpY3Rpb25zKQpwcmludChmIlJvb3QgTWVhbiBTcXVhcmVkIEVycm9yIChSTVNFKToge3Jtc2V9Iik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.evaluation import RegressionEvaluator

# Fer prediccions
predictions = lr_model.transform(data)

# Inicialitzar l'avaluador
evaluator = RegressionEvaluator(predictionCol=&quot;prediction&quot;, labelCol=&quot;label&quot;, metricName=&quot;rmse&quot;)

# Avaluar el model
rmse = evaluator.evaluate(predictions)
print(f&quot;Root Mean Squared Error (RMSE): {rmse}&quot;)</pre></div><div class='content'></div><h2>Pas 5: Ajust del Model (Opcional)</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrLm1sLnR1bmluZyBpbXBvcnQgUGFyYW1HcmlkQnVpbGRlciwgQ3Jvc3NWYWxpZGF0b3IKCiMgQ3JlYXIgbGEgZ3JhZWxsYSBkZSBwYXLDoG1ldHJlcwpwYXJhbUdyaWQgPSBQYXJhbUdyaWRCdWlsZGVyKCkuYWRkR3JpZChsci5yZWdQYXJhbSwgWzAuMSwgMC4wMV0pLmJ1aWxkKCkKCiMgSW5pY2lhbGl0emFyIGVsIENyb3NzVmFsaWRhdG9yCmNyb3NzdmFsID0gQ3Jvc3NWYWxpZGF0b3IoZXN0aW1hdG9yPWxyLCBlc3RpbWF0b3JQYXJhbU1hcHM9cGFyYW1HcmlkLCBldmFsdWF0b3I9ZXZhbHVhdG9yLCBudW1Gb2xkcz0zKQoKIyBFeGVjdXRhciBsYSB2YWxpZGFjacOzIGNyZXVhZGEKY3ZfbW9kZWwgPSBjcm9zc3ZhbC5maXQoZGF0YSkKCiMgT2J0ZW5pciBlbCBtaWxsb3IgbW9kZWwKYmVzdF9tb2RlbCA9IGN2X21vZGVsLmJlc3RNb2RlbApwcmludChmIkJlc3QgTW9kZWwgQ29lZmZpY2llbnRzOiB7YmVzdF9tb2RlbC5jb2VmZmljaWVudHN9IikKcHJpbnQoZiJCZXN0IE1vZGVsIEludGVyY2VwdDoge2Jlc3RfbW9kZWwuaW50ZXJjZXB0fSIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark.ml.tuning import ParamGridBuilder, CrossValidator

# Crear la graella de par&agrave;metres
paramGrid = ParamGridBuilder().addGrid(lr.regParam, [0.1, 0.01]).build()

# Inicialitzar el CrossValidator
crossval = CrossValidator(estimator=lr, estimatorParamMaps=paramGrid, evaluator=evaluator, numFolds=3)

# Executar la validaci&oacute; creuada
cv_model = crossval.fit(data)

# Obtenir el millor model
best_model = cv_model.bestModel
print(f&quot;Best Model Coefficients: {best_model.coefficients}&quot;)
print(f&quot;Best Model Intercept: {best_model.intercept}&quot;)</pre></div><div class='content'></div><h2>Pas 6: Desplegament del Model</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBHdWFyZGFyIGVsIG1vZGVsCmJlc3RfbW9kZWwuc2F2ZSgibGluZWFyX3JlZ3Jlc3Npb25fbW9kZWwiKQoKIyBDYXJyZWdhciBlbCBtb2RlbApmcm9tIHB5c3BhcmsubWwucmVncmVzc2lvbiBpbXBvcnQgTGluZWFyUmVncmVzc2lvbk1vZGVsCmxvYWRlZF9tb2RlbCA9IExpbmVhclJlZ3Jlc3Npb25Nb2RlbC5sb2FkKCJsaW5lYXJfcmVncmVzc2lvbl9tb2RlbCIp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Guardar el model
best_model.save(&quot;linear_regression_model&quot;)

# Carregar el model
from pyspark.ml.regression import LinearRegressionModel
loaded_model = LinearRegressionModel.load(&quot;linear_regression_model&quot;)</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquesta secció, hem introduït Spark MLlib i els seus components clau. Hem recorregut un flux de treball bàsic per construir un model d'aprenentatge automàtic utilitzant Spark MLlib, incloent carregar dades, enginyeria de característiques, entrenament del model, avaluació, ajust i desplegament. Amb aquesta base, podeu començar a explorar característiques i algorismes més avançats proporcionats per Spark MLlib per construir aplicacions d'aprenentatge automàtic escalables.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='structured-streaming'>&#x25C4;Streaming Estructurat</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Introducció a Spark MLlib</a>
	</div>
	<div class='col-4 text-end'>
					<a href='basic-statistics'>Estadístiques Bàsiques &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
