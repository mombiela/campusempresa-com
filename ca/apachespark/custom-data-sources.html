<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fonts de Dades Personalitzades a Apache Spark</title>

    <link rel="alternate" href="https://campusempresa.com/es/apachespark/custom-data-sources" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/apachespark/custom-data-sources" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/apachespark/custom-data-sources" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/apachespark/custom-data-sources" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Apache Spark és un potent sistema de computació distribuïda que permet processar grans conjunts de dades de manera eficient. Una de les seves característiques principals és la capacitat de llegir i escriure en diverses fonts de dades. Tot i que Spark proporciona suport integrat per a moltes fonts de dades comunes com CSV, JSON, Parquet i JDBC, hi ha escenaris en què potser necessiteu treballar amb fonts de dades personalitzades. Aquesta secció us guiarà a través del procés de creació i ús de fonts de dades personalitzades a Apache Spark.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>API de Font de Dades</strong>: L'API proporcionada per Spark per integrar fonts de dades personalitzades.</li>
<li><strong>DataFrame</strong>: Una col·lecció distribuïda de dades organitzada en columnes amb nom.</li>
<li><strong>Esquema</strong>: L'estructura que defineix els tipus de dades de les columnes en un DataFrame.</li>
<li><strong>Particionament</strong>: Dividir les dades en trossos més petits i manejables per al processament en paral·lel.</li>
</ul>
</div><h1>Per què Fonts de Dades Personalitzades?</h1>
<div class='content'><ul>
<li><strong>Formats Especialitzats</strong>: Les vostres dades poden estar en un format no suportat nativament per Spark.</li>
<li><strong>Rendiment Optimitzat</strong>: Les fonts de dades personalitzades es poden optimitzar per a casos d'ús específics.</li>
<li><strong>Integració</strong>: Integració sense problemes amb sistemes propietaris o heretats.</li>
</ul>
</div><h1>Implementació d'una Font de Dades Personalitzada</h1>
<div class='content'><p>Per implementar una font de dades personalitzada a Spark, heu d'extendre l'API <code>DataSourceV2</code>. A continuació es mostra una guia pas a pas per crear una font de dades personalitzada simple.</p>
</div><h2>Pas 1: Definir la Font de Dades</h2>
<div class='content'><p>Creeu una classe que extengui <code>DataSourceV2</code> i <code>ReadSupport</code>. Aquesta classe definirà les capacitats de la vostra font de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3Bhcmsuc3FsLnNvdXJjZXMudjIuXwppbXBvcnQgb3JnLmFwYWNoZS5zcGFyay5zcWwuc291cmNlcy52Mi5yZWFkZXIuXwppbXBvcnQgb3JnLmFwYWNoZS5zcGFyay5zcWwudHlwZXMuXwoKY2xhc3MgU2ltcGxlRGF0YVNvdXJjZSBleHRlbmRzIERhdGFTb3VyY2VWMiB3aXRoIFJlYWRTdXBwb3J0IHsKICBvdmVycmlkZSBkZWYgY3JlYXRlUmVhZGVyKG9wdGlvbnM6IERhdGFTb3VyY2VPcHRpb25zKTogRGF0YVNvdXJjZVJlYWRlciA9IHsKICAgIG5ldyBTaW1wbGVEYXRhU291cmNlUmVhZGVyCiAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.sql.sources.v2._
import org.apache.spark.sql.sources.v2.reader._
import org.apache.spark.sql.types._

class SimpleDataSource extends DataSourceV2 with ReadSupport {
  override def createReader(options: DataSourceOptions): DataSourceReader = {
    new SimpleDataSourceReader
  }
}</pre></div><div class='content'></div><h2>Pas 2: Definir el Lector de la Font de Dades</h2>
<div class='content'><p>El <code>DataSourceReader</code> és responsable de llegir les dades i proporcionar informació de l'esquema.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlRGF0YVNvdXJjZVJlYWRlciBleHRlbmRzIERhdGFTb3VyY2VSZWFkZXIgewogIG92ZXJyaWRlIGRlZiByZWFkU2NoZW1hKCk6IFN0cnVjdFR5cGUgPSB7CiAgICBTdHJ1Y3RUeXBlKEFycmF5KAogICAgICBTdHJ1Y3RGaWVsZCgiaWQiLCBJbnRlZ2VyVHlwZSwgbnVsbGFibGUgPSBmYWxzZSksCiAgICAgIFN0cnVjdEZpZWxkKCJ2YWx1ZSIsIFN0cmluZ1R5cGUsIG51bGxhYmxlID0gdHJ1ZSkKICAgICkpCiAgfQoKICBvdmVycmlkZSBkZWYgY3JlYXRlRGF0YVJlYWRlckZhY3RvcmllcygpOiBqYXZhLnV0aWwuTGlzdFtEYXRhUmVhZGVyRmFjdG9yeVtSb3ddXSA9IHsKICAgIGphdmEudXRpbC5Db2xsZWN0aW9ucy5zaW5nbGV0b25MaXN0KG5ldyBTaW1wbGVEYXRhUmVhZGVyRmFjdG9yeSkKICB9Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleDataSourceReader extends DataSourceReader {
  override def readSchema(): StructType = {
    StructType(Array(
      StructField(&quot;id&quot;, IntegerType, nullable = false),
      StructField(&quot;value&quot;, StringType, nullable = true)
    ))
  }

  override def createDataReaderFactories(): java.util.List[DataReaderFactory[Row]] = {
    java.util.Collections.singletonList(new SimpleDataReaderFactory)
  }
}</pre></div><div class='content'></div><h2>Pas 3: Definir la Fàbrica de Lectors de Dades</h2>
<div class='content'><p>La <code>DataReaderFactory</code> crea instàncies de <code>DataReader</code> que realment llegeixen les dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlRGF0YVJlYWRlckZhY3RvcnkgZXh0ZW5kcyBEYXRhUmVhZGVyRmFjdG9yeVtSb3ddIHsKICBvdmVycmlkZSBkZWYgY3JlYXRlRGF0YVJlYWRlcigpOiBEYXRhUmVhZGVyW1Jvd10gPSBuZXcgU2ltcGxlRGF0YVJlYWRlcgp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleDataReaderFactory extends DataReaderFactory[Row] {
  override def createDataReader(): DataReader[Row] = new SimpleDataReader
}</pre></div><div class='content'></div><h2>Pas 4: Definir el Lector de Dades</h2>
<div class='content'><p>El <code>DataReader</code> llegeix les dades i les converteix en el format intern de Spark <code>Row</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Y2xhc3MgU2ltcGxlRGF0YVJlYWRlciBleHRlbmRzIERhdGFSZWFkZXJbUm93XSB7CiAgcHJpdmF0ZSB2YWwgZGF0YSA9IExpc3QoCiAgICBSb3coMSwgInZhbHVlMSIpLAogICAgUm93KDIsICJ2YWx1ZTIiKQogICkuaXRlcmF0b3IKCiAgb3ZlcnJpZGUgZGVmIG5leHQoKTogQm9vbGVhbiA9IGRhdGEuaGFzTmV4dAoKICBvdmVycmlkZSBkZWYgZ2V0KCk6IFJvdyA9IGRhdGEubmV4dCgpCgogIG92ZXJyaWRlIGRlZiBjbG9zZSgpOiBVbml0ID0ge30KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>class SimpleDataReader extends DataReader[Row] {
  private val data = List(
    Row(1, &quot;value1&quot;),
    Row(2, &quot;value2&quot;)
  ).iterator

  override def next(): Boolean = data.hasNext

  override def get(): Row = data.next()

  override def close(): Unit = {}
}</pre></div><div class='content'></div><h2>Ús de la Font de Dades Personalitzada</h2>
<div class='content'><p>Un cop la vostra font de dades personalitzada està implementada, podeu utilitzar-la en la vostra aplicació Spark de la següent manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHNwYXJrID0gU3BhcmtTZXNzaW9uLmJ1aWxkZXIoKQogIC5hcHBOYW1lKCJDdXN0b20gRGF0YSBTb3VyY2UgRXhhbXBsZSIpCiAgLmdldE9yQ3JlYXRlKCkKCnZhbCBkZiA9IHNwYXJrLnJlYWQKICAuZm9ybWF0KCJjb20uZXhhbXBsZS5TaW1wbGVEYXRhU291cmNlIikKICAubG9hZCgpCgpkZi5zaG93KCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val spark = SparkSession.builder()
  .appName(&quot;Custom Data Source Example&quot;)
  .getOrCreate()

val df = spark.read
  .format(&quot;com.example.SimpleDataSource&quot;)
  .load()

df.show()</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Crear fonts de dades personalitzades a Apache Spark us permet estendre les seves capacitats per manejar formats de dades especialitzats i integrar-se amb diversos sistemes. Seguint els passos descrits en aquesta secció, podeu implementar i utilitzar fonts de dades personalitzades en les vostres aplicacions Spark. Aquesta flexibilitat assegura que Spark es pugui adaptar per satisfer els requisits únics de les vostres tasques de processament de dades.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
