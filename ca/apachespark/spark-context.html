<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/apachespark/spark-context" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció al Spark Context</h1>
<div class='content'><p>Apache Spark és un potent motor de processament de codi obert construït al voltant de la velocitat, la facilitat d'ús i les anàlisis sofisticades. Al cor de la funcionalitat de Spark hi ha el Spark Context, que és el punt d'entrada per a qualsevol funcionalitat de Spark.</p>
<ul>
<li><strong>Spark Context</strong>: El punt d'entrada principal per a la funcionalitat de Spark. Permet que la teva aplicació Spark accedeixi a les capacitats de Spark.</li>
<li><strong>Inicialització</strong>: El Spark Context s'inicialitza amb un objecte SparkConf que conté informació sobre la teva aplicació.</li>
</ul>
</div><h1>Creació d'un Spark Context</h1>
<div class='content'><p>Per començar a utilitzar Spark, necessites crear un Spark Context. Això es fa típicament en el programa controlador.</p>
</div><h2>Exemple en Scala</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG9yZy5hcGFjaGUuc3Bhcmsue1NwYXJrQ29uZiwgU3BhcmtDb250ZXh0fQoKLy8gQ3JlYXIgdW4gb2JqZWN0ZSBTcGFya0NvbmYKdmFsIGNvbmYgPSBuZXcgU3BhcmtDb25mKCkuc2V0QXBwTmFtZSgiTXlBcHAiKS5zZXRNYXN0ZXIoImxvY2FsIikKCi8vIENyZWFyIHVuIG9iamVjdGUgU3BhcmtDb250ZXh0CnZhbCBzYyA9IG5ldyBTcGFya0NvbnRleHQoY29uZik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import org.apache.spark.{SparkConf, SparkContext}

// Crear un objecte SparkConf
val conf = new SparkConf().setAppName(&quot;MyApp&quot;).setMaster(&quot;local&quot;)

// Crear un objecte SparkContext
val sc = new SparkContext(conf)</pre></div><div class='content'></div><h2>Exemple en Python</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBweXNwYXJrIGltcG9ydCBTcGFya0NvbmYsIFNwYXJrQ29udGV4dAoKIyBDcmVhciB1biBvYmplY3RlIFNwYXJrQ29uZgpjb25mID0gU3BhcmtDb25mKCkuc2V0QXBwTmFtZSgiTXlBcHAiKS5zZXRNYXN0ZXIoImxvY2FsIikKCiMgQ3JlYXIgdW4gb2JqZWN0ZSBTcGFya0NvbnRleHQKc2MgPSBTcGFya0NvbnRleHQoY29uZik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from pyspark import SparkConf, SparkContext

# Crear un objecte SparkConf
conf = SparkConf().setAppName(&quot;MyApp&quot;).setMaster(&quot;local&quot;)

# Crear un objecte SparkContext
sc = SparkContext(conf)</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>SparkConf</strong>: Aquest objecte conté paràmetres de configuració per a la teva aplicació Spark.
<ul>
<li><code>setAppName(&quot;MyApp&quot;)</code>: Estableix el nom de la teva aplicació.</li>
<li><code>setMaster(&quot;local&quot;)</code>: Especifica l'URL del mestre per al clúster. &quot;local&quot; significa executar Spark localment amb un fil.</li>
</ul>
</li>
<li><strong>SparkContext</strong>: Aquest objecte permet que la teva aplicació Spark accedeixi a les capacitats de Spark.</li>
</ul>
</div><h1>Funcions Clau del Spark Context</h1>
<div class='content'><p>Un cop tens un Spark Context, pots utilitzar-lo per realitzar diverses operacions.</p>
<ul>
<li><strong>Parallelize</strong>: Distribuir una col·lecció local per formar un RDD (Resilient Distributed Dataset).</li>
<li><strong>TextFile</strong>: Llegir un fitxer de text des d'HDFS, un sistema de fitxers local o qualsevol sistema de fitxers compatible amb Hadoop.</li>
<li><strong>Stop</strong>: Aturar el Spark Context.</li>
</ul>
</div><h2>Exemple en Scala</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gRGlzdHJpYnVpciB1bmEgY29swrdsZWNjacOzIGxvY2FsCnZhbCBkYXRhID0gQXJyYXkoMSwgMiwgMywgNCwgNSkKdmFsIGRpc3REYXRhID0gc2MucGFyYWxsZWxpemUoZGF0YSkKCi8vIExsZWdpciB1biBmaXR4ZXIgZGUgdGV4dAp2YWwgdGV4dEZpbGUgPSBzYy50ZXh0RmlsZSgiaGRmczovL3BhdGgvdG8vZmlsZS50eHQiKQoKLy8gQXR1cmFyIGVsIFNwYXJrIENvbnRleHQKc2Muc3RvcCgp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Distribuir una col&middot;lecci&oacute; local
val data = Array(1, 2, 3, 4, 5)
val distData = sc.parallelize(data)

// Llegir un fitxer de text
val textFile = sc.textFile(&quot;hdfs://path/to/file.txt&quot;)

// Aturar el Spark Context
sc.stop()</pre></div><div class='content'></div><h2>Exemple en Python</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("IyBEaXN0cmlidWlyIHVuYSBjb2zCt2xlY2Npw7MgbG9jYWwKZGF0YSA9IFsxLCAyLCAzLCA0LCA1XQpkaXN0RGF0YSA9IHNjLnBhcmFsbGVsaXplKGRhdGEpCgojIExsZWdpciB1biBmaXR4ZXIgZGUgdGV4dAp0ZXh0RmlsZSA9IHNjLnRleHRGaWxlKCJoZGZzOi8vcGF0aC90by9maWxlLnR4dCIpCgojIEF0dXJhciBlbCBTcGFyayBDb250ZXh0CnNjLnN0b3AoKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'># Distribuir una col&middot;lecci&oacute; local
data = [1, 2, 3, 4, 5]
distData = sc.parallelize(data)

# Llegir un fitxer de text
textFile = sc.textFile(&quot;hdfs://path/to/file.txt&quot;)

# Aturar el Spark Context
sc.stop()</pre></div><div class='content'></div><h1>Ús Avançat del Spark Context</h1>
<div class='content'><p>A mesura que et familiaritzis més amb Spark, podràs aprofitar funcions més avançades del Spark Context.</p>
<ul>
<li><strong>Variables Broadcast</strong>: Distribuir eficientment dades grans de només lectura a tots els nodes treballadors.</li>
<li><strong>Acumuladors</strong>: Variables que només s'afegeixen, com comptadors i sumes.</li>
</ul>
</div><h2>Exemple de Variables Broadcast en Scala</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIGJyb2FkY2FzdFZhciA9IHNjLmJyb2FkY2FzdChBcnJheSgxLCAyLCAzKSkKCi8vIFV0aWxpdHphciBsYSB2YXJpYWJsZSBicm9hZGNhc3QgZW4gdW5hIHRyYW5zZm9ybWFjacOzCnZhbCByZXN1bHQgPSBkaXN0RGF0YS5tYXAoeCA9PiB4ICsgYnJvYWRjYXN0VmFyLnZhbHVlKDApKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val broadcastVar = sc.broadcast(Array(1, 2, 3))

// Utilitzar la variable broadcast en una transformaci&oacute;
val result = distData.map(x =&gt; x + broadcastVar.value(0))</pre></div><div class='content'></div><h2>Exemple d'Acumuladors en Python</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("YWNjdW0gPSBzYy5hY2N1bXVsYXRvcigwKQoKZGVmIGYoeCk6CiAgICBnbG9iYWwgYWNjdW0KICAgIGFjY3VtICs9IHgKCnJkZCA9IHNjLnBhcmFsbGVsaXplKFsxLCAyLCAzLCA0LCA1XSkKcmRkLmZvcmVhY2goZikKCnByaW50KGFjY3VtLnZhbHVlKSAgIyBTb3J0aWRhOiAxNQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>accum = sc.accumulator(0)

def f(x):
    global accum
    accum += x

rdd = sc.parallelize([1, 2, 3, 4, 5])
rdd.foreach(f)

print(accum.value)  # Sortida: 15</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>El Spark Context és un component crític de qualsevol aplicació Spark, servint com el punt d'entrada principal per a la funcionalitat de Spark. Entenent com crear i utilitzar un Spark Context, pots aprofitar efectivament el poder de Spark per al processament de dades distribuïdes. A mesura que avancis, podràs explorar funcions més sofisticades com les variables broadcast i els acumuladors per optimitzar les teves aplicacions Spark.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
