<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Validació Creuada</title>

    <link rel="alternate" href="https://campusempresa.com/es/machine_learning/validacion-cruzada" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/machine_learning/validacion-cruzada" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/machine_learning/validacion-cruzada" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/machine_learning/validacion-cruzada" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='metricas-evaluacion'>&#x25C4; Mètriques d'Avaluació</a></div><div class='col-6 text-end'><a href='curvas-roc-auc'>Corbes ROC i AUC &#x25BA;</a></div></div><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>La validació creuada és una tècnica fonamental en Machine Learning per avaluar la capacitat de generalització d'un model. En lloc de dependre d'una única partició de dades per a entrenament i prova, la validació creuada permet utilitzar múltiples particions per obtenir una estimació més robusta del rendiment del model.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Sobreajustament (Overfitting):</strong> Ocorre quan un model s'ajusta massa a les dades d'entrenament, capturant soroll i patrons irrellevants, la qual cosa resulta en un mal rendiment en dades no vistes.</li>
<li><strong>Subajustament (Underfitting):</strong> Ocorre quan un model és massa simple per capturar l'estructura subjacent de les dades, resultant en un mal rendiment tant en les dades d'entrenament com en les de prova.</li>
<li><strong>Partició de Dades:</strong> Dividir el conjunt de dades en subconjunts d'entrenament i prova per avaluar el rendiment del model.</li>
<li><strong>K-Fold Cross-Validation:</strong> Tècnica de validació creuada on les dades es divideixen en 'k' subconjunts (folds) i el model s'entrena i avalua 'k' vegades, cada vegada utilitzant un fold diferent com a conjunt de prova i els restants com a conjunt d'entrenament.</li>
</ul>
</div><h1>Tipus de Validació Creuada</h1>
<div class='content'></div><h2>K-Fold Cross-Validation</h2>
<div class='content'><p>En K-Fold Cross-Validation, el conjunt de dades es divideix en 'k' parts iguals. El model s'entrena 'k' vegades, cada vegada utilitzant un fold diferent com a conjunt de prova i els restants com a conjunt d'entrenament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgS0ZvbGQKZnJvbSBza2xlYXJuLmxpbmVhcl9tb2RlbCBpbXBvcnQgTGluZWFyUmVncmVzc2lvbgpmcm9tIHNrbGVhcm4ubWV0cmljcyBpbXBvcnQgbWVhbl9zcXVhcmVkX2Vycm9yCmltcG9ydCBudW1weSBhcyBucAoKIyBEYWRlcyBkJ2V4ZW1wbGUKWCA9IG5wLmFycmF5KFtbMSwgMl0sIFszLCA0XSwgWzUsIDZdLCBbNywgOF0sIFs5LCAxMF1dKQp5ID0gbnAuYXJyYXkoWzEsIDIsIDMsIDQsIDVdKQoKIyBDb25maWd1cmFjacOzIGRlIEstRm9sZAprZiA9IEtGb2xkKG5fc3BsaXRzPTUpCgojIEluaWNpYWxpdHphY2nDsyBkZWwgbW9kZWwKbW9kZWwgPSBMaW5lYXJSZWdyZXNzaW9uKCkKCiMgTGxpc3RhIHBlciBlbW1hZ2F0emVtYXIgZWxzIGVycm9ycwplcnJvcnMgPSBbXQoKIyBWYWxpZGFjacOzIGNyZXVhZGEKZm9yIHRyYWluX2luZGV4LCB0ZXN0X2luZGV4IGluIGtmLnNwbGl0KFgpOgogICAgWF90cmFpbiwgWF90ZXN0ID0gWFt0cmFpbl9pbmRleF0sIFhbdGVzdF9pbmRleF0KICAgIHlfdHJhaW4sIHlfdGVzdCA9IHlbdHJhaW5faW5kZXhdLCB5W3Rlc3RfaW5kZXhdCiAgICAKICAgIG1vZGVsLmZpdChYX3RyYWluLCB5X3RyYWluKQogICAgcHJlZGljdGlvbnMgPSBtb2RlbC5wcmVkaWN0KFhfdGVzdCkKICAgIGVycm9yID0gbWVhbl9zcXVhcmVkX2Vycm9yKHlfdGVzdCwgcHJlZGljdGlvbnMpCiAgICBlcnJvcnMuYXBwZW5kKGVycm9yKQoKcHJpbnQoIkVycm9ycyBlbiBjYWRhIGZvbGQ6IiwgZXJyb3JzKQpwcmludCgiRXJyb3IgbWl0asOgOiIsIG5wLm1lYW4oZXJyb3JzKSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.model_selection import KFold
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error
import numpy as np

# Dades d'exemple
X = np.array([[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]])
y = np.array([1, 2, 3, 4, 5])

# Configuraci&oacute; de K-Fold
kf = KFold(n_splits=5)

# Inicialitzaci&oacute; del model
model = LinearRegression()

# Llista per emmagatzemar els errors
errors = []

# Validaci&oacute; creuada
for train_index, test_index in kf.split(X):
    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y[train_index], y[test_index]
    
    model.fit(X_train, y_train)
    predictions = model.predict(X_test)
    error = mean_squared_error(y_test, predictions)
    errors.append(error)

print(&quot;Errors en cada fold:&quot;, errors)
print(&quot;Error mitj&agrave;:&quot;, np.mean(errors))</pre></div><div class='content'></div><h2>Leave-One-Out Cross-Validation (LOOCV)</h2>
<div class='content'><p>En LOOCV, cada observació en el conjunt de dades s'utilitza una vegada com a conjunt de prova, mentre que la resta s'utilitza com a conjunt d'entrenament. Això resulta en 'n' iteracions, on 'n' és el nombre d'observacions.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgTGVhdmVPbmVPdXQKCiMgQ29uZmlndXJhY2nDsyBkZSBMT09DVgpsb28gPSBMZWF2ZU9uZU91dCgpCgojIExsaXN0YSBwZXIgZW1tYWdhdHplbWFyIGVscyBlcnJvcnMKZXJyb3JzID0gW10KCiMgVmFsaWRhY2nDsyBjcmV1YWRhCmZvciB0cmFpbl9pbmRleCwgdGVzdF9pbmRleCBpbiBsb28uc3BsaXQoWCk6CiAgICBYX3RyYWluLCBYX3Rlc3QgPSBYW3RyYWluX2luZGV4XSwgWFt0ZXN0X2luZGV4XQogICAgeV90cmFpbiwgeV90ZXN0ID0geVt0cmFpbl9pbmRleF0sIHlbdGVzdF9pbmRleF0KICAgIAogICAgbW9kZWwuZml0KFhfdHJhaW4sIHlfdHJhaW4pCiAgICBwcmVkaWN0aW9ucyA9IG1vZGVsLnByZWRpY3QoWF90ZXN0KQogICAgZXJyb3IgPSBtZWFuX3NxdWFyZWRfZXJyb3IoeV90ZXN0LCBwcmVkaWN0aW9ucykKICAgIGVycm9ycy5hcHBlbmQoZXJyb3IpCgpwcmludCgiRXJyb3JzIGVuIGNhZGEgaXRlcmFjacOzOiIsIGVycm9ycykKcHJpbnQoIkVycm9yIG1pdGrDoDoiLCBucC5tZWFuKGVycm9ycykp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.model_selection import LeaveOneOut

# Configuraci&oacute; de LOOCV
loo = LeaveOneOut()

# Llista per emmagatzemar els errors
errors = []

# Validaci&oacute; creuada
for train_index, test_index in loo.split(X):
    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y[train_index], y[test_index]
    
    model.fit(X_train, y_train)
    predictions = model.predict(X_test)
    error = mean_squared_error(y_test, predictions)
    errors.append(error)

print(&quot;Errors en cada iteraci&oacute;:&quot;, errors)
print(&quot;Error mitj&agrave;:&quot;, np.mean(errors))</pre></div><div class='content'></div><h2>Stratified K-Fold Cross-Validation</h2>
<div class='content'><p>En problemes de classificació, és important que cada fold tingui una proporció similar de classes. Stratified K-Fold assegura que cada fold sigui representatiu de la distribució de classes en el conjunt de dades complet.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1vZGVsX3NlbGVjdGlvbiBpbXBvcnQgU3RyYXRpZmllZEtGb2xkCgojIERhZGVzIGQnZXhlbXBsZSBwZXIgYSBjbGFzc2lmaWNhY2nDswpYID0gbnAuYXJyYXkoW1sxLCAyXSwgWzMsIDRdLCBbNSwgNl0sIFs3LCA4XSwgWzksIDEwXV0pCnkgPSBucC5hcnJheShbMCwgMSwgMCwgMSwgMF0pCgojIENvbmZpZ3VyYWNpw7MgZGUgU3RyYXRpZmllZCBLLUZvbGQKc2tmID0gU3RyYXRpZmllZEtGb2xkKG5fc3BsaXRzPTMpCgojIExsaXN0YSBwZXIgZW1tYWdhdHplbWFyIGVscyBlcnJvcnMKZXJyb3JzID0gW10KCiMgVmFsaWRhY2nDsyBjcmV1YWRhCmZvciB0cmFpbl9pbmRleCwgdGVzdF9pbmRleCBpbiBza2Yuc3BsaXQoWCwgeSk6CiAgICBYX3RyYWluLCBYX3Rlc3QgPSBYW3RyYWluX2luZGV4XSwgWFt0ZXN0X2luZGV4XQogICAgeV90cmFpbiwgeV90ZXN0ID0geVt0cmFpbl9pbmRleF0sIHlbdGVzdF9pbmRleF0KICAgIAogICAgbW9kZWwuZml0KFhfdHJhaW4sIHlfdHJhaW4pCiAgICBwcmVkaWN0aW9ucyA9IG1vZGVsLnByZWRpY3QoWF90ZXN0KQogICAgZXJyb3IgPSBtZWFuX3NxdWFyZWRfZXJyb3IoeV90ZXN0LCBwcmVkaWN0aW9ucykKICAgIGVycm9ycy5hcHBlbmQoZXJyb3IpCgpwcmludCgiRXJyb3JzIGVuIGNhZGEgZm9sZDoiLCBlcnJvcnMpCnByaW50KCJFcnJvciBtaXRqw6A6IiwgbnAubWVhbihlcnJvcnMpKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.model_selection import StratifiedKFold

# Dades d'exemple per a classificaci&oacute;
X = np.array([[1, 2], [3, 4], [5, 6], [7, 8], [9, 10]])
y = np.array([0, 1, 0, 1, 0])

# Configuraci&oacute; de Stratified K-Fold
skf = StratifiedKFold(n_splits=3)

# Llista per emmagatzemar els errors
errors = []

# Validaci&oacute; creuada
for train_index, test_index in skf.split(X, y):
    X_train, X_test = X[train_index], X[test_index]
    y_train, y_test = y[train_index], y[test_index]
    
    model.fit(X_train, y_train)
    predictions = model.predict(X_test)
    error = mean_squared_error(y_test, predictions)
    errors.append(error)

print(&quot;Errors en cada fold:&quot;, errors)
print(&quot;Error mitj&agrave;:&quot;, np.mean(errors))</pre></div><div class='content'></div><h1>Comparació de Mètodes</h1>
<div class='content'><p>| Mètode                  | Avantatges                                                                 | Desavantatges                                                              |
|-------------------------|--------------------------------------------------------------------------|--------------------------------------------------------------------------|
| K-Fold Cross-Validation | - Equilibri entre bias i variància<br>- Menor cost computacional que LOOCV | - Pot ser menys precís que LOOCV en petits conjunts de dades       |
| LOOCV                   | - Utilitza tota la informació disponible<br>- Menor bias                 | - Alt cost computacional<br>- Major variància en l'estimació de l'error|
| Stratified K-Fold       | - Millor representació de la distribució de classes                      | - Cost computacional similar a K-Fold                                   |</p>
</div><h1>Conclusió</h1>
<div class='content'><p>La validació creuada és una eina essencial per avaluar el rendiment dels models de Machine Learning. En utilitzar tècniques com K-Fold, LOOCV i Stratified K-Fold, els professionals poden obtenir estimacions més precises i robustes del rendiment del model, ajudant a prevenir problemes de sobreajustament i subajustament. L'elecció del mètode de validació creuada dependrà de la mida del conjunt de dades i del problema específic que s'estigui abordant.</p>
</div><div class='row navigation'><div class='col-6'><a href='metricas-evaluacion'>&#x25C4; Mètriques d'Avaluació</a></div><div class='col-6 text-end'><a href='curvas-roc-auc'>Corbes ROC i AUC &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
