<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Corbes ROC i AUC</title>

    <link rel="alternate" href="https://campusempresa.com/es/machine_learning/curvas-roc-auc" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/machine_learning/curvas-roc-auc" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/machine_learning/curvas-roc-auc" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/machine_learning/curvas-roc-auc" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En l'àmbit del Machine Learning, especialment en problemes de classificació, és crucial avaluar el rendiment dels nostres models. Dues eines fonamentals per a aquesta avaluació són les corbes ROC (Receiver Operating Characteristic) i l'AUC (Area Under the Curve). Aquest tema et proporcionarà una comprensió profunda d'aquests conceptes, com es calculen i com interpretar-los.</p>
</div><h1>Què és una Corba ROC?</h1>
<div class='content'><p>La corba ROC és una representació gràfica que il·lustra el rendiment d'un model de classificació binària. Mostra la relació entre la Taxa de Vertaders Positius (TPR) i la Taxa de Falsos Positius (FPR) a diferents llindars de classificació.</p>
<ul>
<li><strong>Taxa de Vertaders Positius (TPR)</strong>: També coneguda com a sensibilitat o recall, és la proporció de positius correctament identificats pel model.</li>
<li><strong>Taxa de Falsos Positius (FPR)</strong>: És la proporció de negatius incorrectament identificats com a positius.</li>
</ul>
</div><h2>Com es construeix una Corba ROC</h2>
<div class='content'><ol>
<li><strong>Calcular les prediccions del model</strong>: Obtenir les probabilitats de pertinença a la classe positiva per a cada instància.</li>
<li><strong>Establir diferents llindars</strong>: Variar el llindar de decisió des de 0 a 1.</li>
<li><strong>Calcular TPR i FPR</strong>: Per a cada llindar, calcular TPR i FPR.</li>
<li><strong>Gràficar la corba</strong>: Plotear TPR vs. FPR per a tots els llindars.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IG51bXB5IGFzIG5wCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCByb2NfY3VydmUKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKIyBFeGVtcGxlIGRlIHByZWRpY2Npb25zIGkgZXRpcXVldGVzIHZlcml0YWJsZXMKeV90cnVlID0gbnAuYXJyYXkoWzAsIDAsIDEsIDFdKQp5X3Njb3JlcyA9IG5wLmFycmF5KFswLjEsIDAuNCwgMC4zNSwgMC44XSkKCiMgQ2FsY3VsYXIgRlBSIGkgVFBSCmZwciwgdHByLCB0aHJlc2hvbGRzID0gcm9jX2N1cnZlKHlfdHJ1ZSwgeV9zY29yZXMpCgojIEdyw6BmaWNhciBsYSBjb3JiYSBST0MKcGx0LmZpZ3VyZSgpCnBsdC5wbG90KGZwciwgdHByLCBjb2xvcj0nZGFya29yYW5nZScsIGx3PTIsIGxhYmVsPSdDb3JiYSBST0MnKQpwbHQucGxvdChbMCwgMV0sIFswLCAxXSwgY29sb3I9J25hdnknLCBsdz0yLCBsaW5lc3R5bGU9Jy0tJykKcGx0LnhsYWJlbCgnVGF4YSBkZSBGYWxzb3MgUG9zaXRpdXMnKQpwbHQueWxhYmVsKCdUYXhhIGRlIFZlcnRhZGVycyBQb3NpdGl1cycpCnBsdC50aXRsZSgnQ29yYmEgUk9DJykKcGx0LmxlZ2VuZChsb2M9Imxvd2VyIHJpZ2h0IikKcGx0LnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import numpy as np
from sklearn.metrics import roc_curve
import matplotlib.pyplot as plt

# Exemple de prediccions i etiquetes veritables
y_true = np.array([0, 0, 1, 1])
y_scores = np.array([0.1, 0.4, 0.35, 0.8])

# Calcular FPR i TPR
fpr, tpr, thresholds = roc_curve(y_true, y_scores)

# Gr&agrave;ficar la corba ROC
plt.figure()
plt.plot(fpr, tpr, color='darkorange', lw=2, label='Corba ROC')
plt.plot([0, 1], [0, 1], color='navy', lw=2, linestyle='--')
plt.xlabel('Taxa de Falsos Positius')
plt.ylabel('Taxa de Vertaders Positius')
plt.title('Corba ROC')
plt.legend(loc=&quot;lower right&quot;)
plt.show()</pre></div><div class='content'></div><h1>Què és l'AUC?</h1>
<div class='content'><p>L'AUC (Area Under the Curve) és una mètrica que resumeix la corba ROC en un sol valor. Representa l'àrea sota la corba ROC i proporciona una mesura agregada del rendiment del model en tots els llindars possibles.</p>
<ul>
<li><strong>Interpretació de l'AUC</strong>:
<ul>
<li><strong>AUC = 1</strong>: El model classifica perfectament totes les instàncies.</li>
<li><strong>AUC = 0.5</strong>: El model no té capacitat de discriminació, equivalent a una classificació aleatòria.</li>
<li><strong>AUC &lt; 0.5</strong>: El model classifica pitjor que una classificació aleatòria.</li>
</ul>
</li>
</ul>
</div><h2>Càlcul de l'AUC</h2>
<div class='content'><p>L'AUC es pot calcular utilitzant biblioteques com <code>scikit-learn</code> en Python.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLm1ldHJpY3MgaW1wb3J0IHJvY19hdWNfc2NvcmUKCiMgQ2FsY3VsYXIgQVVDCmF1YyA9IHJvY19hdWNfc2NvcmUoeV90cnVlLCB5X3Njb3JlcykKcHJpbnQoZidBVUM6IHthdWN9Jyk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.metrics import roc_auc_score

# Calcular AUC
auc = roc_auc_score(y_true, y_scores)
print(f'AUC: {auc}')</pre></div><div class='content'></div><h1>Exemple Pràctic</h1>
<div class='content'><p>Aplicarem aquests conceptes en un exemple pràctic utilitzant un conjunt de dades de joguina.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZnJvbSBza2xlYXJuLmRhdGFzZXRzIGltcG9ydCBtYWtlX2NsYXNzaWZpY2F0aW9uCmZyb20gc2tsZWFybi5tb2RlbF9zZWxlY3Rpb24gaW1wb3J0IHRyYWluX3Rlc3Rfc3BsaXQKZnJvbSBza2xlYXJuLmxpbmVhcl9tb2RlbCBpbXBvcnQgTG9naXN0aWNSZWdyZXNzaW9uCmZyb20gc2tsZWFybi5tZXRyaWNzIGltcG9ydCByb2NfY3VydmUsIHJvY19hdWNfc2NvcmUKaW1wb3J0IG1hdHBsb3RsaWIucHlwbG90IGFzIHBsdAoKIyBHZW5lcmFyIHVuIGNvbmp1bnQgZGUgZGFkZXMgZGUgam9ndWluYQpYLCB5ID0gbWFrZV9jbGFzc2lmaWNhdGlvbihuX3NhbXBsZXM9MTAwMCwgbl9mZWF0dXJlcz0yMCwgcmFuZG9tX3N0YXRlPTQyKQoKIyBEaXZpZGlyIGVsIGNvbmp1bnQgZGUgZGFkZXMgZW4gZW50cmVuYW1lbnQgaSBwcm92YQpYX3RyYWluLCBYX3Rlc3QsIHlfdHJhaW4sIHlfdGVzdCA9IHRyYWluX3Rlc3Rfc3BsaXQoWCwgeSwgdGVzdF9zaXplPTAuMywgcmFuZG9tX3N0YXRlPTQyKQoKIyBFbnRyZW5hciB1biBtb2RlbCBkZSByZWdyZXNzacOzIGxvZ8Otc3RpY2EKbW9kZWwgPSBMb2dpc3RpY1JlZ3Jlc3Npb24oKQptb2RlbC5maXQoWF90cmFpbiwgeV90cmFpbikKCiMgT2J0ZW5pciBsZXMgcHJvYmFiaWxpdGF0cyBkZSBwcmVkaWNjacOzCnlfc2NvcmVzID0gbW9kZWwucHJlZGljdF9wcm9iYShYX3Rlc3QpWzosIDFdCgojIENhbGN1bGFyIEZQUiwgVFBSIGkgQVVDCmZwciwgdHByLCB0aHJlc2hvbGRzID0gcm9jX2N1cnZlKHlfdGVzdCwgeV9zY29yZXMpCmF1YyA9IHJvY19hdWNfc2NvcmUoeV90ZXN0LCB5X3Njb3JlcykKCiMgR3LDoGZpY2FyIGxhIGNvcmJhIFJPQwpwbHQuZmlndXJlKCkKcGx0LnBsb3QoZnByLCB0cHIsIGNvbG9yPSdkYXJrb3JhbmdlJywgbHc9MiwgbGFiZWw9ZidDb3JiYSBST0MgKEFVQyA9IHthdWM6LjJmfSknKQpwbHQucGxvdChbMCwgMV0sIFswLCAxXSwgY29sb3I9J25hdnknLCBsdz0yLCBsaW5lc3R5bGU9Jy0tJykKcGx0LnhsYWJlbCgnVGF4YSBkZSBGYWxzb3MgUG9zaXRpdXMnKQpwbHQueWxhYmVsKCdUYXhhIGRlIFZlcnRhZGVycyBQb3NpdGl1cycpCnBsdC50aXRsZSgnQ29yYmEgUk9DJykKcGx0LmxlZ2VuZChsb2M9Imxvd2VyIHJpZ2h0IikKcGx0LnNob3coKQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>from sklearn.datasets import make_classification
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import roc_curve, roc_auc_score
import matplotlib.pyplot as plt

# Generar un conjunt de dades de joguina
X, y = make_classification(n_samples=1000, n_features=20, random_state=42)

# Dividir el conjunt de dades en entrenament i prova
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.3, random_state=42)

# Entrenar un model de regressi&oacute; log&iacute;stica
model = LogisticRegression()
model.fit(X_train, y_train)

# Obtenir les probabilitats de predicci&oacute;
y_scores = model.predict_proba(X_test)[:, 1]

# Calcular FPR, TPR i AUC
fpr, tpr, thresholds = roc_curve(y_test, y_scores)
auc = roc_auc_score(y_test, y_scores)

# Gr&agrave;ficar la corba ROC
plt.figure()
plt.plot(fpr, tpr, color='darkorange', lw=2, label=f'Corba ROC (AUC = {auc:.2f})')
plt.plot([0, 1], [0, 1], color='navy', lw=2, linestyle='--')
plt.xlabel('Taxa de Falsos Positius')
plt.ylabel('Taxa de Vertaders Positius')
plt.title('Corba ROC')
plt.legend(loc=&quot;lower right&quot;)
plt.show()</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Les corbes ROC i l'AUC són eines essencials per avaluar el rendiment dels models de classificació binària. La corba ROC proporciona una visió detallada del rendiment del model en diferents llindars, mentre que l'AUC ofereix una mètrica resumida i fàcil d'interpretar. Comprendre i utilitzar aquestes eines et permetrà prendre decisions més informades sobre l'efectivitat dels teus models de Machine Learning.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
