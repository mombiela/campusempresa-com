<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 5: Integrant VBA amb Serveis Web</title>

    <link rel="alternate" href="https://campusempresa.com/es/vba/project-5-integrating-vba-with-web-services" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/vba/project-5-integrating-vba-with-web-services" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/vba/project-5-integrating-vba-with-web-services" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/vba/project-5-integrating-vba-with-web-services" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='project-4-building-a-dashboard'>&#x25C4;Projecte 4: Construcció d'un quadre de comandament</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Project 5: Integrant VBA amb Serveis Web</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vba-best-practices'>Millors pràctiques de VBA &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquest projecte, explorarem com integrar VBA (Visual Basic for Applications) amb serveis web. Aquest és un tema avançat que et permetrà ampliar les capacitats de les teves aplicacions VBA interactuant amb APIs en línia per obtenir o enviar dades. Al final d'aquest projecte, seràs capaç de:</p>
<ul>
<li>Entendre els conceptes bàsics dels serveis web i les APIs.</li>
<li>Fer sol·licituds HTTP des de VBA.</li>
<li>Analitzar respostes JSON.</li>
<li>Gestionar errors i excepcions en les trucades a serveis web.</li>
</ul>
</div><h1>Entenent els Serveis Web i les APIs</h1>
<div class='content'><p>Abans d'endinsar-nos en el codi, és important entendre què són els serveis web i les APIs.</p>
<ul>
<li><strong>Serveis Web</strong>: Aquests són serveis oferts per un dispositiu electrònic a un altre dispositiu electrònic, comunicant-se entre ells a través de la World Wide Web.</li>
<li><strong>API (Application Programming Interface)</strong>: Aquest és un conjunt de regles que permeten que una aplicació de programari interactuï amb una altra.</li>
</ul>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Mètodes HTTP</strong>: GET, POST, PUT, DELETE.</li>
<li><strong>Endpoints</strong>: URLs que proporcionen accés al servei web.</li>
<li><strong>Headers</strong>: Metadades enviades amb la sol·licitud.</li>
<li><strong>JSON (JavaScript Object Notation)</strong>: Un format lleuger d'intercanvi de dades.</li>
</ul>
</div><h1>Fent Sol·licituds HTTP des de VBA</h1>
<div class='content'><p>Per interactuar amb serveis web, necessitem fer sol·licituds HTTP. VBA no té suport integrat per a sol·licituds HTTP, així que utilitzarem l'objecte <code>MSXML2.XMLHTTP</code>.</p>
</div><h2>Exemple: Fent una Sol·licitud GET</h2>
<div class='content'><p>Aquí tens un exemple senzill de com fer una sol·licitud GET a un servei web que retorna dades JSON.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdldFJlcXVlc3RFeGFtcGxlKCkKICAgIERpbSBodHRwIEFzIE9iamVjdAogICAgRGltIHVybCBBcyBTdHJpbmcKICAgIERpbSByZXNwb25zZSBBcyBTdHJpbmcKICAgIAogICAgJyBDcmVhciBsJ29iamVjdGUgWE1MSFRUUAogICAgU2V0IGh0dHAgPSBDcmVhdGVPYmplY3QoIk1TWE1MMi5YTUxIVFRQIikKICAgIAogICAgJyBEZWZpbmlyIGxhIFVSTCBkZWwgc2VydmVpIHdlYgogICAgdXJsID0gImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEiCiAgICAKICAgICcgT2JyaXIgbGEgc29swrdsaWNpdHVkCiAgICBodHRwLk9wZW4gIkdFVCIsIHVybCwgRmFsc2UKICAgIAogICAgJyBFbnZpYXIgbGEgc29swrdsaWNpdHVkCiAgICBodHRwLlNlbmQKICAgIAogICAgJyBPYnRlbmlyIGVsIHRleHQgZGUgbGEgcmVzcG9zdGEKICAgIHJlc3BvbnNlID0gaHR0cC5yZXNwb25zZVRleHQKICAgIAogICAgJyBNb3N0cmFyIGxhIHJlc3Bvc3RhCiAgICBNc2dCb3ggcmVzcG9uc2UKRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GetRequestExample()
    Dim http As Object
    Dim url As String
    Dim response As String
    
    ' Crear l'objecte XMLHTTP
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Definir la URL del servei web
    url = &quot;https://api.example.com/data&quot;
    
    ' Obrir la sol&middot;licitud
    http.Open &quot;GET&quot;, url, False
    
    ' Enviar la sol&middot;licitud
    http.Send
    
    ' Obtenir el text de la resposta
    response = http.responseText
    
    ' Mostrar la resposta
    MsgBox response
End Sub</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>CreateObject(&quot;MSXML2.XMLHTTP&quot;)</strong>: Crea una instància de l'objecte XMLHTTP.</li>
<li><strong>http.Open &quot;GET&quot;, url, False</strong>: Inicialitza una sol·licitud GET a la URL especificada.</li>
<li><strong>http.Send</strong>: Envia la sol·licitud al servidor.</li>
<li><strong>http.responseText</strong>: Recupera la resposta del servidor.</li>
</ul>
</div><h1>Analitzant Respostes JSON</h1>
<div class='content'><p>Un cop rebem la resposta del servei web, sovint està en format JSON. Necessitem analitzar aquest JSON per extreure informació útil.</p>
</div><h2>Exemple: Analitzant JSON</h2>
<div class='content'><p>Utilitzarem la biblioteca <code>JsonConverter</code> per analitzar JSON en VBA. Pots descarregar aquesta biblioteca de GitHub i importar-la al teu projecte VBA.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFBhcnNlSnNvbkV4YW1wbGUoKQogICAgRGltIGh0dHAgQXMgT2JqZWN0CiAgICBEaW0gdXJsIEFzIFN0cmluZwogICAgRGltIHJlc3BvbnNlIEFzIFN0cmluZwogICAgRGltIGpzb24gQXMgT2JqZWN0CiAgICBEaW0gZGF0YSBBcyBPYmplY3QKICAgIAogICAgJyBDcmVhciBsJ29iamVjdGUgWE1MSFRUUAogICAgU2V0IGh0dHAgPSBDcmVhdGVPYmplY3QoIk1TWE1MMi5YTUxIVFRQIikKICAgIAogICAgJyBEZWZpbmlyIGxhIFVSTCBkZWwgc2VydmVpIHdlYgogICAgdXJsID0gImh0dHBzOi8vYXBpLmV4YW1wbGUuY29tL2RhdGEiCiAgICAKICAgICcgT2JyaXIgbGEgc29swrdsaWNpdHVkCiAgICBodHRwLk9wZW4gIkdFVCIsIHVybCwgRmFsc2UKICAgIAogICAgJyBFbnZpYXIgbGEgc29swrdsaWNpdHVkCiAgICBodHRwLlNlbmQKICAgIAogICAgJyBPYnRlbmlyIGVsIHRleHQgZGUgbGEgcmVzcG9zdGEKICAgIHJlc3BvbnNlID0gaHR0cC5yZXNwb25zZVRleHQKICAgIAogICAgJyBBbmFsaXR6YXIgbGEgcmVzcG9zdGEgSlNPTgogICAgU2V0IGpzb24gPSBKc29uQ29udmVydGVyLlBhcnNlSnNvbihyZXNwb25zZSkKICAgIAogICAgJyBBY2NlZGlyIGEgZGFkZXMgZGUgbCdvYmplY3RlIEpTT04KICAgIFNldCBkYXRhID0ganNvbigia2V5IikKICAgIAogICAgJyBNb3N0cmFyIGxlcyBkYWRlcwogICAgTXNnQm94IGRhdGEKRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ParseJsonExample()
    Dim http As Object
    Dim url As String
    Dim response As String
    Dim json As Object
    Dim data As Object
    
    ' Crear l'objecte XMLHTTP
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Definir la URL del servei web
    url = &quot;https://api.example.com/data&quot;
    
    ' Obrir la sol&middot;licitud
    http.Open &quot;GET&quot;, url, False
    
    ' Enviar la sol&middot;licitud
    http.Send
    
    ' Obtenir el text de la resposta
    response = http.responseText
    
    ' Analitzar la resposta JSON
    Set json = JsonConverter.ParseJson(response)
    
    ' Accedir a dades de l'objecte JSON
    Set data = json(&quot;key&quot;)
    
    ' Mostrar les dades
    MsgBox data
End Sub</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>JsonConverter.ParseJson(response)</strong>: Analitza la resposta JSON en un objecte VBA.</li>
<li><strong>json(&quot;key&quot;)</strong>: Accedeix a un valor específic de l'objecte JSON.</li>
</ul>
</div><h1>Gestionant Errors i Excepcions</h1>
<div class='content'><p>Quan treballes amb serveis web, és important gestionar els errors i excepcions de manera adequada.</p>
</div><h2>Exemple: Gestió d'Errors</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdldFJlcXVlc3RXaXRoRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgogICAgCiAgICBEaW0gaHR0cCBBcyBPYmplY3QKICAgIERpbSB1cmwgQXMgU3RyaW5nCiAgICBEaW0gcmVzcG9uc2UgQXMgU3RyaW5nCiAgICAKICAgICcgQ3JlYXIgbCdvYmplY3RlIFhNTEhUVFAKICAgIFNldCBodHRwID0gQ3JlYXRlT2JqZWN0KCJNU1hNTDIuWE1MSFRUUCIpCiAgICAKICAgICcgRGVmaW5pciBsYSBVUkwgZGVsIHNlcnZlaSB3ZWIKICAgIHVybCA9ICJodHRwczovL2FwaS5leGFtcGxlLmNvbS9kYXRhIgogICAgCiAgICAnIE9icmlyIGxhIHNvbMK3bGljaXR1ZAogICAgaHR0cC5PcGVuICJHRVQiLCB1cmwsIEZhbHNlCiAgICAKICAgICcgRW52aWFyIGxhIHNvbMK3bGljaXR1ZAogICAgaHR0cC5TZW5kCiAgICAKICAgICcgQ29tcHJvdmFyIGVycm9ycyBIVFRQCiAgICBJZiBodHRwLlN0YXR1cyA8PiAyMDAgVGhlbgogICAgICAgIEVyci5SYWlzZSB2Yk9iamVjdEVycm9yICsgMSwgIkdldFJlcXVlc3RXaXRoRXJyb3JIYW5kbGluZyIsICJMYSBzb2zCt2xpY2l0dWQgSFRUUCBoYSBmYWxsYXQgYW1iIGwnZXN0YXQgIiAmIGh0dHAuU3RhdHVzCiAgICBFbmQgSWYKICAgIAogICAgJyBPYnRlbmlyIGVsIHRleHQgZGUgbGEgcmVzcG9zdGEKICAgIHJlc3BvbnNlID0gaHR0cC5yZXNwb25zZVRleHQKICAgIAogICAgJyBNb3N0cmFyIGxhIHJlc3Bvc3RhCiAgICBNc2dCb3ggcmVzcG9uc2UKICAgIAogICAgRXhpdCBTdWIKICAgIApFcnJvckhhbmRsZXI6CiAgICBNc2dCb3ggIlMnaGEgcHJvZHXDr3QgdW4gZXJyb3I6ICIgJiBFcnIuRGVzY3JpcHRpb24KRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GetRequestWithErrorHandling()
    On Error GoTo ErrorHandler
    
    Dim http As Object
    Dim url As String
    Dim response As String
    
    ' Crear l'objecte XMLHTTP
    Set http = CreateObject(&quot;MSXML2.XMLHTTP&quot;)
    
    ' Definir la URL del servei web
    url = &quot;https://api.example.com/data&quot;
    
    ' Obrir la sol&middot;licitud
    http.Open &quot;GET&quot;, url, False
    
    ' Enviar la sol&middot;licitud
    http.Send
    
    ' Comprovar errors HTTP
    If http.Status &lt;&gt; 200 Then
        Err.Raise vbObjectError + 1, &quot;GetRequestWithErrorHandling&quot;, &quot;La sol&middot;licitud HTTP ha fallat amb l'estat &quot; &amp; http.Status
    End If
    
    ' Obtenir el text de la resposta
    response = http.responseText
    
    ' Mostrar la resposta
    MsgBox response
    
    Exit Sub
    
ErrorHandler:
    MsgBox &quot;S'ha produ&iuml;t un error: &quot; &amp; Err.Description
End Sub</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>On Error GoTo ErrorHandler</strong>: Dirigeix VBA a l'etiqueta ErrorHandler si es produeix un error.</li>
<li><strong>http.Status</strong>: Comprova el codi d'estat HTTP de la resposta.</li>
<li><strong>Err.Raise</strong>: Genera un error personalitzat si la sol·licitud HTTP falla.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Integrar VBA amb serveis web pot millorar significativament la funcionalitat de les teves aplicacions permetent-les interactuar amb APIs en línia. En aquest projecte, hem cobert:</p>
<ul>
<li>Els conceptes bàsics dels serveis web i les APIs.</li>
<li>Fer sol·licituds HTTP des de VBA.</li>
<li>Analitzar respostes JSON.</li>
<li>Gestionar errors i excepcions.</li>
</ul>
<p>Dominant aquestes tècniques, podràs crear aplicacions VBA potents que aprofitin la gran quantitat de dades i serveis disponibles a la web.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='project-4-building-a-dashboard'>&#x25C4;Projecte 4: Construcció d'un quadre de comandament</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Project 5: Integrant VBA amb Serveis Web</a>
	</div>
	<div class='col-4 text-end'>
					<a href='vba-best-practices'>Millors pràctiques de VBA &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
