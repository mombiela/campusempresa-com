<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestió d'Esdeveniments en Formularis d'Usuari</title>

    <link rel="alternate" href="https://campusempresa.com/es/vba/event-handling-in-user-forms" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/vba/event-handling-in-user-forms" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/vba/event-handling-in-user-forms" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/vba/event-handling-in-user-forms" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='adding-controls-to-user-forms'>&#x25C4;Afegint controls als formularis d'usuari</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Gestió d'Esdeveniments en Formularis d'Usuari</a>
	</div>
	<div class='col-4 text-end'>
					<a href='validating-user-input'>Validació de l'entrada de l'usuari &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La gestió d'esdeveniments és un aspecte crucial per crear formularis d'usuari interactius en VBA (Visual Basic for Applications). Aquest tema et guiarà des dels conceptes bàsics fins als avançats de la gestió d'esdeveniments en formularis d'usuari, proporcionant explicacions clares, exemples i exercicis per consolidar la teva comprensió.</p>
</div><h1>Introducció a la Gestió d'Esdeveniments</h1>
<div class='content'><p>La gestió d'esdeveniments en VBA et permet executar codi en resposta a accions de l'usuari, com ara fer clic en un botó, introduir text o canviar una selecció en un quadre combinat. Entendre com gestionar aquests esdeveniments és essencial per crear formularis d'usuari dinàmics i responsius.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Esdeveniment</strong>: Una acció o esdeveniment reconegut pel programari, com ara un clic de ratolí o una pressió de tecla.</li>
<li><strong>Gestor d'Esdeveniments</strong>: Un procediment o funció que s'executa en resposta a un esdeveniment.</li>
</ul>
</div><h1>Gestió Bàsica d'Esdeveniments</h1>
<div class='content'><p>Comencem amb alguns conceptes bàsics de gestió d'esdeveniments i exemples.</p>
</div><h2>Creació d'un Formulari d'Usuari Simple</h2>
<div class='content'><ol>
<li>Obre l'editor de VBA (Alt + F11).</li>
<li>Insereix un nou UserForm (Insert &gt; UserForm).</li>
<li>Afegeix un CommandButton al UserForm.</li>
</ol>
</div><h2>Gestió de l'Esdeveniment de Clic</h2>
<div class='content'><p>Per gestionar l'esdeveniment de clic del CommandButton:</p>
<ol>
<li>Fes doble clic al CommandButton per obrir la finestra de codi.</li>
<li>Veureu un procediment anomenat <code>CommandButton1_Click</code>. Aquest és el gestor d'esdeveniments per l'esdeveniment de clic.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgQ29tbWFuZEJ1dHRvbjFfQ2xpY2soKQogICAgTXNnQm94ICJCb3TDsyBDbGljYXQhIgpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub CommandButton1_Click()
    MsgBox &quot;Bot&oacute; Clicat!&quot;
End Sub</pre></div><div class='content'><p>Quan es faci clic al botó, apareixerà un quadre de missatge amb el text &quot;Botó Clicat!&quot;.</p>
</div><h2>Exercici: Gestió Bàsica d'Esdeveniments</h2>
<div class='content'><ul>
<li>Crea un UserForm amb un TextBox i un CommandButton.</li>
<li>Escriu un gestor d'esdeveniments per al CommandButton que mostri el text introduït al TextBox en un quadre de missatge.</li>
</ul>
</div><h1>Gestió Intermèdia d'Esdeveniments</h1>
<div class='content'><p>Ara que entens els conceptes bàsics, passem a escenaris més complexos.</p>
</div><h2>Gestió de Múltiples Esdeveniments</h2>
<div class='content'><p>Pots gestionar múltiples esdeveniments per a un sol control. Per exemple, podries voler gestionar tant els esdeveniments <code>Click</code> com <code>MouseMove</code> per a un CommandButton.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgQ29tbWFuZEJ1dHRvbjFfQ2xpY2soKQogICAgTXNnQm94ICJCb3TDsyBDbGljYXQhIgpFbmQgU3ViCgpQcml2YXRlIFN1YiBDb21tYW5kQnV0dG9uMV9Nb3VzZU1vdmUoQnlWYWwgQnV0dG9uIEFzIEludGVnZXIsIEJ5VmFsIFNoaWZ0IEFzIEludGVnZXIsIEJ5VmFsIFggQXMgU2luZ2xlLCBCeVZhbCBZIEFzIFNpbmdsZSkKICAgIENvbW1hbmRCdXR0b24xLkNhcHRpb24gPSAiUmF0b2zDrSBhIFNvYnJlIgpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub CommandButton1_Click()
    MsgBox &quot;Bot&oacute; Clicat!&quot;
End Sub

Private Sub CommandButton1_MouseMove(ByVal Button As Integer, ByVal Shift As Integer, ByVal X As Single, ByVal Y As Single)
    CommandButton1.Caption = &quot;Ratol&iacute; a Sobre&quot;
End Sub</pre></div><div class='content'></div><h2>Exercici: Gestió de Múltiples Esdeveniments</h2>
<div class='content'><ul>
<li>Crea un UserForm amb un CommandButton.</li>
<li>Escriu gestors d'esdeveniments tant per als esdeveniments <code>Click</code> com <code>MouseMove</code>.</li>
<li>Canvia la llegenda del botó a &quot;Clicat!&quot; quan es faci clic i a &quot;Ratolí a Sobre&quot; quan el ratolí estigui sobre el botó.</li>
</ul>
</div><h1>Gestió Avançada d'Esdeveniments</h1>
<div class='content'><p>En escenaris avançats, podries necessitar gestionar esdeveniments dinàmicament o crear gestors d'esdeveniments personalitzats.</p>
</div><h2>Gestió Dinàmica d'Esdeveniments</h2>
<div class='content'><p>Pots assignar gestors d'esdeveniments dinàmicament als controls en temps d'execució. Això és útil quan crees controls programàticament.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGltIFdpdGhFdmVudHMgRHluYW1pY0J1dHRvbiBBcyBNU0Zvcm1zLkNvbW1hbmRCdXR0b24KClByaXZhdGUgU3ViIFVzZXJGb3JtX0luaXRpYWxpemUoKQogICAgU2V0IER5bmFtaWNCdXR0b24gPSBNZS5Db250cm9scy5BZGQoIkZvcm1zLkNvbW1hbmRCdXR0b24uMSIsICJEeW5hbWljQnV0dG9uIikKICAgIER5bmFtaWNCdXR0b24uQ2FwdGlvbiA9ICJCb3TDsyBEaW7DoG1pYyIKICAgIER5bmFtaWNCdXR0b24uTGVmdCA9IDUwCiAgICBEeW5hbWljQnV0dG9uLlRvcCA9IDUwCkVuZCBTdWIKClByaXZhdGUgU3ViIER5bmFtaWNCdXR0b25fQ2xpY2soKQogICAgTXNnQm94ICJCb3TDsyBEaW7DoG1pYyBDbGljYXQhIgpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dim WithEvents DynamicButton As MSForms.CommandButton

Private Sub UserForm_Initialize()
    Set DynamicButton = Me.Controls.Add(&quot;Forms.CommandButton.1&quot;, &quot;DynamicButton&quot;)
    DynamicButton.Caption = &quot;Bot&oacute; Din&agrave;mic&quot;
    DynamicButton.Left = 50
    DynamicButton.Top = 50
End Sub

Private Sub DynamicButton_Click()
    MsgBox &quot;Bot&oacute; Din&agrave;mic Clicat!&quot;
End Sub</pre></div><div class='content'></div><h2>Exercici: Gestió Dinàmica d'Esdeveniments</h2>
<div class='content'><ul>
<li>Crea un UserForm.</li>
<li>Afegeix programàticament un CommandButton al UserForm.</li>
<li>Escriu un gestor d'esdeveniments per al CommandButton creat dinàmicament que mostri un quadre de missatge quan es faci clic.</li>
</ul>
</div><h1>Resum</h1>
<div class='content'><p>La gestió d'esdeveniments en VBA és una característica potent que et permet crear formularis d'usuari interactius i responsius. Entenent i utilitzant els gestors d'esdeveniments, pots executar codi en resposta a accions de l'usuari, fent que les teves aplicacions siguin més dinàmiques i fàcils d'usar.</p>
</div><h2>Punts Clau</h2>
<div class='content'><ul>
<li>Els esdeveniments són accions reconegudes pel programari, i els gestors d'esdeveniments són procediments que responen a aquests esdeveniments.</li>
<li>La gestió bàsica d'esdeveniments implica escriure procediments per a esdeveniments comuns com <code>Click</code>.</li>
<li>La gestió intermèdia d'esdeveniments pot implicar múltiples esdeveniments per a un sol control.</li>
<li>La gestió avançada d'esdeveniments inclou l'assignació dinàmica d'esdeveniments i gestors d'esdeveniments personalitzats.</li>
</ul>
<p>Dominant aquests conceptes, estaràs ben preparat per crear formularis d'usuari sofisticats en VBA.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='adding-controls-to-user-forms'>&#x25C4;Afegint controls als formularis d'usuari</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Gestió d'Esdeveniments en Formularis d'Usuari</a>
	</div>
	<div class='col-4 text-end'>
					<a href='validating-user-input'>Validació de l'entrada de l'usuari &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
