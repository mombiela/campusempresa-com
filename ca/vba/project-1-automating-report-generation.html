<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project 1: Automatització de la Generació d'Informes</title>

    <link rel="alternate" href="https://campusempresa.com/es/vba/project-1-automating-report-generation" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/vba/project-1-automating-report-generation" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/vba/project-1-automating-report-generation" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/vba/project-1-automating-report-generation" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='testing-and-quality-assurance'>&#x25C4;Proves i assegurament de la qualitat</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Project 1: Automatització de la Generació d'Informes</a>
	</div>
	<div class='col-4 text-end'>
					<a href='project-2-data-analysis-with-vba'>Projecte 2: Anàlisi de dades amb VBA &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció</h1>
<div class='content'><p>En aquest projecte, aprendrem a automatitzar la generació d'informes utilitzant VBA (Visual Basic for Applications). Aquest projecte està dissenyat per portar-te des d'un nivell principiant fins a un nivell avançat introduint gradualment conceptes i tècniques més complexes.</p>
</div><h1>Objectius</h1>
<div class='content'><p>Al final d'aquest projecte, seràs capaç de:</p>
<ul>
<li>Entendre els conceptes bàsics de VBA.</li>
<li>Aprendre a manipular objectes d'Excel utilitzant VBA.</li>
<li>Automatitzar el procés de generació d'informes.</li>
<li>Implementar tècniques de maneig d'errors i depuració.</li>
<li>Crear interfícies fàcils d'usar per a la generació d'informes.</li>
</ul>
</div><h1>Començant amb VBA</h1>
<h2>Què és VBA?</h2>
<div class='content'><ul>
<li>VBA significa Visual Basic for Applications.</li>
<li>És un llenguatge de programació desenvolupat per Microsoft.</li>
<li>VBA s'utilitza per automatitzar tasques en aplicacions de Microsoft Office com Excel, Word i Access.</li>
</ul>
</div><h2>Activant la Pestanya de Desenvolupador</h2>
<div class='content'><p>Per escriure codi VBA, necessites activar la pestanya de Desenvolupador a Excel:</p>
<ol>
<li>Ves a <code>Fitxer</code> &gt; <code>Opcions</code>.</li>
<li>Selecciona <code>Personalitza la Cinta</code>.</li>
<li>Marca l'opció <code>Desenvolupador</code> al panell de la dreta.</li>
<li>Fes clic a <code>D'acord</code>.</li>
</ol>
</div><h2>Escriure el Teu Primer Macro</h2>
<div class='content'><ol>
<li>Ves a la pestanya <code>Desenvolupador</code>.</li>
<li>Fes clic a <code>Visual Basic</code> per obrir l'editor de VBA.</li>
<li>Insereix un nou mòdul fent clic dret sobre qualsevol mòdul existent o el nom del llibre de treball, després selecciona <code>Inserir</code> &gt; <code>Mòdul</code>.</li>
<li>Escriu el següent codi:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEhlbGxvV29ybGQoKQogICAgTXNnQm94ICJIb2xhLCBNw7NuISIKRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub HelloWorld()
    MsgBox &quot;Hola, M&oacute;n!&quot;
End Sub</pre></div><div class='content'><ol start="5">
<li>Executa el macro prement <code>F5</code> o tornant a Excel i fent clic a <code>Macros</code> a la pestanya <code>Desenvolupador</code>, després seleccionant <code>HelloWorld</code> i fent clic a <code>Executar</code>.</li>
</ol>
</div><h1>Manipulant Objectes d'Excel</h1>
<h2>Entenent els Objectes d'Excel</h2>
<div class='content'><ul>
<li><strong>Llibre de treball</strong>: Tot el fitxer d'Excel.</li>
<li><strong>Full de càlcul</strong>: Un full individual dins del llibre de treball.</li>
<li><strong>Rang</strong>: Una cel·la o un grup de cel·les dins d'un full de càlcul.</li>
</ul>
</div><h2>Exemple: Escriure Dades en un Full de Càlcul</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFdyaXRlRGF0YSgpCiAgICBEaW0gd3MgQXMgV29ya3NoZWV0CiAgICBTZXQgd3MgPSBUaGlzV29ya2Jvb2suU2hlZXRzKCJGdWxsMSIpCiAgICAKICAgIHdzLlJhbmdlKCJBMSIpLlZhbHVlID0gIk5vbSIKICAgIHdzLlJhbmdlKCJCMSIpLlZhbHVlID0gIkVkYXQiCiAgICB3cy5SYW5nZSgiQTIiKS5WYWx1ZSA9ICJKb2huIERvZSIKICAgIHdzLlJhbmdlKCJCMiIpLlZhbHVlID0gMzAKRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub WriteData()
    Dim ws As Worksheet
    Set ws = ThisWorkbook.Sheets(&quot;Full1&quot;)
    
    ws.Range(&quot;A1&quot;).Value = &quot;Nom&quot;
    ws.Range(&quot;B1&quot;).Value = &quot;Edat&quot;
    ws.Range(&quot;A2&quot;).Value = &quot;John Doe&quot;
    ws.Range(&quot;B2&quot;).Value = 30
End Sub</pre></div><div class='content'></div><h2>Exemple: Llegir Dades d'un Full de Càlcul</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFJlYWREYXRhKCkKICAgIERpbSB3cyBBcyBXb3Jrc2hlZXQKICAgIERpbSBub20gQXMgU3RyaW5nCiAgICBEaW0gZWRhdCBBcyBJbnRlZ2VyCiAgICAKICAgIFNldCB3cyA9IFRoaXNXb3JrYm9vay5TaGVldHMoIkZ1bGwxIikKICAgIAogICAgbm9tID0gd3MuUmFuZ2UoIkEyIikuVmFsdWUKICAgIGVkYXQgPSB3cy5SYW5nZSgiQjIiKS5WYWx1ZQogICAgCiAgICBNc2dCb3ggIk5vbTogIiAmIG5vbSAmIHZiQ3JMZiAmICJFZGF0OiAiICYgZWRhdApFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub ReadData()
    Dim ws As Worksheet
    Dim nom As String
    Dim edat As Integer
    
    Set ws = ThisWorkbook.Sheets(&quot;Full1&quot;)
    
    nom = ws.Range(&quot;A2&quot;).Value
    edat = ws.Range(&quot;B2&quot;).Value
    
    MsgBox &quot;Nom: &quot; &amp; nom &amp; vbCrLf &amp; &quot;Edat: &quot; &amp; edat
End Sub</pre></div><div class='content'></div><h1>Automatització de la Generació d'Informes</h1>
<h2>Creant una Plantilla</h2>
<div class='content'><ol>
<li>Dissenya una plantilla a Excel amb espais reservats per a les dades.</li>
<li>Desa la plantilla com <code>PlantillaInforme.xlsx</code>.</li>
</ol>
</div><h2>Omplint la Plantilla amb Dades</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEdlbmVyYXRlUmVwb3J0KCkKICAgIERpbSB3c1RlbXBsYXRlIEFzIFdvcmtzaGVldAogICAgRGltIHdzRGF0YSBBcyBXb3Jrc2hlZXQKICAgIERpbSByZXBvcnQgQXMgV29ya2Jvb2sKICAgIERpbSBpIEFzIEludGVnZXIKICAgIAogICAgJyBPYnJlIGxhIHBsYW50aWxsYQogICAgU2V0IHJlcG9ydCA9IFdvcmtib29rcy5PcGVuKCJDOlxSdXRhXEFcUGxhbnRpbGxhSW5mb3JtZS54bHN4IikKICAgIFNldCB3c1RlbXBsYXRlID0gcmVwb3J0LlNoZWV0cygiUGxhbnRpbGxhIikKICAgIFNldCB3c0RhdGEgPSBUaGlzV29ya2Jvb2suU2hlZXRzKCJEYWRlcyIpCiAgICAKICAgICcgQnVjbGUgYSB0cmF2w6lzIGRlIGxlcyBkYWRlcyBpIG9tcGxlIGxhIHBsYW50aWxsYQogICAgRm9yIGkgPSAyIFRvIHdzRGF0YS5DZWxscyh3c0RhdGEuUm93cy5Db3VudCwgMSkuRW5kKHhsVXApLlJvdwogICAgICAgIHdzVGVtcGxhdGUuUmFuZ2UoIkEiICYgaSkuVmFsdWUgPSB3c0RhdGEuUmFuZ2UoIkEiICYgaSkuVmFsdWUKICAgICAgICB3c1RlbXBsYXRlLlJhbmdlKCJCIiAmIGkpLlZhbHVlID0gd3NEYXRhLlJhbmdlKCJCIiAmIGkpLlZhbHVlCiAgICBOZXh0IGkKICAgIAogICAgJyBEZXNhIGwnaW5mb3JtZQogICAgcmVwb3J0LlNhdmVBcyAiQzpcUnV0YVxBXEluZm9ybWVHZW5lcmF0Lnhsc3giCiAgICByZXBvcnQuQ2xvc2UKRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub GenerateReport()
    Dim wsTemplate As Worksheet
    Dim wsData As Worksheet
    Dim report As Workbook
    Dim i As Integer
    
    ' Obre la plantilla
    Set report = Workbooks.Open(&quot;C:\Ruta\A\PlantillaInforme.xlsx&quot;)
    Set wsTemplate = report.Sheets(&quot;Plantilla&quot;)
    Set wsData = ThisWorkbook.Sheets(&quot;Dades&quot;)
    
    ' Bucle a trav&eacute;s de les dades i omple la plantilla
    For i = 2 To wsData.Cells(wsData.Rows.Count, 1).End(xlUp).Row
        wsTemplate.Range(&quot;A&quot; &amp; i).Value = wsData.Range(&quot;A&quot; &amp; i).Value
        wsTemplate.Range(&quot;B&quot; &amp; i).Value = wsData.Range(&quot;B&quot; &amp; i).Value
    Next i
    
    ' Desa l'informe
    report.SaveAs &quot;C:\Ruta\A\InformeGenerat.xlsx&quot;
    report.Close
End Sub</pre></div><div class='content'></div><h1>Maneig d'Errors i Depuració</h1>
<h2>Maneig Bàsic d'Errors</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIFNhZmVHZW5lcmF0ZVJlcG9ydCgpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgogICAgCiAgICAnIEVsIHRldSBjb2RpIGFxdcOtCiAgICAKICAgIEV4aXQgU3ViCkVycm9ySGFuZGxlcjoKICAgIE1zZ0JveCAiUydoYSBwcm9kdcOvdCB1biBlcnJvcjogIiAmIEVyci5EZXNjcmlwdGlvbgpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub SafeGenerateReport()
    On Error GoTo ErrorHandler
    
    ' El teu codi aqu&iacute;
    
    Exit Sub
ErrorHandler:
    MsgBox &quot;S'ha produ&iuml;t un error: &quot; &amp; Err.Description
End Sub</pre></div><div class='content'></div><h2>Tècniques de Depuració</h2>
<div class='content'><ul>
<li>Utilitza <code>MsgBox</code> per mostrar valors de variables.</li>
<li>Utilitza la <code>Finestra Immediata</code> a l'editor de VBA per provar fragments de codi.</li>
<li>Estableix punts de ruptura fent clic al marge esquerre al costat de la línia de codi.</li>
</ul>
</div><h1>Creant Interfícies d'Usuari</h1>
<h2>Afegint un Botó per Executar el Macro</h2>
<div class='content'><ol>
<li>Ves a la pestanya <code>Desenvolupador</code>.</li>
<li>Fes clic a <code>Inserir</code> i selecciona un <code>Botó (Control de Formulari)</code>.</li>
<li>Dibuixa el botó al full de càlcul.</li>
<li>Assigna el macro <code>GenerateReport</code> al botó.</li>
</ol>
</div><h2>Exemple: Creant un Formulari d'Usuari</h2>
<div class='content'><ol>
<li>A l'editor de VBA, ves a <code>Inserir</code> &gt; <code>UserForm</code>.</li>
<li>Afegeix controls com caixes de text, etiquetes i botons al formulari.</li>
<li>Escriu codi per gestionar els esdeveniments del formulari, com els clics de botons.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("UHJpdmF0ZSBTdWIgYnRuR2VuZXJhdGVfQ2xpY2soKQogICAgJyBFbCB0ZXUgY29kaSBwZXIgZ2VuZXJhciBsJ2luZm9ybWUKICAgIE1zZ0JveCAiSW5mb3JtZSBHZW5lcmF0ISIKRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Private Sub btnGenerate_Click()
    ' El teu codi per generar l'informe
    MsgBox &quot;Informe Generat!&quot;
End Sub</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>En aquest projecte, hem cobert els conceptes bàsics de VBA, com manipular objectes d'Excel, i com automatitzar la generació d'informes. També hem tocat el maneig d'errors, la depuració i la creació d'interfícies d'usuari. En completar aquest projecte, hauríeu de tenir una base sòlida en VBA i ser capaç d'automatitzar diverses tasques a Excel.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='testing-and-quality-assurance'>&#x25C4;Proves i assegurament de la qualitat</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Project 1: Automatització de la Generació d'Informes</a>
	</div>
	<div class='col-4 text-end'>
					<a href='project-2-data-analysis-with-vba'>Projecte 2: Anàlisi de dades amb VBA &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
