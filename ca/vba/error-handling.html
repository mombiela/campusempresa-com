<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestió d'Errors en VBA</title>

    <link rel="alternate" href="https://campusempresa.com/es/vba/error-handling" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/vba/error-handling" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/vba/error-handling" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/vba/error-handling" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='scope-and-lifetime-of-variables'>&#x25C4;Abast i durada de les variables</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Gestió d'Errors en VBA</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-user-forms'>Introducció als formularis d'usuari &#x25BA;</a>
			</div>
</div>
<div class='content'><p>La gestió d'errors és un aspecte crucial de la programació que assegura que el teu codi pugui gestionar situacions inesperades de manera elegant. En VBA, la gestió d'errors et permet gestionar errors en temps d'execució de manera efectiva, proporcionant una millor experiència d'usuari i fent el teu codi més robust.</p>
</div><h1>Introducció a la Gestió d'Errors</h1>
<div class='content'><ul>
<li><strong>Definició</strong>: La gestió d'errors és el procés d'anticipar, detectar i resoldre errors de programació.</li>
<li><strong>Importància</strong>: Ajuda en la depuració, millora l'experiència d'usuari i assegura que el programa funcioni sense problemes fins i tot quan sorgeixen problemes inesperats.</li>
</ul>
</div><h1>Tècniques Bàsiques de Gestió d'Errors</h1>
<div class='content'></div><h2>Instrucció On Error</h2>
<div class='content'><p>La instrucció <code>On Error</code> és la base de la gestió d'errors en VBA. Dirigeix el programa sobre què fer quan es produeix un error.</p>
<ul>
<li>
<p><strong>Sintaxi</strong>:</p>
<pre><code class="language-vba">On Error GoTo [label]
On Error Resume Next
On Error GoTo 0
</code></pre>
</li>
<li>
<p><strong>Explicació</strong>:</p>
<ul>
<li><code>On Error GoTo [label]</code>: Transfereix el control a una etiqueta de línia especificada quan es produeix un error.</li>
<li><code>On Error Resume Next</code>: Continua l'execució amb la instrucció immediatament següent a la que va causar l'error.</li>
<li><code>On Error GoTo 0</code>: Desactiva qualsevol gestor d'errors habilitat en el procediment actual.</li>
</ul>
</li>
</ul>
</div><h2>Exemple: Gestió Bàsica d'Errors</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEJhc2ljRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgoKICAgIERpbSB4IEFzIEludGVnZXIKICAgIHggPSAxIC8gMCAgJyBBaXjDsiBjYXVzYXLDoCB1biBlcnJvciBkZSBkaXZpc2nDsyBwZXIgemVybwoKICAgIEV4aXQgU3ViCgpFcnJvckhhbmRsZXI6CiAgICBNc2dCb3ggIlMnaGEgcHJvZHXDr3QgdW4gZXJyb3I6ICIgJiBFcnIuRGVzY3JpcHRpb24KRW5kIFN1Yg=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub BasicErrorHandling()
    On Error GoTo ErrorHandler

    Dim x As Integer
    x = 1 / 0  ' Aix&ograve; causar&agrave; un error de divisi&oacute; per zero

    Exit Sub

ErrorHandler:
    MsgBox &quot;S'ha produ&iuml;t un error: &quot; &amp; Err.Description
End Sub</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li>La instrucció <code>On Error GoTo ErrorHandler</code> diu a VBA que salti a l'etiqueta <code>ErrorHandler</code> si es produeix un error.</li>
<li>La funció <code>MsgBox</code> mostra un quadre de missatge amb la descripció de l'error.</li>
</ul>
</li>
</ul>
</div><h1>Tècniques Avançades de Gestió d'Errors</h1>
<div class='content'></div><h2>Objecte Error</h2>
<div class='content'><p>L'objecte <code>Err</code> proporciona informació detallada sobre errors en temps d'execució.</p>
<ul>
<li><strong>Propietats</strong>:
<ul>
<li><code>Number</code>: El número de l'error.</li>
<li><code>Description</code>: Una descripció de l'error.</li>
<li><code>Source</code>: El nom de l'objecte o aplicació que va generar l'error.</li>
<li><code>HelpFile</code>: El camí al fitxer d'ajuda associat amb l'error.</li>
<li><code>HelpContext</code>: L'ID de context per a un tema en el fitxer d'ajuda.</li>
</ul>
</li>
</ul>
</div><h2>Exemple: Ús de l'Objecte Err</h2>
<div class='content'></div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEFkdmFuY2VkRXJyb3JIYW5kbGluZygpCiAgICBPbiBFcnJvciBHb1RvIEVycm9ySGFuZGxlcgoKICAgIERpbSB4IEFzIEludGVnZXIKICAgIHggPSAxIC8gMCAgJyBBaXjDsiBjYXVzYXLDoCB1biBlcnJvciBkZSBkaXZpc2nDsyBwZXIgemVybwoKICAgIEV4aXQgU3ViCgpFcnJvckhhbmRsZXI6CiAgICBNc2dCb3ggIk7Dum1lcm8gZCdlcnJvcjogIiAmIEVyci5OdW1iZXIgJiB2YkNyTGYgJiBfCiAgICAgICAgICAgIkRlc2NyaXBjacOzOiAiICYgRXJyLkRlc2NyaXB0aW9uICYgdmJDckxmICYgXwogICAgICAgICAgICJGb250OiAiICYgRXJyLlNvdXJjZQpFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub AdvancedErrorHandling()
    On Error GoTo ErrorHandler

    Dim x As Integer
    x = 1 / 0  ' Aix&ograve; causar&agrave; un error de divisi&oacute; per zero

    Exit Sub

ErrorHandler:
    MsgBox &quot;N&uacute;mero d'error: &quot; &amp; Err.Number &amp; vbCrLf &amp; _
           &quot;Descripci&oacute;: &quot; &amp; Err.Description &amp; vbCrLf &amp; _
           &quot;Font: &quot; &amp; Err.Source
End Sub</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li>L'objecte <code>Err</code> s'utilitza per recuperar i mostrar informació detallada sobre l'error.</li>
</ul>
</li>
</ul>
</div><h2>Gestió d'Errors Personalitzada</h2>
<div class='content'><p>Pots crear missatges d'error personalitzats i gestionar errors específics de manera diferent.</p>
<ul>
<li><strong>Exemple</strong>:</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("U3ViIEN1c3RvbUVycm9ySGFuZGxpbmcoKQogICAgT24gRXJyb3IgR29UbyBFcnJvckhhbmRsZXIKCiAgICBEaW0geCBBcyBJbnRlZ2VyCiAgICB4ID0gMSAvIDAgICcgQWl4w7IgY2F1c2Fyw6AgdW4gZXJyb3IgZGUgZGl2aXNpw7MgcGVyIHplcm8KCiAgICBFeGl0IFN1YgoKRXJyb3JIYW5kbGVyOgogICAgU2VsZWN0IENhc2UgRXJyLk51bWJlcgogICAgICAgIENhc2UgMTEgICcgRGl2aXNpw7MgcGVyIHplcm8KICAgICAgICAgICAgTXNnQm94ICJObyBlcyBwb3QgZGl2aWRpciBwZXIgemVyby4gU2kgdXMgcGxhdSwgY29tcHJvdmEgbGVzIHRldmVzIGVudHJhZGVzLiIKICAgICAgICBDYXNlIEVsc2UKICAgICAgICAgICAgTXNnQm94ICJTJ2hhIHByb2R1w690IHVuIGVycm9yIGluZXNwZXJhdDogIiAmIEVyci5EZXNjcmlwdGlvbgogICAgRW5kIFNlbGVjdApFbmQgU3Vi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Sub CustomErrorHandling()
    On Error GoTo ErrorHandler

    Dim x As Integer
    x = 1 / 0  ' Aix&ograve; causar&agrave; un error de divisi&oacute; per zero

    Exit Sub

ErrorHandler:
    Select Case Err.Number
        Case 11  ' Divisi&oacute; per zero
            MsgBox &quot;No es pot dividir per zero. Si us plau, comprova les teves entrades.&quot;
        Case Else
            MsgBox &quot;S'ha produ&iuml;t un error inesperat: &quot; &amp; Err.Description
    End Select
End Sub</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li>La instrucció <code>Select Case</code> s'utilitza per gestionar errors específics de manera diferent segons el número de l'error.</li>
</ul>
</li>
</ul>
</div><h1>Millors Pràctiques per a la Gestió d'Errors</h1>
<div class='content'><ul>
<li><strong>Utilitza Sempre la Gestió d'Errors</strong>: Assegura't que cada procediment tingui alguna forma de gestió d'errors.</li>
<li><strong>Neteja els Gestors d'Errors</strong>: Utilitza <code>On Error GoTo 0</code> per netejar els gestors d'errors quan ja no siguin necessaris.</li>
<li><strong>Proporciona Missatges Útils</strong>: Mostra missatges d'error significatius per ajudar els usuaris a entendre i resoldre problemes.</li>
<li><strong>Registra els Errors</strong>: Considera registrar els errors en un fitxer o base de dades per a una anàlisi posterior.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>La gestió d'errors en VBA és essencial per crear aplicacions robustes i fàcils d'utilitzar. Utilitzant la instrucció <code>On Error</code>, l'objecte <code>Err</code> i tècniques de gestió d'errors personalitzades, pots gestionar errors en temps d'execució de manera efectiva. Segueix sempre les millors pràctiques per assegurar que la teva gestió d'errors sigui eficient i informativa.</p>
<p>Dominant la gestió d'errors, pots millorar significativament la fiabilitat i mantenibilitat del teu codi VBA.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='scope-and-lifetime-of-variables'>&#x25C4;Abast i durada de les variables</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Gestió d'Errors en VBA</a>
	</div>
	<div class='col-4 text-end'>
					<a href='introduction-to-user-forms'>Introducció als formularis d'usuari &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
