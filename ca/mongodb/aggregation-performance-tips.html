<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consells per a Millorar el Rendiment de l'Agrupació</title>

    <link rel="alternate" href="https://campusempresa.com/es/mongodb/aggregation-performance-tips" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/mongodb/aggregation-performance-tips" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/mongodb/aggregation-performance-tips" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/mongodb/aggregation-performance-tips" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció</h1>
<div class='content'><p>Les operacions d'agrupació a MongoDB permeten processar registres de dades i retornar resultats calculats. Són essencials per a l'anàlisi de dades i la creació d'informes. No obstant això, a mesura que els teus conjunts de dades creixen, el rendiment pot convertir-se en una preocupació. Aquesta secció proporcionarà consells per optimitzar les teves canonades d'agrupació per obtenir un millor rendiment.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>Canonada d'Agrupació</strong>: Un marc per a l'agrupació de dades modelat en el concepte de canonades de processament de dades. Els documents entren en una canonada de múltiples etapes que transforma els documents en resultats agregats.</li>
<li><strong>Etapes</strong>: Cada etapa de la canonada realitza una operació sobre els documents d'entrada i passa els resultats a l'etapa següent.</li>
<li><strong>Índexs</strong>: Estructures de dades que milloren la velocitat de les operacions de recuperació de dades en una taula de base de dades a costa d'escriptures addicionals i espai d'emmagatzematge.</li>
</ul>
</div><h1>Consells per Optimitzar el Rendiment de l'Agrupació</h1>
<div class='content'></div><h2>1. Utilitza Índexs Sàviament</h2>
<div class='content'><p>Els índexs poden accelerar significativament el rendiment de les teves consultes d'agrupació.</p>
<ul>
<li><strong>Crea Índexs en Camps Utilitzats en <code>$match</code></strong>: L'etapa <code>$match</code> filtra documents per una condició especificada. Indexant els camps utilitzats en <code>$match</code>, MongoDB pot localitzar ràpidament els documents que compleixen els criteris.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gQ3JlYSB1biDDrW5kZXggZW4gZWwgY2FtcCAnc3RhdHVzJwpkYi5vcmRlcnMuY3JlYXRlSW5kZXgoeyBzdGF0dXM6IDEgfSk7CgovLyBDYW5vbmFkYSBkJ2FncnVwYWNpw7MgYW1iIGV0YXBhICRtYXRjaApkYi5vcmRlcnMuYWdncmVnYXRlKFsKICB7ICRtYXRjaDogeyBzdGF0dXM6ICJzaGlwcGVkIiB9IH0sCiAgeyAkZ3JvdXA6IHsgX2lkOiAiJGN1c3RvbWVySWQiLCB0b3RhbDogeyAkc3VtOiAiJGFtb3VudCIgfSB9IH0KXSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Crea un &iacute;ndex en el camp 'status'
db.orders.createIndex({ status: 1 });

// Canonada d'agrupaci&oacute; amb etapa $match
db.orders.aggregate([
  { $match: { status: &quot;shipped&quot; } },
  { $group: { _id: &quot;$customerId&quot;, total: { $sum: &quot;$amount&quot; } } }
]);</pre></div><div class='content'></div><h2>2. Col·loca `$match` i `$sort` Primer en la Canonada</h2>
<div class='content'><p>Filtrar i ordenar primer en la canonada redueix el nombre de documents que necessiten ser processats en etapes posteriors.</p>
<ul>
<li><strong>Exemple</strong>: Col·loca <code>$match</code> abans de <code>$group</code> per filtrar documents innecessaris primer.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIub3JkZXJzLmFnZ3JlZ2F0ZShbCiAgeyAkbWF0Y2g6IHsgc3RhdHVzOiAic2hpcHBlZCIgfSB9LAogIHsgJGdyb3VwOiB7IF9pZDogIiRjdXN0b21lcklkIiwgdG90YWw6IHsgJHN1bTogIiRhbW91bnQiIH0gfSB9LAogIHsgJHNvcnQ6IHsgdG90YWw6IC0xIH0gfQpdKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.orders.aggregate([
  { $match: { status: &quot;shipped&quot; } },
  { $group: { _id: &quot;$customerId&quot;, total: { $sum: &quot;$amount&quot; } } },
  { $sort: { total: -1 } }
]);</pre></div><div class='content'></div><h2>3. Limita el Nombre de Documents Processats</h2>
<div class='content'><p>Utilitza l'etapa <code>$limit</code> per restringir el nombre de documents que passen per la canonada.</p>
<ul>
<li><strong>Exemple</strong>: Limita els resultats als 10 millors clients per import total.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIub3JkZXJzLmFnZ3JlZ2F0ZShbCiAgeyAkbWF0Y2g6IHsgc3RhdHVzOiAic2hpcHBlZCIgfSB9LAogIHsgJGdyb3VwOiB7IF9pZDogIiRjdXN0b21lcklkIiwgdG90YWw6IHsgJHN1bTogIiRhbW91bnQiIH0gfSB9LAogIHsgJHNvcnQ6IHsgdG90YWw6IC0xIH0gfSwKICB7ICRsaW1pdDogMTAgfQpdKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.orders.aggregate([
  { $match: { status: &quot;shipped&quot; } },
  { $group: { _id: &quot;$customerId&quot;, total: { $sum: &quot;$amount&quot; } } },
  { $sort: { total: -1 } },
  { $limit: 10 }
]);</pre></div><div class='content'></div><h2>4. Optimitza l'Etapa `$group`</h2>
<div class='content'><p>L'etapa <code>$group</code> pot ser intensiva en recursos. Assegura't que estàs agrupant en camps indexats i evita càlculs innecessaris.</p>
<ul>
<li><strong>Exemple</strong>: Agrupa per un camp indexat i calcula la suma.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIub3JkZXJzLmFnZ3JlZ2F0ZShbCiAgeyAkbWF0Y2g6IHsgc3RhdHVzOiAic2hpcHBlZCIgfSB9LAogIHsgJGdyb3VwOiB7IF9pZDogIiRjdXN0b21lcklkIiwgdG90YWw6IHsgJHN1bTogIiRhbW91bnQiIH0gfSB9Cl0pOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.orders.aggregate([
  { $match: { status: &quot;shipped&quot; } },
  { $group: { _id: &quot;$customerId&quot;, total: { $sum: &quot;$amount&quot; } } }
]);</pre></div><div class='content'></div><h2>5. Utilitza la Projecció per Incloure Només els Camps Necessaris</h2>
<div class='content'><p>L'etapa <code>$project</code> es pot utilitzar per incloure només els camps que necessites, reduint la quantitat de dades processades.</p>
<ul>
<li><strong>Exemple</strong>: Projecció només dels camps <code>customerId</code> i <code>amount</code>.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIub3JkZXJzLmFnZ3JlZ2F0ZShbCiAgeyAkbWF0Y2g6IHsgc3RhdHVzOiAic2hpcHBlZCIgfSB9LAogIHsgJHByb2plY3Q6IHsgY3VzdG9tZXJJZDogMSwgYW1vdW50OiAxIH0gfSwKICB7ICRncm91cDogeyBfaWQ6ICIkY3VzdG9tZXJJZCIsIHRvdGFsOiB7ICRzdW06ICIkYW1vdW50IiB9IH0gfQpdKTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.orders.aggregate([
  { $match: { status: &quot;shipped&quot; } },
  { $project: { customerId: 1, amount: 1 } },
  { $group: { _id: &quot;$customerId&quot;, total: { $sum: &quot;$amount&quot; } } }
]);</pre></div><div class='content'></div><h2>6. Utilitza `$facet` per a l'Agrupació Multifacètica</h2>
<div class='content'><p>L'etapa <code>$facet</code> et permet realitzar múltiples agrupacions en paral·lel i és útil per a consultes complexes.</p>
<ul>
<li><strong>Exemple</strong>: Realitza múltiples agrupacions en paral·lel.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGIub3JkZXJzLmFnZ3JlZ2F0ZShbCiAgeyAkZmFjZXQ6IHsKICAgICAgInRvdGFsQW1vdW50IjogWwogICAgICAgIHsgJGdyb3VwOiB7IF9pZDogbnVsbCwgdG90YWw6IHsgJHN1bTogIiRhbW91bnQiIH0gfSB9CiAgICAgIF0sCiAgICAgICJhdmVyYWdlQW1vdW50IjogWwogICAgICAgIHsgJGdyb3VwOiB7IF9pZDogbnVsbCwgYXZlcmFnZTogeyAkYXZnOiAiJGFtb3VudCIgfSB9IH0KICAgICAgXQogICAgfQogIH0KXSk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>db.orders.aggregate([
  { $facet: {
      &quot;totalAmount&quot;: [
        { $group: { _id: null, total: { $sum: &quot;$amount&quot; } } }
      ],
      &quot;averageAmount&quot;: [
        { $group: { _id: null, average: { $avg: &quot;$amount&quot; } } }
      ]
    }
  }
]);</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Optimitzar el rendiment de l'agrupació a MongoDB implica una combinació d'utilitzar índexs, ordenar les etapes de manera efectiva, limitar els documents processats i utilitzar la projecció per minimitzar les dades. Seguint aquests consells, pots assegurar-te que les teves canonades d'agrupació funcionin eficientment, fins i tot a mesura que els teus conjunts de dades creixen. Recorda sempre analitzar i monitoritzar les teves consultes per identificar i abordar colls d'ampolla de rendiment.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
