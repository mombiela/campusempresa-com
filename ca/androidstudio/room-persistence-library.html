<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca de Persistència Room</title>

    <link rel="alternate" href="https://campusempresa.com/es/androidstudio/room-persistence-library" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/androidstudio/room-persistence-library" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/androidstudio/room-persistence-library" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/androidstudio/room-persistence-library" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Introducció a Room</h1>
<div class='content'><p>La Biblioteca de Persistència Room forma part del conjunt Jetpack d'Android i proporciona una capa d'abstracció sobre SQLite per permetre un accés més robust a la base de dades mentre es fa ús de tot el potencial de SQLite. Room simplifica el treball amb bases de dades i elimina el codi redundant.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Entitat</strong>: Representa una taula dins de la base de dades.</li>
<li><strong>DAO (Data Access Object)</strong>: Conté els mètodes utilitzats per accedir a la base de dades.</li>
<li><strong>Base de dades</strong>: El punt principal d'accés a la connexió subjacent amb les dades persistents de l'aplicació.</li>
</ul>
</div><h1>Configuració de Room</h1>
<div class='content'><p>Per utilitzar Room en el teu projecte d'Android, has d'afegir les dependències necessàries al teu fitxer <code>build.gradle</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzIHsKICAgIGltcGxlbWVudGF0aW9uICJhbmRyb2lkeC5yb29tOnJvb20tcnVudGltZToyLjMuMCIKICAgIGFubm90YXRpb25Qcm9jZXNzb3IgImFuZHJvaWR4LnJvb206cm9vbS1jb21waWxlcjoyLjMuMCIKICAgIC8vIFBlciBhIEtvdGxpbiB1dGlsaXR6YSBrYXB0IGVuIGxsb2MgZCdhbm5vdGF0aW9uUHJvY2Vzc29yCiAgICBrYXB0ICJhbmRyb2lkeC5yb29tOnJvb20tY29tcGlsZXI6Mi4zLjAiCn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies {
    implementation &quot;androidx.room:room-runtime:2.3.0&quot;
    annotationProcessor &quot;androidx.room:room-compiler:2.3.0&quot;
    // Per a Kotlin utilitza kapt en lloc d'annotationProcessor
    kapt &quot;androidx.room:room-compiler:2.3.0&quot;
}</pre></div><div class='content'></div><h1>Creació d'una Entitat</h1>
<div class='content'><p>Una entitat representa una taula dins de la base de dades. Cada camp de l'entitat correspon a una columna de la taula.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LnJvb20uRW50aXR5OwppbXBvcnQgYW5kcm9pZHgucm9vbS5QcmltYXJ5S2V5OwoKQEVudGl0eSh0YWJsZU5hbWUgPSAidXNlcnMiKQpwdWJsaWMgY2xhc3MgVXNlciB7CiAgICBAUHJpbWFyeUtleShhdXRvR2VuZXJhdGUgPSB0cnVlKQogICAgcHVibGljIGludCBpZDsKCiAgICBwdWJsaWMgU3RyaW5nIGZpcnN0TmFtZTsKICAgIHB1YmxpYyBTdHJpbmcgbGFzdE5hbWU7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.room.Entity;
import androidx.room.PrimaryKey;

@Entity(tableName = &quot;users&quot;)
public class User {
    @PrimaryKey(autoGenerate = true)
    public int id;

    public String firstName;
    public String lastName;
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>@Entity</code>: Marca la classe com una entitat i proporciona el nom de la taula.</li>
<li><code>@PrimaryKey</code>: Marca el camp com la clau primària. <code>autoGenerate = true</code> significa que l'ID es generarà automàticament.</li>
</ul>
</div><h1>Creació d'un DAO</h1>
<div class='content'><p>El DAO (Data Access Object) és on defineixes els mètodes per accedir a la base de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LnJvb20uRGFvOwppbXBvcnQgYW5kcm9pZHgucm9vbS5JbnNlcnQ7CmltcG9ydCBhbmRyb2lkeC5yb29tLlF1ZXJ5OwoKaW1wb3J0IGphdmEudXRpbC5MaXN0OwoKQERhbwpwdWJsaWMgaW50ZXJmYWNlIFVzZXJEYW8gewogICAgQEluc2VydAogICAgdm9pZCBpbnNlcnQoVXNlciB1c2VyKTsKCiAgICBAUXVlcnkoIlNFTEVDVCAqIEZST00gdXNlcnMiKQogICAgTGlzdDxVc2VyPiBnZXRBbGxVc2VycygpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.room.Dao;
import androidx.room.Insert;
import androidx.room.Query;

import java.util.List;

@Dao
public interface UserDao {
    @Insert
    void insert(User user);

    @Query(&quot;SELECT * FROM users&quot;)
    List&lt;User&gt; getAllUsers();
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>@Dao</code>: Marca la interfície com un DAO.</li>
<li><code>@Insert</code>: Marca el mètode com una operació d'inserció.</li>
<li><code>@Query</code>: Marca el mètode com una operació de consulta. La consulta SQL es proporciona com una cadena.</li>
</ul>
</div><h1>Creació de la Base de Dades</h1>
<div class='content'><p>La classe de la base de dades proporciona el punt principal d'accés a les dades persistents.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LnJvb20uRGF0YWJhc2U7CmltcG9ydCBhbmRyb2lkeC5yb29tLlJvb21EYXRhYmFzZTsKCkBEYXRhYmFzZShlbnRpdGllcyA9IHtVc2VyLmNsYXNzfSwgdmVyc2lvbiA9IDEpCnB1YmxpYyBhYnN0cmFjdCBjbGFzcyBBcHBEYXRhYmFzZSBleHRlbmRzIFJvb21EYXRhYmFzZSB7CiAgICBwdWJsaWMgYWJzdHJhY3QgVXNlckRhbyB1c2VyRGFvKCk7Cn0="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.room.Database;
import androidx.room.RoomDatabase;

@Database(entities = {User.class}, version = 1)
public abstract class AppDatabase extends RoomDatabase {
    public abstract UserDao userDao();
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>@Database</code>: Marca la classe com una base de dades Room. L'atribut <code>entities</code> llista totes les entitats associades amb la base de dades.</li>
<li><code>RoomDatabase</code>: La classe base per a les bases de dades Room. Proporciona els DAOs definits a la base de dades.</li>
</ul>
</div><h1>Ús de Room a la Teva Aplicació</h1>
<div class='content'><p>Per utilitzar Room, has de crear una instància de la base de dades i utilitzar el DAO per realitzar operacions a la base de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWQuY29udGVudC5Db250ZXh0OwppbXBvcnQgYW5kcm9pZHgucm9vbS5Sb29tOwoKcHVibGljIGNsYXNzIE15QXBwIHsKICAgIHByaXZhdGUgQXBwRGF0YWJhc2UgZGI7CgogICAgcHVibGljIE15QXBwKENvbnRleHQgY29udGV4dCkgewogICAgICAgIGRiID0gUm9vbS5kYXRhYmFzZUJ1aWxkZXIoY29udGV4dCwgQXBwRGF0YWJhc2UuY2xhc3MsICJteS1kYXRhYmFzZSIpLmJ1aWxkKCk7CiAgICB9CgogICAgcHVibGljIHZvaWQgYWRkVXNlcihVc2VyIHVzZXIpIHsKICAgICAgICBkYi51c2VyRGFvKCkuaW5zZXJ0KHVzZXIpOwogICAgfQoKICAgIHB1YmxpYyBMaXN0PFVzZXI+IGdldEFsbFVzZXJzKCkgewogICAgICAgIHJldHVybiBkYi51c2VyRGFvKCkuZ2V0QWxsVXNlcnMoKTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import android.content.Context;
import androidx.room.Room;

public class MyApp {
    private AppDatabase db;

    public MyApp(Context context) {
        db = Room.databaseBuilder(context, AppDatabase.class, &quot;my-database&quot;).build();
    }

    public void addUser(User user) {
        db.userDao().insert(user);
    }

    public List&lt;User&gt; getAllUsers() {
        return db.userDao().getAllUsers();
    }
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>Room.databaseBuilder</code>: Crea una instància de la base de dades Room.</li>
<li><code>db.userDao()</code>: Accedeix al DAO per realitzar operacions a la base de dades.</li>
</ul>
</div><h1>Temes Avançats</h1>
<h2>Migracions</h2>
<div class='content'><p>Quan necessites canviar l'esquema de la base de dades, has de proporcionar una estratègia de migració.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LnJvb20ubWlncmF0aW9uLk1pZ3JhdGlvbjsKaW1wb3J0IGFuZHJvaWR4LnNxbGl0ZS5kYi5TdXBwb3J0U1FMaXRlRGF0YWJhc2U7CgpNaWdyYXRpb24gTUlHUkFUSU9OXzFfMiA9IG5ldyBNaWdyYXRpb24oMSwgMikgewogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgdm9pZCBtaWdyYXRlKFN1cHBvcnRTUUxpdGVEYXRhYmFzZSBkYXRhYmFzZSkgewogICAgICAgIGRhdGFiYXNlLmV4ZWNTUUwoIkFMVEVSIFRBQkxFIHVzZXJzIEFERCBDT0xVTU4gYWdlIElOVEVHRVIiKTsKICAgIH0KfTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.room.migration.Migration;
import androidx.sqlite.db.SupportSQLiteDatabase;

Migration MIGRATION_1_2 = new Migration(1, 2) {
    @Override
    public void migrate(SupportSQLiteDatabase database) {
        database.execSQL(&quot;ALTER TABLE users ADD COLUMN age INTEGER&quot;);
    }
};</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>Migration</code>: Defineix una migració d'una versió a una altra.</li>
<li><code>migrate()</code>: Conté les instruccions SQL per migrar la base de dades.</li>
</ul>
</div><h2>Ús de LiveData amb Room</h2>
<div class='content'><p>Room suporta retornar objectes LiveData des dels mètodes del DAO, cosa que et permet observar els canvis a la base de dades.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LmxpZmVjeWNsZS5MaXZlRGF0YTsKCkBEYW8KcHVibGljIGludGVyZmFjZSBVc2VyRGFvIHsKICAgIEBRdWVyeSgiU0VMRUNUICogRlJPTSB1c2VycyIpCiAgICBMaXZlRGF0YTxMaXN0PFVzZXI+PiBnZXRBbGxVc2VycygpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.lifecycle.LiveData;

@Dao
public interface UserDao {
    @Query(&quot;SELECT * FROM users&quot;)
    LiveData&lt;List&lt;User&gt;&gt; getAllUsers();
}</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>LiveData</code>: Un contenidor de dades conscient del cicle de vida que et permet observar els canvis.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>La Biblioteca de Persistència Room simplifica la gestió de bases de dades en aplicacions Android proporcionant una capa d'abstracció robusta sobre SQLite. Entenent les entitats, els DAOs i la classe de la base de dades, pots gestionar eficientment les dades de la teva aplicació. Les característiques avançades com les migracions i la integració amb LiveData milloren encara més les capacitats de Room, fent-la una eina poderosa per als desenvolupadors d'Android.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
