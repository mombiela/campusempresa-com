<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introducció a les Tasques en Segon Pla</title>

    <link rel="alternate" href="https://campusempresa.com/es/androidstudio/introduction-to-background-tasks" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/androidstudio/introduction-to-background-tasks" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/androidstudio/introduction-to-background-tasks" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/androidstudio/introduction-to-background-tasks" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>En aquesta secció, explorarem el concepte de les tasques en segon pla en el desenvolupament d'Android. Les tasques en segon pla són essencials per realitzar operacions que no haurien de bloquejar el fil principal de la interfície d'usuari, assegurant una experiència d'usuari fluida.</p>
</div><h1>Què són les Tasques en Segon Pla?</h1>
<div class='content'><p>Les tasques en segon pla són operacions que s'executen fora del fil principal de la interfície d'usuari. S'utilitzen per a tasques que:</p>
<ul>
<li>Triguen molt de temps a completar-se (per exemple, descarregar un fitxer).</li>
<li>Necessiten ser realitzades periòdicament (per exemple, sincronitzar dades amb un servidor).</li>
<li>Haurien de continuar executant-se fins i tot quan l'usuari no està interactuant amb l'aplicació (per exemple, reproducció de música en segon pla).</li>
</ul>
</div><h1>Importància de les Tasques en Segon Pla</h1>
<div class='content'><ul>
<li><strong>Millora de l'Experiència d'Usuari</strong>: Descarregant les tasques de llarga durada al segon pla, el fil principal de la interfície d'usuari roman responsiu.</li>
<li><strong>Gestió de Recursos</strong>: Gestionar eficientment els recursos del sistema programant tasques durant els temps d'inactivitat.</li>
<li><strong>Eficiència de la Bateria</strong>: Les tasques en segon pla ben gestionades poden ajudar a conservar la vida de la bateria.</li>
</ul>
</div><h1>Mètodes Comuns per Implementar Tasques en Segon Pla</h1>
<div class='content'></div><h2>AsyncTask (Desaprovat)</h2>
<div class='content'><p><code>AsyncTask</code> era una manera popular de realitzar operacions en segon pla abans de ser desaprovat en Android 11. Permetia l'execució fàcil de tasques en segon pla amb callbacks al fil principal.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHJpdmF0ZSBjbGFzcyBEb3dubG9hZFRhc2sgZXh0ZW5kcyBBc3luY1Rhc2s8U3RyaW5nLCBWb2lkLCBTdHJpbmc+IHsKICAgIEBPdmVycmlkZQogICAgcHJvdGVjdGVkIFN0cmluZyBkb0luQmFja2dyb3VuZChTdHJpbmcuLi4gdXJscykgewogICAgICAgIC8vIFJlYWxpdHphciBvcGVyYWNpw7MgZW4gc2Vnb24gcGxhCiAgICAgICAgcmV0dXJuIGRvd25sb2FkRmlsZSh1cmxzWzBdKTsKICAgIH0KCiAgICBAT3ZlcnJpZGUKICAgIHByb3RlY3RlZCB2b2lkIG9uUG9zdEV4ZWN1dGUoU3RyaW5nIHJlc3VsdCkgewogICAgICAgIC8vIEFjdHVhbGl0emFyIGxhIGludGVyZsOtY2llIGQndXN1YXJpIGFtYiBlbCByZXN1bHRhdAogICAgICAgIHRleHRWaWV3LnNldFRleHQocmVzdWx0KTsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>private class DownloadTask extends AsyncTask&lt;String, Void, String&gt; {
    @Override
    protected String doInBackground(String... urls) {
        // Realitzar operaci&oacute; en segon pla
        return downloadFile(urls[0]);
    }

    @Override
    protected void onPostExecute(String result) {
        // Actualitzar la interf&iacute;cie d'usuari amb el resultat
        textView.setText(result);
    }
}</pre></div><div class='content'></div><h2>HandlerThread</h2>
<div class='content'><p><code>HandlerThread</code> és una manera senzilla de crear un fil en segon pla amb un <code>Looper</code> i <code>Handler</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("SGFuZGxlclRocmVhZCBoYW5kbGVyVGhyZWFkID0gbmV3IEhhbmRsZXJUaHJlYWQoIkJhY2tncm91bmRUaHJlYWQiKTsKaGFuZGxlclRocmVhZC5zdGFydCgpOwpIYW5kbGVyIGhhbmRsZXIgPSBuZXcgSGFuZGxlcihoYW5kbGVyVGhyZWFkLmdldExvb3BlcigpKTsKCmhhbmRsZXIucG9zdChuZXcgUnVubmFibGUoKSB7CiAgICBAT3ZlcnJpZGUKICAgIHB1YmxpYyB2b2lkIHJ1bigpIHsKICAgICAgICAvLyBSZWFsaXR6YXIgb3BlcmFjacOzIGVuIHNlZ29uIHBsYQogICAgfQp9KTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>HandlerThread handlerThread = new HandlerThread(&quot;BackgroundThread&quot;);
handlerThread.start();
Handler handler = new Handler(handlerThread.getLooper());

handler.post(new Runnable() {
    @Override
    public void run() {
        // Realitzar operaci&oacute; en segon pla
    }
});</pre></div><div class='content'></div><h2>WorkManager</h2>
<div class='content'><p><code>WorkManager</code> és la solució recomanada per a tasques en segon pla que necessiten una execució garantida. És adequat per a tasques que es poden ajornar i que requereixen una execució garantida, com ara sincronitzacions de dades periòdiques.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15V29ya2VyIGV4dGVuZHMgV29ya2VyIHsKICAgIHB1YmxpYyBNeVdvcmtlcihATm9uTnVsbCBDb250ZXh0IGNvbnRleHQsIEBOb25OdWxsIFdvcmtlclBhcmFtZXRlcnMgcGFyYW1zKSB7CiAgICAgICAgc3VwZXIoY29udGV4dCwgcGFyYW1zKTsKICAgIH0KCiAgICBATm9uTnVsbAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgUmVzdWx0IGRvV29yaygpIHsKICAgICAgICAvLyBSZWFsaXR6YXIgb3BlcmFjacOzIGVuIHNlZ29uIHBsYQogICAgICAgIHJldHVybiBSZXN1bHQuc3VjY2VzcygpOwogICAgfQp9CgovLyBFbnF1ZXVlIHRoZSB3b3JrCldvcmtNYW5hZ2VyIHdvcmtNYW5hZ2VyID0gV29ya01hbmFnZXIuZ2V0SW5zdGFuY2UoY29udGV4dCk7Ck9uZVRpbWVXb3JrUmVxdWVzdCB3b3JrUmVxdWVzdCA9IG5ldyBPbmVUaW1lV29ya1JlcXVlc3QuQnVpbGRlcihNeVdvcmtlci5jbGFzcykuYnVpbGQoKTsKd29ya01hbmFnZXIuZW5xdWV1ZSh3b3JrUmVxdWVzdCk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyWorker extends Worker {
    public MyWorker(@NonNull Context context, @NonNull WorkerParameters params) {
        super(context, params);
    }

    @NonNull
    @Override
    public Result doWork() {
        // Realitzar operaci&oacute; en segon pla
        return Result.success();
    }
}

// Enqueue the work
WorkManager workManager = WorkManager.getInstance(context);
OneTimeWorkRequest workRequest = new OneTimeWorkRequest.Builder(MyWorker.class).build();
workManager.enqueue(workRequest);</pre></div><div class='content'></div><h2>Services</h2>
<div class='content'><p><code>Service</code> és un component que pot realitzar operacions de llarga durada en segon pla. Hi ha dos tipus de serveis:</p>
<ul>
<li><strong>Started Service</strong>: S'executa indefinidament fins que es deté.</li>
<li><strong>Bound Service</strong>: Es vincula a un component i s'executa mentre el component està vinculat.</li>
</ul>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIE15U2VydmljZSBleHRlbmRzIFNlcnZpY2UgewogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgaW50IG9uU3RhcnRDb21tYW5kKEludGVudCBpbnRlbnQsIGludCBmbGFncywgaW50IHN0YXJ0SWQpIHsKICAgICAgICAvLyBSZWFsaXR6YXIgb3BlcmFjacOzIGVuIHNlZ29uIHBsYQogICAgICAgIHJldHVybiBTVEFSVF9TVElDS1k7CiAgICB9CgogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgSUJpbmRlciBvbkJpbmQoSW50ZW50IGludGVudCkgewogICAgICAgIHJldHVybiBudWxsOwogICAgfQp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class MyService extends Service {
    @Override
    public int onStartCommand(Intent intent, int flags, int startId) {
        // Realitzar operaci&oacute; en segon pla
        return START_STICKY;
    }

    @Override
    public IBinder onBind(Intent intent) {
        return null;
    }
}</pre></div><div class='content'></div><h1>Triar l'Eina Adequada</h1>
<div class='content'><p>| Mètode       | Cas d'Ús                                      | Pros                                         | Contres                                      |
|--------------|-----------------------------------------------|----------------------------------------------|---------------------------------------------|
| AsyncTask    | Tasques senzilles i de curta durada           | Fàcil d'implementar                          | Desaprovat, no adequat per a tasques llargues|
| HandlerThread| Tasques en segon pla amb gestió de missatges  | Senzill, lleuger                             | Gestió manual del fil                       |
| WorkManager  | Tasques ajornables i garantides               | Execució garantida, eficient en bateria      | Configuració més complexa                   |
| Service      | Tasques de llarga durada                      | S'executa independentment de la interfície d'usuari | Requereix més codi boilerplate              |</p>
</div><h1>Exemple de Codi: Utilitzant WorkManager</h1>
<div class='content'><p>Implementem un exemple senzill utilitzant <code>WorkManager</code> per realitzar una tasca en segon pla que descarrega dades d'una URL.</p>
<ol>
<li><strong>Afegir Dependència</strong>: Afegiu la dependència de WorkManager al vostre fitxer <code>build.gradle</code>.</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzIHsKICAgIGltcGxlbWVudGF0aW9uICJhbmRyb2lkeC53b3JrOndvcmstcnVudGltZToyLjcuMCIKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies {
    implementation &quot;androidx.work:work-runtime:2.7.0&quot;
}</pre></div><div class='content'><ol start="2">
<li><strong>Crear Classe Worker</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("cHVibGljIGNsYXNzIERvd25sb2FkV29ya2VyIGV4dGVuZHMgV29ya2VyIHsKICAgIHB1YmxpYyBEb3dubG9hZFdvcmtlcihATm9uTnVsbCBDb250ZXh0IGNvbnRleHQsIEBOb25OdWxsIFdvcmtlclBhcmFtZXRlcnMgcGFyYW1zKSB7CiAgICAgICAgc3VwZXIoY29udGV4dCwgcGFyYW1zKTsKICAgIH0KCiAgICBATm9uTnVsbAogICAgQE92ZXJyaWRlCiAgICBwdWJsaWMgUmVzdWx0IGRvV29yaygpIHsKICAgICAgICAvLyBSZWFsaXR6YXIgb3BlcmFjacOzIGRlIGRlc2PDoHJyZWdhCiAgICAgICAgU3RyaW5nIGRhdGEgPSBkb3dubG9hZERhdGEoKTsKICAgICAgICBpZiAoZGF0YSAhPSBudWxsKSB7CiAgICAgICAgICAgIHJldHVybiBSZXN1bHQuc3VjY2VzcygpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBSZXN1bHQucmV0cnkoKTsKICAgICAgICB9CiAgICB9CgogICAgcHJpdmF0ZSBTdHJpbmcgZG93bmxvYWREYXRhKCkgewogICAgICAgIC8vIFNpbXVsYXIgb3BlcmFjacOzIGRlIGRlc2PDoHJyZWdhCiAgICAgICAgcmV0dXJuICJEYWRlcyBkZXNjYXJyZWdhZGVzIjsKICAgIH0KfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>public class DownloadWorker extends Worker {
    public DownloadWorker(@NonNull Context context, @NonNull WorkerParameters params) {
        super(context, params);
    }

    @NonNull
    @Override
    public Result doWork() {
        // Realitzar operaci&oacute; de desc&agrave;rrega
        String data = downloadData();
        if (data != null) {
            return Result.success();
        } else {
            return Result.retry();
        }
    }

    private String downloadData() {
        // Simular operaci&oacute; de desc&agrave;rrega
        return &quot;Dades descarregades&quot;;
    }
}</pre></div><div class='content'><ol start="3">
<li><strong>Enqueue Work Request</strong>:</li>
</ol>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("V29ya01hbmFnZXIgd29ya01hbmFnZXIgPSBXb3JrTWFuYWdlci5nZXRJbnN0YW5jZShjb250ZXh0KTsKT25lVGltZVdvcmtSZXF1ZXN0IGRvd25sb2FkUmVxdWVzdCA9IG5ldyBPbmVUaW1lV29ya1JlcXVlc3QuQnVpbGRlcihEb3dubG9hZFdvcmtlci5jbGFzcykuYnVpbGQoKTsKd29ya01hbmFnZXIuZW5xdWV1ZShkb3dubG9hZFJlcXVlc3QpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>WorkManager workManager = WorkManager.getInstance(context);
OneTimeWorkRequest downloadRequest = new OneTimeWorkRequest.Builder(DownloadWorker.class).build();
workManager.enqueue(downloadRequest);</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Les tasques en segon pla són crucials per mantenir una aplicació d'Android responsiva i eficient. Comprenent i utilitzant les eines adequades com <code>HandlerThread</code>, <code>WorkManager</code> i <code>Service</code>, els desenvolupadors poden assegurar-se que les seves aplicacions funcionin de manera fluida i eficient. Trieu sempre l'eina adequada en funció dels requisits específics de la vostra tasca per aconseguir els millors resultats.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
