<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WorkManager a Android Studio</title>

    <link rel="alternate" href="https://campusempresa.com/es/androidstudio/workmanager" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/androidstudio/workmanager" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/androidstudio/workmanager" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/androidstudio/workmanager" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='broadcast-receivers'>&#x25C4;Receptors de Difusió</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">WorkManager a Android Studio</a>
	</div>
	<div class='col-4 text-end'>
					<a href='jobscheduler'>JobScheduler &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a WorkManager</h1>
<div class='content'><p>WorkManager és una biblioteca d'Android que simplifica el procés de programació de tasques ajornables i asíncrones que s'espera que s'executin fins i tot si l'aplicació surt o el dispositiu es reinicia. És part d'Android Jetpack i és adequada per a tasques que requereixen execució garantida.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Tasques Ajorrnables</strong>: Tasques que es poden retardar i no necessiten ser executades immediatament.</li>
<li><strong>Execució Garantida</strong>: Assegura que la tasca s'executarà fins i tot si l'aplicació es tanca o el dispositiu es reinicia.</li>
<li><strong>Tasques Asíncrones</strong>: Tasques que s'executen en un fil de fons, sense bloquejar el fil principal de la UI.</li>
</ul>
</div><h1>Configuració de WorkManager</h1>
<div class='content'><p>Per utilitzar WorkManager, cal afegir les dependències necessàries al teu fitxer <code>build.gradle</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("ZGVwZW5kZW5jaWVzIHsKICAgIGltcGxlbWVudGF0aW9uICJhbmRyb2lkeC53b3JrOndvcmstcnVudGltZToyLjcuMCIKfQ=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>dependencies {
    implementation &quot;androidx.work:work-runtime:2.7.0&quot;
}</pre></div><div class='content'></div><h1>Creació d'una Sol·licitud de Treball Simple</h1>
<div class='content'><p>Una WorkRequest defineix una tasca individual que serà executada per WorkManager. Hi ha dos tipus de WorkRequests:</p>
<ul>
<li><strong>OneTimeWorkRequest</strong>: Per a tasques que només s'han d'executar una vegada.</li>
<li><strong>PeriodicWorkRequest</strong>: Per a tasques que s'han d'executar periòdicament.</li>
</ul>
</div><h2>Exemple: OneTimeWorkRequest</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LndvcmsuT25lVGltZVdvcmtSZXF1ZXN0CmltcG9ydCBhbmRyb2lkeC53b3JrLldvcmtNYW5hZ2VyCmltcG9ydCBhbmRyb2lkeC53b3JrLldvcmtlcgppbXBvcnQgYW5kcm9pZHgud29yay5Xb3JrZXJQYXJhbWV0ZXJzCgpjbGFzcyBTaW1wbGVXb3JrZXIoYXBwQ29udGV4dDogQ29udGV4dCwgd29ya2VyUGFyYW1zOiBXb3JrZXJQYXJhbWV0ZXJzKSA6IFdvcmtlcihhcHBDb250ZXh0LCB3b3JrZXJQYXJhbXMpIHsKICAgIG92ZXJyaWRlIGZ1biBkb1dvcmsoKTogUmVzdWx0IHsKICAgICAgICAvLyBGZXMgbGEgZmVpbmEgYXF1w60tLWVuIGFxdWVzdCBjYXMsIHB1amEgbGVzIGltYXRnZXMuCiAgICAgICAgdXBsb2FkSW1hZ2VzKCkKICAgICAgICAvLyBJbmRpY2Egc2kgbGEgZmVpbmEgaGEgYWNhYmF0IGFtYiDDqHhpdCBhbWIgZWwgUmVzdWx0CiAgICAgICAgcmV0dXJuIFJlc3VsdC5zdWNjZXNzKCkKICAgIH0KfQoKZnVuIHVwbG9hZEltYWdlcygpIHsKICAgIC8vIENvZGkgcGVyIHB1amFyIGltYXRnZXMKfQoKLy8gRW5xdWV1ZSBsYSBmZWluYQp2YWwgdXBsb2FkV29ya1JlcXVlc3QgPSBPbmVUaW1lV29ya1JlcXVlc3QuQnVpbGRlcihTaW1wbGVXb3JrZXI6OmNsYXNzLmphdmEpLmJ1aWxkKCkKV29ya01hbmFnZXIuZ2V0SW5zdGFuY2UoY29udGV4dCkuZW5xdWV1ZSh1cGxvYWRXb3JrUmVxdWVzdCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.work.OneTimeWorkRequest
import androidx.work.WorkManager
import androidx.work.Worker
import androidx.work.WorkerParameters

class SimpleWorker(appContext: Context, workerParams: WorkerParameters) : Worker(appContext, workerParams) {
    override fun doWork(): Result {
        // Fes la feina aqu&iacute;--en aquest cas, puja les imatges.
        uploadImages()
        // Indica si la feina ha acabat amb &egrave;xit amb el Result
        return Result.success()
    }
}

fun uploadImages() {
    // Codi per pujar imatges
}

// Enqueue la feina
val uploadWorkRequest = OneTimeWorkRequest.Builder(SimpleWorker::class.java).build()
WorkManager.getInstance(context).enqueue(uploadWorkRequest)</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>SimpleWorker</strong>: Una classe que extén <code>Worker</code> on es defineix la feina real.</li>
<li><strong>doWork()</strong>: El mètode on s'executa la tasca.</li>
<li><strong>enqueue()</strong>: Mètode per programar la feina.</li>
</ul>
</div><h1>Afegint Restriccions</h1>
<div class='content'><p>Les restriccions especifiquen condicions que han de complir-se perquè la feina s'executi, com la disponibilitat de xarxa o l'estat de càrrega del dispositiu.</p>
</div><h2>Exemple: Afegint Restriccions</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("aW1wb3J0IGFuZHJvaWR4LndvcmsuQ29uc3RyYWludHMKaW1wb3J0IGFuZHJvaWR4LndvcmsuTmV0d29ya1R5cGUKCnZhbCBjb25zdHJhaW50cyA9IENvbnN0cmFpbnRzLkJ1aWxkZXIoKQogICAgLnNldFJlcXVpcmVkTmV0d29ya1R5cGUoTmV0d29ya1R5cGUuQ09OTkVDVEVEKQogICAgLnNldFJlcXVpcmVzQ2hhcmdpbmcodHJ1ZSkKICAgIC5idWlsZCgpCgp2YWwgY29uc3RyYWluZWRXb3JrUmVxdWVzdCA9IE9uZVRpbWVXb3JrUmVxdWVzdC5CdWlsZGVyKFNpbXBsZVdvcmtlcjo6Y2xhc3MuamF2YSkKICAgIC5zZXRDb25zdHJhaW50cyhjb25zdHJhaW50cykKICAgIC5idWlsZCgpCgpXb3JrTWFuYWdlci5nZXRJbnN0YW5jZShjb250ZXh0KS5lbnF1ZXVlKGNvbnN0cmFpbmVkV29ya1JlcXVlc3Qp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>import androidx.work.Constraints
import androidx.work.NetworkType

val constraints = Constraints.Builder()
    .setRequiredNetworkType(NetworkType.CONNECTED)
    .setRequiresCharging(true)
    .build()

val constrainedWorkRequest = OneTimeWorkRequest.Builder(SimpleWorker::class.java)
    .setConstraints(constraints)
    .build()

WorkManager.getInstance(context).enqueue(constrainedWorkRequest)</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>Constraints.Builder()</strong>: Utilitzat per definir les restriccions.</li>
<li><strong>setRequiredNetworkType(NetworkType.CONNECTED)</strong>: Assegura que el dispositiu està connectat a una xarxa.</li>
<li><strong>setRequiresCharging(true)</strong>: Assegura que el dispositiu està carregant.</li>
</ul>
</div><h1>Enllaçant Sol·licituds de Treball</h1>
<div class='content'><p>WorkManager permet enllaçar múltiples sol·licituds de treball per executar-les en un ordre especificat.</p>
</div><h2>Exemple: Enllaçant Sol·licituds de Treball</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHdvcmtBID0gT25lVGltZVdvcmtSZXF1ZXN0LkJ1aWxkZXIoV29ya2VyQTo6Y2xhc3MuamF2YSkuYnVpbGQoKQp2YWwgd29ya0IgPSBPbmVUaW1lV29ya1JlcXVlc3QuQnVpbGRlcihXb3JrZXJCOjpjbGFzcy5qYXZhKS5idWlsZCgpCnZhbCB3b3JrQyA9IE9uZVRpbWVXb3JrUmVxdWVzdC5CdWlsZGVyKFdvcmtlckM6OmNsYXNzLmphdmEpLmJ1aWxkKCkKCldvcmtNYW5hZ2VyLmdldEluc3RhbmNlKGNvbnRleHQpCiAgICAuYmVnaW5XaXRoKHdvcmtBKQogICAgLnRoZW4od29ya0IpCiAgICAudGhlbih3b3JrQykKICAgIC5lbnF1ZXVlKCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val workA = OneTimeWorkRequest.Builder(WorkerA::class.java).build()
val workB = OneTimeWorkRequest.Builder(WorkerB::class.java).build()
val workC = OneTimeWorkRequest.Builder(WorkerC::class.java).build()

WorkManager.getInstance(context)
    .beginWith(workA)
    .then(workB)
    .then(workC)
    .enqueue()</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>beginWith(workA)</strong>: Comença la cadena amb <code>workA</code>.</li>
<li><strong>then(workB)</strong>: Especifica que <code>workB</code> s'ha d'executar després de <code>workA</code>.</li>
<li><strong>then(workC)</strong>: Especifica que <code>workC</code> s'ha d'executar després de <code>workB</code>.</li>
</ul>
</div><h1>Observant l'Estat de la Feina</h1>
<div class='content'><p>Pots observar l'estat d'una sol·licitud de treball per obtenir actualitzacions sobre el seu progrés o finalització.</p>
</div><h2>Exemple: Observant l'Estat de la Feina</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHdvcmtSZXF1ZXN0ID0gT25lVGltZVdvcmtSZXF1ZXN0LkJ1aWxkZXIoU2ltcGxlV29ya2VyOjpjbGFzcy5qYXZhKS5idWlsZCgpCldvcmtNYW5hZ2VyLmdldEluc3RhbmNlKGNvbnRleHQpLmVucXVldWUod29ya1JlcXVlc3QpCgpXb3JrTWFuYWdlci5nZXRJbnN0YW5jZShjb250ZXh0KS5nZXRXb3JrSW5mb0J5SWRMaXZlRGF0YSh3b3JrUmVxdWVzdC5pZCkKICAgIC5vYnNlcnZlKHRoaXMsIE9ic2VydmVyIHsgd29ya0luZm8gLT4KICAgICAgICBpZiAod29ya0luZm8gIT0gbnVsbCAmJiB3b3JrSW5mby5zdGF0ZSA9PSBXb3JrSW5mby5TdGF0ZS5TVUNDRUVERUQpIHsKICAgICAgICAgICAgLy8gTGEgZmVpbmEgaGEgYWNhYmF0IGFtYiDDqHhpdAogICAgICAgIH0KICAgIH0p"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val workRequest = OneTimeWorkRequest.Builder(SimpleWorker::class.java).build()
WorkManager.getInstance(context).enqueue(workRequest)

WorkManager.getInstance(context).getWorkInfoByIdLiveData(workRequest.id)
    .observe(this, Observer { workInfo -&gt;
        if (workInfo != null &amp;&amp; workInfo.state == WorkInfo.State.SUCCEEDED) {
            // La feina ha acabat amb &egrave;xit
        }
    })</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>getWorkInfoByIdLiveData(workRequest.id)</strong>: Retorna un objecte LiveData que es pot observar per canvis en l'estat de la feina.</li>
<li><strong>Observer</strong>: Reacciona als canvis en l'estat de la feina.</li>
</ul>
</div><h1>Funcions Avançades de WorkManager</h1>
<h2>Sol·licituds de Treball Periòdiques</h2>
<div class='content'><p>Per a tasques que necessiten executar-se periòdicament, utilitza <code>PeriodicWorkRequest</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("dmFsIHBlcmlvZGljV29ya1JlcXVlc3QgPSBQZXJpb2RpY1dvcmtSZXF1ZXN0LkJ1aWxkZXIoU2ltcGxlV29ya2VyOjpjbGFzcy5qYXZhLCAxLCBUaW1lVW5pdC5IT1VSUykuYnVpbGQoKQpXb3JrTWFuYWdlci5nZXRJbnN0YW5jZShjb250ZXh0KS5lbnF1ZXVlKHBlcmlvZGljV29ya1JlcXVlc3Qp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>val periodicWorkRequest = PeriodicWorkRequest.Builder(SimpleWorker::class.java, 1, TimeUnit.HOURS).build()
WorkManager.getInstance(context).enqueue(periodicWorkRequest)</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><strong>PeriodicWorkRequest.Builder</strong>: Programa la feina per executar-se periòdicament.</li>
<li><strong>1, TimeUnit.HOURS</strong>: Especifica l'interval entre execucions.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>WorkManager és una eina poderosa per gestionar tasques de fons en aplicacions Android. Proporciona una API simple i flexible per programar tasques, afegir restriccions, enllaçar tasques i observar el seu estat. Entenent i utilitzant WorkManager, pots assegurar-te que les tasques de fons de la teva aplicació es gestionen de manera eficient i fiable, fins i tot sota condicions difícils com la terminació de l'aplicació o els reinicis del dispositiu.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='broadcast-receivers'>&#x25C4;Receptors de Difusió</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">WorkManager a Android Studio</a>
	</div>
	<div class='col-4 text-end'>
					<a href='jobscheduler'>JobScheduler &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
