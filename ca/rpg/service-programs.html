<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programes de Servei</title>

    <link rel="alternate" href="https://campusempresa.com/es/rpg/service-programs" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/rpg/service-programs" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/rpg/service-programs" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/rpg/service-programs" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='creating-using-modules'>&#x25C4;Creació i Ús de Mòduls</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Programes de Servei</a>
	</div>
	<div class='col-4 text-end'>
					<a href='binding-directories'>Directoris de Vinculació &#x25BA;</a>
			</div>
</div>
<div class='content'><p>Els Programes de Servei són una característica poderosa en RPG que permet encapsular i reutilitzar codi a través de múltiples aplicacions. Aquest tema et guiarà a través de la comprensió, creació i ús de programes de servei des d'un nivell principiant fins a un nivell avançat.</p>
</div><h1>Introducció als Programes de Servei</h1>
<div class='content'><p>Els Programes de Servei en RPG són similars a les biblioteques d'enllaç dinàmic (DLLs) en altres llenguatges de programació. Permeten agrupar procediments i funcions relacionades en un únic mòdul que pot ser utilitzat per múltiples programes.</p>
<ul>
<li><strong>Encapsulació</strong>: Agrupa procediments relacionats junts.</li>
<li><strong>Reutilització</strong>: Utilitza els mateixos procediments en diferents programes sense duplicar codi.</li>
<li><strong>Mantenibilitat</strong>: Actualitza procediments en un sol lloc, i tots els programes que utilitzen el programa de servei utilitzaran automàticament el codi actualitzat.</li>
</ul>
</div><h1>Creació d'un Programa de Servei</h1>
<div class='content'></div><h2>Definició de Procediments</h2>
<div class='content'><p>Per crear un programa de servei, primer has de definir els procediments que vols incloure. Aquí tens un exemple senzill de definició de procediments en un mòdul RPG:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KipmcmVlCi8vIFByb2NlZGltZW50IHBlciBzdW1hciBkb3MgbsO6bWVyb3MKZGNsLXByb2MgQWRkTnVtYmVyczsKICBkY2wtcGkgKm4gaW50KDEwKTsKICAgIG51bTEgaW50KDEwKTsKICAgIG51bTIgaW50KDEwKTsKICBlbmQtcGk7CgogIHJldHVybiBudW0xICsgbnVtMjsKZW5kLXByb2M7CgovLyBQcm9jZWRpbWVudCBwZXIgcmVzdGFyIGRvcyBuw7ptZXJvcwpkY2wtcHJvYyBTdWJ0cmFjdE51bWJlcnM7CiAgZGNsLXBpICpuIGludCgxMCk7CiAgICBudW0xIGludCgxMCk7CiAgICBudW0yIGludCgxMCk7CiAgZW5kLXBpOwoKICByZXR1cm4gbnVtMSAtIG51bTI7CmVuZC1wcm9jOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>**free
// Procediment per sumar dos n&uacute;meros
dcl-proc AddNumbers;
  dcl-pi *n int(10);
    num1 int(10);
    num2 int(10);
  end-pi;

  return num1 + num2;
end-proc;

// Procediment per restar dos n&uacute;meros
dcl-proc SubtractNumbers;
  dcl-pi *n int(10);
    num1 int(10);
    num2 int(10);
  end-pi;

  return num1 - num2;
end-proc;</pre></div><div class='content'></div><h2>Creació del Mòdul</h2>
<div class='content'><p>Compila el codi anterior en un mòdul. A IBM i, pots utilitzar la comanda <code>CRTRPGMOD</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUUlBHTU9EIE1PRFVMRShNWUxJQi9NWVNSVlBHTSkgU1JDRklMRShNWUxJQi9RUlBHTEVTUkMpIFNSQ01CUihNWVNSVlBHTSk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTRPGMOD MODULE(MYLIB/MYSRVPGM) SRCFILE(MYLIB/QRPGLESRC) SRCMBR(MYSRVPGM)</pre></div><div class='content'></div><h2>Enllaçar el Mòdul en un Programa de Servei</h2>
<div class='content'><p>Un cop tens el teu mòdul, necessites crear un programa de servei utilitzant la comanda <code>CRTSRVPGM</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUU1JWUEdNIFNSVlBHTShNWUxJQi9NWVNSVlBHTSkgTU9EVUxFKE1ZTElCL01ZU1JWUEdNKSBFWFBPUlQoKkFMTCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTSRVPGM SRVPGM(MYLIB/MYSRVPGM) MODULE(MYLIB/MYSRVPGM) EXPORT(*ALL)</pre></div><div class='content'></div><h1>Ús d'un Programa de Servei</h1>
<div class='content'></div><h2>Enllaçar un Programa de Servei a un Programa</h2>
<div class='content'><p>Per utilitzar els procediments en un programa de servei, necessites enllaçar el programa de servei al teu programa RPG. Aquí tens un exemple de com cridar els procediments d'un programa de servei:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KipmcmVlCi8vIFByb3RvdGlwIHBlciBhbCBwcm9jZWRpbWVudCBBZGROdW1iZXJzCmRjbC1wciBBZGROdW1iZXJzIGludCgxMCk7CiAgbnVtMSBpbnQoMTApOwogIG51bTIgaW50KDEwKTsKZW5kLXByOwoKLy8gUHJvdG90aXAgcGVyIGFsIHByb2NlZGltZW50IFN1YnRyYWN0TnVtYmVycwpkY2wtcHIgU3VidHJhY3ROdW1iZXJzIGludCgxMCk7CiAgbnVtMSBpbnQoMTApOwogIG51bTIgaW50KDEwKTsKZW5kLXByOwoKZGNsLXMgcmVzdWx0IGludCgxMCk7CgpyZXN1bHQgPSBBZGROdW1iZXJzKDEwLCA1KTsKZHNwbHkgcmVzdWx0OyAvLyBNb3N0cmEgMTUKCnJlc3VsdCA9IFN1YnRyYWN0TnVtYmVycygxMCwgNSk7CmRzcGx5IHJlc3VsdDsgLy8gTW9zdHJhIDUKCippbmxyID0gKm9uOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>**free
// Prototip per al procediment AddNumbers
dcl-pr AddNumbers int(10);
  num1 int(10);
  num2 int(10);
end-pr;

// Prototip per al procediment SubtractNumbers
dcl-pr SubtractNumbers int(10);
  num1 int(10);
  num2 int(10);
end-pr;

dcl-s result int(10);

result = AddNumbers(10, 5);
dsply result; // Mostra 15

result = SubtractNumbers(10, 5);
dsply result; // Mostra 5

*inlr = *on;</pre></div><div class='content'></div><h2>Directori d'Enllaç</h2>
<div class='content'><p>Necessites especificar el programa de servei en el directori d'enllaç. Utilitza la comanda <code>CRTBNDCL</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUQk5EQ0wgUEdNKE1ZTElCL01ZUEdNKSBTUkNGSUxFKE1ZTElCL1FDTExFU1JDKSBTUkNNQlIoTVlQR00pIEJORERJUihNWUxJQi9NWUJORERJUik="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTBNDCL PGM(MYLIB/MYPGM) SRCFILE(MYLIB/QCLLESRC) SRCMBR(MYPGM) BNDDIR(MYLIB/MYBNDDIR)</pre></div><div class='content'><p>Assegura't que el directori d'enllaç inclogui el programa de servei:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QUREQk5ERElSRSBCTkRESVIoTVlMSUIvTVlCTkRESVIpIE9CSigoTVlMSUIvTVlTUlZQR00gKlNSVlBHTSkp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>ADDBNDDIRE BNDDIR(MYLIB/MYBNDDIR) OBJ((MYLIB/MYSRVPGM *SRVPGM))</pre></div><div class='content'></div><h1>Ús Avançat</h1>
<div class='content'></div><h2>Versionat de Programes de Servei</h2>
<div class='content'><p>A mesura que les teves aplicacions evolucionen, potser necessitaràs actualitzar els teus programes de servei. El versionat et permet gestionar els canvis sense trencar les aplicacions existents.</p>
<ul>
<li><strong>Compatibilitat cap enrere</strong>: Assegura't que les noves versions dels procediments no trenquin la funcionalitat existent.</li>
<li><strong>Llistes d'Exportació</strong>: Utilitza llistes d'exportació per controlar quins procediments estan disponibles per als programes que els criden.</li>
</ul>
</div><h2>Exemple de Llistes d'Exportació</h2>
<div class='content'><p>Defineix una llista d'exportació en el teu programa de servei:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Q1JUU1JWUEdNIFNSVlBHTShNWUxJQi9NWVNSVlBHTSkgTU9EVUxFKE1ZTElCL01ZU1JWUEdNKSBFWFBPUlQoKlNSQ0ZJTEUpIFNSQ0ZJTEUoTVlMSUIvUVNSVlNSQykgU1JDTUJSKEVYUE9SVFMp"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>CRTSRVPGM SRVPGM(MYLIB/MYSRVPGM) MODULE(MYLIB/MYSRVPGM) EXPORT(*SRCFILE) SRCFILE(MYLIB/QSRVSRC) SRCMBR(EXPORTS)</pre></div><div class='content'><p>En el membre de font <code>EXPORTS</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("QWRkTnVtYmVycwpTdWJ0cmFjdE51bWJlcnM="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>AddNumbers
SubtractNumbers</pre></div><div class='content'></div><h2>Enllaç Dinàmic</h2>
<div class='content'><p>L'enllaç dinàmic et permet cridar procediments en un programa de servei en temps d'execució, proporcionant flexibilitat en com utilitzes els programes de servei.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("KipmcmVlCmRjbC1wciBEeW5hbWljQWRkTnVtYmVycyBleHRwZ20oJ01ZU1JWUEdNJyk7CiAgbnVtMSBpbnQoMTApOwogIG51bTIgaW50KDEwKTsKZW5kLXByOwoKZGNsLXMgcmVzdWx0IGludCgxMCk7CgpyZXN1bHQgPSBEeW5hbWljQWRkTnVtYmVycygxMCwgNSk7CmRzcGx5IHJlc3VsdDsgLy8gTW9zdHJhIDE1CgoqaW5sciA9ICpvbjs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>**free
dcl-pr DynamicAddNumbers extpgm('MYSRVPGM');
  num1 int(10);
  num2 int(10);
end-pr;

dcl-s result int(10);

result = DynamicAddNumbers(10, 5);
dsply result; // Mostra 15

*inlr = *on;</pre></div><div class='content'></div><h1>Conclusió</h1>
<div class='content'><p>Els Programes de Servei en RPG proporcionen una manera robusta d'encapsular i reutilitzar codi, fent que les teves aplicacions siguin més modulars i mantenibles. Comprenent com crear, utilitzar i gestionar programes de servei, pots millorar significativament l'eficiència i escalabilitat de les teves aplicacions RPG. A mesura que avancis, considera explorar característiques més complexes com el versionat i l'enllaç dinàmic per aprofitar completament el poder dels programes de servei.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='creating-using-modules'>&#x25C4;Creació i Ús de Mòduls</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Programes de Servei</a>
	</div>
	<div class='col-4 text-end'>
					<a href='binding-directories'>Directoris de Vinculació &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
