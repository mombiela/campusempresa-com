<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaccions de Base de Dades</title>

    <link rel="alternate" href="https://campusempresa.com/es/rpg/database-transactions" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/rpg/database-transactions" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/rpg/database-transactions" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/rpg/database-transactions" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'><div class='col-6'><a href='dynamic-sql'>&#x25C4; SQL Dinàmic</a></div><div class='col-6 text-end'><a href='ile-concepts'>Conceptes i Arquitectura ILE &#x25BA;</a></div></div><div class='content'></div><h1>Introducció a les Transaccions de Base de Dades</h1>
<div class='content'><p>Les transaccions de base de dades són un concepte fonamental en els sistemes de gestió de bases de dades relacionals (RDBMS). Asseguren que una sèrie d'operacions de base de dades s'executin de manera fiable i consistent. En RPG (Report Program Generator), entendre i gestionar les transaccions és crucial per mantenir la integritat i la consistència de les dades.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Transacció</strong>: Una seqüència d'una o més operacions SQL executades com una unitat única.</li>
<li><strong>Propietats ACID</strong>: Les transaccions han d'adherir-se a les següents propietats:
<ul>
<li><strong>Atomicitat</strong>: Assegura que totes les operacions dins d'una transacció es completin; si no, la transacció s'aborta.</li>
<li><strong>Consistència</strong>: Assegura que una transacció porta la base de dades d'un estat vàlid a un altre.</li>
<li><strong>Aïllament</strong>: Assegura que les transaccions s'executin de manera aïllada les unes de les altres.</li>
<li><strong>Durabilitat</strong>: Assegura que una vegada una transacció es compromet, roman així, fins i tot en cas de fallada del sistema.</li>
</ul>
</li>
</ul>
</div><h1>Operacions Bàsiques de Transacció en RPG</h1>
<div class='content'><p>En RPG, pots gestionar les transaccions utilitzant instruccions SQL. Les operacions bàsiques inclouen <code>BEGIN TRANSACTION</code>, <code>COMMIT</code>, i <code>ROLLBACK</code>.</p>
</div><h2>Exemple: Control Bàsic de Transaccions</h2>
<div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gSW5pY2lhciB1bmEgdHJhbnNhY2Npw7MKZXhlYyBzcWwKICBiZWdpbiB0cmFuc2FjdGlvbjsKCi8vIEluc2VyaXIgdW4gcmVnaXN0cmUgYSBsYSB0YXVsYSBDVVNUT01FUgpleGVjIHNxbAogIGluc2VydCBpbnRvIENVU1RPTUVSIChJRCwgTkFNRSwgQkFMQU5DRSkKICB2YWx1ZXMgKDEsICdKb2huIERvZScsIDEwMC4wMCk7CgovLyBDb21wcm9tZXRyZSBsYSB0cmFuc2FjY2nDswpleGVjIHNxbAogIGNvbW1pdDs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Iniciar una transacci&oacute;
exec sql
  begin transaction;

// Inserir un registre a la taula CUSTOMER
exec sql
  insert into CUSTOMER (ID, NAME, BALANCE)
  values (1, 'John Doe', 100.00);

// Comprometre la transacci&oacute;
exec sql
  commit;</pre></div><div class='content'><p>Explicació:</p>
<ul>
<li><code>BEGIN TRANSACTION</code>: Inicia una nova transacció.</li>
<li><code>INSERT INTO</code>: Afegeix un nou registre a la taula <code>CUSTOMER</code>.</li>
<li><code>COMMIT</code>: Desa tots els canvis fets durant la transacció.</li>
</ul>
</div><h2>Gestió d'Errors amb ROLLBACK</h2>
<div class='content'><p>Si es produeix un error durant una transacció, pots utilitzar <code>ROLLBACK</code> per desfer tots els canvis fets durant la transacció.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gSW5pY2lhciB1bmEgdHJhbnNhY2Npw7MKZXhlYyBzcWwKICBiZWdpbiB0cmFuc2FjdGlvbjsKCnRyeTsKICAvLyBJbnNlcmlyIHVuIHJlZ2lzdHJlIGEgbGEgdGF1bGEgQ1VTVE9NRVIKICBleGVjIHNxbAogICAgaW5zZXJ0IGludG8gQ1VTVE9NRVIgKElELCBOQU1FLCBCQUxBTkNFKQogICAgdmFsdWVzICgyLCAnSmFuZSBTbWl0aCcsIDIwMC4wMCk7CgogIC8vIFNpbXVsYXIgdW4gZXJyb3IKICBpZiAlZXJyb3I7CiAgICAvLyBEZXNmZXIgbGEgdHJhbnNhY2Npw7Mgc2kgZXMgcHJvZHVlaXggdW4gZXJyb3IKICAgIGV4ZWMgc3FsCiAgICAgIHJvbGxiYWNrOwogICAgZHNwbHkgJ1RyYW5zYWNjacOzIGRlc2ZldGEgYSBjYXVzYSBkJ3VuIGVycm9yJzsKICBlbHNlOwogICAgLy8gQ29tcHJvbWV0cmUgbGEgdHJhbnNhY2Npw7Mgc2kgbm8gaGkgaGEgZXJyb3JzCiAgICBleGVjIHNxbAogICAgICBjb21taXQ7CiAgICBkc3BseSAnVHJhbnNhY2Npw7MgY29tcHJvbWVzYSBhbWIgw6h4aXQnOwogIGVuZGlmOwpvbi1lcnJvcjsKICAvLyBEZXNmZXIgbGEgdHJhbnNhY2Npw7MgZW4gY2FzIGQndW4gZXJyb3IgaW5lc3BlcmF0CiAgZXhlYyBzcWwKICAgIHJvbGxiYWNrOwogIGRzcGx5ICdUcmFuc2FjY2nDsyBkZXNmZXRhIGEgY2F1c2EgZCd1biBlcnJvciBpbmVzcGVyYXQnOwplbmR0cnk7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Iniciar una transacci&oacute;
exec sql
  begin transaction;

try;
  // Inserir un registre a la taula CUSTOMER
  exec sql
    insert into CUSTOMER (ID, NAME, BALANCE)
    values (2, 'Jane Smith', 200.00);

  // Simular un error
  if %error;
    // Desfer la transacci&oacute; si es produeix un error
    exec sql
      rollback;
    dsply 'Transacci&oacute; desfeta a causa d'un error';
  else;
    // Comprometre la transacci&oacute; si no hi ha errors
    exec sql
      commit;
    dsply 'Transacci&oacute; compromesa amb &egrave;xit';
  endif;
on-error;
  // Desfer la transacci&oacute; en cas d'un error inesperat
  exec sql
    rollback;
  dsply 'Transacci&oacute; desfeta a causa d'un error inesperat';
endtry;</pre></div><div class='content'><p>Explicació:</p>
<ul>
<li><code>ROLLBACK</code>: Desfà tots els canvis fets durant la transacció si es produeix un error.</li>
<li><code>try</code> i <code>on-error</code>: Construccions RPG per gestionar excepcions.</li>
</ul>
</div><h1>Gestió Avançada de Transaccions</h1>
<div class='content'><p>La gestió avançada de transaccions implica gestionar escenaris complexos com transaccions niades i punts de desament.</p>
</div><h2>Punts de Desament</h2>
<div class='content'><p>Els punts de desament et permeten establir punts intermedis dins d'una transacció als quals pots desfer sense afectar tota la transacció.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gSW5pY2lhciB1bmEgdHJhbnNhY2Npw7MKZXhlYyBzcWwKICBiZWdpbiB0cmFuc2FjdGlvbjsKCnRyeTsKICAvLyBJbnNlcmlyIHVuIHJlZ2lzdHJlIGEgbGEgdGF1bGEgQ1VTVE9NRVIKICBleGVjIHNxbAogICAgaW5zZXJ0IGludG8gQ1VTVE9NRVIgKElELCBOQU1FLCBCQUxBTkNFKQogICAgdmFsdWVzICgzLCAnQWxpY2UgQnJvd24nLCAzMDAuMDApOwoKICAvLyBFc3RhYmxpciB1biBwdW50IGRlIGRlc2FtZW50CiAgZXhlYyBzcWwKICAgIHNhdmVwb2ludCBzcDE7CgogIC8vIEluc2VyaXIgdW4gYWx0cmUgcmVnaXN0cmUKICBleGVjIHNxbAogICAgaW5zZXJ0IGludG8gQ1VTVE9NRVIgKElELCBOQU1FLCBCQUxBTkNFKQogICAgdmFsdWVzICg0LCAnQm9iIFdoaXRlJywgNDAwLjAwKTsKCiAgLy8gU2ltdWxhciB1biBlcnJvcgogIGlmICVlcnJvcjsKICAgIC8vIERlc2ZlciBmaW5zIGFsIHB1bnQgZGUgZGVzYW1lbnQKICAgIGV4ZWMgc3FsCiAgICAgIHJvbGxiYWNrIHRvIHNhdmVwb2ludCBzcDE7CiAgICBkc3BseSAnRGVzZmV0IGZpbnMgYWwgcHVudCBkZSBkZXNhbWVudCBzcDEnOwogIGVsc2U7CiAgICAvLyBDb21wcm9tZXRyZSBsYSB0cmFuc2FjY2nDsyBzaSBubyBoaSBoYSBlcnJvcnMKICAgIGV4ZWMgc3FsCiAgICAgIGNvbW1pdDsKICAgIGRzcGx5ICdUcmFuc2FjY2nDsyBjb21wcm9tZXNhIGFtYiDDqHhpdCc7CiAgZW5kaWY7Cm9uLWVycm9yOwogIC8vIERlc2ZlciBsYSB0cmFuc2FjY2nDsyBlbiBjYXMgZCd1biBlcnJvciBpbmVzcGVyYXQKICBleGVjIHNxbAogICAgcm9sbGJhY2s7CiAgZHNwbHkgJ1RyYW5zYWNjacOzIGRlc2ZldGEgYSBjYXVzYSBkJ3VuIGVycm9yIGluZXNwZXJhdCc7CmVuZHRyeTs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// Iniciar una transacci&oacute;
exec sql
  begin transaction;

try;
  // Inserir un registre a la taula CUSTOMER
  exec sql
    insert into CUSTOMER (ID, NAME, BALANCE)
    values (3, 'Alice Brown', 300.00);

  // Establir un punt de desament
  exec sql
    savepoint sp1;

  // Inserir un altre registre
  exec sql
    insert into CUSTOMER (ID, NAME, BALANCE)
    values (4, 'Bob White', 400.00);

  // Simular un error
  if %error;
    // Desfer fins al punt de desament
    exec sql
      rollback to savepoint sp1;
    dsply 'Desfet fins al punt de desament sp1';
  else;
    // Comprometre la transacci&oacute; si no hi ha errors
    exec sql
      commit;
    dsply 'Transacci&oacute; compromesa amb &egrave;xit';
  endif;
on-error;
  // Desfer la transacci&oacute; en cas d'un error inesperat
  exec sql
    rollback;
  dsply 'Transacci&oacute; desfeta a causa d'un error inesperat';
endtry;</pre></div><div class='content'><p>Explicació:</p>
<ul>
<li><code>SAVEPOINT sp1</code>: Estableix un punt de desament anomenat <code>sp1</code>.</li>
<li><code>ROLLBACK TO SAVEPOINT sp1</code>: Desfà la transacció fins al punt de desament <code>sp1</code>.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Entendre i gestionar les transaccions de base de dades en RPG és essencial per assegurar la integritat i la consistència de les dades. Utilitzant operacions bàsiques de transacció com <code>BEGIN TRANSACTION</code>, <code>COMMIT</code>, i <code>ROLLBACK</code>, així com tècniques avançades com els punts de desament, pots gestionar escenaris complexos de manipulació de dades de manera efectiva. Assegura't sempre que les teves transaccions adhereixin a les propietats ACID per mantenir un estat de base de dades fiable i consistent.</p>
</div><div class='row navigation'><div class='col-6'><a href='dynamic-sql'>&#x25C4; SQL Dinàmic</a></div><div class='col-6 text-end'><a href='ile-concepts'>Conceptes i Arquitectura ILE &#x25BA;</a></div></div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
