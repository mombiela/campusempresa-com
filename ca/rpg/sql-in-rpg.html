<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Introducció a SQL en RPG</title>

    <link rel="alternate" href="https://campusempresa.com/es/rpg/sql-in-rpg" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/rpg/sql-in-rpg" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/rpg/sql-in-rpg" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/rpg/sql-in-rpg" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'></div><h1>Visió General</h1>
<div class='content'><p>SQL (Structured Query Language) és una eina poderosa per gestionar i manipular bases de dades. En el context de RPG (Report Program Generator), integrar SQL pot millorar significativament les capacitats de processament de dades. Aquesta secció us introduirà als conceptes bàsics d'usar SQL dins dels programes RPG.</p>
</div><h1>Conceptes Clau</h1>
<div class='content'><ul>
<li><strong>SQL Integrat</strong>: Sentències SQL integrades directament dins del codi RPG.</li>
<li><strong>Precompiladors SQL</strong>: Eines que processen les sentències SQL integrades abans que el programa RPG sigui compilat.</li>
<li><strong>SQLCA (Àrea de Comunicació SQL)</strong>: Una estructura utilitzada per gestionar l'estat d'execució de SQL i els errors.</li>
<li><strong>Operacions CRUD</strong>: Operacions bàsiques de SQL - Crear, Llegir, Actualitzar, Esborrar.</li>
</ul>
</div><h1>Configuració de SQL en RPG</h1>
<div class='content'><p>Per utilitzar SQL en RPG, heu d'assegurar-vos que el vostre entorn està configurat correctament:</p>
<ol>
<li><strong>Incloure el Precompilador SQL</strong>: Assegureu-vos que el vostre compilador RPG suporta la precompilació SQL.</li>
<li><strong>Connexió a la Base de Dades</strong>: Establiu una connexió amb la vostra base de dades.</li>
</ol>
</div><h1>Operacions Bàsiques de SQL en RPG</h1>
<div class='content'></div><h2>Seleccionar Dades</h2>
<div class='content'><p>Per recuperar dades d'una base de dades, utilitzeu la sentència <code>SELECT</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJOYW1lIENoYXIoNTApOwpFeGVjIFNRTAogICAgU0VMRUNUIE5hbWUgSU5UTyA6Q3VzdG9tZXJOYW1lCiAgICBGUk9NIEN1c3RvbWVycwogICAgV0hFUkUgQ3VzdG9tZXJJRCA9IDE7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerName Char(50);
Exec SQL
    SELECT Name INTO :CustomerName
    FROM Customers
    WHERE CustomerID = 1;</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>Dcl-S CustomerName Char(50);</code>: Declara una variable per emmagatzemar el nom del client.</li>
<li><code>Exec SQL</code>: Indica l'inici d'una sentència SQL integrada.</li>
<li><code>SELECT Name INTO :CustomerName</code>: Selecciona el camp <code>Name</code> de la taula <code>Customers</code> i l'emmagatzema a la variable <code>CustomerName</code>.</li>
<li><code>WHERE CustomerID = 1;</code>: Especifica la condició per filtrar les dades.</li>
</ul>
</li>
</ul>
</div><h2>Inserir Dades</h2>
<div class='content'><p>Per afegir nous registres a una taula, utilitzeu la sentència <code>INSERT</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJJRCBJbnQoMTApOwpEY2wtUyBDdXN0b21lck5hbWUgQ2hhcig1MCk7CkN1c3RvbWVySUQgPSAyOwpDdXN0b21lck5hbWUgPSAnSm9obiBEb2UnOwoKRXhlYyBTUUwKICAgIElOU0VSVCBJTlRPIEN1c3RvbWVycyAoQ3VzdG9tZXJJRCwgTmFtZSkKICAgIFZBTFVFUyAoOkN1c3RvbWVySUQsIDpDdXN0b21lck5hbWUpOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerID Int(10);
Dcl-S CustomerName Char(50);
CustomerID = 2;
CustomerName = 'John Doe';

Exec SQL
    INSERT INTO Customers (CustomerID, Name)
    VALUES (:CustomerID, :CustomerName);</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>Dcl-S CustomerID Int(10);</code>: Declara una variable per a l'ID del client.</li>
<li><code>Dcl-S CustomerName Char(50);</code>: Declara una variable per al nom del client.</li>
<li><code>CustomerID = 2;</code>: Assigna un valor a la variable <code>CustomerID</code>.</li>
<li><code>CustomerName = 'John Doe';</code>: Assigna un valor a la variable <code>CustomerName</code>.</li>
<li><code>INSERT INTO Customers (CustomerID, Name)</code>: Especifica la taula i les columnes on inserir les dades.</li>
<li><code>VALUES (:CustomerID, :CustomerName);</code>: Proporciona els valors a inserir.</li>
</ul>
</li>
</ul>
</div><h2>Actualitzar Dades</h2>
<div class='content'><p>Per modificar registres existents, utilitzeu la sentència <code>UPDATE</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJJRCBJbnQoMTApOwpEY2wtUyBOZXdOYW1lIENoYXIoNTApOwpDdXN0b21lcklEID0gMjsKTmV3TmFtZSA9ICdKYW5lIERvZSc7CgpFeGVjIFNRTAogICAgVVBEQVRFIEN1c3RvbWVycwogICAgU0VUIE5hbWUgPSA6TmV3TmFtZQogICAgV0hFUkUgQ3VzdG9tZXJJRCA9IDpDdXN0b21lcklEOw=="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerID Int(10);
Dcl-S NewName Char(50);
CustomerID = 2;
NewName = 'Jane Doe';

Exec SQL
    UPDATE Customers
    SET Name = :NewName
    WHERE CustomerID = :CustomerID;</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>Dcl-S CustomerID Int(10);</code>: Declara una variable per a l'ID del client.</li>
<li><code>Dcl-S NewName Char(50);</code>: Declara una variable per al nou nom.</li>
<li><code>CustomerID = 2;</code>: Assigna un valor a la variable <code>CustomerID</code>.</li>
<li><code>NewName = 'Jane Doe';</code>: Assigna un valor a la variable <code>NewName</code>.</li>
<li><code>UPDATE Customers</code>: Especifica la taula a actualitzar.</li>
<li><code>SET Name = :NewName</code>: Estableix el nou valor per a la columna <code>Name</code>.</li>
<li><code>WHERE CustomerID = :CustomerID;</code>: Especifica la condició per identificar el registre a actualitzar.</li>
</ul>
</li>
</ul>
</div><h2>Esborrar Dades</h2>
<div class='content'><p>Per eliminar registres d'una taula, utilitzeu la sentència <code>DELETE</code>.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLVMgQ3VzdG9tZXJJRCBJbnQoMTApOwpDdXN0b21lcklEID0gMjsKCkV4ZWMgU1FMCiAgICBERUxFVEUgRlJPTSBDdXN0b21lcnMKICAgIFdIRVJFIEN1c3RvbWVySUQgPSA6Q3VzdG9tZXJJRDs="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-S CustomerID Int(10);
CustomerID = 2;

Exec SQL
    DELETE FROM Customers
    WHERE CustomerID = :CustomerID;</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>Dcl-S CustomerID Int(10);</code>: Declara una variable per a l'ID del client.</li>
<li><code>CustomerID = 2;</code>: Assigna un valor a la variable <code>CustomerID</code>.</li>
<li><code>DELETE FROM Customers</code>: Especifica la taula d'on esborrar.</li>
<li><code>WHERE CustomerID = :CustomerID;</code>: Especifica la condició per identificar el registre a esborrar.</li>
</ul>
</li>
</ul>
</div><h1>Gestió d'Errors amb SQLCA</h1>
<div class='content'><p>SQLCA (Àrea de Comunicació SQL) s'utilitza per gestionar errors i informació d'estat per a les operacions SQL.</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("RGNsLURTIFNRTENBOwogIFNRTENPREUgSW50KDEwKTsKICBTUUxTVEFURSBDaGFyKDUpOwpFbmQtRFM7CgpFeGVjIFNRTAogICAgU0VMRUNUIE5hbWUgSU5UTyA6Q3VzdG9tZXJOYW1lCiAgICBGUk9NIEN1c3RvbWVycwogICAgV0hFUkUgQ3VzdG9tZXJJRCA9IDE7CgpJZiBTUUxDQS5TUUxDT0RFIDw+IDA7CiAgLy8gR2VzdGlvbmFyIGVycm9yCiAgRHNwbHkgKCdFcnJvcjogJyArICVDaGFyKFNRTENBLlNRTENPREUpKTsKRW5kSWY7"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>Dcl-DS SQLCA;
  SQLCODE Int(10);
  SQLSTATE Char(5);
End-DS;

Exec SQL
    SELECT Name INTO :CustomerName
    FROM Customers
    WHERE CustomerID = 1;

If SQLCA.SQLCODE &lt;&gt; 0;
  // Gestionar error
  Dsply ('Error: ' + %Char(SQLCA.SQLCODE));
EndIf;</pre></div><div class='content'><ul>
<li><strong>Explicació</strong>:
<ul>
<li><code>Dcl-DS SQLCA;</code>: Declara l'estructura de dades SQLCA.</li>
<li><code>SQLCODE Int(10);</code>: Declara una variable per emmagatzemar el codi de retorn de SQL.</li>
<li><code>SQLSTATE Char(5);</code>: Declara una variable per emmagatzemar l'estat de SQL.</li>
<li><code>If SQLCA.SQLCODE &lt;&gt; 0;</code>: Comprova si hi ha hagut un error durant l'operació SQL.</li>
<li><code>Dsply ('Error: ' + %Char(SQLCA.SQLCODE));</code>: Mostra el codi d'error.</li>
</ul>
</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>Integrar SQL amb RPG pot millorar enormement la vostra capacitat per gestionar i manipular dades dins de les vostres aplicacions. Entenent i utilitzant operacions bàsiques de SQL com <code>SELECT</code>, <code>INSERT</code>, <code>UPDATE</code> i <code>DELETE</code>, podeu realitzar una àmplia gamma de tasques de processament de dades. A més, gestionar errors utilitzant SQLCA assegura que els vostres programes puguin gestionar i respondre adequadament als problemes que sorgeixin durant l'execució de SQL.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
