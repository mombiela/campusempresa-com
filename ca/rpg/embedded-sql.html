<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>

	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui<br> i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="https://campusempresa.com/rpg/embedded-sql" id="lnk_lang_es" data-lang="es">Castellano</a></b>
				|
				<b id="lit_lang_ca">Catala</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="objective">El Projecte</a>
				<a href="about">Sobre nosaltres</a>
				<a href="contribute">Contribuir</a>
				<a href="donate">Donacions</a>
				<a href="licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='content'><p>El SQL incrustat permet que els programes RPG executin instruccions SQL directament dins del codi. Aquesta integració proporciona capacitats poderoses de manipulació de bases de dades, combinant els punts forts de SQL amb la lògica procedimental de RPG.</p>
</div><h1>Introducció al SQL incrustat</h1>
<div class='content'><ul>
<li><strong>Definició</strong>: El SQL incrustat es refereix a la inclusió d'instruccions SQL dins d'un programa RPG.</li>
<li><strong>Propòsit</strong>: Aprofitar les capacitats de manipulació de dades de SQL directament dins de les aplicacions RPG.</li>
<li><strong>Beneficis</strong>:
<ul>
<li>Simplifica la recuperació i manipulació de dades complexes.</li>
<li>Millora el rendiment reduint la necessitat de múltiples crides a la base de dades.</li>
<li>Proporciona un codi més llegible i mantenible.</li>
</ul>
</li>
</ul>
</div><h1>Conceptes bàsics</h1>
<div class='content'></div><h2>Precompilador SQL</h2>
<div class='content'><ul>
<li><strong>Rol</strong>: El precompilador SQL processa les instruccions SQL incrustades abans que el compilador RPG.</li>
<li><strong>Funció</strong>: Converteix les instruccions SQL en crides a la biblioteca d'execució SQL.</li>
</ul>
</div><h2>SQLCA (Àrea de Comunicació SQL)</h2>
<div class='content'><ul>
<li><strong>Propòsit</strong>: Una estructura utilitzada per emmagatzemar informació sobre l'execució de les instruccions SQL.</li>
<li><strong>Camps clau</strong>:
<ul>
<li><code>SQLCODE</code>: Indica l'èxit o el fracàs d'una instrucció SQL.</li>
<li><code>SQLSTATE</code>: Proporciona informació detallada d'error o estat.</li>
</ul>
</li>
</ul>
</div><h2>Declarar SQL en RPG</h2>
<div class='content'><ul>
<li><strong>Sintaxi</strong>: Les instruccions SQL s'incrusten dins de RPG utilitzant les paraules clau <code>EXEC SQL</code> i <code>END-EXEC</code>.</li>
<li><strong>Exemple</strong>:
<pre><code class="language-rpg">EXEC SQL
  SELECT COUNT(*) INTO :recordCount FROM myTable;
END-EXEC;
</code></pre>
</li>
</ul>
</div><h1>Operacions bàsiques</h1>
<div class='content'></div><h2>Connexió a una base de dades</h2>
<div class='content'><ul>
<li><strong>Sintaxi</strong>:
<pre><code class="language-rpg">EXEC SQL
  CONNECT TO myDatabase USER myUser USING myPassword;
END-EXEC;
</code></pre>
</li>
<li><strong>Explicació</strong>: Estableix una connexió amb la base de dades especificada utilitzant les credencials proporcionades.</li>
</ul>
</div><h2>Instrucció SELECT simple</h2>
<div class='content'><ul>
<li><strong>Sintaxi</strong>:
<pre><code class="language-rpg">DCL-S recordCount INT(10);

EXEC SQL
  SELECT COUNT(*) INTO :recordCount FROM myTable;
END-EXEC;
</code></pre>
</li>
<li><strong>Explicació</strong>: Recupera el recompte de registres de <code>myTable</code> i l'emmagatzema a la variable <code>recordCount</code>.</li>
</ul>
</div><h2>Inserir dades</h2>
<div class='content'><ul>
<li><strong>Sintaxi</strong>:
<pre><code class="language-rpg">DCL-S myValue CHAR(50);

myValue = 'Sample Data';

EXEC SQL
  INSERT INTO myTable (myColumn) VALUES (:myValue);
END-EXEC;
</code></pre>
</li>
<li><strong>Explicació</strong>: Insereix un nou registre a <code>myTable</code> amb el valor de <code>myValue</code>.</li>
</ul>
</div><h1>Operacions avançades</h1>
<div class='content'></div><h2>Ús de cursos</h2>
<div class='content'><ul>
<li>
<p><strong>Definició</strong>: Els cursos permeten el processament fila per fila dels resultats de la consulta.</p>
</li>
<li>
<p><strong>Passos</strong>:</p>
<ol>
<li>Declarar el curs.</li>
<li>Obrir el curs.</li>
<li>Recuperar files del curs.</li>
<li>Tancar el curs.</li>
</ol>
</li>
<li>
<p><strong>Exemple</strong>:</p>
<pre><code class="language-rpg">DCL-S myColumn CHAR(50);

EXEC SQL
  DECLARE myCursor CURSOR FOR
  SELECT myColumn FROM myTable;
END-EXEC;

EXEC SQL
  OPEN myCursor;
END-EXEC;

DOU SQLCODE &lt;&gt; 0;
  EXEC SQL
    FETCH myCursor INTO :myColumn;
  END-EXEC;

  // Processar la fila recuperada
ENDDO;

EXEC SQL
  CLOSE myCursor;
END-EXEC;
</code></pre>
</li>
</ul>
</div><h2>Gestió d'errors</h2>
<div class='content'><ul>
<li>
<p><strong>Utilitzant SQLCODE</strong>:</p>
<pre><code class="language-rpg">EXEC SQL
  SELECT myColumn INTO :myValue FROM myTable WHERE myID = 1;
END-EXEC;

IF SQLCODE &lt;&gt; 0;
  // Gestionar error
ENDIF;
</code></pre>
</li>
<li>
<p><strong>Utilitzant SQLSTATE</strong>:</p>
<pre><code class="language-rpg">DCL-S sqlState CHAR(5);

EXEC SQL
  SELECT myColumn INTO :myValue FROM myTable WHERE myID = 1;
END-EXEC;

sqlState = SQLSTATE;

IF sqlState &lt;&gt; '00000';
  // Gestionar error
ENDIF;
</code></pre>
</li>
</ul>
</div><h1>Consideracions de rendiment</h1>
<div class='content'><ul>
<li><strong>Ús d'índexs</strong>: Assegureu-vos que les consultes utilitzin índexs per millorar el rendiment.</li>
<li><strong>Processament per lots</strong>: Utilitzeu el processament per lots per a manipulacions de dades grans per reduir la sobrecàrrega.</li>
<li><strong>Optimització</strong>: Reviseu i optimitzeu regularment les instruccions SQL per obtenir un millor rendiment.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>El SQL incrustat en RPG proporciona una manera poderosa d'interactuar amb bases de dades directament dins dels vostres programes RPG. Comprenent i utilitzant el SQL incrustat, podeu escriure codi més eficient, llegible i mantenible. Aquest tema ha cobert els conceptes bàsics del SQL incrustat, incloent la connexió a una base de dades, l'execució d'operacions SQL simples i avançades, i la gestió d'errors. A mesura que avanceu, considereu explorar operacions SQL més complexes i tècniques d'optimització de rendiment per aprofitar al màxim el poder del SQL incrustat en RPG.</p>
</div></div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
       <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
       <a href="cookies">Més informació</a>
   </div>	
	</div>    
</body>
</html>
