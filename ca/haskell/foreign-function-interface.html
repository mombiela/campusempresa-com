<!DOCTYPE html>
<html lang="ca">
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interfície de Funcions Externes (FFI) en Haskell</title>

    <link rel="alternate" href="https://campusempresa.com/es/haskell/foreign-function-interface" hreflang="es" />
    <link rel="alternate" href="https://campusempresa.com/es/haskell/foreign-function-interface" hreflang="x-default" />
	<link rel="alternate" href="https://campusempresa.com/ca/haskell/foreign-function-interface" hreflang="ca" />
    
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
	<link href="/css/site.css" rel="stylesheet">
	
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
  	<script type="text/javascript" src="js/math_init.js"></script>
  	<script type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js"></script>
  	<script type="text/javascript" src="/js/cookie.js"></script>
  	<script type="text/javascript" src="/js/main.js"></script>
</head>

<body>
    <div id="content">
		<div id="header" class="container-xxl">
	<div class="row">
		<div class="col-8 p-0">
			<h1 class="m-0 p-0">
				<a href="/ca/"><img src="/img/logo_header.png" style="visibility:hiddenxx;"></a>
			</h1>
		</div>
		<div class="col-4 p-0 text-end">
			<h2 id="main_title"><cite>Construint la societat d'avui i del demà</cite></h2>
			<h3 id="main_subtitle"></h3>
		</div>
	</div>
</div>
<div class="container-xxl" style="margin-top: -1em;">
	<div class="row">
		<div class="col-12 p-0 m-0 text-end">
							<a href="/es/haskell/foreign-function-interface" id="lnk_lang_es" data-lang="es" class="px-2">ES</a></b>
				|
				<b id="lit_lang_ca" class="px-2">CA</b>
								</div>
	</div>
</div>
   <div class="top-bar container-fluid">
	<div class="container-xxl">
		<div class="row">
			<div class="col" id="left_menu">
				<a href="/ca/objective">El Projecte</a>
				<a href="/ca/about">Sobre nosaltres</a>
				<a href="/ca/contribute">Contribuir</a>
				<a href="/ca/donate">Donacions</a>
				<a href="/ca/licence">Llicència</a>
			</div>
		</div>
	</div>
   </div>

<div class="container-xxl" id="main_content">
	<div class="row">
		<div class="col-12 col-lg-8">
			<div id="nav1" class="navigation"></div>
			<div id="inner_content"><div class='row navigation'>
	<div class='col-4'>
					<a href='concurrency-parallelism'>&#x25C4;Concurrència i Paral·lelisme</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfície de Funcions Externes (FFI) en Haskell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='template-haskell'>Template Haskell &#x25BA;</a>
			</div>
</div>
<div class='content'></div><h1>Introducció a FFI</h1>
<div class='content'><p>La Interfície de Funcions Externes (FFI) permet que els programes Haskell cridin funcions escrites en altres llenguatges de programació, com ara C. Això és particularment útil per aprofitar biblioteques existents, optimitzar seccions crítiques de rendiment o interfície amb APIs a nivell de sistema.</p>
</div><h2>Conceptes Clau</h2>
<div class='content'><ul>
<li><strong>Imports Externs</strong>: Declarar funcions externes en Haskell.</li>
<li><strong>Exports Externs</strong>: Fer que les funcions Haskell estiguin disponibles per a altres llenguatges.</li>
<li><strong>Marshalling</strong>: Convertir dades entre Haskell i el llenguatge extern.</li>
</ul>
</div><h1>Imports Externs</h1>
<div class='content'></div><h2>Declarar Funcions Externes</h2>
<div class='content'><p>Per cridar una funció escrita en C des de Haskell, cal declarar-la utilitzant la paraula clau <code>foreign import</code>.</p>
<h4>Exemple: Importar una Funció C</h4>
<p>Suposem que tens una funció C <code>int add(int a, int b)</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gYWRkLmMKI2luY2x1ZGUgPHN0ZGlvLmg+CgppbnQgYWRkKGludCBhLCBpbnQgYikgewogICAgcmV0dXJuIGEgKyBiOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// add.c
#include &lt;stdio.h&gt;

int add(int a, int b) {
    return a + b;
}</pre></div><div class='content'><p>Pots importar aquesta funció a Haskell de la següent manera:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gQWRkLmhzCnstIyBMQU5HVUFHRSBGb3JlaWduRnVuY3Rpb25JbnRlcmZhY2UgIy19Cgptb2R1bGUgQWRkIHdoZXJlCgpmb3JlaWduIGltcG9ydCBjY2FsbCAiYWRkIiBjX2FkZCA6OiBJbnQgLT4gSW50IC0+IEludAoKbWFpbiA6OiBJTyAoKQptYWluID0gZG8KICAgIGxldCByZXN1bHQgPSBjX2FkZCA1IDMKICAgIHB1dFN0ckxuICQgIkVsIHJlc3VsdGF0IMOpczogIiArKyBzaG93KHJlc3VsdCk="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Add.hs
{-# LANGUAGE ForeignFunctionInterface #-}

module Add where

foreign import ccall &quot;add&quot; c_add :: Int -&gt; Int -&gt; Int

main :: IO ()
main = do
    let result = c_add 5 3
    putStrLn $ &quot;El resultat &eacute;s: &quot; ++ show(result)</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>foreign import ccall &quot;add&quot;</code>: Indica que estem important una funció C anomenada <code>add</code>.</li>
<li><code>c_add :: Int -&gt; Int -&gt; Int</code>: Especifica la signatura de tipus Haskell per a la funció importada.</li>
</ul>
</div><h1>Exports Externs</h1>
<div class='content'></div><h2>Fer Funcions Haskell Disponibles per a C</h2>
<div class='content'><p>També pots fer que les funcions Haskell siguin cridables des de C utilitzant la paraula clau <code>foreign export</code>.</p>
<h4>Exemple: Exportar una Funció Haskell</h4>
<p>Suposem que tens una funció Haskell <code>multiply</code>:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gTXVsdGlwbHkuaHMKey0jIExBTkdVQUdFIEZvcmVpZ25GdW5jdGlvbkludGVyZmFjZSAjLX0KCm1vZHVsZSBNdWx0aXBseSB3aGVyZQoKZm9yZWlnbiBleHBvcnQgY2NhbGwgbXVsdGlwbHkgOjogSW50IC0+IEludCAtPiBJbnQKCm11bHRpcGx5IDo6IEludCAtPiBJbnQgLT4gSW50Cm11bHRpcGx5IGEgYiA9IGEgKiBi"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Multiply.hs
{-# LANGUAGE ForeignFunctionInterface #-}

module Multiply where

foreign export ccall multiply :: Int -&gt; Int -&gt; Int

multiply :: Int -&gt; Int -&gt; Int
multiply a b = a * b</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>foreign export ccall multiply</code>: Indica que estem exportant la funció Haskell <code>multiply</code> per ser cridada des de C.</li>
<li><code>multiply :: Int -&gt; Int -&gt; Int</code>: Especifica la funció Haskell que s'exportarà.</li>
</ul>
</div><h1>Marshalling de Dades</h1>
<div class='content'></div><h2>Convertir Tipus de Dades</h2>
<div class='content'><p>Quan s'interfície amb funcions externes, sovint cal convertir dades entre Haskell i el llenguatge extern. Aquest procés es coneix com a marshalling.</p>
<h4>Exemple: Marshalling de Cadenes</h4>
<p>Considera una funció C que pren una cadena:</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("Ly8gZ3JlZXQuYwojaW5jbHVkZSA8c3RkaW8uaD4KCnZvaWQgZ3JlZXQoY29uc3QgY2hhciogbmFtZSkgewogICAgcHJpbnRmKCJIb2xhLCAlcyFcbiIsIG5hbWUpOwp9"))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>// greet.c
#include &lt;stdio.h&gt;

void greet(const char* name) {
    printf(&quot;Hola, %s!\n&quot;, name);
}</pre></div><div class='content'><p>Pots cridar aquesta funció des de Haskell fent marshalling d'una <code>String</code> Haskell a una cadena C (<code>CString</code>):</p>
</div><div style='position:relative'><a class='copy_button' href='#' onclick='navigator.clipboard.writeText(decodeURIComponent(escape(atob("LS0gR3JlZXQuaHMKey0jIExBTkdVQUdFIEZvcmVpZ25GdW5jdGlvbkludGVyZmFjZSAjLX0KCm1vZHVsZSBHcmVldCB3aGVyZQoKaW1wb3J0IEZvcmVpZ24uQy5TdHJpbmcgKENTdHJpbmcsIHdpdGhDU3RyaW5nKQoKZm9yZWlnbiBpbXBvcnQgY2NhbGwgImdyZWV0IiBjX2dyZWV0IDo6IENTdHJpbmcgLT4gSU8gKCkKCmdyZWV0IDo6IFN0cmluZyAtPiBJTyAoKQpncmVldCBuYW1lID0gd2l0aENTdHJpbmcgbmFtZSBjX2dyZWV0CgptYWluIDo6IElPICgpCm1haW4gPSBncmVldCAiSGFza2VsbCI="))));alert("Copiat!");return false;'><i class='bi bi-copy'></i></a><pre class='code'>-- Greet.hs
{-# LANGUAGE ForeignFunctionInterface #-}

module Greet where

import Foreign.C.String (CString, withCString)

foreign import ccall &quot;greet&quot; c_greet :: CString -&gt; IO ()

greet :: String -&gt; IO ()
greet name = withCString name c_greet

main :: IO ()
main = greet &quot;Haskell&quot;</pre></div><div class='content'></div><h2>Explicació</h2>
<div class='content'><ul>
<li><code>import Foreign.C.String (CString, withCString)</code>: Importa les funcions necessàries per al marshalling de cadenes.</li>
<li><code>withCString name c_greet</code>: Converteix la <code>String</code> Haskell a una <code>CString</code> i crida la funció C.</li>
</ul>
</div><h1>Conclusió</h1>
<div class='content'><p>La Interfície de Funcions Externes (FFI) en Haskell és una característica poderosa que permet cridar funcions escrites en altres llenguatges i fer que les funcions Haskell estiguin disponibles per a aquests llenguatges. Entenent com declarar imports i exports externs, i com fer marshalling de dades entre Haskell i el llenguatge extern, pots ampliar les capacitats dels teus programes Haskell i integrar-los amb una àmplia gamma de biblioteques i sistemes externs.</p>
</div><div class='row navigation'>
	<div class='col-4'>
					<a href='concurrency-parallelism'>&#x25C4;Concurrència i Paral·lelisme</a>
			</div>
	<div class='col-4 text-center'>
		<a href="./" class="title">Interfície de Funcions Externes (FFI) en Haskell</a>
	</div>
	<div class='col-4 text-end'>
					<a href='template-haskell'>Template Haskell &#x25BA;</a>
			</div>
</div>
</div>
		</div>
		<div class="col-12 col-lg-4 publi" id="div_publi">
			<h1>Publicitat</h1>
			<p>Aquest espai està destinat a publicitat.</p>
			<p>Si vols ser patrocinador, contacta amb nosaltres per incloure enllaços en aquesta zona: <a href='mailto:admin@campusempresa.cat'>admin@campusempresa.cat</a></p>
			<p>Gràcies per col·laborar!</p>
		</div>
	</div>
</div>

   <div class="container-xxl my-3">
	<div class="row">
		<div class="col">
			<footer>&copy; Copyright 2024. Tots els drets reservats</footer>
		</div>
	</div>
</div>	

<div id="cookies_adv" style="display:none;">
	Fem servir galetes per millorar la teva experiència d'ús i oferir continguts adaptats als teus interessos
    <a href="#" id="btn_accept_cookies" class="button">Entès!</a>
    <a href="/ca/cookies">Més informació</a>
</div>	

	</div>    
</body>
</html>
